(window.webpackJsonp=window.webpackJsonp||[]).push([[100,101,525,526],{"./node_modules/lodash/_baseEach.js":function(e,n,t){var a=t("./node_modules/lodash/_baseForOwn.js"),o=t("./node_modules/lodash/_createBaseEach.js")(a);e.exports=o},"./node_modules/lodash/_baseFor.js":function(e,n,t){var a=t("./node_modules/lodash/_createBaseFor.js")();e.exports=a},"./node_modules/lodash/_baseForOwn.js":function(e,n,t){var a=t("./node_modules/lodash/_baseFor.js"),o=t("./node_modules/lodash/keys.js");e.exports=function(e,n){return e&&a(e,n,o)}},"./node_modules/lodash/_castFunction.js":function(e,n,t){var a=t("./node_modules/lodash/identity.js");e.exports=function(e){return"function"==typeof e?e:a}},"./node_modules/lodash/_createBaseEach.js":function(e,n,t){var a=t("./node_modules/lodash/isArrayLike.js");e.exports=function(e,n){return function(t,o){if(null==t)return t;if(!a(t))return e(t,o);for(var s=t.length,i=n?s:-1,l=Object(t);(n?i--:++i<s)&&!1!==o(l[i],i,l););return t}}},"./node_modules/lodash/_createBaseFor.js":function(e,n){e.exports=function(e){return function(n,t,a){for(var o=-1,s=Object(n),i=a(n),l=i.length;l--;){var r=i[e?l:++o];if(!1===t(s[r],r,s))break}return n}}},"./node_modules/lodash/forOwn.js":function(e,n,t){var a=t("./node_modules/lodash/_baseForOwn.js"),o=t("./node_modules/lodash/_castFunction.js");e.exports=function(e,n){return e&&a(e,o(n))}},"./src/Common/CountryMap/CountryMapController.js":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=v(t("./node_modules/babel-runtime/helpers/classCallCheck.js")),o=v(t("./node_modules/babel-runtime/helpers/createClass.js")),s=v(t("./node_modules/lodash/keys.js")),i=v(t("./node_modules/lodash/reduce.js")),l=v(t("./node_modules/lodash/forOwn.js")),r=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}(t("./node_modules/topojson/dist/topojson.js")),c=v(t("./node_modules/svg-pan-zoom/src/browserify.js")),d=v(t("./node_modules/d3/d3.js"));function v(e){return e&&e.__esModule?e:{default:e}}var m=function(){function e(n,t,o){(0,a.default)(this,e),this.el=n,this.scope=t,this.state=o,this.EE=window.EE,this.tooltipOver=!1,this.preventMouseOut=!1,this.checkIfCountryChanged=this.checkIfCountryChanged.bind(this),this.checkIfDistrictDataChanged=this.checkIfDistrictDataChanged.bind(this),this.createInMemoryDOMElement=this.createInMemoryDOMElement.bind(this),this.drawMapShape=this.drawMapShape.bind(this),this.$onInit=this.onInit,this.$onDestroy=this.onDestroy}return(0,o.default)(e,[{key:"onInit",value:function(){this.showPlaceholder=!this.big,this.svgPanZoom=c.default,this.covLib={},this.svgLib={},this.drawnMap=null,this.createInMemoryDOMElement(),this.watchers()}},{key:"createInMemoryDOMElement",value:function(){this.elementContainer=d.default.select(this.el[0]).append("div").attr("class","countrymapcontainer");var e=this.elementContainer[0][0].offsetWidth,n=this.big?d.default.select("#map")[0][0].offsetHeight:409,t=document.createElement("div");this.mapDOMElement=d.default.select(t).append("svg"),this.mapDOMElement.attr("class","countrymap").attr("width",e).attr("height",n)}},{key:"onDestroy",value:function(){this.data=!1,this.countryMapData=!1}},{key:"watchers",value:function(){this.scope.$watch(function(e){return e.vm.mapData},this.checkIfCountryChanged),this.scope.$watch(function(e){return e.vm.districtLevelCoverage},this.checkIfDistrictDataChanged,!0)}},{key:"checkIfCountryChanged",value:function(e){e&&e.mapData&&e.name!==this.drawnMap&&(this.drawMapShape(e),this.drawnMap=e.name)}},{key:"checkIfDistrictDataChanged",value:function(e){e&&this.drawnMap&&(this.boundNrs=(0,i.default)(e,function(e,n,t){return"date"===t?e:((0,l.default)(n,function(n,t){e[t]=(e[t]||0)+n}),e)},{}),this.fillDistrictData(e))}},{key:"setGlobal",value:function(){this.showNationalLevelCoverage=!0;var e=document.getElementsByClassName("d3district");Array.prototype.forEach.call(e,function(e){e.classList.add("global")})}},{key:"setTotal",value:function(){this.showNationalLevelCoverage=!1;var e=document.getElementsByClassName("d3district");Array.prototype.forEach.call(e,function(e){e.classList.remove("global")})}},{key:"makeGeoFromTopo",value:function(e){var n=(0,s.default)(e.objects)[0];return r.feature(e,e.objects[n])}},{key:"calculateScale",value:function(e){return 10*Math.max.apply(null,e.transform.scale.map(function(e){return 1/e}))}},{key:"makeSvgPannableAndZoomable",value:function(e){this.svgZoom=this.svgPanZoom(e,{panEnabled:!0,controlIconsEnabled:!1,zoomEnabled:!0,mouseWheelZoomEnabled:!1,preventMouseEventsDefault:!0,zoomScaleSensitivity:.2,minZoom:.5,maxZoom:10,contain:!1,center:!0,refreshRate:"auto"}),this.svgZoom.zoomOut()}},{key:"drawMapShape",value:function(e){var n=this;this.showPlaceholder=!0;var t=this;this.drawnMap&&(d.default.select(this.el[0]).select(".countrymapcontainer").remove(),this.createInMemoryDOMElement()),this.countryName=e.name,this.flagUrl=e.flag;var a=this.makeGeoFromTopo(e.mapData),o=d.default.geo.mercator().scale(this.calculateScale(e.mapData)),s=d.default.geo.path().projection(o);a.features.forEach(function(o){var i=o.properties.name||o.properties["wof:name"],l=e.districts.find(function(e){return e.id===i});n.svgLib[l.id]=n.mapDOMElement.append("path").datum({type:a.type,geocoding:a.geocoding,features:[o],name:l.name}).attr("d",s).classed("d3district",!0).classed("global",n.showNationalLevelCoverage).classed("name-"+l.id,!0).on("click",function(){n.scope.$evalAsync(function(){n.activeDistrict={name:l.name,data:t.svgLib[l.id]?t.svgLib[l.id].districtData:null}})})}),this.elementContainer.append(function(){return n.mapDOMElement.node()}),this.makeSvgPannableAndZoomable(this.mapDOMElement.node()),this.showPlaceholder=!1}},{key:"fillDistrictData",value:function(e){for(var n in this.svgLib){var t=this.svgLib[n];e[n]?(t.classed("d3district-data",!0),t.districtData=e[n]):(t.classed("d3district-data",!1),t.districtData=null)}}},{key:"goToProject",value:function(e){this.state.go("editProject",{appName:e.id,editMode:"publish"})}}],[{key:"countrymapFactory",value:function(){function n(n,t,a){return new e(n,t,a)}return t("./src/Common/CountryMap/Countrymap.scss"),n.$inject=["$element","$scope","$state"],n}}]),e}();n.default=m},"./src/Common/CountryMap/Countrymap.html":function(e,n){e.exports='<div class="relative">\n\n  \x3c!-- for DASH --\x3e\n  <div class="countrychart-tooltip md-whiteframe-2dp" ng-if="!vm.big" ng-hide="vm.showPlaceholder">\n\n    <div class="countrychart-tooltip-header bold" layout="row" layout-align="space-between">\n      <p flex>{{vm.countryName}}</p>\n      <img class="tooltip-flag" ng-src="{{vm.flagUrl}}">\n    </div>\n\n    <md-tabs md-no-pagination md-dynamic-height md-stretch-tabs="always">\n      <md-tab label="{{\'Total\'|translate}}">\n\n        <div class="countrychart-tooltip-main" layout="column">\n\n          <div flex layout="row" class="coverage-data" >\n            <div flex class="cap lh">\n              <translate>Clients: </translate>\n            </div>\n            <div class="bold lh colorednr color0">{{vm.boundNrs.clients || 0}}</div>\n          </div>\n          <div flex layout="row" class="coverage-data">\n            <div flex class="cap lh">\n              <translate>Health Workers: </translate>\n            </div>\n            <div class="bold lh colorednr color1">{{vm.boundNrs.health_workers || 0}}</div>\n          </div>\n          <div flex layout="row" class="coverage-data">\n            <div flex class="cap lh">\n              <translate>Facilities: </translate>\n            </div>\n            <div class="bold lh colorednr color2">{{vm.boundNrs.facilities || 0}}</div>\n          </div>\n\n        </div>\n\n        <div class="countrychart-tooltip-main main2" ng-show="vm.activeDistrict.name" >\n\n          <div flex class="activename bold lh">\n            {{vm.activeDistrict.name}}\n          </div>\n\n          <div ng-show="vm.activeDistrict.data">\n            <div flex\n                 class="coverage-data"\n                 layout="row">\n              <div flex class="cap lh">\n                <translate>Clients: </translate>\n              </div>\n              <div class="bold lh colorednr color0">{{vm.activeDistrict.data.clients}}</div>\n            </div>\n            <div flex\n                 class="coverage-data"\n                 layout="row">\n              <div flex class="cap lh">\n                <translate>Health Workers: </translate>\n              </div>\n              <div class="bold lh colorednr color1">{{vm.activeDistrict.data.health_workers}}</div>\n            </div>\n            <div flex\n                 class="coverage-data"\n                 layout="row">\n              <div flex class="cap lh">\n                <translate>Facilities: </translate>\n              </div>\n              <div class="bold lh colorednr color2">{{vm.activeDistrict.data.facilities}}</div>\n            </div>\n          </div>\n          <div class="bold lh" ng-show="!vm.activeDistrict.data" translate>No coverage data</div>\n\n        </div>\n\n      </md-tab>\n      <md-tab label="{{\'Global\'|translate}}" md-on-select="vm.setGlobal()" md-on-deselect="vm.setTotal()">\n\n        <div class="countrychart-tooltip-main">\n\n          <div ng-show="vm.nationalLevelCoverage">\n            <div flex class="coverage-data" layout="row">\n              <div flex class="cap lh">\n                <translate>Clients: </translate>\n              </div>\n              <div class="bold lh colorednr color0">{{vm.nationalLevelCoverage.clients}}</div>\n            </div>\n\n            <div flex class="coverage-data" layout="row">\n              <div flex class="cap lh">\n                <translate>Health Workers: </translate>\n              </div>\n              <div class="bold lh colorednr color1">{{vm.nationalLevelCoverage.health_workers}}</div>\n            </div>\n\n            <div flex class="coverage-data"layout="row">\n              <div flex class="cap lh">\n                <translate>Facilities: </translate>\n              </div>\n              <div class="bold lh colorednr color2">{{vm.nationalLevelCoverage.facilities}}</div>\n            </div>\n\n          </div>\n\n          <div class="bold lh" ng-show="!vm.nationalLevelCoverage" translate>No national coverage</div>\n\n        </div>\n\n      </md-tab>\n    </md-tabs>\n  </div>\n\n  \x3c!-- for CLV --\x3e\n  <div class="countrychart-tooltip md-whiteframe-2dp" ng-if="vm.big" ng-hide="!vm.mapData">\n\n    <div class="countrychart-tooltip-header bold">\n      {{vm.countryName}} {{vm.activeDistrict.name ? \'-\' : \'\'}} {{vm.activeDistrict.name}}\n      <img class ="tooltip-flag" ng-src="{{vm.flagUrl}}">\n    </div>\n\n    <md-tabs md-no-pagination md-dynamic-height md-stretch-tabs="always">\n\n      <md-tab label="{{\'Sub-national\'|translate}}">\n\n        <div class="countrychart-tooltip-main countrychart-tooltip-main-big mainbig" ng-show="vm.activeDistrict.name" >\n\n          <div\n            flex\n            layout="column"\n            layout-align="space-around start"\n            class="projectcont"\n            ng-repeat="project in vm.activeDistrict.data | limitTo:5"\n            ng-click="vm.goToProject(project)">\n\n            <div class="projectname">{{project.name}}</div>\n            <div class="projectorg">{{project.organisation}}</div>\n\n            <div class="country-approved" ng-show="project.approved">\n              <i class="material-icons">assignment_turned_in</i>\n              <translate>Verified by country</translate>\n            </div>\n\n            <div ng-show="project.isMember" class="my-star"><md-icon>grade</md-icon></div>\n            <div ng-show="project.isViewer" class="my-eye"><md-icon>visibility</md-icon></div>\n          </div>\n          <div class="bold lh no-projects" ng-show="!vm.activeDistrict.data" translate>No projects available</div>\n        </div>\n      </md-tab>\n\n      <md-tab label="{{\'National\'|translate}}" md-on-select="vm.setGlobal()" md-on-deselect="vm.setTotal()">\n        <div class="countrychart-tooltip-main countrychart-tooltip-main-big mainbig">\n\n          <div flex\n               layout="column"\n               layout-align="space-around start"\n               class="projectcont"\n               ng-repeat="project in vm.nationalLevelCoverage | limitTo:5"\n               ng-click="vm.goToProject(project)">\n\n            <div class="projectname">{{project.name}}</div>\n            <div class="projectorg">{{project.organisation_name}}</div>\n\n            <div class="country-approved" ng-show="project.approved">\n              <i class="material-icons">assignment_turned_in</i>\n              <translate>Verified by country</translate>\n            </div>\n\n            <div ng-show="project.isMember" class="my-star"><md-icon>grade</md-icon></div>\n            <div ng-show="project.isViewer" class="my-eye"><md-icon>visibility</md-icon></div>\n          </div>\n          <div class="bold lh no-projects" ng-show="!vm.nationalLevelCoverage" translate>No projects available</div>\n        </div>\n      </md-tab>\n    </md-tabs>\n  </div>\n\n  <div ng-class="[\'zoomhandlers\', {zoomhandlers2: vm.big}]" ng-hide="!vm.mapData">\n    <div>\n      <md-icon class="material-icons unselectable" ng-click="vm.svgZoom.zoomIn()">add_circle_outline</md-icon>\n    </div>\n    <div>\n      <md-icon class="material-icons unselectable" ng-click="vm.svgZoom.zoomOut()">remove_circle_outline</md-icon>\n    </div>\n  </div>\n\n  \x3c!-- Placeholder spinner --\x3e\n  <div class="spinner" layout="row" layout-align="center center" ng-show="vm.showPlaceholder">\n    <span flex>Loading map</span>\n    <md-progress-circular flex md-mode="indeterminate" md-diameter="50"></md-progress-circular>\n  </div>\n\n</div>\n'},"./src/Common/CountryMap/Countrymap.scss":function(e,n,t){},"./src/Common/CountryMap/countrymap.js":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=o(t("./src/Common/CountryMap/Countrymap.html"));function o(e){return e&&e.__esModule?e:{default:e}}var s={controller:o(t("./src/Common/CountryMap/CountryMapController.js")).default.countrymapFactory(),controllerAs:"vm",template:a.default,name:"countrymap",bindings:{big:"<",districtLevelCoverage:"<",nationalLevelCoverage:"<",mapData:"<"}};n.default=s}}]);