(window.webpackJsonp=window.webpackJsonp||[]).push([[101,525],{"./node_modules/lodash/_baseEach.js":function(e,t,a){var o=a("./node_modules/lodash/_baseForOwn.js"),n=a("./node_modules/lodash/_createBaseEach.js")(o);e.exports=n},"./node_modules/lodash/_baseFor.js":function(e,t,a){var o=a("./node_modules/lodash/_createBaseFor.js")();e.exports=o},"./node_modules/lodash/_baseForOwn.js":function(e,t,a){var o=a("./node_modules/lodash/_baseFor.js"),n=a("./node_modules/lodash/keys.js");e.exports=function(e,t){return e&&o(e,t,n)}},"./node_modules/lodash/_castFunction.js":function(e,t,a){var o=a("./node_modules/lodash/identity.js");e.exports=function(e){return"function"==typeof e?e:o}},"./node_modules/lodash/_createBaseEach.js":function(e,t,a){var o=a("./node_modules/lodash/isArrayLike.js");e.exports=function(e,t){return function(a,n){if(null==a)return a;if(!o(a))return e(a,n);for(var s=a.length,i=t?s:-1,r=Object(a);(t?i--:++i<s)&&!1!==n(r[i],i,r););return a}}},"./node_modules/lodash/_createBaseFor.js":function(e,t){e.exports=function(e){return function(t,a,o){for(var n=-1,s=Object(t),i=o(t),r=i.length;r--;){var l=i[e?r:++n];if(!1===a(s[l],l,s))break}return t}}},"./node_modules/lodash/forOwn.js":function(e,t,a){var o=a("./node_modules/lodash/_baseForOwn.js"),n=a("./node_modules/lodash/_castFunction.js");e.exports=function(e,t){return e&&o(e,n(t))}},"./src/Common/CountryMap/CountryMapController.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=u(a("./node_modules/babel-runtime/helpers/classCallCheck.js")),n=u(a("./node_modules/babel-runtime/helpers/createClass.js")),s=u(a("./node_modules/lodash/keys.js")),i=u(a("./node_modules/lodash/reduce.js")),r=u(a("./node_modules/lodash/forOwn.js")),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a("./node_modules/topojson/dist/topojson.js")),c=u(a("./node_modules/svg-pan-zoom/src/browserify.js")),d=u(a("./node_modules/d3/d3.js"));function u(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t,a,n){(0,o.default)(this,e),this.el=t,this.scope=a,this.state=n,this.EE=window.EE,this.tooltipOver=!1,this.preventMouseOut=!1,this.checkIfCountryChanged=this.checkIfCountryChanged.bind(this),this.checkIfDistrictDataChanged=this.checkIfDistrictDataChanged.bind(this),this.createInMemoryDOMElement=this.createInMemoryDOMElement.bind(this),this.drawMapShape=this.drawMapShape.bind(this),this.$onInit=this.onInit,this.$onDestroy=this.onDestroy}return(0,n.default)(e,[{key:"onInit",value:function(){this.showPlaceholder=!this.big,this.svgPanZoom=c.default,this.covLib={},this.svgLib={},this.drawnMap=null,this.createInMemoryDOMElement(),this.watchers()}},{key:"createInMemoryDOMElement",value:function(){this.elementContainer=d.default.select(this.el[0]).append("div").attr("class","countrymapcontainer");var e=this.elementContainer[0][0].offsetWidth,t=this.big?d.default.select("#map")[0][0].offsetHeight:409,a=document.createElement("div");this.mapDOMElement=d.default.select(a).append("svg"),this.mapDOMElement.attr("class","countrymap").attr("width",e).attr("height",t)}},{key:"onDestroy",value:function(){this.data=!1,this.countryMapData=!1}},{key:"watchers",value:function(){this.scope.$watch(function(e){return e.vm.mapData},this.checkIfCountryChanged),this.scope.$watch(function(e){return e.vm.districtLevelCoverage},this.checkIfDistrictDataChanged,!0)}},{key:"checkIfCountryChanged",value:function(e){e&&e.mapData&&e.name!==this.drawnMap&&(this.drawMapShape(e),this.drawnMap=e.name)}},{key:"checkIfDistrictDataChanged",value:function(e){e&&this.drawnMap&&(this.boundNrs=(0,i.default)(e,function(e,t,a){return"date"===a?e:((0,r.default)(t,function(t,a){e[a]=(e[a]||0)+t}),e)},{}),this.fillDistrictData(e))}},{key:"setGlobal",value:function(){this.showNationalLevelCoverage=!0;var e=document.getElementsByClassName("d3district");Array.prototype.forEach.call(e,function(e){e.classList.add("global")})}},{key:"setTotal",value:function(){this.showNationalLevelCoverage=!1;var e=document.getElementsByClassName("d3district");Array.prototype.forEach.call(e,function(e){e.classList.remove("global")})}},{key:"makeGeoFromTopo",value:function(e){var t=(0,s.default)(e.objects)[0];return l.feature(e,e.objects[t])}},{key:"calculateScale",value:function(e){return 10*Math.max.apply(null,e.transform.scale.map(function(e){return 1/e}))}},{key:"makeSvgPannableAndZoomable",value:function(e){this.svgZoom=this.svgPanZoom(e,{panEnabled:!0,controlIconsEnabled:!1,zoomEnabled:!0,mouseWheelZoomEnabled:!1,preventMouseEventsDefault:!0,zoomScaleSensitivity:.2,minZoom:.5,maxZoom:10,contain:!1,center:!0,refreshRate:"auto"}),this.svgZoom.zoomOut()}},{key:"drawMapShape",value:function(e){var t=this;this.showPlaceholder=!0;var a=this;this.drawnMap&&(d.default.select(this.el[0]).select(".countrymapcontainer").remove(),this.createInMemoryDOMElement()),this.countryName=e.name,this.flagUrl=e.flag;var o=this.makeGeoFromTopo(e.mapData),n=d.default.geo.mercator().scale(this.calculateScale(e.mapData)),s=d.default.geo.path().projection(n);o.features.forEach(function(n){var i=n.properties.name||n.properties["wof:name"],r=e.districts.find(function(e){return e.id===i});t.svgLib[r.id]=t.mapDOMElement.append("path").datum({type:o.type,geocoding:o.geocoding,features:[n],name:r.name}).attr("d",s).classed("d3district",!0).classed("global",t.showNationalLevelCoverage).classed("name-"+r.id,!0).on("click",function(){t.scope.$evalAsync(function(){t.activeDistrict={name:r.name,data:a.svgLib[r.id]?a.svgLib[r.id].districtData:null}})})}),this.elementContainer.append(function(){return t.mapDOMElement.node()}),this.makeSvgPannableAndZoomable(this.mapDOMElement.node()),this.showPlaceholder=!1}},{key:"fillDistrictData",value:function(e){for(var t in this.svgLib){var a=this.svgLib[t];e[t]?(a.classed("d3district-data",!0),a.districtData=e[t]):(a.classed("d3district-data",!1),a.districtData=null)}}},{key:"goToProject",value:function(e){this.state.go("editProject",{appName:e.id,editMode:"publish"})}}],[{key:"countrymapFactory",value:function(){function t(t,a,o){return new e(t,a,o)}return a("./src/Common/CountryMap/Countrymap.scss"),t.$inject=["$element","$scope","$state"],t}}]),e}();t.default=h},"./src/Common/CountryMap/Countrymap.scss":function(e,t,a){}}]);