
<div id="clv-container" layout="column">

    <md-card md-whiteframe="2" class="rel" layout="row">
        <div class="littleheader">COUNTRY LEVEL VIEW</div>
        <md-tabs md-border-bottom md-dynamic-height md-center-tabs="true" flex="75" class="clv-tab-container">


            <!-- MAP VIEW -->
            <md-tab label="map view">

                <div class="tab-wrap" id="map" ng-class="{'emptyy': !vm.projectsData}">

                    <md-card md-whiteframe="2" class="countrychoser">
                        <md-input-container>
                            <md-select
                                    class="no-border"
                                    md-container-class="country-chooser"
                                    ng-model-options="{trackBy: '$value.id'}"
                                    placeholder='Select a country'
                                    ng-model="vm.selectedCountry"
                                    ng-change="vm.updateCountry(vm.selectedCountry)">

                                <md-option ng-repeat="country in vm.countries track by $index" ng-value="{{country}}">{{country.name}}</md-option>

                            </md-select>
                        </md-input-container>
                    </md-card>

                    <countrymap big="true"></countrymap>

                </div>

            </md-tab>


            <!-- LIST VIEW -->
            <md-tab label="list view">
                <div class="tab-wrap" id="list">

                    <div class="headercont" layout="row">

                        <md-card md-whiteframe="2" class="countrychoser">
                            <md-input-container>
                                <md-select
                                        class="no-border"
                                        md-container-class="country-chooser"
                                        ng-model-options="{trackBy: '$value.id'}"
                                        placeholder='Select a country'
                                        ng-model="vm.selectedCountry"
                                        ng-change="vm.updateCountry(vm.selectedCountry)">

                                    <md-option ng-repeat="country in vm.countries2 track by $index" ng-value="{{country}}">{{country.name}}</md-option>

                                </md-select>
                            </md-input-container>
                        </md-card>

                        <div class="starry">
                            <md-icon>grade</md-icon>
                            Team member
                            <md-icon>visibility</md-icon>
                            Viewer
                        </div>
                    </div>

                    <md-content class="projectcont">

                        <div class="headerrow" layout="row" layout-padding md-whiteframe="2">
                            <div flex="35">Project name</div>
                            <div flex="20">Country</div>
                            <div flex="20">Organisation name</div>
                            <div flex="20">Donors</div>
                            <div flex="20">Point of Contact</div>
                            <div flex="30">Overview of digital health implementation</div>
                            <div flex="20">Implementing partners</div>
                            <div flex="20">Geographical coverage</div>
                            <div flex="20">mHealth interventions</div>
                        </div>

                        <div
                                class="projectrow"
                                layout="row"
                                layout-padding
                                ng-repeat="project in vm.projectsData track by $index"
                                ng-class="{'member': vm.isMember(project), 'viewer': vm.isViewer(project)}">

                            <div flex="35" class="projectlink" layout="row">
                                <div flex class="name">
                                    <md-icon class="member" ng-show="vm.isMember(project)">grade</md-icon>
                                    <md-icon class="viewer" ng-show="vm.isViewer(project)">visibility</md-icon>
                                    {{project.name}}
                                </div>
                                <div layout="column" class="links">
                                    <span ui-sref="dashboard({ appName: project.id })">Project Dashboard</span>
                                    <span ui-sref="hss({ appName: project.id })">Visualize Project</span>
                                </div>
                            </div>
                            <div flex="20" class="cap">
                                {{vm.countriesLib[project.country]}}
                            </div>
                            <div flex="20">{{project.organisation_name}}</div>
                            <div flex="20">
								<span ng-repeat="donor in project.donors">
                                    {{donor}}{{$last ? '' : ', '}}
								</span>
                            </div>
                            <div flex="20">{{project.contact_name}}, <a ng-href="mailto:{{project.contact_email}}">{{project.contact_email}}</a></div>
                            <div flex="30">{{project.implementation_overview}}</div>
                            <div flex="20">{{project.implementing_partners}}</div>
                            <div flex="20">{{project.geographic_scope}}</div>
                            <div flex="20">{{project.health_focus_areas.join(', ')}}</div>

                        </div>
                        <div ng-if="!vm.projectsData.length" class="projectrow" layout="row" layout-padding>
                            <div flex>There is no project to show in this country.</div>
                        </div>
                    </md-content>
                </div>
            </md-tab>
        </md-tabs>

        <div class="clv-filter-container" flex="25" layout="row">
            <div class="filter-wrapper" layout="row" flex="100">
                <div class="filter-project-counter" md-whiteframe="2">
                    <div class="project-counter-name">
                        <div class="description">
                            Number of Projects
                        </div>
                        <div class="country-name">
                            in {{vm.selectedCountry.name}}
                        </div>
                    </div>
                    <div class="project-counter-arrow">
                        <img src="img/after-white.svg" />
                    </div>
                    <div class="project-counter-number">
                        {{ vm.projectsData.length}}
                    </div>
                </div>

                <div class="filter-list">
                    <div class="description">
                        Apply filters to map:
                    </div>

                    <div class="list-headers" ng-repeat="header in vm.filterArray">
                        <div class="header" ng-click="header.open = !header.open">
                            <md-icon ng-hide="header.open" >expand_more</md-icon>
                            <md-icon ng-show="header.open" >expand_less</md-icon>
                            {{vm.replaceLodash(header.name)}} ({{header.items.length}})
                        </div>
                        <div class="list-item" ng-repeat="item in header.items  | orderBy: 'name' " ng-show="header.open">
                            <md-checkbox class="md-primary" ng-model="item.value" aria-label="item.name" ng-change="vm.filterClv()">
                                {{item.name}}
                            </md-checkbox>
                        </div>

                    </div>

                </div>

            </div>

        </div>
    </md-card>

    <disclaimer></disclaimer>
</div>
