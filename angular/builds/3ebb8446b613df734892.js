(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[585],{

/***/ "./node_modules/trix/dist/trix.js":
/*!****************************************!*\
  !*** ./node_modules/trix/dist/trix.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/* WEBPACK VAR INJECTION */(function(setImmediate) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\nTrix 0.10.1\nCopyright Â© 2017 Basecamp, LLC\nhttp://trix-editor.org/\n */\n(function(){}).call(this),function(){var t;null==window.Set&&(window.Set=t=function(){function t(){this.clear()}return t.prototype.clear=function(){return this.values=[]},t.prototype.has=function(t){return-1!==this.values.indexOf(t)},t.prototype.add=function(t){return this.has(t)||this.values.push(t),this},t.prototype[\"delete\"]=function(t){var e;return-1===(e=this.values.indexOf(t))?!1:(this.values.splice(e,1),!0)},t.prototype.forEach=function(){var t;return(t=this.values).forEach.apply(t,arguments)},t}())}.call(this),function(t){function e(){}function n(t,e){return function(){t.apply(e,arguments)}}function o(t){if(\"object\"!=typeof this)throw new TypeError(\"Promises must be constructed via new\");if(\"function\"!=typeof t)throw new TypeError(\"not a function\");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(t,this)}function i(t,e){for(;3===t._state;)t=t._value;return 0===t._state?void t._deferreds.push(e):(t._handled=!0,void h(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?r:s)(e.promise,t._value);var o;try{o=n(t._value)}catch(i){return void s(e.promise,i)}r(e.promise,o)}))}function r(t,e){try{if(e===t)throw new TypeError(\"A promise cannot be resolved with itself.\");if(e&&(\"object\"==typeof e||\"function\"==typeof e)){var i=e.then;if(e instanceof o)return t._state=3,t._value=e,void a(t);if(\"function\"==typeof i)return void c(n(i,e),t)}t._state=1,t._value=e,a(t)}catch(r){s(t,r)}}function s(t,e){t._state=2,t._value=e,a(t)}function a(t){2===t._state&&0===t._deferreds.length&&setTimeout(function(){t._handled||p(t._value)},1);for(var e=0,n=t._deferreds.length;n>e;e++)i(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled=\"function\"==typeof t?t:null,this.onRejected=\"function\"==typeof e?e:null,this.promise=n}function c(t,e){var n=!1;try{t(function(t){n||(n=!0,r(e,t))},function(t){n||(n=!0,s(e,t))})}catch(o){if(n)return;n=!0,s(e,o)}}var l=setTimeout,h=\"function\"==typeof setImmediate&&setImmediate||function(t){l(t,1)},p=function(t){\"undefined\"!=typeof console&&console&&console.warn(\"Possible Unhandled Promise Rejection:\",t)};o.prototype[\"catch\"]=function(t){return this.then(null,t)},o.prototype.then=function(t,n){var r=new o(e);return i(this,new u(t,n,r)),r},o.all=function(t){var e=Array.prototype.slice.call(t);return new o(function(t,n){function o(r,s){try{if(s&&(\"object\"==typeof s||\"function\"==typeof s)){var a=s.then;if(\"function\"==typeof a)return void a.call(s,function(t){o(r,t)},n)}e[r]=s,0===--i&&t(e)}catch(u){n(u)}}if(0===e.length)return t([]);for(var i=e.length,r=0;r<e.length;r++)o(r,e[r])})},o.resolve=function(t){return t&&\"object\"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){for(var o=0,i=t.length;i>o;o++)t[o].then(e,n)})},o._setImmediateFn=function(t){h=t},o._setUnhandledRejectionFn=function(t){p=t},\"undefined\"!=typeof module&&module.exports?module.exports=o:t.Promise||(t.Promise=o)}(this),/**\n * @license\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\"undefined\"==typeof WeakMap&&!function(){var t=Object.defineProperty,e=Date.now()%1e9,n=function(){this.name=\"__st\"+(1e9*Math.random()>>>0)+(e++ +\"__\")};n.prototype={set:function(e,n){var o=e[this.name];return o&&o[0]===e?o[1]=n:t(e,this.name,{value:[e,n],writable:!0}),this},get:function(t){var e;return(e=t[this.name])&&e[0]===t?e[1]:void 0},\"delete\":function(t){var e=t[this.name];return e&&e[0]===t?(e[0]=e[1]=void 0,!0):!1},has:function(t){var e=t[this.name];return e?e[0]===t:!1}},window.WeakMap=n}(),function(t){function e(t){A.push(t),b||(b=!0,g(o))}function n(t){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(t)||t}function o(){b=!1;var t=A;A=[],t.sort(function(t,e){return t.uid_-e.uid_});var e=!1;t.forEach(function(t){var n=t.takeRecords();i(t),n.length&&(t.callback_(n,t),e=!0)}),e&&o()}function i(t){t.nodes_.forEach(function(e){var n=m.get(e);n&&n.forEach(function(e){e.observer===t&&e.removeTransientObservers()})})}function r(t,e){for(var n=t;n;n=n.parentNode){var o=m.get(n);if(o)for(var i=0;i<o.length;i++){var r=o[i],s=r.options;if(n===t||s.subtree){var a=e(s);a&&r.enqueue(a)}}}}function s(t){this.callback_=t,this.nodes_=[],this.records_=[],this.uid_=++C}function a(t,e){this.type=t,this.target=e,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function u(t){var e=new a(t.type,t.target);return e.addedNodes=t.addedNodes.slice(),e.removedNodes=t.removedNodes.slice(),e.previousSibling=t.previousSibling,e.nextSibling=t.nextSibling,e.attributeName=t.attributeName,e.attributeNamespace=t.attributeNamespace,e.oldValue=t.oldValue,e}function c(t,e){return w=new a(t,e)}function l(t){return x?x:(x=u(w),x.oldValue=t,x)}function h(){w=x=void 0}function p(t){return t===x||t===w}function d(t,e){return t===e?t:x&&p(t)?x:null}function f(t,e,n){this.observer=t,this.target=e,this.options=n,this.transientObservedNodes=[]}if(!t.JsMutationObserver){var g,m=new WeakMap;if(/Trident|Edge/.test(navigator.userAgent))g=setTimeout;else if(window.setImmediate)g=window.setImmediate;else{var y=[],v=String(Math.random());window.addEventListener(\"message\",function(t){if(t.data===v){var e=y;y=[],e.forEach(function(t){t()})}}),g=function(t){y.push(t),window.postMessage(v,\"*\")}}var b=!1,A=[],C=0;s.prototype={observe:function(t,e){if(t=n(t),!e.childList&&!e.attributes&&!e.characterData||e.attributeOldValue&&!e.attributes||e.attributeFilter&&e.attributeFilter.length&&!e.attributes||e.characterDataOldValue&&!e.characterData)throw new SyntaxError;var o=m.get(t);o||m.set(t,o=[]);for(var i,r=0;r<o.length;r++)if(o[r].observer===this){i=o[r],i.removeListeners(),i.options=e;break}i||(i=new f(this,t,e),o.push(i),this.nodes_.push(t)),i.addListeners()},disconnect:function(){this.nodes_.forEach(function(t){for(var e=m.get(t),n=0;n<e.length;n++){var o=e[n];if(o.observer===this){o.removeListeners(),e.splice(n,1);break}}},this),this.records_=[]},takeRecords:function(){var t=this.records_;return this.records_=[],t}};var w,x;f.prototype={enqueue:function(t){var n=this.observer.records_,o=n.length;if(n.length>0){var i=n[o-1],r=d(i,t);if(r)return void(n[o-1]=r)}else e(this.observer);n[o]=t},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(t){var e=this.options;e.attributes&&t.addEventListener(\"DOMAttrModified\",this,!0),e.characterData&&t.addEventListener(\"DOMCharacterDataModified\",this,!0),e.childList&&t.addEventListener(\"DOMNodeInserted\",this,!0),(e.childList||e.subtree)&&t.addEventListener(\"DOMNodeRemoved\",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(t){var e=this.options;e.attributes&&t.removeEventListener(\"DOMAttrModified\",this,!0),e.characterData&&t.removeEventListener(\"DOMCharacterDataModified\",this,!0),e.childList&&t.removeEventListener(\"DOMNodeInserted\",this,!0),(e.childList||e.subtree)&&t.removeEventListener(\"DOMNodeRemoved\",this,!0)},addTransientObserver:function(t){if(t!==this.target){this.addListeners_(t),this.transientObservedNodes.push(t);var e=m.get(t);e||m.set(t,e=[]),e.push(this)}},removeTransientObservers:function(){var t=this.transientObservedNodes;this.transientObservedNodes=[],t.forEach(function(t){this.removeListeners_(t);for(var e=m.get(t),n=0;n<e.length;n++)if(e[n]===this){e.splice(n,1);break}},this)},handleEvent:function(t){switch(t.stopImmediatePropagation(),t.type){case\"DOMAttrModified\":var e=t.attrName,n=t.relatedNode.namespaceURI,o=t.target,i=new c(\"attributes\",o);i.attributeName=e,i.attributeNamespace=n;var s=t.attrChange===MutationEvent.ADDITION?null:t.prevValue;r(o,function(t){return!t.attributes||t.attributeFilter&&t.attributeFilter.length&&-1===t.attributeFilter.indexOf(e)&&-1===t.attributeFilter.indexOf(n)?void 0:t.attributeOldValue?l(s):i});break;case\"DOMCharacterDataModified\":var o=t.target,i=c(\"characterData\",o),s=t.prevValue;r(o,function(t){return t.characterData?t.characterDataOldValue?l(s):i:void 0});break;case\"DOMNodeRemoved\":this.addTransientObserver(t.target);case\"DOMNodeInserted\":var a,u,p=t.target;\"DOMNodeInserted\"===t.type?(a=[p],u=[]):(a=[],u=[p]);var d=p.previousSibling,f=p.nextSibling,i=c(\"childList\",t.target.parentNode);i.addedNodes=a,i.removedNodes=u,i.previousSibling=d,i.nextSibling=f,r(t.relatedNode,function(t){return t.childList?i:void 0})}h()}},t.JsMutationObserver=s,t.MutationObserver||(t.MutationObserver=s,s._isPolyfilled=!0)}}(self),function(){\"use strict\";if(!window.performance){var t=Date.now();window.performance={now:function(){return Date.now()-t}}}window.requestAnimationFrame||(window.requestAnimationFrame=function(){var t=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return t?function(e){return t(function(){e(performance.now())})}:function(t){return window.setTimeout(t,1e3/60)}}()),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(){return window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}}());var e=function(){var t=document.createEvent(\"Event\");return t.initEvent(\"foo\",!0,!0),t.preventDefault(),t.defaultPrevented}();if(!e){var n=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(n.call(this),Object.defineProperty(this,\"defaultPrevented\",{get:function(){return!0},configurable:!0}))}}var o=/Trident/.test(navigator.userAgent);if((!window.CustomEvent||o&&\"function\"!=typeof window.CustomEvent)&&(window.CustomEvent=function(t,e){e=e||{};var n=document.createEvent(\"CustomEvent\");return n.initCustomEvent(t,Boolean(e.bubbles),Boolean(e.cancelable),e.detail),n},window.CustomEvent.prototype=window.Event.prototype),!window.Event||o&&\"function\"!=typeof window.Event){var i=window.Event;window.Event=function(t,e){e=e||{};var n=document.createEvent(\"Event\");return n.initEvent(t,Boolean(e.bubbles),Boolean(e.cancelable)),n},window.Event.prototype=i.prototype}}(window.WebComponents),window.CustomElements=window.CustomElements||{flags:{}},function(t){var e=t.flags,n=[],o=function(t){n.push(t)},i=function(){n.forEach(function(e){e(t)})};t.addModule=o,t.initializeModules=i,t.hasNative=Boolean(document.registerElement),t.isIE=/Trident/.test(navigator.userAgent),t.useNative=!e.register&&t.hasNative&&!window.ShadowDOMPolyfill&&(!window.HTMLImports||window.HTMLImports.useNative)}(window.CustomElements),window.CustomElements.addModule(function(t){function e(t,e){n(t,function(t){return e(t)?!0:void o(t,e)}),o(t,e)}function n(t,e,o){var i=t.firstElementChild;if(!i)for(i=t.firstChild;i&&i.nodeType!==Node.ELEMENT_NODE;)i=i.nextSibling;for(;i;)e(i,o)!==!0&&n(i,e,o),i=i.nextElementSibling;return null}function o(t,n){for(var o=t.shadowRoot;o;)e(o,n),o=o.olderShadowRoot}function i(t,e){r(t,e,[])}function r(t,e,n){if(t=window.wrap(t),!(n.indexOf(t)>=0)){n.push(t);for(var o,i=t.querySelectorAll(\"link[rel=\"+s+\"]\"),a=0,u=i.length;u>a&&(o=i[a]);a++)o.import&&r(o.import,e,n);e(t)}}var s=window.HTMLImports?window.HTMLImports.IMPORT_LINK_TYPE:\"none\";t.forDocumentTree=i,t.forSubtree=e}),window.CustomElements.addModule(function(t){function e(t,e){return n(t,e)||o(t,e)}function n(e,n){return t.upgrade(e,n)?!0:void(n&&s(e))}function o(t,e){b(t,function(t){return n(t,e)?!0:void 0})}function i(t){x.push(t),w||(w=!0,setTimeout(r))}function r(){w=!1;for(var t,e=x,n=0,o=e.length;o>n&&(t=e[n]);n++)t();x=[]}function s(t){C?i(function(){a(t)}):a(t)}function a(t){t.__upgraded__&&!t.__attached&&(t.__attached=!0,t.attachedCallback&&t.attachedCallback())}function u(t){c(t),b(t,function(t){c(t)})}function c(t){C?i(function(){l(t)}):l(t)}function l(t){t.__upgraded__&&t.__attached&&(t.__attached=!1,t.detachedCallback&&t.detachedCallback())}function h(t){for(var e=t,n=window.wrap(document);e;){if(e==n)return!0;e=e.parentNode||e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host}}function p(t){if(t.shadowRoot&&!t.shadowRoot.__watched){v.dom&&console.log(\"watching shadow-root for: \",t.localName);for(var e=t.shadowRoot;e;)g(e),e=e.olderShadowRoot}}function d(t,n){if(v.dom){var o=n[0];if(o&&\"childList\"===o.type&&o.addedNodes&&o.addedNodes){for(var i=o.addedNodes[0];i&&i!==document&&!i.host;)i=i.parentNode;var r=i&&(i.URL||i._URL||i.host&&i.host.localName)||\"\";r=r.split(\"/?\").shift().split(\"/\").pop()}console.group(\"mutations (%d) [%s]\",n.length,r||\"\")}var s=h(t);n.forEach(function(t){\"childList\"===t.type&&(E(t.addedNodes,function(t){t.localName&&e(t,s)}),E(t.removedNodes,function(t){t.localName&&u(t)}))}),v.dom&&console.groupEnd()}function f(t){for(t=window.wrap(t),t||(t=window.wrap(document));t.parentNode;)t=t.parentNode;var e=t.__observer;e&&(d(t,e.takeRecords()),r())}function g(t){if(!t.__observer){var e=new MutationObserver(d.bind(this,t));e.observe(t,{childList:!0,subtree:!0}),t.__observer=e}}function m(t){t=window.wrap(t),v.dom&&console.group(\"upgradeDocument: \",t.baseURI.split(\"/\").pop());var n=t===window.wrap(document);e(t,n),g(t),v.dom&&console.groupEnd()}function y(t){A(t,m)}var v=t.flags,b=t.forSubtree,A=t.forDocumentTree,C=window.MutationObserver._isPolyfilled&&v[\"throttle-attached\"];t.hasPolyfillMutations=C,t.hasThrottledAttached=C;var w=!1,x=[],E=Array.prototype.forEach.call.bind(Array.prototype.forEach),S=Element.prototype.createShadowRoot;S&&(Element.prototype.createShadowRoot=function(){var t=S.call(this);return window.CustomElements.watchShadow(this),t}),t.watchShadow=p,t.upgradeDocumentTree=y,t.upgradeDocument=m,t.upgradeSubtree=o,t.upgradeAll=e,t.attached=s,t.takeRecords=f}),window.CustomElements.addModule(function(t){function e(e,o){if(\"template\"===e.localName&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(e),!e.__upgraded__&&e.nodeType===Node.ELEMENT_NODE){var i=e.getAttribute(\"is\"),r=t.getRegisteredDefinition(e.localName)||t.getRegisteredDefinition(i);if(r&&(i&&r.tag==e.localName||!i&&!r.extends))return n(e,r,o)}}function n(e,n,i){return s.upgrade&&console.group(\"upgrade:\",e.localName),n.is&&e.setAttribute(\"is\",n.is),o(e,n),e.__upgraded__=!0,r(e),i&&t.attached(e),t.upgradeSubtree(e,i),s.upgrade&&console.groupEnd(),e}function o(t,e){Object.__proto__?t.__proto__=e.prototype:(i(t,e.prototype,e.native),t.__proto__=e.prototype)}function i(t,e,n){for(var o={},i=e;i!==n&&i!==HTMLElement.prototype;){for(var r,s=Object.getOwnPropertyNames(i),a=0;r=s[a];a++)o[r]||(Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r)),o[r]=1);i=Object.getPrototypeOf(i)}}function r(t){t.createdCallback&&t.createdCallback()}var s=t.flags;t.upgrade=e,t.upgradeWithDefinition=n,t.implementPrototype=o}),window.CustomElements.addModule(function(t){function e(e,o){var u=o||{};if(!e)throw new Error(\"document.registerElement: first argument `name` must not be empty\");if(e.indexOf(\"-\")<0)throw new Error(\"document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '\"+String(e)+\"'.\");if(i(e))throw new Error(\"Failed to execute 'registerElement' on 'Document': Registration failed for type '\"+String(e)+\"'. The type name is invalid.\");if(c(e))throw new Error(\"DuplicateDefinitionError: a type with name '\"+String(e)+\"' is already registered\");return u.prototype||(u.prototype=Object.create(HTMLElement.prototype)),u.__name=e.toLowerCase(),u.extends&&(u.extends=u.extends.toLowerCase()),u.lifecycle=u.lifecycle||{},u.ancestry=r(u.extends),s(u),a(u),n(u.prototype),l(u.__name,u),u.ctor=h(u),u.ctor.prototype=u.prototype,u.prototype.constructor=u.ctor,t.ready&&m(document),u.ctor}function n(t){if(!t.setAttribute._polyfilled){var e=t.setAttribute;t.setAttribute=function(t,n){o.call(this,t,n,e)};var n=t.removeAttribute;t.removeAttribute=function(t){o.call(this,t,null,n)},t.setAttribute._polyfilled=!0}}function o(t,e,n){t=t.toLowerCase();var o=this.getAttribute(t);n.apply(this,arguments);var i=this.getAttribute(t);this.attributeChangedCallback&&i!==o&&this.attributeChangedCallback(t,o,i)}function i(t){for(var e=0;e<C.length;e++)if(t===C[e])return!0}function r(t){var e=c(t);return e?r(e.extends).concat([e]):[]}function s(t){for(var e,n=t.extends,o=0;e=t.ancestry[o];o++)n=e.is&&e.tag;t.tag=n||t.__name,n&&(t.is=t.__name)}function a(t){if(!Object.__proto__){var e=HTMLElement.prototype;if(t.is){var n=document.createElement(t.tag);e=Object.getPrototypeOf(n)}for(var o,i=t.prototype,r=!1;i;)i==e&&(r=!0),o=Object.getPrototypeOf(i),o&&(i.__proto__=o),i=o;r||console.warn(t.tag+\" prototype not found in prototype chain for \"+t.is),t.native=e}}function u(t){return v(E(t.tag),t)}function c(t){return t?w[t.toLowerCase()]:void 0}function l(t,e){w[t]=e}function h(t){return function(){return u(t)}}function p(t,e,n){return t===x?d(e,n):S(t,e)}function d(t,e){t&&(t=t.toLowerCase()),e&&(e=e.toLowerCase());var n=c(e||t);if(n){if(t==n.tag&&e==n.is)return new n.ctor;if(!e&&!n.is)return new n.ctor}var o;return e?(o=d(t),o.setAttribute(\"is\",e),o):(o=E(t),t.indexOf(\"-\")>=0&&b(o,HTMLElement),o)}function f(t,e){var n=t[e];t[e]=function(){var t=n.apply(this,arguments);return y(t),t}}var g,m=(t.isIE,t.upgradeDocumentTree),y=t.upgradeAll,v=t.upgradeWithDefinition,b=t.implementPrototype,A=t.useNative,C=[\"annotation-xml\",\"color-profile\",\"font-face\",\"font-face-src\",\"font-face-uri\",\"font-face-format\",\"font-face-name\",\"missing-glyph\"],w={},x=\"http://www.w3.org/1999/xhtml\",E=document.createElement.bind(document),S=document.createElementNS.bind(document);g=Object.__proto__||A?function(t,e){return t instanceof e}:function(t,e){if(t instanceof e)return!0;for(var n=t;n;){if(n===e.prototype)return!0;n=n.__proto__}return!1},f(Node.prototype,\"cloneNode\"),f(document,\"importNode\"),document.registerElement=e,document.createElement=d,document.createElementNS=p,t.registry=w,t.instanceof=g,t.reservedTagList=C,t.getRegisteredDefinition=c,document.register=document.registerElement}),function(t){function e(){r(window.wrap(document)),window.CustomElements.ready=!0;var t=window.requestAnimationFrame||function(t){setTimeout(t,16)};t(function(){setTimeout(function(){window.CustomElements.readyTime=Date.now(),window.HTMLImports&&(window.CustomElements.elapsed=window.CustomElements.readyTime-window.HTMLImports.readyTime),document.dispatchEvent(new CustomEvent(\"WebComponentsReady\",{bubbles:!0}))})})}{var n=t.useNative,o=t.initializeModules;t.isIE}if(n){var i=function(){};t.watchShadow=i,t.upgrade=i,t.upgradeAll=i,t.upgradeDocumentTree=i,t.upgradeSubtree=i,t.takeRecords=i,t.instanceof=function(t,e){return t instanceof e}}else o();var r=t.upgradeDocumentTree,s=t.upgradeDocument;if(window.wrap||(window.ShadowDOMPolyfill?(window.wrap=window.ShadowDOMPolyfill.wrapIfNeeded,window.unwrap=window.ShadowDOMPolyfill.unwrapIfNeeded):window.wrap=window.unwrap=function(t){return t}),window.HTMLImports&&(window.HTMLImports.__importsParsingHook=function(t){t.import&&s(wrap(t.import))}),\"complete\"===document.readyState||t.flags.eager)e();else if(\"interactive\"!==document.readyState||window.attachEvent||window.HTMLImports&&!window.HTMLImports.ready){var a=window.HTMLImports&&!window.HTMLImports.ready?\"HTMLImportsLoaded\":\"DOMContentLoaded\";window.addEventListener(a,e)}else e()}(window.CustomElements),function(){}.call(this),function(){var t=this;(function(){(function(){this.Trix={VERSION:\"0.10.1\",ZERO_WIDTH_SPACE:\"\\ufeff\",NON_BREAKING_SPACE:\"\\xa0\",OBJECT_REPLACEMENT_CHARACTER:\"\\ufffc\",config:{}}}).call(this)}).call(t);var e=t.Trix;(function(){(function(){e.BasicObject=function(){function t(){}var e,n,o;return t.proxyMethod=function(t){var o,i,r,s,a;return r=n(t),o=r.name,s=r.toMethod,a=r.toProperty,i=r.optional,this.prototype[o]=function(){var t,n;return t=null!=s?i?\"function\"==typeof this[s]?this[s]():void 0:this[s]():null!=a?this[a]:void 0,i?(n=null!=t?t[o]:void 0,null!=n?e.call(n,t,arguments):void 0):(n=t[o],e.call(n,t,arguments))}},n=function(t){var e,n;if(!(n=t.match(o)))throw new Error(\"can't parse @proxyMethod expression: \"+t);return e={name:n[4]},null!=n[2]?e.toMethod=n[1]:e.toProperty=n[1],null!=n[3]&&(e.optional=!0),e},e=Function.prototype.apply,o=/^(.+?)(\\(\\))?(\\?)?\\.(.+?)$/,t}()}).call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.Object=function(n){function o(){this.id=++i}var i;return t(o,n),i=0,o.fromJSONString=function(t){return this.fromJSON(JSON.parse(t))},o.prototype.hasSameConstructorAs=function(t){return this.constructor===(null!=t?t.constructor:void 0)},o.prototype.isEqualTo=function(t){return this===t},o.prototype.inspect=function(){var t,e,n;return t=function(){var t,o,i;o=null!=(t=this.contentsForInspection())?t:{},i=[];for(e in o)n=o[e],i.push(e+\"=\"+n);return i}.call(this),\"#<\"+this.constructor.name+\":\"+this.id+(t.length?\" \"+t.join(\", \"):\"\")+\">\"},o.prototype.contentsForInspection=function(){},o.prototype.toJSONString=function(){return JSON.stringify(this)},o.prototype.toUTF16String=function(){return e.UTF16String.box(this)},o.prototype.getCacheKey=function(){return this.id.toString()},o}(e.BasicObject)}.call(this),function(){e.extend=function(t){var e,n;for(e in t)n=t[e],this[e]=n;return this}}.call(this),function(){e.extend({defer:function(t){return setTimeout(t,1)}})}.call(this),function(){var t,n;e.extend({normalizeSpaces:function(t){return t.replace(RegExp(\"\"+e.ZERO_WIDTH_SPACE,\"g\"),\"\").replace(RegExp(\"\"+e.NON_BREAKING_SPACE,\"g\"),\" \")},summarizeStringChange:function(t,o){var i,r,s,a;return t=e.UTF16String.box(t),o=e.UTF16String.box(o),o.length<t.length?(r=n(t,o),a=r[0],i=r[1]):(s=n(o,t),i=s[0],a=s[1]),{added:i,removed:a}}}),n=function(n,o){var i,r,s,a,u;return n.isEqualTo(o)?[\"\",\"\"]:(r=t(n,o),a=r.utf16String.length,s=a?(u=r.offset,r,i=n.codepoints.slice(0,u).concat(n.codepoints.slice(u+a)),t(o,e.UTF16String.fromCodepoints(i))):t(o,n),[r.utf16String.toString(),s.utf16String.toString()])},t=function(t,e){var n,o,i;for(n=0,o=t.length,i=e.length;o>n&&t.charAt(n).isEqualTo(e.charAt(n));)n++;for(;o>n+1&&t.charAt(o-1).isEqualTo(e.charAt(i-1));)o--,i--;return{utf16String:t.slice(n,o),offset:n}}}.call(this),function(){e.extend({copyObject:function(t){var e,n,o;null==t&&(t={}),n={};for(e in t)o=t[e],n[e]=o;return n},objectsAreEqual:function(t,e){var n,o;if(null==t&&(t={}),null==e&&(e={}),Object.keys(t).length!==Object.keys(e).length)return!1;for(n in t)if(o=t[n],o!==e[n])return!1;return!0}})}.call(this),function(){var t=[].slice;e.extend({arraysAreEqual:function(t,e){var n,o,i,r;if(null==t&&(t=[]),null==e&&(e=[]),t.length!==e.length)return!1;for(o=n=0,i=t.length;i>n;o=++n)if(r=t[o],r!==e[o])return!1;return!0},arrayStartsWith:function(t,n){return null==t&&(t=[]),null==n&&(n=[]),e.arraysAreEqual(t.slice(0,n.length),n)},spliceArray:function(){var e,n,o;return n=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],o=n.slice(0),o.splice.apply(o,e),o},summarizeArrayChange:function(t,e){var n,o,i,r,s,a,u,c,l,h,p;for(null==t&&(t=[]),null==e&&(e=[]),n=[],h=[],i=new Set,r=0,u=t.length;u>r;r++)p=t[r],i.add(p);for(o=new Set,s=0,c=e.length;c>s;s++)p=e[s],o.add(p),i.has(p)||n.push(p);for(a=0,l=t.length;l>a;a++)p=t[a],o.has(p)||h.push(p);return{added:n,removed:h}}})}.call(this),function(){var t,n,o,i;t=null,n=null,i=null,o=null,e.extend({getAllAttributeNames:function(){return null!=t?t:t=e.getTextAttributeNames().concat(e.getBlockAttributeNames())},getBlockConfig:function(t){return e.config.blockAttributes[t]},getBlockAttributeNames:function(){return null!=n?n:n=Object.keys(e.config.blockAttributes)},getTextConfig:function(t){return e.config.textAttributes[t]},getTextAttributeNames:function(){return null!=i?i:i=Object.keys(e.config.textAttributes)},getListAttributeNames:function(){var t,n;return null!=o?o:o=function(){var o,i;o=e.config.blockAttributes,i=[];for(t in o)n=o[t].listAttribute,null!=n&&i.push(n);return i}()}})}.call(this),function(){var t,n,o,i,r,s=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=document.documentElement,n=null!=(o=null!=(i=null!=(r=t.matchesSelector)?r:t.webkitMatchesSelector)?i:t.msMatchesSelector)?o:t.mozMatchesSelector,e.extend({handleEvent:function(n,o){var i,r,s,a,u,c,l,h,p,d,f,g;return h=null!=o?o:{},c=h.onElement,u=h.matchingSelector,g=h.withCallback,a=h.inPhase,l=h.preventDefault,d=h.times,r=null!=c?c:t,p=u,i=g,f=\"capturing\"===a,s=function(t){var n;return null!=d&&0===--d&&s.destroy(),n=e.findClosestElementFromNode(t.target,{matchingSelector:p}),null!=n&&(null!=g&&g.call(n,t,n),l)?t.preventDefault():void 0},s.destroy=function(){return r.removeEventListener(n,s,f)},r.addEventListener(n,s,f),s},handleEventOnce:function(t,n){return null==n&&(n={}),n.times=1,e.handleEvent(t,n)},triggerEvent:function(n,o){var i,r,s,a,u,c,l;return l=null!=o?o:{},c=l.onElement,r=l.bubbles,s=l.cancelable,i=l.attributes,a=null!=c?c:t,r=r!==!1,s=s!==!1,u=document.createEvent(\"Events\"),u.initEvent(n,r,s),null!=i&&e.extend.call(u,i),a.dispatchEvent(u)},elementMatchesSelector:function(t,e){return 1===(null!=t?t.nodeType:void 0)?n.call(t,e):void 0},findClosestElementFromNode:function(t,n){var o,i,r;for(i=null!=n?n:{},o=i.matchingSelector,r=i.untilNode;null!=t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.parentNode;if(null!=t){if(null==o)return t;if(t.closest&&null==r)return t.closest(o);for(;t&&t!==r;){if(e.elementMatchesSelector(t,o))return t;t=t.parentNode}}},findInnerElement:function(t){for(;null!=t?t.firstElementChild:void 0;)t=t.firstElementChild;return t},innerElementIsActive:function(t){return document.activeElement!==t&&e.elementContainsNode(t,document.activeElement)},elementContainsNode:function(t,e){if(t&&e)for(;e;){if(e===t)return!0;e=e.parentNode}},findNodeFromContainerAndOffset:function(t,e){var n;if(t)return t.nodeType===Node.TEXT_NODE?t:0===e?null!=(n=t.firstChild)?n:t:t.childNodes.item(e-1)},findElementFromContainerAndOffset:function(t,n){var o;return o=e.findNodeFromContainerAndOffset(t,n),e.findClosestElementFromNode(o)},findChildIndexOfNode:function(t){var e;if(null!=t?t.parentNode:void 0){for(e=0;t=t.previousSibling;)e++;return e}},walkTree:function(t,e){var n,o,i,r,s;return i=null!=e?e:{},o=i.onlyNodesOfType,r=i.usingFilter,n=i.expandEntityReferences,s=function(){switch(o){case\"element\":return NodeFilter.SHOW_ELEMENT;case\"text\":return NodeFilter.SHOW_TEXT;case\"comment\":return NodeFilter.SHOW_COMMENT;default:return NodeFilter.SHOW_ALL}}(),document.createTreeWalker(t,s,null!=r?r:null,n===!0)},tagName:function(t){var e;return null!=t&&null!=(e=t.tagName)?e.toLowerCase():void 0},makeElement:function(t,e){var n,o,i,r,s,a,u,c,l,h;if(null==e&&(e={}),\"object\"==typeof t?(e=t,t=e.tagName):e={attributes:e},o=document.createElement(t),null!=e.editable&&(null==e.attributes&&(e.attributes={}),e.attributes.contenteditable=e.editable),e.attributes){a=e.attributes;for(r in a)h=a[r],o.setAttribute(r,h)}if(e.style){u=e.style;for(r in u)h=u[r],o.style[r]=h}if(e.data){c=e.data;for(r in c)h=c[r],o.dataset[r]=h}if(e.className)for(l=e.className.split(\" \"),i=0,s=l.length;s>i;i++)n=l[i],o.classList.add(n);return e.textContent&&(o.textContent=e.textContent),o},cloneFragment:function(t){var e,n,o,i,r;for(e=document.createDocumentFragment(),r=t.childNodes,n=0,o=r.length;o>n;n++)i=r[n],e.appendChild(i.cloneNode(!0));return e},makeFragment:function(t){var e,n,o;for(null==t&&(t=\"\"),e=document.createElement(\"div\"),e.innerHTML=t,n=document.createDocumentFragment();o=e.firstChild;)n.appendChild(o);return n},getBlockTagNames:function(){var t,n;return null!=e.blockTagNames?e.blockTagNames:e.blockTagNames=function(){var o,i;o=e.config.blockAttributes,i=[];for(t in o)n=o[t],i.push(n.tagName);return i}()},nodeIsBlockContainer:function(t){return e.nodeIsBlockStartComment(null!=t?t.firstChild:void 0)},nodeProbablyIsBlockContainer:function(t){var n,o;return n=e.tagName(t),s.call(e.getBlockTagNames(),n)>=0&&(o=e.tagName(t.firstChild),s.call(e.getBlockTagNames(),o)<0)},nodeIsBlockStart:function(t,n){var o;return o=(null!=n?n:{strict:!0}).strict,o?e.nodeIsBlockStartComment(t):e.nodeIsBlockStartComment(t)||!e.nodeIsBlockStartComment(t.firstChild)&&e.nodeProbablyIsBlockContainer(t)},nodeIsBlockStartComment:function(t){return e.nodeIsCommentNode(t)&&\"block\"===(null!=t?t.data:void 0)},nodeIsCommentNode:function(t){return(null!=t?t.nodeType:void 0)===Node.COMMENT_NODE},nodeIsCursorTarget:function(t){return t?e.nodeIsTextNode(t)?t.data===e.ZERO_WIDTH_SPACE:e.nodeIsCursorTarget(t.firstChild):void 0},nodeIsAttachmentElement:function(t){return e.elementMatchesSelector(t,e.AttachmentView.attachmentSelector)},nodeIsEmptyTextNode:function(t){return e.nodeIsTextNode(t)&&\"\"===(null!=t?t.data:void 0)},nodeIsTextNode:function(t){return(null!=t?t.nodeType:void 0)===Node.TEXT_NODE}})}.call(this),function(){var t,n,o,i,r;t=e.copyObject,i=e.objectsAreEqual,e.extend({normalizeRange:o=function(t){var e;if(null!=t)return Array.isArray(t)||(t=[t,t]),[n(t[0]),n(null!=(e=t[1])?e:t[0])]},rangeIsCollapsed:function(t){var e,n,i;if(null!=t)return n=o(t),i=n[0],e=n[1],r(i,e)},rangesAreEqual:function(t,e){var n,i,s,a,u,c;if(null!=t&&null!=e)return s=o(t),i=s[0],n=s[1],a=o(e),c=a[0],u=a[1],r(i,c)&&r(n,u)}}),n=function(e){return\"number\"==typeof e?e:t(e)},r=function(t,e){return\"number\"==typeof t?t===e:i(t,e)}}.call(this),function(){var t,n,o,i;t={extendsTagName:\"div\",css:\"%t { display: block; }\"},e.registerElement=function(e,n){var r,s,a,u,c,l,h;return null==n&&(n={}),e=e.toLowerCase(),c=i(n),u=null!=(h=c.extendsTagName)?h:t.extendsTagName,delete c.extendsTagName,s=c.defaultCSS,delete c.defaultCSS,null!=s&&u===t.extendsTagName?s+=\"\\n\"+t.css:s=t.css,o(s,e),a=Object.getPrototypeOf(document.createElement(u)),a.__super__=a,l=Object.create(a,c),r=document.registerElement(e,{prototype:l}),Object.defineProperty(l,\"constructor\",{value:r}),r},o=function(t,e){var o;return o=n(e),o.textContent=t.replace(/%t/g,e)},n=function(t){var e;return e=document.createElement(\"style\"),e.setAttribute(\"type\",\"text/css\"),e.setAttribute(\"data-tag-name\",t.toLowerCase()),document.head.insertBefore(e,document.head.firstChild),e},i=function(t){var e,n,o;n={};for(e in t)o=t[e],n[e]=\"function\"==typeof o?{value:o}:o;return n}}.call(this),function(){var t,n;e.extend({getDOMSelection:function(){var t;return t=window.getSelection(),t.rangeCount>0?t:void 0},getDOMRange:function(){var n,o;return(n=null!=(o=e.getDOMSelection())?o.getRangeAt(0):void 0)&&!t(n)?n:void 0},setDOMRange:function(t){var n;return n=window.getSelection(),n.removeAllRanges(),n.addRange(t),e.selectionChangeObserver.update()}}),t=function(t){return n(t.startContainer)||n(t.endContainer)},n=function(t){return!Object.getPrototypeOf(t)}}.call(this),function(){}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=e.arraysAreEqual,e.Hash=function(o){function i(t){null==t&&(t={}),this.values=s(t),i.__super__.constructor.apply(this,arguments)}var r,s,a,u,c;return n(i,o),i.fromCommonAttributesOfObjects=function(t){var e,n,o,i,s,a;if(null==t&&(t=[]),!t.length)return new this;for(e=r(t[0]),o=e.getKeys(),a=t.slice(1),n=0,i=a.length;i>n;n++)s=a[n],o=e.getKeysCommonToHash(r(s)),e=e.slice(o);return e},i.box=function(t){return r(t)},i.prototype.add=function(t,e){return this.merge(u(t,e))},i.prototype.remove=function(t){return new e.Hash(s(this.values,t))},i.prototype.get=function(t){return this.values[t]},i.prototype.has=function(t){return t in this.values},i.prototype.merge=function(t){return new e.Hash(a(this.values,c(t)))},i.prototype.slice=function(t){var n,o,i,r;for(r={},n=0,i=t.length;i>n;n++)o=t[n],this.has(o)&&(r[o]=this.values[o]);return new e.Hash(r)},i.prototype.getKeys=function(){return Object.keys(this.values)},i.prototype.getKeysCommonToHash=function(t){var e,n,o,i,s;for(t=r(t),i=this.getKeys(),s=[],e=0,o=i.length;o>e;e++)n=i[e],this.values[n]===t.values[n]&&s.push(n);return s},i.prototype.isEqualTo=function(e){return t(this.toArray(),r(e).toArray())},i.prototype.isEmpty=function(){return 0===this.getKeys().length},i.prototype.toArray=function(){var t,e,n;return(null!=this.array?this.array:this.array=function(){var o;e=[],o=this.values;for(t in o)n=o[t],e.push(t,n);return e}.call(this)).slice(0)},i.prototype.toObject=function(){return s(this.values)},i.prototype.toJSON=function(){return this.toObject()},i.prototype.contentsForInspection=function(){return{values:JSON.stringify(this.values)}},u=function(t,e){var n;return n={},n[t]=e,n},a=function(t,e){var n,o,i;o=s(t);for(n in e)i=e[n],o[n]=i;return o},s=function(t,e){var n,o,i,r,s;for(r={},s=Object.keys(t).sort(),n=0,i=s.length;i>n;n++)o=s[n],o!==e&&(r[o]=t[o]);return r},r=function(t){return t instanceof e.Hash?t:new e.Hash(t)},c=function(t){return t instanceof e.Hash?t.values:t},i}(e.Object)}.call(this),function(){e.ObjectGroup=function(){function t(t,e){var n,o;this.objects=null!=t?t:[],o=e.depth,n=e.asTree,n&&(this.depth=o,this.objects=this.constructor.groupObjects(this.objects,{asTree:n,depth:this.depth+1}))}return t.groupObjects=function(t,e){var n,o,i,r,s,a,u,c,l;for(null==t&&(t=[]),l=null!=e?e:{},i=l.depth,n=l.asTree,n&&null==i&&(i=0),c=[],s=0,a=t.length;a>s;s++){if(u=t[s],r){if((\"function\"==typeof u.canBeGrouped?u.canBeGrouped(i):void 0)&&(\"function\"==typeof(o=r[r.length-1]).canBeGroupedWith?o.canBeGroupedWith(u,i):void 0)){r.push(u);continue}c.push(new this(r,{depth:i,asTree:n})),r=null}(\"function\"==typeof u.canBeGrouped?u.canBeGrouped(i):void 0)?r=[u]:c.push(u)}return r&&c.push(new this(r,{depth:i,asTree:n})),c},t.prototype.getObjects=function(){return this.objects},t.prototype.getDepth=function(){return this.depth},t.prototype.getCacheKey=function(){var t,e,n,o,i;for(e=[\"objectGroup\"],i=this.getObjects(),t=0,n=i.length;n>t;t++)o=i[t],e.push(o.getCacheKey());return e.join(\"/\")},t}()}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.ObjectMap=function(e){function n(t){var e,n,o,i,r;for(null==t&&(t=[]),this.objects={},o=0,i=t.length;i>o;o++)r=t[o],n=JSON.stringify(r),null==(e=this.objects)[n]&&(e[n]=r)}return t(n,e),n.prototype.find=function(t){var e;return e=JSON.stringify(t),this.objects[e]},n}(e.BasicObject)}.call(this),function(){e.ElementStore=function(){function t(t){this.reset(t)}var e;return t.prototype.add=function(t){var n;return n=e(t),this.elements[n]=t},t.prototype.remove=function(t){var n,o;return n=e(t),(o=this.elements[n])?(delete this.elements[n],o):void 0},t.prototype.reset=function(t){var e,n,o;for(null==t&&(t=[]),this.elements={},n=0,o=t.length;o>n;n++)e=t[n],this.add(e);return t},e=function(t){return t.dataset.trixStoreKey},t}()}.call(this),function(){}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.Operation=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.isPerforming=function(){return this.performing===!0},n.prototype.hasPerformed=function(){return this.performed===!0},n.prototype.hasSucceeded=function(){return this.performed&&this.succeeded},n.prototype.hasFailed=function(){return this.performed&&!this.succeeded},n.prototype.getPromise=function(){return null!=this.promise?this.promise:this.promise=new Promise(function(t){return function(e,n){return t.performing=!0,t.perform(function(o,i){return t.succeeded=o,t.performing=!1,t.performed=!0,t.succeeded?e(i):n(i)})}}(this))},n.prototype.perform=function(t){return t(!1)},n.prototype.release=function(){var t;return null!=(t=this.promise)&&\"function\"==typeof t.cancel&&t.cancel(),this.promise=null,this.performing=null,this.performed=null,this.succeeded=null\n},n.proxyMethod(\"getPromise().then\"),n.proxyMethod(\"getPromise().catch\"),n}(e.BasicObject)}.call(this),function(){var t,n,o,i,r,s=function(t,e){function n(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;e.UTF16String=function(t){function e(t,e){this.ucs2String=t,this.codepoints=e,this.length=this.codepoints.length,this.ucs2Length=this.ucs2String.length}return s(e,t),e.box=function(t){return null==t&&(t=\"\"),t instanceof this?t:this.fromUCS2String(null!=t?t.toString():void 0)},e.fromUCS2String=function(t){return new this(t,i(t))},e.fromCodepoints=function(t){return new this(r(t),t)},e.prototype.offsetToUCS2Offset=function(t){return r(this.codepoints.slice(0,Math.max(0,t))).length},e.prototype.offsetFromUCS2Offset=function(t){return i(this.ucs2String.slice(0,Math.max(0,t))).length},e.prototype.slice=function(){var t;return this.constructor.fromCodepoints((t=this.codepoints).slice.apply(t,arguments))},e.prototype.charAt=function(t){return this.slice(t,t+1)},e.prototype.isEqualTo=function(t){return this.constructor.box(t).ucs2String===this.ucs2String},e.prototype.toJSON=function(){return this.ucs2String},e.prototype.getCacheKey=function(){return this.ucs2String},e.prototype.toString=function(){return this.ucs2String},e}(e.BasicObject),t=1===(\"function\"==typeof Array.from?Array.from(\"\\ud83d\\udc7c\").length:void 0),n=null!=(\"function\"==typeof\" \".codePointAt?\" \".codePointAt(0):void 0),o=\" \\ud83d\\udc7c\"===(\"function\"==typeof String.fromCodePoint?String.fromCodePoint(32,128124):void 0),i=t&&n?function(t){return Array.from(t).map(function(t){return t.codePointAt(0)})}:function(t){var e,n,o,i,r;for(i=[],e=0,o=t.length;o>e;)r=t.charCodeAt(e++),r>=55296&&56319>=r&&o>e&&(n=t.charCodeAt(e++),56320===(64512&n)?r=((1023&r)<<10)+(1023&n)+65536:e--),i.push(r);return i},r=o?function(t){return String.fromCodePoint.apply(String,t)}:function(t){var e,n,o;return e=function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)o=t[e],n=\"\",o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|1023&o),r.push(n+String.fromCharCode(o));return r}(),e.join(\"\")}}.call(this),function(){}.call(this),function(){}.call(this),function(){e.config.lang={bold:\"Bold\",bullets:\"Bullets\",\"byte\":\"Byte\",bytes:\"Bytes\",captionPlaceholder:\"Type a caption here\\u2026\",captionPrompt:\"Add a caption\\u2026\",code:\"Code\",heading1:\"Heading\",indent:\"Increase Level\",italic:\"Italic\",link:\"Link\",numbers:\"Numbers\",outdent:\"Decrease Level\",quote:\"Quote\",redo:\"Redo\",remove:\"Remove\",strike:\"Strikethrough\",undo:\"Undo\",unlink:\"Unlink\",urlPlaceholder:\"Enter a URL\\u2026\",GB:\"GB\",KB:\"KB\",MB:\"MB\",PB:\"PB\",TB:\"TB\"}}.call(this),function(){e.config.css={classNames:{attachment:{container:\"attachment\",typePrefix:\"attachment-\",caption:\"caption\",captionEdited:\"caption-edited\",captionEditor:\"caption-editor\",editingCaption:\"caption-editing\",progressBar:\"progress\",removeButton:\"remove icon\",size:\"size\"}}}}.call(this),function(){var t;e.config.blockAttributes=t={\"default\":{tagName:\"div\",parse:!1},quote:{tagName:\"blockquote\",nestable:!0},heading1:{tagName:\"h1\",terminal:!0,breakOnReturn:!0,group:!1},code:{tagName:\"pre\",terminal:!0,text:{plaintext:!0}},bulletList:{tagName:\"ul\",parse:!1},bullet:{tagName:\"li\",listAttribute:\"bulletList\",group:!1,nestable:!0,test:function(n){return e.tagName(n.parentNode)===t[this.listAttribute].tagName}},numberList:{tagName:\"ol\",parse:!1},number:{tagName:\"li\",listAttribute:\"numberList\",group:!1,nestable:!0,test:function(n){return e.tagName(n.parentNode)===t[this.listAttribute].tagName}}}}.call(this),function(){var t,n;t=e.config.lang,n=[t.bytes,t.KB,t.MB,t.GB,t.TB,t.PB],e.config.fileSize={prefix:\"IEC\",precision:2,formatter:function(e){var o,i,r,s,a;switch(e){case 0:return\"0 \"+t.bytes;case 1:return\"1 \"+t.byte;default:return o=function(){switch(this.prefix){case\"SI\":return 1e3;case\"IEC\":return 1024}}.call(this),i=Math.floor(Math.log(e)/Math.log(o)),r=e/Math.pow(o,i),s=r.toFixed(this.precision),a=s.replace(/0*$/,\"\").replace(/\\.$/,\"\"),a+\" \"+n[i]}}}}.call(this),function(){e.config.textAttributes={bold:{tagName:\"strong\",inheritable:!0,parser:function(t){var e;return e=window.getComputedStyle(t),\"bold\"===e.fontWeight||e.fontWeight>=600}},italic:{tagName:\"em\",inheritable:!0,parser:function(t){var e;return e=window.getComputedStyle(t),\"italic\"===e.fontStyle}},href:{groupTagName:\"a\",parser:function(t){var n,o,i;return n=e.AttachmentView.attachmentSelector,i=\"a:not(\"+n+\")\",(o=e.findClosestElementFromNode(t,{matchingSelector:i}))?o.getAttribute(\"href\"):void 0}},strike:{tagName:\"del\",inheritable:!0},frozen:{style:{backgroundColor:\"highlight\"}}}}.call(this),function(){var t,n,o,i,r;r=\"[data-trix-serialize=false]\",i=[\"contenteditable\",\"data-trix-id\",\"data-trix-store-key\",\"data-trix-mutable\"],n=\"data-trix-serialized-attributes\",o=\"[\"+n+\"]\",t=new RegExp(\"<!--block-->\",\"g\"),e.extend({serializers:{\"application/json\":function(t){var n;if(t instanceof e.Document)n=t;else{if(!(t instanceof HTMLElement))throw new Error(\"unserializable object\");n=e.Document.fromHTML(t.innerHTML)}return n.toSerializableDocument().toJSONString()},\"text/html\":function(s){var a,u,c,l,h,p,d,f,g,m,y,v,b,A,C,w,x;if(s instanceof e.Document)l=e.DocumentView.render(s);else{if(!(s instanceof HTMLElement))throw new Error(\"unserializable object\");l=s.cloneNode(!0)}for(A=l.querySelectorAll(r),h=0,g=A.length;g>h;h++)c=A[h],c.parentNode.removeChild(c);for(p=0,m=i.length;m>p;p++)for(a=i[p],C=l.querySelectorAll(\"[\"+a+\"]\"),d=0,y=C.length;y>d;d++)c=C[d],c.removeAttribute(a);for(w=l.querySelectorAll(o),f=0,v=w.length;v>f;f++){c=w[f];try{u=JSON.parse(c.getAttribute(n)),c.removeAttribute(n);for(b in u)x=u[b],c.setAttribute(b,x)}catch(E){}}return l.innerHTML.replace(t,\"\")}},deserializers:{\"application/json\":function(t){return e.Document.fromJSONString(t)},\"text/html\":function(t){return e.Document.fromHTML(t)}},serializeToContentType:function(t,n){var o;if(o=e.serializers[n])return o(t);throw new Error(\"unknown content type: \"+n)},deserializeFromContentType:function(t,n){var o;if(o=e.deserializers[n])return o(t);throw new Error(\"unknown content type: \"+n)}})}.call(this),function(){var t,n;n=e.makeFragment,t=e.config.lang,e.config.toolbar={content:n('<div class=\"button_row\">\\n  <span class=\"button_group text_tools\">\\n    <button type=\"button\" class=\"icon bold\" data-trix-attribute=\"bold\" data-trix-key=\"b\" title=\"'+t.bold+'\">'+t.bold+'</button>\\n    <button type=\"button\" class=\"icon italic\" data-trix-attribute=\"italic\" data-trix-key=\"i\" title=\"'+t.italic+'\">'+t.italic+'</button>\\n    <button type=\"button\" class=\"icon strike\" data-trix-attribute=\"strike\" title=\"'+t.strike+'\">'+t.strike+'</button>\\n    <button type=\"button\" class=\"icon link\" data-trix-attribute=\"href\" data-trix-action=\"link\" data-trix-key=\"k\" title=\"'+t.link+'\">'+t.link+'</button>\\n  </span>\\n\\n  <span class=\"button_group block_tools\">\\n    <button type=\"button\" class=\"icon heading-1\" data-trix-attribute=\"heading1\" title=\"'+t.heading1+'\">'+t.heading1+'</button>\\n    <button type=\"button\" class=\"icon quote\" data-trix-attribute=\"quote\" title=\"'+t.quote+'\">'+t.quote+'</button>\\n    <button type=\"button\" class=\"icon code\" data-trix-attribute=\"code\" title=\"'+t.code+'\">'+t.code+'</button>\\n    <button type=\"button\" class=\"icon list bullets\" data-trix-attribute=\"bullet\" title=\"'+t.bullets+'\">'+t.bullets+'</button>\\n    <button type=\"button\" class=\"icon list numbers\" data-trix-attribute=\"number\" title=\"'+t.numbers+'\">'+t.numbers+'</button>\\n    <button type=\"button\" class=\"icon nesting-level decrease\" data-trix-action=\"decreaseNestingLevel\" title=\"'+t.outdent+'\">'+t.outdent+'</button>\\n    <button type=\"button\" class=\"icon nesting-level increase\" data-trix-action=\"increaseNestingLevel\" title=\"'+t.indent+'\">'+t.indent+'</button>\\n  </span>\\n\\n  <span class=\"button_group history_tools\">\\n    <button type=\"button\" class=\"icon undo\" data-trix-action=\"undo\" data-trix-key=\"z\" title=\"'+t.undo+'\">'+t.undo+'</button>\\n    <button type=\"button\" class=\"icon redo\" data-trix-action=\"redo\" data-trix-key=\"shift+z\" title=\"'+t.redo+'\">'+t.redo+'</button>\\n  </span>\\n</div>\\n\\n<div class=\"dialogs\">\\n  <div class=\"dialog link_dialog\" data-trix-attribute=\"href\" data-trix-dialog=\"href\">\\n    <div class=\"link_url_fields\">\\n      <input type=\"url\" required name=\"href\" placeholder=\"'+t.urlPlaceholder+'\">\\n      <div class=\"button_group\">\\n        <input type=\"button\" value=\"'+t.link+'\" data-trix-method=\"setAttribute\">\\n        <input type=\"button\" value=\"'+t.unlink+'\" data-trix-method=\"removeAttribute\">\\n      </div>\\n    </div>\\n  </div>\\n</div>')}}.call(this),function(){e.config.undoInterval=5e3}.call(this),function(){var t,n;t=e.makeElement,n={cursorTarget:t({tagName:\"span\",textContent:e.ZERO_WIDTH_SPACE,data:{trixSelection:!0,trixCursorTarget:!0,trixSerialize:!1}})},e.extend({selectionElements:{selector:\"[data-trix-selection]\",cssText:\"font-size: 0 !important;\\npadding: 0 !important;\\nmargin: 0 !important;\\nborder: none !important;\\nline-height: 0 !important;\",create:function(t){return n[t].cloneNode(!0)}}})}.call(this),function(){}.call(this),function(){var t;t=e.cloneFragment,e.registerElement(\"trix-toolbar\",{defaultCSS:\"%t {\\n  white-space: collapse;\\n}\\n\\n%t .dialog {\\n  display: none;\\n}\\n\\n%t .dialog.active {\\n  display: block;\\n}\\n\\n%t .dialog input.validate:invalid {\\n  background-color: #ffdddd;\\n}\\n\\n%t[native] {\\n  display: none;\\n}\",createdCallback:function(){return\"\"===this.innerHTML?this.appendChild(t(e.config.toolbar.content)):void 0}})}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty,o=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};e.ObjectView=function(n){function i(t,e){this.object=t,this.options=null!=e?e:{},this.childViews=[],this.rootView=this}return t(i,n),i.prototype.getNodes=function(){var t,e,n,o,i;for(null==this.nodes&&(this.nodes=this.createNodes()),o=this.nodes,i=[],t=0,e=o.length;e>t;t++)n=o[t],i.push(n.cloneNode(!0));return i},i.prototype.invalidate=function(){var t;return this.nodes=null,null!=(t=this.parentView)?t.invalidate():void 0},i.prototype.invalidateViewForObject=function(t){var e;return null!=(e=this.findViewForObject(t))?e.invalidate():void 0},i.prototype.findOrCreateCachedChildView=function(t,e){var n;return(n=this.getCachedViewForObject(e))?this.recordChildView(n):(n=this.createChildView.apply(this,arguments),this.cacheViewForObject(n,e)),n},i.prototype.createChildView=function(t,n,o){var i;return null==o&&(o={}),n instanceof e.ObjectGroup&&(o.viewClass=t,t=e.ObjectGroupView),i=new t(n,o),this.recordChildView(i)},i.prototype.recordChildView=function(t){return t.parentView=this,t.rootView=this.rootView,o.call(this.childViews,t)<0&&this.childViews.push(t),t},i.prototype.getAllChildViews=function(){var t,e,n,o,i;for(i=[],o=this.childViews,e=0,n=o.length;n>e;e++)t=o[e],i.push(t),i=i.concat(t.getAllChildViews());return i},i.prototype.findElement=function(){return this.findElementForObject(this.object)},i.prototype.findElementForObject=function(t){var e;return(e=null!=t?t.id:void 0)?this.rootView.element.querySelector(\"[data-trix-id='\"+e+\"']\"):void 0},i.prototype.findViewForObject=function(t){var e,n,o,i;for(o=this.getAllChildViews(),e=0,n=o.length;n>e;e++)if(i=o[e],i.object===t)return i},i.prototype.getViewCache=function(){return this.rootView!==this?this.rootView.getViewCache():this.isViewCachingEnabled()?null!=this.viewCache?this.viewCache:this.viewCache={}:void 0},i.prototype.isViewCachingEnabled=function(){return this.shouldCacheViews!==!1},i.prototype.enableViewCaching=function(){return this.shouldCacheViews=!0},i.prototype.disableViewCaching=function(){return this.shouldCacheViews=!1},i.prototype.getCachedViewForObject=function(t){var e;return null!=(e=this.getViewCache())?e[t.getCacheKey()]:void 0},i.prototype.cacheViewForObject=function(t,e){var n;return null!=(n=this.getViewCache())?n[e.getCacheKey()]=t:void 0},i.prototype.garbageCollectCachedViews=function(){var t,e,n,i,r,s;if(t=this.getViewCache()){s=this.getAllChildViews().concat(this),n=function(){var t,e,n;for(n=[],t=0,e=s.length;e>t;t++)r=s[t],n.push(r.object.getCacheKey());return n}(),i=[];for(e in t)o.call(n,e)<0&&i.push(delete t[e]);return i}},i}(e.BasicObject)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.ObjectGroupView=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.objectGroup=this.object,this.viewClass=this.options.viewClass,delete this.options.viewClass}return t(n,e),n.prototype.getChildViews=function(){var t,e,n,o;if(!this.childViews.length)for(o=this.objectGroup.getObjects(),t=0,e=o.length;e>t;t++)n=o[t],this.findOrCreateCachedChildView(this.viewClass,n,this.options);return this.childViews},n.prototype.createNodes=function(){var t,e,n,o,i,r,s,a,u;for(t=this.createContainerElement(),s=this.getChildViews(),e=0,o=s.length;o>e;e++)for(u=s[e],a=u.getNodes(),n=0,i=a.length;i>n;n++)r=a[n],t.appendChild(r);return[t]},n.prototype.createContainerElement=function(t){return null==t&&(t=this.objectGroup.getDepth()),this.getChildViews()[0].createContainerElement(t)},n}(e.ObjectView)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.Controller=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(e.BasicObject)}.call(this),function(){var t,n,o,i,r,s,a=function(t,e){return function(){return t.apply(e,arguments)}},u=function(t,e){function n(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty,l=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=e.findClosestElementFromNode,o=e.nodeIsEmptyTextNode,n=e.nodeIsBlockStartComment,i=e.normalizeSpaces,r=e.summarizeStringChange,s=e.tagName,e.MutationObserver=function(e){function c(t){this.element=t,this.didMutate=a(this.didMutate,this),this.observer=new window.MutationObserver(this.didMutate),this.start()}var h,p,d,f;return u(c,e),p=\"data-trix-mutable\",d=\"[\"+p+\"]\",f={attributes:!0,childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},c.prototype.start=function(){return this.reset(),this.observer.observe(this.element,f)},c.prototype.stop=function(){return this.observer.disconnect()},c.prototype.didMutate=function(t){var e,n;return(e=this.mutations).push.apply(e,this.findSignificantMutations(t)),this.mutations.length?(null!=(n=this.delegate)&&\"function\"==typeof n.elementDidMutate&&n.elementDidMutate(this.getMutationSummary()),this.reset()):void 0},c.prototype.reset=function(){return this.mutations=[]},c.prototype.findSignificantMutations=function(t){var e,n,o,i;for(i=[],e=0,n=t.length;n>e;e++)o=t[e],this.mutationIsSignificant(o)&&i.push(o);return i},c.prototype.mutationIsSignificant=function(t){var e,n,o,i;for(i=this.nodesModifiedByMutation(t),e=0,n=i.length;n>e;e++)if(o=i[e],this.nodeIsSignificant(o))return!0;return!1},c.prototype.nodeIsSignificant=function(t){return t!==this.element&&!this.nodeIsMutable(t)&&!o(t)},c.prototype.nodeIsMutable=function(e){return t(e,{matchingSelector:d})},c.prototype.nodesModifiedByMutation=function(t){var e;switch(e=[],t.type){case\"attributes\":t.attributeName!==p&&e.push(t.target);break;case\"characterData\":e.push(t.target.parentNode),e.push(t.target);break;case\"childList\":e.push.apply(e,t.addedNodes),e.push.apply(e,t.removedNodes)}return e},c.prototype.getMutationSummary=function(){return this.getTextMutationSummary()},c.prototype.getTextMutationSummary=function(){var t,e,n,o,i,r,s,a,u,c,h;for(a=this.getTextChangesFromCharacterData(),n=a.additions,i=a.deletions,h=this.getTextChangesFromChildList(),u=h.additions,r=0,s=u.length;s>r;r++)e=u[r],l.call(n,e)<0&&n.push(e);return i.push.apply(i,h.deletions),c={},(t=n.join(\"\"))&&(c.textAdded=t),(o=i.join(\"\"))&&(c.textDeleted=o),c},c.prototype.getMutationsByType=function(t){var e,n,o,i,r;for(i=this.mutations,r=[],e=0,n=i.length;n>e;e++)o=i[e],o.type===t&&r.push(o);return r},c.prototype.getTextChangesFromChildList=function(){var t,e,o,r,s,a,u,c,l,p,d;for(t=[],u=[],a=this.getMutationsByType(\"childList\"),e=0,r=a.length;r>e;e++)s=a[e],t.push.apply(t,s.addedNodes),u.push.apply(u,s.removedNodes);return c=0===t.length&&1===u.length&&n(u[0]),c?(p=[],d=[\"\\n\"]):(p=h(t),d=h(u)),{additions:function(){var t,e,n;for(n=[],o=t=0,e=p.length;e>t;o=++t)l=p[o],l!==d[o]&&n.push(i(l));return n}(),deletions:function(){var t,e,n;for(n=[],o=t=0,e=d.length;e>t;o=++t)l=d[o],l!==p[o]&&n.push(i(l));return n}()}},c.prototype.getTextChangesFromCharacterData=function(){var t,e,n,o,s,a,u,c;return e=this.getMutationsByType(\"characterData\"),e.length&&(c=e[0],n=e[e.length-1],s=i(c.oldValue),o=i(n.target.data),a=r(s,o),t=a.added,u=a.removed),{additions:t?[t]:[],deletions:u?[u]:[]}},h=function(t){var e,n,o,i;for(null==t&&(t=[]),i=[],e=0,n=t.length;n>e;e++)switch(o=t[e],o.nodeType){case Node.TEXT_NODE:i.push(o.data);break;case Node.ELEMENT_NODE:\"br\"===s(o)?i.push(\"\\n\"):i.push.apply(i,h(o.childNodes))}return i},c}(e.BasicObject)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.FileVerificationOperation=function(e){function n(t){this.file=t}return t(n,e),n.prototype.perform=function(t){var e;return e=new FileReader,e.onerror=function(){return t(!1)},e.onload=function(n){return function(){e.onerror=null;try{e.abort()}catch(o){}return t(!0,n.file)}}(this),e.readAsArrayBuffer(this.file)},n}(e.Operation)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.CompositionInput=function(e){function n(t){var e;this.inputController=t,e=this.inputController,this.responder=e.responder,this.delegate=e.delegate,this.inputSummary=e.inputSummary,this.data={}}return t(n,e),n.prototype.start=function(t){var e,n;return this.data.start=t,\"keypress\"===this.inputSummary.eventName&&this.inputSummary.textAdded&&null!=(e=this.responder)&&e.deleteInDirection(\"left\"),this.selectionIsExpanded()||(this.insertPlaceholder(),this.requestRender()),this.range=null!=(n=this.responder)?n.getSelectedRange():void 0},n.prototype.update=function(t){var e;return this.data.update=t,(e=this.selectPlaceholder())?(this.forgetPlaceholder(),this.range=e):void 0},n.prototype.end=function(t){var e,n,o,i;return this.data.end=t,this.forgetPlaceholder(),this.canApplyToDocument()?(this.setInputSummary({preferDocument:!0}),null!=(e=this.delegate)&&e.inputControllerWillPerformTyping(),null!=(n=this.responder)&&n.setSelectedRange(this.range),null!=(o=this.responder)&&o.insertString(this.data.end),null!=(i=this.responder)?i.setSelectedRange(this.range[0]+this.data.end.length):void 0):null!=this.data.start||null!=this.data.update?(this.requestReparse(),this.inputController.reset()):void 0},n.prototype.getEndData=function(){return this.data.end},n.prototype.isEnded=function(){return null!=this.getEndData()},n.prototype.canApplyToDocument=function(){var t,e;return 0===(null!=(t=this.data.start)?t.length:void 0)&&(null!=(e=this.data.end)?e.length:void 0)>0&&null!=this.range},n.proxyMethod(\"inputController.setInputSummary\"),n.proxyMethod(\"inputController.requestRender\"),n.proxyMethod(\"inputController.requestReparse\"),n.proxyMethod(\"responder?.selectionIsExpanded\"),n.proxyMethod(\"responder?.insertPlaceholder\"),n.proxyMethod(\"responder?.selectPlaceholder\"),n.proxyMethod(\"responder?.forgetPlaceholder\"),n}(e.BasicObject)}.call(this),function(){var t,n,o,i,r,s,a,u,c,l,h,p,d,f=function(t,e){function n(){this.constructor=t}for(var o in e)g.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},g={}.hasOwnProperty,m=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};i=e.handleEvent,c=e.makeElement,r=e.innerElementIsActive,l=e.objectsAreEqual,p=e.tagName,e.InputController=function(p){function d(t){var n;this.element=t,this.resetInputSummary(),this.mutationObserver=new e.MutationObserver(this.element),this.mutationObserver.delegate=this;for(n in this.events)i(n,{onElement:this.element,withCallback:this.handlerFor(n),inPhase:\"capturing\"})}var g;return f(d,p),g=0,d.keyNames={8:\"backspace\",9:\"tab\",13:\"return\",37:\"left\",39:\"right\",46:\"delete\",68:\"d\",72:\"h\",79:\"o\"},d.prototype.handlerFor=function(t){return function(e){return function(n){return e.handleInput(function(){return r(this.element)?void 0:(this.eventName=t,this.events[t].call(this,n))})}}(this)},d.prototype.setInputSummary=function(t){var e,n;null==t&&(t={}),this.inputSummary.eventName=this.eventName;for(e in t)n=t[e],this.inputSummary[e]=n;return this.inputSummary},d.prototype.resetInputSummary=function(){return this.inputSummary={}},d.prototype.reset=function(){return this.resetInputSummary(),e.selectionChangeObserver.reset()},d.prototype.editorWillSyncDocumentView=function(){return this.mutationObserver.stop()},d.prototype.editorDidSyncDocumentView=function(){return this.mutationObserver.start()},d.prototype.requestRender=function(){var t;return null!=(t=this.delegate)&&\"function\"==typeof t.inputControllerDidRequestRender?t.inputControllerDidRequestRender():void 0},d.prototype.requestReparse=function(){var t;return null!=(t=this.delegate)&&\"function\"==typeof t.inputControllerDidRequestReparse&&t.inputControllerDidRequestReparse(),this.requestRender()},d.prototype.elementDidMutate=function(t){var e;return this.isComposing()?null!=(e=this.delegate)&&\"function\"==typeof e.inputControllerDidAllowUnhandledInput?e.inputControllerDidAllowUnhandledInput():void 0:this.handleInput(function(){return this.mutationIsSignificant(t)&&(this.mutationIsExpected(t)?this.requestRender():this.requestReparse()),this.reset()})},d.prototype.mutationIsExpected=function(t){var e,n,o,i,r,s,a,u,c,l;return a=t.textAdded,u=t.textDeleted,this.inputSummary.preferDocument?!0:(e=null!=a?a===this.inputSummary.textAdded:!this.inputSummary.textAdded,n=null!=u?this.inputSummary.didDelete:!this.inputSummary.didDelete,c=\"\\n\"===a&&!e,l=\"\\n\"===u&&!n,s=c&&!l||l&&!c,s&&(i=this.getSelectedRange())&&(o=c?-1:1,null!=(r=this.responder)?r.positionIsBlockBreak(i[1]+o):void 0)?!0:e&&n)},d.prototype.mutationIsSignificant=function(t){var e,n,o;return o=Object.keys(t).length>0,e=\"\"===(null!=(n=this.compositionInput)?n.getEndData():void 0),o||!e},d.prototype.attachFiles=function(t){var n,o;return o=function(){var o,i,r;for(r=[],o=0,i=t.length;i>o;o++)n=t[o],r.push(new e.FileVerificationOperation(n));return r}(),Promise.all(o).then(function(t){return function(e){return t.handleInput(function(){var t,n;return null!=(t=this.delegate)&&t.inputControllerWillAttachFiles(),null!=(n=this.responder)&&n.insertFiles(e),this.requestRender()})}}(this))},d.prototype.events={keydown:function(t){var n,o,i,r,a,u,c,l,h;if(this.isComposing()||this.resetInputSummary(),r=this.constructor.keyNames[t.keyCode]){for(o=this.keys,l=[\"ctrl\",\"alt\",\"shift\",\"meta\"],i=0,u=l.length;u>i;i++)c=l[i],t[c+\"Key\"]&&(\"ctrl\"===c&&(c=\"control\"),o=null!=o?o[c]:void 0);null!=(null!=o?o[r]:void 0)&&(this.setInputSummary({keyName:r}),e.selectionChangeObserver.reset(),o[r].call(this,t))}return s(t)&&(n=String.fromCharCode(t.keyCode).toLowerCase())&&(a=function(){var e,n,o,i;for(o=[\"alt\",\"shift\"],i=[],e=0,n=o.length;n>e;e++)c=o[e],t[c+\"Key\"]&&i.push(c);return i}(),a.push(n),null!=(h=this.delegate)?h.inputControllerDidReceiveKeyboardCommand(a):void 0)?t.preventDefault():void 0},keypress:function(t){var e,n,o;if(null==this.inputSummary.eventName&&(!t.metaKey&&!t.ctrlKey||t.altKey)&&!u(t)&&!a(t))return null===t.which?e=String.fromCharCode(t.keyCode):0!==t.which&&0!==t.charCode&&(e=String.fromCharCode(t.charCode)),null!=e?(null!=(n=this.delegate)&&n.inputControllerWillPerformTyping(),null!=(o=this.responder)&&o.insertString(e),this.setInputSummary({textAdded:e,didDelete:this.selectionIsExpanded()})):void 0},textInput:function(t){var e,n,o,i;return e=t.data,i=this.inputSummary.textAdded,i&&i!==e&&i.toUpperCase()===e?(n=this.getSelectedRange(),this.setSelectedRange([n[0],n[1]+i.length]),null!=(o=this.responder)&&o.insertString(e),this.setInputSummary({textAdded:e}),this.setSelectedRange(n)):void 0},dragenter:function(t){return t.preventDefault()},dragstart:function(t){var e,n;return n=t.target,this.serializeSelectionToDataTransfer(t.dataTransfer),this.draggedRange=this.getSelectedRange(),null!=(e=this.delegate)&&\"function\"==typeof e.inputControllerDidStartDrag?e.inputControllerDidStartDrag():void 0},dragover:function(t){var e,n;return!this.draggedRange&&!this.canAcceptDataTransfer(t.dataTransfer)||(t.preventDefault(),e={x:t.clientX,y:t.clientY},l(e,this.draggingPoint))?void 0:(this.draggingPoint=e,null!=(n=this.delegate)&&\"function\"==typeof n.inputControllerDidReceiveDragOverPoint?n.inputControllerDidReceiveDragOverPoint(this.draggingPoint):void 0)},dragend:function(){var t;return null!=(t=this.delegate)&&\"function\"==typeof t.inputControllerDidCancelDrag&&t.inputControllerDidCancelDrag(),this.draggedRange=null,this.draggingPoint=null},drop:function(t){var n,o,i,r,s,a,u,c,l;return t.preventDefault(),i=null!=(s=t.dataTransfer)?s.files:void 0,r={x:t.clientX,y:t.clientY},null!=(a=this.responder)&&a.setLocationRangeFromPointRange(r),(null!=i?i.length:void 0)?this.attachFiles(i):this.draggedRange?(null!=(u=this.delegate)&&u.inputControllerWillMoveText(),null!=(c=this.responder)&&c.moveTextFromRange(this.draggedRange),this.draggedRange=null,this.requestRender()):(o=t.dataTransfer.getData(\"application/x-trix-document\"))&&(n=e.Document.fromJSONString(o),null!=(l=this.responder)&&l.insertDocument(n),this.requestRender()),this.draggedRange=null,this.draggingPoint=null},cut:function(t){var e;return this.serializeSelectionToDataTransfer(t.clipboardData)&&t.preventDefault(),null!=(e=this.delegate)&&e.inputControllerWillCutText(),this.deleteInDirection(\"backward\"),t.defaultPrevented?this.requestRender():void 0},copy:function(t){return this.serializeSelectionToDataTransfer(t.clipboardData)?t.preventDefault():void 0},paste:function(n){var i,r,s,a,u,c,l,p,d,f,y,v,b,A,C,w,x,E,S,k,R,L;return u=null!=(l=n.clipboardData)?l:n.testClipboardData,c={paste:u},null==u||h(n)?void this.getPastedHTMLUsingHiddenElement(function(t){return function(e){var n,o,i;return c.html=e,null!=(n=t.delegate)&&n.inputControllerWillPasteText(c),null!=(o=t.responder)&&o.insertHTML(e),t.requestRender(),null!=(i=t.delegate)?i.inputControllerDidPaste(c):void 0}}(this)):((s=u.getData(\"URL\"))?(L=u.getData(\"public.url-name\")||s,c.string=L,this.setInputSummary({textAdded:L,didDelete:this.selectionIsExpanded()}),null!=(p=this.delegate)&&p.inputControllerWillPasteText(c),null!=(A=this.responder)&&A.insertText(e.Text.textForStringWithAttributes(L,{href:s})),this.requestRender(),null!=(C=this.delegate)&&C.inputControllerDidPaste(c)):t(u)?(L=u.getData(\"text/plain\"),c.string=L,this.setInputSummary({textAdded:L,didDelete:this.selectionIsExpanded()}),null!=(w=this.delegate)&&w.inputControllerWillPasteText(c),null!=(x=this.responder)&&x.insertString(L),this.requestRender(),null!=(E=this.delegate)&&E.inputControllerDidPaste(c)):(a=u.getData(\"text/html\"))?(c.html=a,null!=(S=this.delegate)&&S.inputControllerWillPasteText(c),null!=(k=this.responder)&&k.insertHTML(a),this.requestRender(),null!=(R=this.delegate)&&R.inputControllerDidPaste(c)):m.call(u.types,\"Files\")>=0&&(r=null!=(d=u.items)&&null!=(f=d[0])&&\"function\"==typeof f.getAsFile?f.getAsFile():void 0)&&(!r.name&&(i=o(r))&&(r.name=\"pasted-file-\"+ ++g+\".\"+i),c.file=r,null!=(y=this.delegate)&&y.inputControllerWillAttachFiles(),null!=(v=this.responder)&&v.insertFile(r),this.requestRender(),null!=(b=this.delegate)&&b.inputControllerDidPaste(c)),n.preventDefault())},compositionstart:function(t){return this.getCompositionInput().start(t.data)},compositionupdate:function(t){return this.getCompositionInput().update(t.data)},compositionend:function(t){return this.getCompositionInput().end(t.data)},input:function(t){return t.stopPropagation()}},d.prototype.keys={backspace:function(t){var e;return null!=(e=this.delegate)&&e.inputControllerWillPerformTyping(),this.deleteInDirection(\"backward\",t)},\"delete\":function(t){var e;return null!=(e=this.delegate)&&e.inputControllerWillPerformTyping(),this.deleteInDirection(\"forward\",t)},\"return\":function(){var t,e;return this.setInputSummary({preferDocument:!0}),null!=(t=this.delegate)&&t.inputControllerWillPerformTyping(),null!=(e=this.responder)?e.insertLineBreak():void 0},tab:function(t){var e,n;return(null!=(e=this.responder)?e.canIncreaseNestingLevel():void 0)?(null!=(n=this.responder)&&n.increaseNestingLevel(),this.requestRender(),t.preventDefault()):void 0},left:function(t){var e;return this.selectionIsInCursorTarget()?(t.preventDefault(),null!=(e=this.responder)?e.moveCursorInDirection(\"backward\"):void 0):void 0},right:function(t){var e;return this.selectionIsInCursorTarget()?(t.preventDefault(),null!=(e=this.responder)?e.moveCursorInDirection(\"forward\"):void 0):void 0},control:{d:function(t){var e;return null!=(e=this.delegate)&&e.inputControllerWillPerformTyping(),this.deleteInDirection(\"forward\",t)},h:function(t){var e;return null!=(e=this.delegate)&&e.inputControllerWillPerformTyping(),this.deleteInDirection(\"backward\",t)},o:function(t){var e,n;return t.preventDefault(),null!=(e=this.delegate)&&e.inputControllerWillPerformTyping(),null!=(n=this.responder)&&n.insertString(\"\\n\",{updatePosition:!1}),this.requestRender()}},shift:{\"return\":function(t){var e,n;return null!=(e=this.delegate)&&e.inputControllerWillPerformTyping(),null!=(n=this.responder)&&n.insertString(\"\\n\"),this.requestRender(),t.preventDefault()},tab:function(t){var e,n;return(null!=(e=this.responder)?e.canDecreaseNestingLevel():void 0)?(null!=(n=this.responder)&&n.decreaseNestingLevel(),this.requestRender(),t.preventDefault()):void 0},left:function(t){return this.selectionIsInCursorTarget()?(t.preventDefault(),this.expandSelectionInDirection(\"backward\")):void 0},right:function(t){return this.selectionIsInCursorTarget()?(t.preventDefault(),this.expandSelectionInDirection(\"forward\")):void 0}},alt:{backspace:function(){var t;return this.setInputSummary({preferDocument:!1}),null!=(t=this.delegate)?t.inputControllerWillPerformTyping():void 0}},meta:{backspace:function(){var t;return this.setInputSummary({preferDocument:!1}),null!=(t=this.delegate)?t.inputControllerWillPerformTyping():void 0}}},d.prototype.handleInput=function(t){var e,n;try{return null!=(e=this.delegate)&&e.inputControllerWillHandleInput(),t.call(this)}finally{null!=(n=this.delegate)&&n.inputControllerDidHandleInput()}},d.prototype.getCompositionInput=function(){return this.isComposing()?this.compositionInput:this.compositionInput=new e.CompositionInput(this)},d.prototype.isComposing=function(){return null!=this.compositionInput&&!this.compositionInput.isEnded()},d.prototype.deleteInDirection=function(t,e){var n;return(null!=(n=this.responder)?n.deleteInDirection(t):void 0)!==!1?this.setInputSummary({didDelete:!0}):e?(e.preventDefault(),this.requestRender()):void 0},d.prototype.serializeSelectionToDataTransfer=function(t){var o,i;if(n(t))return o=null!=(i=this.responder)?i.getSelectedDocument().toSerializableDocument():void 0,t.setData(\"application/x-trix-document\",JSON.stringify(o)),t.setData(\"text/html\",e.DocumentView.render(o).innerHTML),t.setData(\"text/plain\",o.toString().replace(/\\n$/,\"\")),!0},d.prototype.canAcceptDataTransfer=function(t){var e,n,o,i,r,s;for(s={},i=null!=(o=null!=t?t.types:void 0)?o:[],e=0,n=i.length;n>e;e++)r=i[e],s[r]=!0;return s.Files||s[\"application/x-trix-document\"]||s[\"text/html\"]||s[\"text/plain\"]},d.prototype.getPastedHTMLUsingHiddenElement=function(t){var e,n,o;return n=this.getSelectedRange(),o={position:\"absolute\",left:window.pageXOffset+\"px\",top:window.pageYOffset+\"px\",opacity:0},e=c({style:o,tagName:\"div\",editable:!0}),document.body.appendChild(e),e.focus(),requestAnimationFrame(function(o){return function(){var i;return i=e.innerHTML,document.body.removeChild(e),o.setSelectedRange(n),t(i)}}(this))},d.proxyMethod(\"responder?.getSelectedRange\"),d.proxyMethod(\"responder?.setSelectedRange\"),d.proxyMethod(\"responder?.expandSelectionInDirection\"),d.proxyMethod(\"responder?.selectionIsInCursorTarget\"),d.proxyMethod(\"responder?.selectionIsExpanded\"),d\n}(e.BasicObject),o=function(t){var e,n;return null!=(e=t.type)&&null!=(n=e.match(/\\/(\\w+)$/))?n[1]:void 0},u=function(t){return t.metaKey&&t.altKey&&!t.shiftKey&&94===t.keyCode},a=function(t){return t.metaKey&&t.altKey&&t.shiftKey&&9674===t.keyCode},s=function(t){return/Mac|^iP/.test(navigator.platform)?t.metaKey:t.ctrlKey},h=function(t){var e,n;return(n=null!=(e=t.clipboardData)?e.types:void 0)?m.call(n,\"text/html\")<0&&(m.call(n,\"com.apple.webarchive\")>=0||m.call(n,\"com.apple.flat-rtfd\")>=0):void 0},t=function(t){var e,n,o;return o=t.getData(\"text/plain\"),n=t.getData(\"text/html\"),o&&n?(e=c(\"div\"),e.innerHTML=n,e.textContent===o?!e.querySelector(\":not(meta)\"):void 0):null!=o?o.length:void 0},d={\"application/x-trix-feature-detection\":\"test\"},n=function(t){var e,n;if(null!=(null!=t?t.setData:void 0)){for(e in d)if(n=d[e],t.setData(e,n),t.getData(e)!==n)return;return!0}}}.call(this),function(){var t,n,o,i,r,s,a=function(t,e){return function(){return t.apply(e,arguments)}},u=function(t,e){function n(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;n=e.handleEvent,r=e.makeElement,s=e.tagName,o=e.InputController.keyNames,i=e.config.lang,t=e.config.css.classNames,e.AttachmentEditorController=function(e){function c(t,e,n){this.attachmentPiece=t,this.element=e,this.container=n,this.uninstall=a(this.uninstall,this),this.didKeyDownCaption=a(this.didKeyDownCaption,this),this.didChangeCaption=a(this.didChangeCaption,this),this.didClickCaption=a(this.didClickCaption,this),this.didClickRemoveButton=a(this.didClickRemoveButton,this),this.attachment=this.attachmentPiece.attachment,\"a\"===s(this.element)&&(this.element=this.element.firstChild),this.install()}var l;return u(c,e),l=function(t){return function(){var e;return e=t.apply(this,arguments),e[\"do\"](),null==this.undos&&(this.undos=[]),this.undos.push(e.undo)}},c.prototype.install=function(){return this.makeElementMutable(),this.attachment.isPreviewable()&&this.makeCaptionEditable(),this.addRemoveButton()},c.prototype.makeElementMutable=l(function(){return{\"do\":function(t){return function(){return t.element.dataset.trixMutable=!0}}(this),undo:function(t){return function(){return delete t.element.dataset.trixMutable}}(this)}}),c.prototype.makeCaptionEditable=l(function(){var t,e;return t=this.element.querySelector(\"figcaption\"),e=null,{\"do\":function(o){return function(){return e=n(\"click\",{onElement:t,withCallback:o.didClickCaption,inPhase:\"capturing\"})}}(this),undo:function(){return function(){return e.destroy()}}(this)}}),c.prototype.addRemoveButton=l(function(){var e;return e=r({tagName:\"button\",textContent:i.remove,className:t.attachment.removeButton,attributes:{type:\"button\",title:i.remove},data:{trixMutable:!0}}),n(\"click\",{onElement:e,withCallback:this.didClickRemoveButton}),{\"do\":function(t){return function(){return t.element.appendChild(e)}}(this),undo:function(t){return function(){return t.element.removeChild(e)}}(this)}}),c.prototype.editCaption=l(function(){var e,o,s,a,u;return a=r({tagName:\"textarea\",className:t.attachment.captionEditor,attributes:{placeholder:i.captionPlaceholder}}),a.value=this.attachmentPiece.getCaption(),u=a.cloneNode(),u.classList.add(\"trix-autoresize-clone\"),e=function(){return u.value=a.value,a.style.height=u.scrollHeight+\"px\"},n(\"input\",{onElement:a,withCallback:e}),n(\"keydown\",{onElement:a,withCallback:this.didKeyDownCaption}),n(\"change\",{onElement:a,withCallback:this.didChangeCaption}),n(\"blur\",{onElement:a,withCallback:this.uninstall}),s=this.element.querySelector(\"figcaption\"),o=s.cloneNode(),{\"do\":function(){return s.style.display=\"none\",o.appendChild(a),o.appendChild(u),o.classList.add(t.attachment.editingCaption),s.parentElement.insertBefore(o,s),e(),a.focus()},undo:function(){return o.parentNode.removeChild(o),s.style.display=null}}}),c.prototype.didClickRemoveButton=function(t){var e;return t.preventDefault(),t.stopPropagation(),null!=(e=this.delegate)?e.attachmentEditorDidRequestRemovalOfAttachment(this.attachment):void 0},c.prototype.didClickCaption=function(t){return t.preventDefault(),this.editCaption()},c.prototype.didChangeCaption=function(t){var e,n,o;return e=t.target.value.replace(/\\s/g,\" \").trim(),e?null!=(n=this.delegate)&&\"function\"==typeof n.attachmentEditorDidRequestUpdatingAttributesForAttachment?n.attachmentEditorDidRequestUpdatingAttributesForAttachment({caption:e},this.attachment):void 0:null!=(o=this.delegate)&&\"function\"==typeof o.attachmentEditorDidRequestRemovingAttributeForAttachment?o.attachmentEditorDidRequestRemovingAttributeForAttachment(\"caption\",this.attachment):void 0},c.prototype.didKeyDownCaption=function(t){var e;return\"return\"===o[t.keyCode]?(t.preventDefault(),this.didChangeCaption(t),null!=(e=this.delegate)&&\"function\"==typeof e.attachmentEditorDidRequestDeselectingAttachment?e.attachmentEditorDidRequestDeselectingAttachment(this.attachment):void 0):void 0},c.prototype.uninstall=function(){for(var t,e;e=this.undos.pop();)e();return null!=(t=this.delegate)?t.didUninstallAttachmentEditor(this):void 0},c}(e.BasicObject)}.call(this),function(){var t,n,o,i,r=function(t,e){function n(){this.constructor=t}for(var o in e)s.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;o=e.makeElement,i=e.selectionElements,t=e.config.css.classNames,e.AttachmentView=function(e){function s(){s.__super__.constructor.apply(this,arguments),this.attachment=this.object,this.attachment.uploadProgressDelegate=this,this.attachmentPiece=this.options.piece}return r(s,e),s.attachmentSelector=\"[data-trix-attachment]\",s.prototype.createContentNodes=function(){return[]},s.prototype.createNodes=function(){var e,n,r,s,a,u,c,l,h,p,d;if(s=o({tagName:\"figure\",className:this.getClassName()}),this.attachment.hasContent())s.innerHTML=this.attachment.getContent();else for(p=this.createContentNodes(),u=0,l=p.length;l>u;u++)h=p[u],s.appendChild(h);s.appendChild(this.createCaptionElement()),n={trixAttachment:JSON.stringify(this.attachment),trixContentType:this.attachment.getContentType(),trixId:this.attachment.id},e=this.attachmentPiece.getAttributesForAttachment(),e.isEmpty()||(n.trixAttributes=JSON.stringify(e)),this.attachment.isPending()&&(this.progressElement=o({tagName:\"progress\",attributes:{\"class\":t.attachment.progressBar,value:this.attachment.getUploadProgress(),max:100},data:{trixMutable:!0,trixStoreKey:[\"progressElement\",this.attachment.id].join(\"/\")}}),s.appendChild(this.progressElement),n.trixSerialize=!1),(a=this.getHref())?(r=o(\"a\",{href:a}),r.appendChild(s)):r=s;for(c in n)d=n[c],r.dataset[c]=d;return r.setAttribute(\"contenteditable\",!1),[i.create(\"cursorTarget\"),r,i.create(\"cursorTarget\")]},s.prototype.createCaptionElement=function(){var e,n,i,r,s;return n=o({tagName:\"figcaption\",className:t.attachment.caption}),(e=this.attachmentPiece.getCaption())?(n.classList.add(t.attachment.captionEdited),n.textContent=e):(i=this.attachment.getFilename())&&(n.textContent=i,(r=this.attachment.getFormattedFilesize())&&(n.appendChild(document.createTextNode(\" \")),s=o({tagName:\"span\",className:t.attachment.size,textContent:r}),n.appendChild(s))),n},s.prototype.getClassName=function(){var e,n;return n=[t.attachment.container,\"\"+t.attachment.typePrefix+this.attachment.getType()],(e=this.attachment.getExtension())&&n.push(e),n.join(\" \")},s.prototype.getHref=function(){return n(this.attachment.getContent(),\"a\")?void 0:this.attachment.getHref()},s.prototype.findProgressElement=function(){var t;return null!=(t=this.findElement())?t.querySelector(\"progress\"):void 0},s.prototype.attachmentDidChangeUploadProgress=function(){var t,e;return e=this.attachment.getUploadProgress(),null!=(t=this.findProgressElement())?t.value=e:void 0},s}(e.ObjectView),n=function(t,e){var n;return n=o(\"div\"),n.innerHTML=null!=t?t:\"\",n.querySelector(e)}}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;t=e.makeElement,e.PreviewableAttachmentView=function(e){function o(){o.__super__.constructor.apply(this,arguments),this.attachment.previewDelegate=this}return n(o,e),o.prototype.createContentNodes=function(){return this.image=t({tagName:\"img\",attributes:{src:\"\"},data:{trixMutable:!0}}),this.refresh(this.image),[this.image]},o.prototype.refresh=function(t){var e;return null==t&&(t=null!=(e=this.findElement())?e.querySelector(\"img\"):void 0),t?this.updateAttributesForImage(t):void 0},o.prototype.updateAttributesForImage=function(t){var e,n,o,i,r,s;return r=this.attachment.getURL(),n=this.attachment.getPreviewURL(),t.src=n||r,n===r?t.removeAttribute(\"data-trix-serialized-attributes\"):(o=JSON.stringify({src:r}),t.setAttribute(\"data-trix-serialized-attributes\",o)),s=this.attachment.getWidth(),e=this.attachment.getHeight(),null!=s&&(t.width=s),null!=e&&(t.height=e),i=[\"imageElement\",this.attachment.id,t.src,t.width,t.height].join(\"/\"),t.dataset.trixStoreKey=i},o.prototype.attachmentDidChangePreviewURL=function(){return this.refresh(this.image),this.refresh()},o}(e.AttachmentView)}.call(this),function(){var t,n,o,i=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;o=e.makeElement,t=e.findInnerElement,n=e.getTextConfig,e.PieceView=function(r){function s(){var t;s.__super__.constructor.apply(this,arguments),this.piece=this.object,this.attributes=this.piece.getAttributes(),t=this.options,this.textConfig=t.textConfig,this.context=t.context,this.piece.attachment?this.attachment=this.piece.attachment:this.string=this.piece.toString()}var a;return i(s,r),s.prototype.createNodes=function(){var e,n,o,i,r,s;if(s=this.attachment?this.createAttachmentNodes():this.createStringNodes(),e=this.createElement()){for(o=t(e),n=0,i=s.length;i>n;n++)r=s[n],o.appendChild(r);s=[e]}return s},s.prototype.createAttachmentNodes=function(){var t,n;return t=this.attachment.isPreviewable()?e.PreviewableAttachmentView:e.AttachmentView,n=this.createChildView(t,this.piece.attachment,{piece:this.piece}),n.getNodes()},s.prototype.createStringNodes=function(){var t,e,n,i,r,s,a,u,c,l;if(null!=(u=this.textConfig)?u.plaintext:void 0)return[document.createTextNode(this.string)];for(a=[],c=this.string.split(\"\\n\"),n=e=0,i=c.length;i>e;n=++e)l=c[n],n>0&&(t=o(\"br\"),a.push(t)),(r=l.length)&&(s=document.createTextNode(this.preserveSpaces(l)),a.push(s));return a},s.prototype.createElement=function(){var t,e,i,r,s,a,u,c;for(r in this.attributes)if((t=n(r))&&(t.tagName&&(s=o(t.tagName),i?(i.appendChild(s),i=s):e=i=s),t.style))if(u){a=t.style;for(r in a)c=a[r],u[r]=c}else u=t.style;if(u){null==e&&(e=o(\"span\"));for(r in u)c=u[r],e.style[r]=c}return e},s.prototype.createContainerElement=function(){var t,e,i,r,s;r=this.attributes;for(i in r)if(s=r[i],(e=n(i))&&e.groupTagName)return t={},t[i]=s,o(e.groupTagName,t)},a=e.NON_BREAKING_SPACE,s.prototype.preserveSpaces=function(t){return this.context.isLast&&(t=t.replace(/\\ $/,a)),t=t.replace(/(\\S)\\ {3}(\\S)/g,\"$1 \"+a+\" $2\").replace(/\\ {2}/g,a+\" \").replace(/\\ {2}/g,\" \"+a),(this.context.isFirst||this.context.followsWhitespace)&&(t=t.replace(/^\\ /,a)),t},s}(e.ObjectView)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.TextView=function(n){function o(){o.__super__.constructor.apply(this,arguments),this.text=this.object,this.textConfig=this.options.textConfig}var i;return t(o,n),o.prototype.createNodes=function(){var t,n,o,r,s,a,u,c,l,h;for(a=[],c=e.ObjectGroup.groupObjects(this.getPieces()),r=c.length-1,o=n=0,s=c.length;s>n;o=++n)u=c[o],t={},0===o&&(t.isFirst=!0),o===r&&(t.isLast=!0),i(l)&&(t.followsWhitespace=!0),h=this.findOrCreateCachedChildView(e.PieceView,u,{textConfig:this.textConfig,context:t}),a.push.apply(a,h.getNodes()),l=u;return a},o.prototype.getPieces=function(){var t,e,n,o,i;for(o=this.text.getPieces(),i=[],t=0,e=o.length;e>t;t++)n=o[t],n.hasAttribute(\"blockBreak\")||i.push(n);return i},i=function(t){return/\\s$/.test(null!=t?t.toString():void 0)},o}(e.ObjectView)}.call(this),function(){var t,n,o=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;n=e.makeElement,t=e.getBlockConfig,e.BlockView=function(i){function r(){r.__super__.constructor.apply(this,arguments),this.block=this.object,this.attributes=this.block.getAttributes()}return o(r,i),r.prototype.createNodes=function(){var o,i,r,s,a,u,c,l,h;if(o=document.createComment(\"block\"),u=[o],this.block.isEmpty()?u.push(n(\"br\")):(l=null!=(c=t(this.block.getLastAttribute()))?c.text:void 0,h=this.findOrCreateCachedChildView(e.TextView,this.block.text,{textConfig:l}),u.push.apply(u,h.getNodes()),this.shouldAddExtraNewlineElement()&&u.push(n(\"br\"))),this.attributes.length)return u;for(i=n(e.config.blockAttributes[\"default\"].tagName),r=0,s=u.length;s>r;r++)a=u[r],i.appendChild(a);return[i]},r.prototype.createContainerElement=function(e){var o,i;return o=this.attributes[e],i=t(o),n(i.tagName)},r.prototype.shouldAddExtraNewlineElement=function(){return/\\n\\n$/.test(this.block.toString())},r}(e.ObjectView)}.call(this),function(){var t,n,o=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;t=e.defer,n=e.makeElement,e.DocumentView=function(i){function r(){r.__super__.constructor.apply(this,arguments),this.element=this.options.element,this.elementStore=new e.ElementStore,this.setDocument(this.object)}var s,a,u;return o(r,i),r.render=function(t){var e,o;return e=n(\"div\"),o=new this(t,{element:e}),o.render(),o.sync(),e},r.prototype.setDocument=function(t){return t.isEqualTo(this.document)?void 0:this.document=this.object=t},r.prototype.render=function(){var t,o,i,r,s,a,u;if(this.childViews=[],this.shadowElement=n(\"div\"),!this.document.isEmpty()){for(s=e.ObjectGroup.groupObjects(this.document.getBlocks(),{asTree:!0}),a=[],t=0,o=s.length;o>t;t++)r=s[t],u=this.findOrCreateCachedChildView(e.BlockView,r),a.push(function(){var t,e,n,o;for(n=u.getNodes(),o=[],t=0,e=n.length;e>t;t++)i=n[t],o.push(this.shadowElement.appendChild(i));return o}.call(this));return a}},r.prototype.isSynced=function(){return s(this.shadowElement,this.element)},r.prototype.sync=function(){var t;for(t=this.createDocumentFragmentForSync();this.element.lastChild;)this.element.removeChild(this.element.lastChild);return this.element.appendChild(t),this.didSync()},r.prototype.didSync=function(){return this.elementStore.reset(a(this.element)),t(function(t){return function(){return t.garbageCollectCachedViews()}}(this))},r.prototype.createDocumentFragmentForSync=function(){var t,e,n,o,i,r,s,u,c,l;for(e=document.createDocumentFragment(),u=this.shadowElement.childNodes,n=0,i=u.length;i>n;n++)s=u[n],e.appendChild(s.cloneNode(!0));for(c=a(e),o=0,r=c.length;r>o;o++)t=c[o],(l=this.elementStore.remove(t))&&t.parentNode.replaceChild(l,t);return e},a=function(t){return t.querySelectorAll(\"[data-trix-store-key]\")},s=function(t,e){return u(t.innerHTML)===u(e.innerHTML)},u=function(t){return t.replace(/&nbsp;/g,\" \")},r}(e.ObjectView)}.call(this),function(){var t,n,o,i,r=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function n(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=e.handleEvent,i=e.innerElementIsActive,n=e.defer,t=e.AttachmentView.attachmentSelector,e.CompositionController=function(a){function u(n,i){this.element=n,this.composition=i,this.didClickAttachment=r(this.didClickAttachment,this),this.didBlur=r(this.didBlur,this),this.didFocus=r(this.didFocus,this),this.documentView=new e.DocumentView(this.composition.document,{element:this.element}),o(\"focus\",{onElement:this.element,withCallback:this.didFocus}),o(\"blur\",{onElement:this.element,withCallback:this.didBlur}),o(\"click\",{onElement:this.element,matchingSelector:\"a[contenteditable=false]\",preventDefault:!0}),o(\"mousedown\",{onElement:this.element,matchingSelector:t,withCallback:this.didClickAttachment}),o(\"click\",{onElement:this.element,matchingSelector:\"a\"+t,preventDefault:!0})}return s(u,a),u.prototype.didFocus=function(){var t,e,n;return t=function(t){return function(){var e;return t.focused?void 0:(t.focused=!0,null!=(e=t.delegate)&&\"function\"==typeof e.compositionControllerDidFocus?e.compositionControllerDidFocus():void 0)}}(this),null!=(e=null!=(n=this.blurPromise)?n.then(t):void 0)?e:t()},u.prototype.didBlur=function(){return this.blurPromise=new Promise(function(t){return function(e){return n(function(){var n;return i(t.element)||(t.focused=null,null!=(n=t.delegate)&&\"function\"==typeof n.compositionControllerDidBlur&&n.compositionControllerDidBlur()),t.blurPromise=null,e()})}}(this))},u.prototype.didClickAttachment=function(t,e){var n,o;return n=this.findAttachmentForElement(e),null!=(o=this.delegate)&&\"function\"==typeof o.compositionControllerDidSelectAttachment?o.compositionControllerDidSelectAttachment(n):void 0},u.prototype.render=function(){var t,e,n;return this.revision!==this.composition.revision&&(this.documentView.setDocument(this.composition.document),this.documentView.render(),this.revision=this.composition.revision),this.documentView.isSynced()||(null!=(t=this.delegate)&&\"function\"==typeof t.compositionControllerWillSyncDocumentView&&t.compositionControllerWillSyncDocumentView(),this.documentView.sync(),this.reinstallAttachmentEditor(),null!=(e=this.delegate)&&\"function\"==typeof e.compositionControllerDidSyncDocumentView&&e.compositionControllerDidSyncDocumentView()),null!=(n=this.delegate)&&\"function\"==typeof n.compositionControllerDidRender?n.compositionControllerDidRender():void 0},u.prototype.rerenderViewForObject=function(t){return this.invalidateViewForObject(t),this.render()},u.prototype.invalidateViewForObject=function(t){return this.documentView.invalidateViewForObject(t)},u.prototype.isViewCachingEnabled=function(){return this.documentView.isViewCachingEnabled()},u.prototype.enableViewCaching=function(){return this.documentView.enableViewCaching()},u.prototype.disableViewCaching=function(){return this.documentView.disableViewCaching()},u.prototype.refreshViewCache=function(){return this.documentView.garbageCollectCachedViews()},u.prototype.installAttachmentEditorForAttachment=function(t){var n,o,i;if((null!=(i=this.attachmentEditor)?i.attachment:void 0)!==t&&(o=this.documentView.findElementForObject(t)))return this.uninstallAttachmentEditor(),n=this.composition.document.getAttachmentPieceForAttachment(t),this.attachmentEditor=new e.AttachmentEditorController(n,o,this.element),this.attachmentEditor.delegate=this},u.prototype.uninstallAttachmentEditor=function(){var t;return null!=(t=this.attachmentEditor)?t.uninstall():void 0},u.prototype.reinstallAttachmentEditor=function(){var t;return this.attachmentEditor?(t=this.attachmentEditor.attachment,this.uninstallAttachmentEditor(),this.installAttachmentEditorForAttachment(t)):void 0},u.prototype.editAttachmentCaption=function(){var t;return null!=(t=this.attachmentEditor)?t.editCaption():void 0},u.prototype.didUninstallAttachmentEditor=function(){return this.attachmentEditor=null,this.render()},u.prototype.attachmentEditorDidRequestUpdatingAttributesForAttachment=function(t,e){var n;return null!=(n=this.delegate)&&\"function\"==typeof n.compositionControllerWillUpdateAttachment&&n.compositionControllerWillUpdateAttachment(e),this.composition.updateAttributesForAttachment(t,e)},u.prototype.attachmentEditorDidRequestRemovingAttributeForAttachment=function(t,e){var n;return null!=(n=this.delegate)&&\"function\"==typeof n.compositionControllerWillUpdateAttachment&&n.compositionControllerWillUpdateAttachment(e),this.composition.removeAttributeForAttachment(t,e)},u.prototype.attachmentEditorDidRequestRemovalOfAttachment=function(t){var e;return null!=(e=this.delegate)&&\"function\"==typeof e.compositionControllerDidRequestRemovalOfAttachment?e.compositionControllerDidRequestRemovalOfAttachment(t):void 0},u.prototype.attachmentEditorDidRequestDeselectingAttachment=function(t){var e;return null!=(e=this.delegate)&&\"function\"==typeof e.compositionControllerDidRequestDeselectingAttachment?e.compositionControllerDidRequestDeselectingAttachment(t):void 0},u.prototype.findAttachmentForElement=function(t){return this.composition.document.getAttachmentById(parseInt(t.dataset.trixId,10))},u}(e.BasicObject)}.call(this),function(){var t,n,o,i=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function n(){this.constructor=t}for(var o in e)s.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=e.handleEvent,o=e.triggerEvent,t=e.findClosestElementFromNode,e.ToolbarController=function(e){function s(t){this.element=t,this.didKeyDownDialogInput=i(this.didKeyDownDialogInput,this),this.didClickDialogButton=i(this.didClickDialogButton,this),this.didClickAttributeButton=i(this.didClickAttributeButton,this),this.didClickActionButton=i(this.didClickActionButton,this),this.attributes={},this.actions={},this.resetDialogInputs(),n(\"mousedown\",{onElement:this.element,matchingSelector:a,withCallback:this.didClickActionButton}),n(\"mousedown\",{onElement:this.element,matchingSelector:c,withCallback:this.didClickAttributeButton}),n(\"click\",{onElement:this.element,matchingSelector:y,preventDefault:!0}),n(\"click\",{onElement:this.element,matchingSelector:l,withCallback:this.didClickDialogButton}),n(\"keydown\",{onElement:this.element,matchingSelector:h,withCallback:this.didKeyDownDialogInput})}var a,u,c,l,h,p,d,f,g,m,y;return r(s,e),a=\"button[data-trix-action]\",c=\"button[data-trix-attribute]\",y=[a,c].join(\", \"),p=\".dialog[data-trix-dialog]\",u=p+\".active\",l=p+\" input[data-trix-method]\",h=p+\" input[type=text], \"+p+\" input[type=url]\",s.prototype.didClickActionButton=function(t,e){var n,o,i;return null!=(o=this.delegate)&&o.toolbarDidClickButton(),t.preventDefault(),n=d(e),this.getDialog(n)?this.toggleDialog(n):null!=(i=this.delegate)?i.toolbarDidInvokeAction(n):void 0},s.prototype.didClickAttributeButton=function(t,e){var n,o,i;return null!=(o=this.delegate)&&o.toolbarDidClickButton(),t.preventDefault(),n=f(e),this.getDialog(n)?this.toggleDialog(n):null!=(i=this.delegate)&&i.toolbarDidToggleAttribute(n),this.refreshAttributeButtons()},s.prototype.didClickDialogButton=function(e,n){var o,i;return o=t(n,{matchingSelector:p}),i=n.getAttribute(\"data-trix-method\"),this[i].call(this,o)},s.prototype.didKeyDownDialogInput=function(t,e){var n,o;return 13===t.keyCode&&(t.preventDefault(),n=e.getAttribute(\"name\"),o=this.getDialog(n),this.setAttribute(o)),27===t.keyCode?(t.preventDefault(),this.hideDialog()):void 0},s.prototype.updateActions=function(t){return this.actions=t,this.refreshActionButtons()},s.prototype.refreshActionButtons=function(){return this.eachActionButton(function(t){return function(e,n){return e.disabled=t.actions[n]===!1}}(this))},s.prototype.eachActionButton=function(t){var e,n,o,i,r;for(i=this.element.querySelectorAll(a),r=[],n=0,o=i.length;o>n;n++)e=i[n],r.push(t(e,d(e)));return r},s.prototype.updateAttributes=function(t){return this.attributes=t,this.refreshAttributeButtons()},s.prototype.refreshAttributeButtons=function(){return this.eachAttributeButton(function(t){return function(e,n){return e.disabled=t.attributes[n]===!1,t.attributes[n]||t.dialogIsVisible(n)?e.classList.add(\"active\"):e.classList.remove(\"active\")}}(this))},s.prototype.eachAttributeButton=function(t){var e,n,o,i,r;for(i=this.element.querySelectorAll(c),r=[],n=0,o=i.length;o>n;n++)e=i[n],r.push(t(e,f(e)));return r},s.prototype.applyKeyboardCommand=function(t){var e,n,i,r,s,a,u;for(s=JSON.stringify(t.sort()),u=this.element.querySelectorAll(\"[data-trix-key]\"),r=0,a=u.length;a>r;r++)if(e=u[r],i=e.getAttribute(\"data-trix-key\").split(\"+\"),n=JSON.stringify(i.sort()),n===s)return o(\"mousedown\",{onElement:e}),!0;return!1},s.prototype.dialogIsVisible=function(t){var e;return(e=this.getDialog(t))?e.classList.contains(\"active\"):void 0},s.prototype.toggleDialog=function(t){return this.dialogIsVisible(t)?this.hideDialog():this.showDialog(t)},s.prototype.showDialog=function(t){var e,n,o,i,r,s,a,u,c,l;for(this.hideDialog(),null!=(a=this.delegate)&&a.toolbarWillShowDialog(),o=this.getDialog(t),o.classList.add(\"active\"),u=o.querySelectorAll(\"input[disabled]\"),i=0,s=u.length;s>i;i++)n=u[i],n.removeAttribute(\"disabled\");return(e=f(o))&&(r=m(o,t))&&(r.value=null!=(c=this.attributes[e])?c:\"http://\",r.select()),null!=(l=this.delegate)?l.toolbarDidShowDialog(t):void 0},s.prototype.setAttribute=function(t){var e,n,o;return e=f(t),n=m(t,e),n.willValidate&&!n.checkValidity()?(n.classList.add(\"validate\"),n.focus()):(null!=(o=this.delegate)&&o.toolbarDidUpdateAttribute(e,n.value),this.hideDialog())},s.prototype.removeAttribute=function(t){var e,n;return e=f(t),null!=(n=this.delegate)&&n.toolbarDidRemoveAttribute(e),this.hideDialog()},s.prototype.hideDialog=function(){var t,e;return(t=this.element.querySelector(u))?(t.classList.remove(\"active\"),this.resetDialogInputs(),null!=(e=this.delegate)?e.toolbarDidHideDialog(g(t)):void 0):void 0},s.prototype.resetDialogInputs=function(){var t,e,n,o,i;for(o=this.element.querySelectorAll(h),i=[],t=0,n=o.length;n>t;t++)e=o[t],e.setAttribute(\"disabled\",\"disabled\"),i.push(e.classList.remove(\"validate\"));return i},s.prototype.getDialog=function(t){return this.element.querySelector(\".dialog[data-trix-dialog=\"+t+\"]\")},m=function(t,e){return null==e&&(e=f(t)),t.querySelector(\"input[name='\"+e+\"']\")},d=function(t){return t.getAttribute(\"data-trix-action\")},f=function(t){return t.getAttribute(\"data-trix-attribute\")},g=function(t){return t.getAttribute(\"data-trix-dialog\")},s}(e.BasicObject)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.ImagePreloadOperation=function(e){function n(t){this.url=t}return t(n,e),n.prototype.perform=function(t){var e;return e=new Image,e.onload=function(n){return function(){return e.width=n.width=e.naturalWidth,e.height=n.height=e.naturalHeight,t(!0,e)}}(this),e.onerror=function(){return t(!1)},e.src=this.url},n}(e.Operation)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;e.Attachment=function(o){function i(n){null==n&&(n={}),this.releaseFile=t(this.releaseFile,this),i.__super__.constructor.apply(this,arguments),this.attributes=e.Hash.box(n),this.didChangeAttributes()}return n(i,o),i.previewablePattern=/^image(\\/(gif|png|jpe?g)|$)/,i.attachmentForFile=function(t){var e,n;return n=this.attributesForFile(t),e=new this(n),e.setFile(t),e},i.attributesForFile=function(t){return new e.Hash({filename:t.name,filesize:t.size,contentType:t.type})},i.fromJSON=function(t){return new this(t)},i.prototype.getAttribute=function(t){return this.attributes.get(t)},i.prototype.hasAttribute=function(t){return this.attributes.has(t)},i.prototype.getAttributes=function(){return this.attributes.toObject()},i.prototype.setAttributes=function(t){var e,n;return null==t&&(t={}),e=this.attributes.merge(t),this.attributes.isEqualTo(e)?void 0:(this.attributes=e,this.didChangeAttributes(),null!=(n=this.delegate)&&\"function\"==typeof n.attachmentDidChangeAttributes?n.attachmentDidChangeAttributes(this):void 0)},i.prototype.didChangeAttributes=function(){return this.isPreviewable()?this.preloadURL():void 0},i.prototype.isPending=function(){return null!=this.file&&!(this.getURL()||this.getHref())},i.prototype.isPreviewable=function(){return this.attributes.has(\"previewable\")?this.attributes.get(\"previewable\"):this.constructor.previewablePattern.test(this.getContentType())},i.prototype.getType=function(){return this.hasContent()?\"content\":this.isPreviewable()?\"preview\":\"file\"},i.prototype.getURL=function(){return this.attributes.get(\"url\")},i.prototype.getHref=function(){return this.attributes.get(\"href\")},i.prototype.getFilename=function(){var t;return null!=(t=this.attributes.get(\"filename\"))?t:\"\"},i.prototype.getFilesize=function(){return this.attributes.get(\"filesize\")},i.prototype.getFormattedFilesize=function(){var t;return t=this.attributes.get(\"filesize\"),\"number\"==typeof t?e.config.fileSize.formatter(t):\"\"},i.prototype.getExtension=function(){var t;return null!=(t=this.getFilename().match(/\\.(\\w+)$/))?t[1].toLowerCase():void 0},i.prototype.getContentType=function(){return this.attributes.get(\"contentType\")},i.prototype.hasContent=function(){return this.attributes.has(\"content\")},i.prototype.getContent=function(){return this.attributes.get(\"content\")},i.prototype.getWidth=function(){return this.attributes.get(\"width\")},i.prototype.getHeight=function(){return this.attributes.get(\"height\")},i.prototype.getFile=function(){return this.file},i.prototype.setFile=function(t){return this.file=t,this.isPreviewable()?this.preloadFile():void 0},i.prototype.releaseFile=function(){return this.releasePreloadedFile(),this.file=null},i.prototype.getUploadProgress=function(){var t;return null!=(t=this.uploadProgress)?t:0},i.prototype.setUploadProgress=function(t){var e;return this.uploadProgress!==t?(this.uploadProgress=t,null!=(e=this.uploadProgressDelegate)&&\"function\"==typeof e.attachmentDidChangeUploadProgress?e.attachmentDidChangeUploadProgress(this):void 0):void 0},i.prototype.toJSON=function(){return this.getAttributes()},i.prototype.getCacheKey=function(){return[i.__super__.getCacheKey.apply(this,arguments),this.attributes.getCacheKey(),this.getPreviewURL()].join(\"/\")},i.prototype.getPreviewURL=function(){return this.previewURL||this.preloadingURL},i.prototype.setPreviewURL=function(t){var e,n;return t!==this.getPreviewURL()?(this.previewURL=t,null!=(e=this.previewDelegate)&&\"function\"==typeof e.attachmentDidChangePreviewURL&&e.attachmentDidChangePreviewURL(this),null!=(n=this.delegate)&&\"function\"==typeof n.attachmentDidChangePreviewURL?n.attachmentDidChangePreviewURL(this):void 0):void 0},i.prototype.preloadURL=function(){return this.preload(this.getURL(),this.releaseFile)},i.prototype.preloadFile=function(){return this.file?(this.fileObjectURL=URL.createObjectURL(this.file),this.preload(this.fileObjectURL)):void 0},i.prototype.releasePreloadedFile=function(){return this.fileObjectURL?(URL.revokeObjectURL(this.fileObjectURL),this.fileObjectURL=null):void 0},i.prototype.preload=function(t,n){var o;return t&&t!==this.getPreviewURL()?(this.preloadingURL=t,o=new e.ImagePreloadOperation(t),o.then(function(e){return function(o){var i,r;return r=o.width,i=o.height,e.setAttributes({width:r,height:i}),e.preloadingURL=null,e.setPreviewURL(t),\"function\"==typeof n?n():void 0}}(this))):void 0},i}(e.Object)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.Piece=function(n){function o(t,n){null==n&&(n={}),o.__super__.constructor.apply(this,arguments),this.attributes=e.Hash.box(n)}return t(o,n),o.types={},o.registerType=function(t,e){return e.type=t,this.types[t]=e},o.fromJSON=function(t){var e;return(e=this.types[t.type])?e.fromJSON(t):void 0},o.prototype.copyWithAttributes=function(t){return new this.constructor(this.getValue(),t)},o.prototype.copyWithAdditionalAttributes=function(t){return this.copyWithAttributes(this.attributes.merge(t))},o.prototype.copyWithoutAttribute=function(t){return this.copyWithAttributes(this.attributes.remove(t))},o.prototype.copy=function(){return this.copyWithAttributes(this.attributes)},o.prototype.getAttribute=function(t){return this.attributes.get(t)},o.prototype.getAttributesHash=function(){return this.attributes},o.prototype.getAttributes=function(){return this.attributes.toObject()},o.prototype.getCommonAttributes=function(){var t,e,n;return(n=pieceList.getPieceAtIndex(0))?(t=n.attributes,e=t.getKeys(),pieceList.eachPiece(function(n){return e=t.getKeysCommonToHash(n.attributes),t=t.slice(e)}),t.toObject()):{}},o.prototype.hasAttribute=function(t){return this.attributes.has(t)},o.prototype.hasSameStringValueAsPiece=function(t){return null!=t&&this.toString()===t.toString()\n},o.prototype.hasSameAttributesAsPiece=function(t){return null!=t&&(this.attributes===t.attributes||this.attributes.isEqualTo(t.attributes))},o.prototype.isBlockBreak=function(){return!1},o.prototype.isEqualTo=function(t){return o.__super__.isEqualTo.apply(this,arguments)||this.hasSameConstructorAs(t)&&this.hasSameStringValueAsPiece(t)&&this.hasSameAttributesAsPiece(t)},o.prototype.isEmpty=function(){return 0===this.length},o.prototype.isSerializable=function(){return!0},o.prototype.toJSON=function(){return{type:this.constructor.type,attributes:this.getAttributes()}},o.prototype.contentsForInspection=function(){return{type:this.constructor.type,attributes:this.attributes.inspect()}},o.prototype.canBeGrouped=function(){return this.hasAttribute(\"href\")},o.prototype.canBeGroupedWith=function(t){return this.getAttribute(\"href\")===t.getAttribute(\"href\")},o.prototype.getLength=function(){return this.length},o.prototype.canBeConsolidatedWith=function(){return!1},o}(e.Object)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.Piece.registerType(\"attachment\",e.AttachmentPiece=function(n){function o(t){this.attachment=t,o.__super__.constructor.apply(this,arguments),this.length=1,this.ensureAttachmentExclusivelyHasAttribute(\"href\")}return t(o,n),o.fromJSON=function(t){return new this(e.Attachment.fromJSON(t.attachment),t.attributes)},o.prototype.ensureAttachmentExclusivelyHasAttribute=function(t){return this.hasAttribute(t)&&this.attachment.hasAttribute(t)?this.attributes=this.attributes.remove(t):void 0},o.prototype.getValue=function(){return this.attachment},o.prototype.isSerializable=function(){return!this.attachment.isPending()},o.prototype.getCaption=function(){var t;return null!=(t=this.attributes.get(\"caption\"))?t:\"\"},o.prototype.getAttributesForAttachment=function(){return this.attributes.slice([\"caption\"])},o.prototype.canBeGrouped=function(){return o.__super__.canBeGrouped.apply(this,arguments)&&!this.attachment.hasAttribute(\"href\")},o.prototype.isEqualTo=function(t){var e;return o.__super__.isEqualTo.apply(this,arguments)&&this.attachment.id===(null!=t&&null!=(e=t.attachment)?e.id:void 0)},o.prototype.toString=function(){return e.OBJECT_REPLACEMENT_CHARACTER},o.prototype.toJSON=function(){var t;return t=o.__super__.toJSON.apply(this,arguments),t.attachment=this.attachment,t},o.prototype.getCacheKey=function(){return[o.__super__.getCacheKey.apply(this,arguments),this.attachment.getCacheKey()].join(\"/\")},o.prototype.toConsole=function(){return JSON.stringify(this.toString())},o}(e.Piece))}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.Piece.registerType(\"string\",e.StringPiece=function(e){function n(t){n.__super__.constructor.apply(this,arguments),this.string=t,this.length=this.string.length}return t(n,e),n.fromJSON=function(t){return new this(t.string,t.attributes)},n.prototype.getValue=function(){return this.string},n.prototype.toString=function(){return this.string.toString()},n.prototype.isBlockBreak=function(){return\"\\n\"===this.toString()&&this.getAttribute(\"blockBreak\")===!0},n.prototype.toJSON=function(){var t;return t=n.__super__.toJSON.apply(this,arguments),t.string=this.string,t},n.prototype.canBeConsolidatedWith=function(t){return null!=t&&this.hasSameConstructorAs(t)&&this.hasSameAttributesAsPiece(t)},n.prototype.consolidateWith=function(t){return new this.constructor(this.toString()+t.toString(),this.attributes)},n.prototype.splitAtOffset=function(t){var e,n;return 0===t?(e=null,n=this):t===this.length?(e=this,n=null):(e=new this.constructor(this.string.slice(0,t),this.attributes),n=new this.constructor(this.string.slice(t),this.attributes)),[e,n]},n.prototype.toConsole=function(){var t;return t=this.string,t.length>15&&(t=t.slice(0,14)+\"\\u2026\"),JSON.stringify(t.toString())},n}(e.Piece))}.call(this),function(){var t,n=function(t,e){function n(){this.constructor=t}for(var i in e)o.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty,i=[].slice;t=e.spliceArray,e.SplittableList=function(e){function o(t){null==t&&(t=[]),o.__super__.constructor.apply(this,arguments),this.objects=t.slice(0),this.length=this.objects.length}var r,s,a;return n(o,e),o.box=function(t){return t instanceof this?t:new this(t)},o.prototype.indexOf=function(t){return this.objects.indexOf(t)},o.prototype.splice=function(){var e;return e=1<=arguments.length?i.call(arguments,0):[],new this.constructor(t.apply(null,[this.objects].concat(i.call(e))))},o.prototype.eachObject=function(t){var e,n,o,i,r,s;for(r=this.objects,s=[],n=e=0,o=r.length;o>e;n=++e)i=r[n],s.push(t(i,n));return s},o.prototype.insertObjectAtIndex=function(t,e){return this.splice(e,0,t)},o.prototype.insertSplittableListAtIndex=function(t,e){return this.splice.apply(this,[e,0].concat(i.call(t.objects)))},o.prototype.insertSplittableListAtPosition=function(t,e){var n,o,i;return i=this.splitObjectAtPosition(e),o=i[0],n=i[1],new this.constructor(o).insertSplittableListAtIndex(t,n)},o.prototype.editObjectAtIndex=function(t,e){return this.replaceObjectAtIndex(e(this.objects[t]),t)},o.prototype.replaceObjectAtIndex=function(t,e){return this.splice(e,1,t)},o.prototype.removeObjectAtIndex=function(t){return this.splice(t,1)},o.prototype.getObjectAtIndex=function(t){return this.objects[t]},o.prototype.getSplittableListInRange=function(t){var e,n,o,i;return o=this.splitObjectsAtRange(t),n=o[0],e=o[1],i=o[2],new this.constructor(n.slice(e,i+1))},o.prototype.selectSplittableList=function(t){var e,n;return n=function(){var n,o,i,r;for(i=this.objects,r=[],n=0,o=i.length;o>n;n++)e=i[n],t(e)&&r.push(e);return r}.call(this),new this.constructor(n)},o.prototype.removeObjectsInRange=function(t){var e,n,o,i;return o=this.splitObjectsAtRange(t),n=o[0],e=o[1],i=o[2],new this.constructor(n).splice(e,i-e+1)},o.prototype.transformObjectsInRange=function(t,e){var n,o,i,r,s,a,u;return s=this.splitObjectsAtRange(t),r=s[0],o=s[1],a=s[2],u=function(){var t,s,u;for(u=[],n=t=0,s=r.length;s>t;n=++t)i=r[n],u.push(n>=o&&a>=n?e(i):i);return u}(),new this.constructor(u)},o.prototype.splitObjectsAtRange=function(t){var e,n,o,i,s,u;return i=this.splitObjectAtPosition(a(t)),n=i[0],e=i[1],o=i[2],s=new this.constructor(n).splitObjectAtPosition(r(t)+o),n=s[0],u=s[1],[n,e,u-1]},o.prototype.getObjectAtPosition=function(t){var e,n,o;return o=this.findIndexAndOffsetAtPosition(t),e=o.index,n=o.offset,this.objects[e]},o.prototype.splitObjectAtPosition=function(t){var e,n,o,i,r,s,a,u,c,l;return s=this.findIndexAndOffsetAtPosition(t),e=s.index,r=s.offset,i=this.objects.slice(0),null!=e?0===r?(c=e,l=0):(o=this.getObjectAtIndex(e),a=o.splitAtOffset(r),n=a[0],u=a[1],i.splice(e,1,n,u),c=e+1,l=n.getLength()-r):(c=i.length,l=0),[i,c,l]},o.prototype.consolidate=function(){var t,e,n,o,i,r;for(o=[],i=this.objects[0],r=this.objects.slice(1),t=0,e=r.length;e>t;t++)n=r[t],(\"function\"==typeof i.canBeConsolidatedWith?i.canBeConsolidatedWith(n):void 0)?i=i.consolidateWith(n):(o.push(i),i=n);return null!=i&&o.push(i),new this.constructor(o)},o.prototype.consolidateFromIndexToIndex=function(t,e){var n,o,r;return o=this.objects.slice(0),r=o.slice(t,e+1),n=new this.constructor(r).consolidate().toArray(),this.splice.apply(this,[t,r.length].concat(i.call(n)))},o.prototype.findIndexAndOffsetAtPosition=function(t){var e,n,o,i,r,s,a;for(e=0,a=this.objects,o=n=0,i=a.length;i>n;o=++n){if(s=a[o],r=e+s.getLength(),t>=e&&r>t)return{index:o,offset:t-e};e=r}return{index:null,offset:null}},o.prototype.findPositionAtIndexAndOffset=function(t,e){var n,o,i,r,s,a;for(s=0,a=this.objects,n=o=0,i=a.length;i>o;n=++o)if(r=a[n],t>n)s+=r.getLength();else if(n===t){s+=e;break}return s},o.prototype.getEndPosition=function(){var t,e;return null!=this.endPosition?this.endPosition:this.endPosition=function(){var n,o,i;for(e=0,i=this.objects,n=0,o=i.length;o>n;n++)t=i[n],e+=t.getLength();return e}.call(this)},o.prototype.toString=function(){return this.objects.join(\"\")},o.prototype.toArray=function(){return this.objects.slice(0)},o.prototype.toJSON=function(){return this.toArray()},o.prototype.isEqualTo=function(t){return o.__super__.isEqualTo.apply(this,arguments)||s(this.objects,null!=t?t.objects:void 0)},s=function(t,e){var n,o,i,r,s;if(null==e&&(e=[]),t.length!==e.length)return!1;for(s=!0,o=n=0,i=t.length;i>n;o=++n)r=t[o],s&&!r.isEqualTo(e[o])&&(s=!1);return s},o.prototype.contentsForInspection=function(){var t;return{objects:\"[\"+function(){var e,n,o,i;for(o=this.objects,i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(t.inspect());return i}.call(this).join(\", \")+\"]\"}},a=function(t){return t[0]},r=function(t){return t[1]},o}(e.Object)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.Text=function(n){function o(t){var n;null==t&&(t=[]),o.__super__.constructor.apply(this,arguments),this.pieceList=new e.SplittableList(function(){var e,o,i;for(i=[],e=0,o=t.length;o>e;e++)n=t[e],n.isEmpty()||i.push(n);return i}())}return t(o,n),o.textForAttachmentWithAttributes=function(t,n){var o;return o=new e.AttachmentPiece(t,n),new this([o])},o.textForStringWithAttributes=function(t,n){var o;return o=new e.StringPiece(t,n),new this([o])},o.fromJSON=function(t){var n,o;return o=function(){var o,i,r;for(r=[],o=0,i=t.length;i>o;o++)n=t[o],r.push(e.Piece.fromJSON(n));return r}(),new this(o)},o.prototype.copy=function(){return this.copyWithPieceList(this.pieceList)},o.prototype.copyWithPieceList=function(t){return new this.constructor(t.consolidate().toArray())},o.prototype.copyUsingObjectMap=function(t){var e,n;return n=function(){var n,o,i,r,s;for(i=this.getPieces(),s=[],n=0,o=i.length;o>n;n++)e=i[n],s.push(null!=(r=t.find(e))?r:e);return s}.call(this),new this.constructor(n)},o.prototype.appendText=function(t){return this.insertTextAtPosition(t,this.getLength())},o.prototype.insertTextAtPosition=function(t,e){return this.copyWithPieceList(this.pieceList.insertSplittableListAtPosition(t.pieceList,e))},o.prototype.removeTextAtRange=function(t){return this.copyWithPieceList(this.pieceList.removeObjectsInRange(t))},o.prototype.replaceTextAtRange=function(t,e){return this.removeTextAtRange(e).insertTextAtPosition(t,e[0])},o.prototype.moveTextFromRangeToPosition=function(t,e){var n,o;if(!(t[0]<=e&&e<=t[1]))return o=this.getTextAtRange(t),n=o.getLength(),t[0]<e&&(e-=n),this.removeTextAtRange(t).insertTextAtPosition(o,e)},o.prototype.addAttributeAtRange=function(t,e,n){var o;return o={},o[t]=e,this.addAttributesAtRange(o,n)},o.prototype.addAttributesAtRange=function(t,e){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e,function(e){return e.copyWithAdditionalAttributes(t)}))},o.prototype.removeAttributeAtRange=function(t,e){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e,function(e){return e.copyWithoutAttribute(t)}))},o.prototype.setAttributesAtRange=function(t,e){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e,function(e){return e.copyWithAttributes(t)}))},o.prototype.getAttributesAtPosition=function(t){var e,n;return null!=(e=null!=(n=this.pieceList.getObjectAtPosition(t))?n.getAttributes():void 0)?e:{}},o.prototype.getCommonAttributes=function(){var t,n;return t=function(){var t,e,o,i;for(o=this.pieceList.toArray(),i=[],t=0,e=o.length;e>t;t++)n=o[t],i.push(n.getAttributes());return i}.call(this),e.Hash.fromCommonAttributesOfObjects(t).toObject()},o.prototype.getCommonAttributesAtRange=function(t){var e;return null!=(e=this.getTextAtRange(t).getCommonAttributes())?e:{}},o.prototype.getExpandedRangeForAttributeAtOffset=function(t,e){var n,o,i;for(n=i=e,o=this.getLength();n>0&&this.getCommonAttributesAtRange([n-1,i])[t];)n--;for(;o>i&&this.getCommonAttributesAtRange([e,i+1])[t];)i++;return[n,i]},o.prototype.getTextAtRange=function(t){return this.copyWithPieceList(this.pieceList.getSplittableListInRange(t))},o.prototype.getStringAtRange=function(t){return this.pieceList.getSplittableListInRange(t).toString()},o.prototype.getStringAtPosition=function(t){return this.getStringAtRange([t,t+1])},o.prototype.startsWithString=function(t){return this.getStringAtRange([0,t.length])===t},o.prototype.endsWithString=function(t){var e;return e=this.getLength(),this.getStringAtRange([e-t.length,e])===t},o.prototype.getAttachmentPieces=function(){var t,e,n,o,i;for(o=this.pieceList.toArray(),i=[],t=0,e=o.length;e>t;t++)n=o[t],null!=n.attachment&&i.push(n);return i},o.prototype.getAttachments=function(){var t,e,n,o,i;for(o=this.getAttachmentPieces(),i=[],t=0,e=o.length;e>t;t++)n=o[t],i.push(n.attachment);return i},o.prototype.getAttachmentAndPositionById=function(t){var e,n,o,i,r,s;for(i=0,r=this.pieceList.toArray(),e=0,n=r.length;n>e;e++){if(o=r[e],(null!=(s=o.attachment)?s.id:void 0)===t)return{attachment:o.attachment,position:i};i+=o.length}return{attachment:null,position:null}},o.prototype.getAttachmentById=function(t){var e,n,o;return o=this.getAttachmentAndPositionById(t),e=o.attachment,n=o.position,e},o.prototype.getRangeOfAttachment=function(t){var e,n;return n=this.getAttachmentAndPositionById(t.id),t=n.attachment,e=n.position,null!=t?[e,e+1]:void 0},o.prototype.updateAttributesForAttachment=function(t,e){var n;return(n=this.getRangeOfAttachment(e))?this.addAttributesAtRange(t,n):this},o.prototype.getLength=function(){return this.pieceList.getEndPosition()},o.prototype.isEmpty=function(){return 0===this.getLength()},o.prototype.isEqualTo=function(t){var e;return o.__super__.isEqualTo.apply(this,arguments)||(null!=t&&null!=(e=t.pieceList)?e.isEqualTo(this.pieceList):void 0)},o.prototype.isBlockBreak=function(){return 1===this.getLength()&&this.pieceList.getObjectAtIndex(0).isBlockBreak()},o.prototype.eachPiece=function(t){return this.pieceList.eachObject(t)},o.prototype.getPieces=function(){return this.pieceList.toArray()},o.prototype.getPieceAtPosition=function(t){return this.pieceList.getObjectAtPosition(t)},o.prototype.contentsForInspection=function(){return{pieceList:this.pieceList.inspect()}},o.prototype.toSerializableText=function(){var t;return t=this.pieceList.selectSplittableList(function(t){return t.isSerializable()}),this.copyWithPieceList(t)},o.prototype.toString=function(){return this.pieceList.toString()},o.prototype.toJSON=function(){return this.pieceList.toJSON()},o.prototype.toConsole=function(){var t;return JSON.stringify(function(){var e,n,o,i;for(o=this.pieceList.toArray(),i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(JSON.parse(t.toConsole()));return i}.call(this))},o}(e.Object)}.call(this),function(){var t,n,o,i,r,s=function(t,e){function n(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty,u=[].slice,c=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=e.arraysAreEqual,r=e.spliceArray,o=e.getBlockConfig,n=e.getBlockAttributeNames,i=e.getListAttributeNames,e.Block=function(n){function a(t,n){null==t&&(t=new e.Text),null==n&&(n=[]),a.__super__.constructor.apply(this,arguments),this.text=h(t),this.attributes=n}var l,h,p,d,f,g,m,y,v;return s(a,n),a.fromJSON=function(t){var n;return n=e.Text.fromJSON(t.text),new this(n,t.attributes)},a.prototype.isEmpty=function(){return this.text.isBlockBreak()},a.prototype.isEqualTo=function(e){return a.__super__.isEqualTo.apply(this,arguments)||this.text.isEqualTo(null!=e?e.text:void 0)&&t(this.attributes,null!=e?e.attributes:void 0)},a.prototype.copyWithText=function(t){return new this.constructor(t,this.attributes)},a.prototype.copyWithoutText=function(){return this.copyWithText(null)},a.prototype.copyWithAttributes=function(t){return new this.constructor(this.text,t)},a.prototype.copyUsingObjectMap=function(t){var e;return this.copyWithText((e=t.find(this.text))?e:this.text.copyUsingObjectMap(t))},a.prototype.addAttribute=function(t){var e;return e=this.attributes.concat(d(t)),this.copyWithAttributes(e)},a.prototype.removeAttribute=function(t){var e,n;return n=o(t).listAttribute,e=g(g(this.attributes,t),n),this.copyWithAttributes(e)},a.prototype.removeLastAttribute=function(){return this.removeAttribute(this.getLastAttribute())},a.prototype.getLastAttribute=function(){return f(this.attributes)},a.prototype.getAttributes=function(){return this.attributes.slice(0)},a.prototype.getAttributeLevel=function(){return this.attributes.length},a.prototype.getAttributeAtLevel=function(t){return this.attributes[t-1]},a.prototype.hasAttributes=function(){return this.getAttributeLevel()>0},a.prototype.getLastNestableAttribute=function(){return f(this.getNestableAttributes())},a.prototype.getNestableAttributes=function(){var t,e,n,i,r;for(i=this.attributes,r=[],e=0,n=i.length;n>e;e++)t=i[e],o(t).nestable&&r.push(t);return r},a.prototype.getNestingLevel=function(){return this.getNestableAttributes().length},a.prototype.decreaseNestingLevel=function(){var t;return(t=this.getLastNestableAttribute())?this.removeAttribute(t):this},a.prototype.increaseNestingLevel=function(){var t,e,n;return(t=this.getLastNestableAttribute())?(n=this.attributes.lastIndexOf(t),e=r.apply(null,[this.attributes,n+1,0].concat(u.call(d(t)))),this.copyWithAttributes(e)):this},a.prototype.getListItemAttributes=function(){var t,e,n,i,r;for(i=this.attributes,r=[],e=0,n=i.length;n>e;e++)t=i[e],o(t).listAttribute&&r.push(t);return r},a.prototype.isListItem=function(){var t;return null!=(t=o(this.getLastAttribute()))?t.listAttribute:void 0},a.prototype.isTerminalBlock=function(){var t;return null!=(t=o(this.getLastAttribute()))?t.terminal:void 0},a.prototype.breaksOnReturn=function(){var t;return null!=(t=o(this.getLastAttribute()))?t.breakOnReturn:void 0},a.prototype.findLineBreakInDirectionFromPosition=function(t,e){var n,o;return o=this.toString(),n=function(){switch(t){case\"forward\":return o.indexOf(\"\\n\",e);case\"backward\":return o.slice(0,e).lastIndexOf(\"\\n\")}}(),-1!==n?n:void 0},a.prototype.contentsForInspection=function(){return{text:this.text.inspect(),attributes:this.attributes}},a.prototype.toString=function(){return this.text.toString()},a.prototype.toJSON=function(){return{text:this.text,attributes:this.attributes}},a.prototype.getLength=function(){return this.text.getLength()},a.prototype.canBeConsolidatedWith=function(t){return!this.hasAttributes()&&!t.hasAttributes()},a.prototype.consolidateWith=function(t){var n,o;return n=e.Text.textForStringWithAttributes(\"\\n\"),o=this.getTextWithoutBlockBreak().appendText(n),this.copyWithText(o.appendText(t.text))},a.prototype.splitAtOffset=function(t){var e,n;return 0===t?(e=null,n=this):t===this.getLength()?(e=this,n=null):(e=this.copyWithText(this.text.getTextAtRange([0,t])),n=this.copyWithText(this.text.getTextAtRange([t,this.getLength()]))),[e,n]},a.prototype.getBlockBreakPosition=function(){return this.text.getLength()-1},a.prototype.getTextWithoutBlockBreak=function(){return m(this.text)?this.text.getTextAtRange([0,this.getBlockBreakPosition()]):this.text.copy()},a.prototype.canBeGrouped=function(t){return this.attributes[t]},a.prototype.canBeGroupedWith=function(t,e){var n,r,s,a;return s=t.getAttributes(),r=s[e],n=this.attributes[e],n===r&&!(o(n).group===!1&&(a=s[e+1],c.call(i(),a)<0))},h=function(t){return t=v(t),t=l(t)},v=function(t){var n,o,i,r,s,a;return r=!1,a=t.getPieces(),o=2<=a.length?u.call(a,0,n=a.length-1):(n=0,[]),i=a[n++],null==i?t:(o=function(){var t,e,n;for(n=[],t=0,e=o.length;e>t;t++)s=o[t],s.isBlockBreak()?(r=!0,n.push(y(s))):n.push(s);return n}(),r?new e.Text(u.call(o).concat([i])):t)},p=e.Text.textForStringWithAttributes(\"\\n\",{blockBreak:!0}),l=function(t){return m(t)?t:t.appendText(p)},m=function(t){var e,n;return n=t.getLength(),0===n?!1:(e=t.getTextAtRange([n-1,n]),e.isBlockBreak())},y=function(t){return t.copyWithoutAttribute(\"blockBreak\")},d=function(t){var e;return e=o(t).listAttribute,null!=e?[e,t]:[t]},f=function(t){return t.slice(-1)[0]},g=function(t,e){var n;return n=t.lastIndexOf(e),-1===n?t:r(t,n,1)},a}(e.Object)}.call(this),function(){var t,n,o,i,r,s,a,u,c,l=function(t,e){function n(){this.constructor=t}for(var o in e)h.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},h={}.hasOwnProperty,p=[].slice,d=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=e.arraysAreEqual,a=e.normalizeSpaces,r=e.makeElement,u=e.tagName,i=e.getBlockTagNames,c=e.walkTree,o=e.findClosestElementFromNode,n=e.elementContainsNode,s=e.nodeIsAttachmentElement,e.HTMLParser=function(h){function f(t,e){this.html=t,this.referenceElement=(null!=e?e:{}).referenceElement,this.blocks=[],this.blockElements=[],this.processedElements=[]}var g,m,y,v,b,A,C,w,x,E,S,k,R,L,D,O;return l(f,h),g=\"style href src width height class\".split(\" \"),f.parse=function(t,e){var n;return n=new this(t,e),n.parse(),n},f.prototype.getDocument=function(){return e.Document.fromJSON(this.blocks)},f.prototype.parse=function(){var t,e;try{for(this.createHiddenContainer(),t=R(this.html),this.containerElement.innerHTML=t,e=c(this.containerElement,{usingFilter:E});e.nextNode();)this.processNode(e.currentNode);return this.translateBlockElementMarginsToNewlines()}finally{this.removeHiddenContainer()}},f.prototype.createHiddenContainer=function(){return this.referenceElement?(this.containerElement=this.referenceElement.cloneNode(!1),this.containerElement.removeAttribute(\"id\"),this.containerElement.setAttribute(\"data-trix-internal\",\"\"),this.containerElement.style.display=\"none\",this.referenceElement.parentNode.insertBefore(this.containerElement,this.referenceElement.nextSibling)):(this.containerElement=r({tagName:\"div\",style:{display:\"none\"}}),document.body.appendChild(this.containerElement))},f.prototype.removeHiddenContainer=function(){return this.containerElement.parentNode.removeChild(this.containerElement)},R=function(t){var e,n,o,i,r,s,a,u,l,h,f,m,y,v,A,C;for(t=t.replace(/<\\/html[^>]*>[^]*$/i,\"</html>\"),n=document.implementation.createHTMLDocument(\"\"),n.documentElement.innerHTML=t,e=n.body,o=n.head,y=o.querySelectorAll(\"style\"),i=0,a=y.length;a>i;i++)A=y[i],e.appendChild(A);for(m=[],C=c(e);C.nextNode();)switch(f=C.currentNode,f.nodeType){case Node.ELEMENT_NODE:if(b(f))m.push(f);else for(v=p.call(f.attributes),r=0,u=v.length;u>r;r++)h=v[r].name,d.call(g,h)>=0||0===h.indexOf(\"data-trix\")||f.removeAttribute(h);break;case Node.COMMENT_NODE:m.push(f)}for(s=0,l=m.length;l>s;s++)f=m[s],f.parentNode.removeChild(f);return e.innerHTML},b=function(t){return(null!=t?t.nodeType:void 0)!==Node.ELEMENT_NODE||s(t)?void 0:\"script\"===u(t)||\"false\"===t.getAttribute(\"data-trix-serialize\")},E=function(t){return\"style\"===u(t)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},f.prototype.processNode=function(t){switch(t.nodeType){case Node.TEXT_NODE:return this.processTextNode(t);case Node.ELEMENT_NODE:return this.appendBlockForElement(t),this.processElement(t)}},f.prototype.appendBlockForElement=function(e){var o,i,r,s;if(r=this.isBlockElement(e),i=n(this.currentBlockElement,e),r&&!this.isBlockElement(e.firstChild)){if(!(this.isInsignificantTextNode(e.firstChild)&&this.isBlockElement(e.firstElementChild)||(o=this.getBlockAttributes(e),i&&t(o,this.currentBlock.attributes))))return this.currentBlock=this.appendBlockForAttributesWithElement(o,e),this.currentBlockElement=e}else if(this.currentBlockElement&&!i&&!r)return(s=this.findParentBlockElement(e))?this.appendBlockForElement(s):(this.currentBlock=this.appendEmptyBlock(),this.currentBlockElement=null)},f.prototype.findParentBlockElement=function(t){var e;for(e=t.parentElement;e&&e!==this.containerElement;){if(this.isBlockElement(e)&&d.call(this.blockElements,e)>=0)return e;e=e.parentElement}return null},f.prototype.processTextNode=function(t){var e,n;return this.isInsignificantTextNode(t)?void 0:(n=t.data,v(t.parentNode)||(n=L(n),D(null!=(e=t.previousSibling)?e.textContent:void 0)&&(n=x(n))),this.appendStringWithAttributes(n,this.getTextAttributes(t.parentNode)))},f.prototype.processElement=function(t){var e,n,o,i,r;if(s(t))return e=A(t),Object.keys(e).length&&(i=this.getTextAttributes(t),this.appendAttachmentWithAttributes(e,i),t.innerHTML=\"\"),this.processedElements.push(t);switch(u(t)){case\"br\":return this.isExtraBR(t)||this.isBlockElement(t.nextSibling)||this.appendStringWithAttributes(\"\\n\",this.getTextAttributes(t)),this.processedElements.push(t);case\"img\":e={url:t.getAttribute(\"src\"),contentType:\"image\"},o=w(t);for(n in o)r=o[n],e[n]=r;return this.appendAttachmentWithAttributes(e,this.getTextAttributes(t)),this.processedElements.push(t);case\"tr\":if(t.parentNode.firstChild!==t)return this.appendStringWithAttributes(\"\\n\");break;case\"td\":if(t.parentNode.firstChild!==t)return this.appendStringWithAttributes(\" | \")}},f.prototype.appendBlockForAttributesWithElement=function(t,e){var n;return this.blockElements.push(e),n=m(t),this.blocks.push(n),n},f.prototype.appendEmptyBlock=function(){return this.appendBlockForAttributesWithElement([],null)},f.prototype.appendStringWithAttributes=function(t,e){return this.appendPiece(k(t,e))},f.prototype.appendAttachmentWithAttributes=function(t,e){return this.appendPiece(S(t,e))},f.prototype.appendPiece=function(t){return 0===this.blocks.length&&this.appendEmptyBlock(),this.blocks[this.blocks.length-1].text.push(t)},f.prototype.appendStringToTextAtIndex=function(t,e){var n,o;return o=this.blocks[e].text,n=o[o.length-1],\"string\"===(null!=n?n.type:void 0)?n.string+=t:o.push(k(t))},f.prototype.prependStringToTextAtIndex=function(t,e){var n,o;return o=this.blocks[e].text,n=o[0],\"string\"===(null!=n?n.type:void 0)?n.string=t+n.string:o.unshift(k(t))},k=function(t,e){var n;return null==e&&(e={}),n=\"string\",t=a(t),{string:t,attributes:e,type:n}},S=function(t,e){var n;return null==e&&(e={}),n=\"attachment\",{attachment:t,attributes:e,type:n}},m=function(t){var e;return null==t&&(t={}),e=[],{text:e,attributes:t}},f.prototype.getTextAttributes=function(t){var n,i,r,a,u,c,l,h,p,d,f,g,m;r={},d=e.config.textAttributes;for(n in d)if(u=d[n],u.tagName&&o(t,{matchingSelector:u.tagName,untilNode:this.containerElement}))r[n]=!0;else if(u.parser&&(m=u.parser(t))){for(i=!1,f=this.findBlockElementAncestors(t),c=0,p=f.length;p>c;c++)if(a=f[c],u.parser(a)===m){i=!0;break}i||(r[n]=m)}if(s(t)&&(l=t.getAttribute(\"data-trix-attributes\"))){g=JSON.parse(l);for(h in g)m=g[h],r[h]=m}return r},f.prototype.getBlockAttributes=function(t){var n,o,i,r;for(o=[];t&&t!==this.containerElement;){r=e.config.blockAttributes;for(n in r)i=r[n],i.parse!==!1&&u(t)===i.tagName&&((\"function\"==typeof i.test?i.test(t):void 0)||!i.test)&&(o.push(n),i.listAttribute&&o.push(i.listAttribute));t=t.parentNode}return o.reverse()},f.prototype.findBlockElementAncestors=function(t){var e,n;for(e=[];t&&t!==this.containerElement;)n=u(t),d.call(i(),n)>=0&&e.push(t),t=t.parentNode;return e},A=function(t){return JSON.parse(t.getAttribute(\"data-trix-attachment\"))},w=function(t){var e,n,o;return o=t.getAttribute(\"width\"),n=t.getAttribute(\"height\"),e={},o&&(e.width=parseInt(o,10)),n&&(e.height=parseInt(n,10)),e},f.prototype.isBlockElement=function(t){var e;if((null!=t?t.nodeType:void 0)===Node.ELEMENT_NODE&&!o(t,{matchingSelector:\"td\",untilNode:this.containerElement}))return e=u(t),d.call(i(),e)>=0||\"block\"===window.getComputedStyle(t).display},f.prototype.isInsignificantTextNode=function(t){return(null!=t?t.nodeType:void 0)===Node.TEXT_NODE&&O(t.data)&&!v(t.parentNode)?!t.previousSibling||this.isBlockElement(t.previousSibling)||!t.nextSibling||this.isBlockElement(t.nextSibling):void 0},f.prototype.isExtraBR=function(t){return\"br\"===u(t)&&this.isBlockElement(t.parentNode)&&t.parentNode.lastChild===t},v=function(t){var e;return e=window.getComputedStyle(t).whiteSpace,\"pre\"===e||\"pre-wrap\"===e||\"pre-line\"===e},f.prototype.translateBlockElementMarginsToNewlines=function(){var t,e,n,o,i,r,s,a;for(e=this.getMarginOfDefaultBlockElement(),s=this.blocks,a=[],o=n=0,i=s.length;i>n;o=++n)t=s[o],(r=this.getMarginOfBlockElementAtIndex(o))&&(r.top>2*e.top&&this.prependStringToTextAtIndex(\"\\n\",o),a.push(r.bottom>2*e.bottom?this.appendStringToTextAtIndex(\"\\n\",o):void 0));return a},f.prototype.getMarginOfBlockElementAtIndex=function(t){var e,n;return!(e=this.blockElements[t])||(n=u(e),d.call(i(),n)>=0||d.call(this.processedElements,e)>=0)?void 0:C(e)},f.prototype.getMarginOfDefaultBlockElement=function(){var t;return t=r(e.config.blockAttributes[\"default\"].tagName),this.containerElement.appendChild(t),C(t)},C=function(t){var e;return e=window.getComputedStyle(t),\"block\"===e.display?{top:parseInt(e.marginTop),bottom:parseInt(e.marginBottom)}:void 0},y=RegExp(\"[^\\\\S\"+e.NON_BREAKING_SPACE+\"]\"),L=function(t){return t.replace(RegExp(\"\"+y.source,\"g\"),\" \").replace(/\\ {2,}/g,\" \")},x=function(t){return t.replace(RegExp(\"^\"+y.source+\"+\"),\"\")},O=function(t){return RegExp(\"^\"+y.source+\"*$\").test(t)},D=function(t){return/\\s$/.test(t)},f}(e.BasicObject)}.call(this),function(){var t,n,o,i,r=function(t,e){function n(){this.constructor=t}for(var o in e)s.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s={}.hasOwnProperty,a=[].slice,u=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=e.arraysAreEqual,o=e.normalizeRange,i=e.rangeIsCollapsed,n=e.getBlockConfig,e.Document=function(s){function c(t){null==t&&(t=[]),c.__super__.constructor.apply(this,arguments),0===t.length&&(t=[new e.Block]),this.blockList=e.SplittableList.box(t)}var l;return r(c,s),c.fromJSON=function(t){var n,o;return o=function(){var o,i,r;for(r=[],o=0,i=t.length;i>o;o++)n=t[o],r.push(e.Block.fromJSON(n));return r}(),new this(o)},c.fromHTML=function(t,n){return e.HTMLParser.parse(t,n).getDocument()},c.fromString=function(t,n){var o;return o=e.Text.textForStringWithAttributes(t,n),new this([new e.Block(o)])},c.prototype.isEmpty=function(){var t;return 1===this.blockList.length&&(t=this.getBlockAtIndex(0),t.isEmpty()&&!t.hasAttributes())},c.prototype.copy=function(t){var e;return null==t&&(t={}),e=t.consolidateBlocks?this.blockList.consolidate().toArray():this.blockList.toArray(),new this.constructor(e)},c.prototype.copyUsingObjectsFromDocument=function(t){var n;return n=new e.ObjectMap(t.getObjects()),this.copyUsingObjectMap(n)},c.prototype.copyUsingObjectMap=function(t){var e,n,o;return n=function(){var n,i,r,s;for(r=this.getBlocks(),s=[],n=0,i=r.length;i>n;n++)e=r[n],s.push((o=t.find(e))?o:e.copyUsingObjectMap(t));return s}.call(this),new this.constructor(n)},c.prototype.copyWithBaseBlockAttributes=function(t){var e,n,o;return null==t&&(t=[]),o=function(){var o,i,r,s;for(r=this.getBlocks(),s=[],o=0,i=r.length;i>o;o++)n=r[o],e=t.concat(n.getAttributes()),s.push(n.copyWithAttributes(e));return s}.call(this),new this.constructor(o)},c.prototype.replaceBlock=function(t,e){var n;return n=this.blockList.indexOf(t),-1===n?this:new this.constructor(this.blockList.replaceObjectAtIndex(e,n))},c.prototype.insertDocumentAtRange=function(t,e){var n,r,s,a,u,c,l;return r=t.blockList,u=(e=o(e))[0],c=this.locationFromPosition(u),s=c.index,a=c.offset,l=this,n=this.getBlockAtPosition(u),i(e)&&n.isEmpty()&&!n.hasAttributes()?l=new this.constructor(l.blockList.removeObjectAtIndex(s)):n.getBlockBreakPosition()===a&&u++,l=l.removeTextAtRange(e),new this.constructor(l.blockList.insertSplittableListAtPosition(r,u))},c.prototype.mergeDocumentAtRange=function(e,n){var i,r,s,a,u,c,l,h,p,d,f,g;return f=(n=o(n))[0],d=this.locationFromPosition(f),r=this.getBlockAtIndex(d.index).getAttributes(),i=e.getBaseBlockAttributes(),g=r.slice(-i.length),t(i,g)?(l=r.slice(0,-i.length),c=e.copyWithBaseBlockAttributes(l)):c=e.copy({consolidateBlocks:!0}).copyWithBaseBlockAttributes(r),s=c.getBlockCount(),a=c.getBlockAtIndex(0),t(r,a.getAttributes())?(u=a.getTextWithoutBlockBreak(),p=this.insertTextAtRange(u,n),s>1&&(c=new this.constructor(c.getBlocks().slice(1)),h=f+u.getLength(),p=p.insertDocumentAtRange(c,h))):p=this.insertDocumentAtRange(c,n),p},c.prototype.insertTextAtRange=function(t,e){var n,i,r,s,a;return a=(e=o(e))[0],s=this.locationFromPosition(a),i=s.index,r=s.offset,n=this.removeTextAtRange(e),new this.constructor(n.blockList.editObjectAtIndex(i,function(e){return e.copyWithText(e.text.insertTextAtPosition(t,r))}))},c.prototype.removeTextAtRange=function(t){var e,n,r,s,a,u,c,l,h,p,d,f,g,m,y,v,b,A,C,w,x;return p=t=o(t),l=p[0],A=p[1],i(t)?this:(d=this.locationRangeFromRange(t),u=d[0],v=d[1],a=u.index,c=u.offset,s=this.getBlockAtIndex(a),y=v.index,b=v.offset,m=this.getBlockAtIndex(y),f=A-l===1&&s.getBlockBreakPosition()===c&&m.getBlockBreakPosition()!==b&&\"\\n\"===m.text.getStringAtPosition(b),f?r=this.blockList.editObjectAtIndex(y,function(t){return t.copyWithText(t.text.removeTextAtRange([b,b+1]))\n}):(h=s.text.getTextAtRange([0,c]),C=m.text.getTextAtRange([b,m.getLength()]),w=h.appendText(C),g=a!==y&&0===c,x=g&&s.getAttributeLevel()>=m.getAttributeLevel(),n=x?m.copyWithText(w):s.copyWithText(w),e=y+1-a,r=this.blockList.splice(a,e,n)),new this.constructor(r))},c.prototype.moveTextFromRangeToPosition=function(t,e){var n,i,r,s,u,c,l,h,p,d;if(c=t=o(t),p=c[0],r=c[1],e>=p&&r>=e)return this;if(i=this.getDocumentAtRange(t),h=this.removeTextAtRange(t),u=e>p,u&&(e-=i.getLength()),!h.firstBlockInRangeIsEntirelySelected(t)){if(l=i.getBlocks(),s=l[0],n=2<=l.length?a.call(l,1):[],0===n.length?(d=s.getTextWithoutBlockBreak(),u&&(e+=1)):d=s.text,h=h.insertTextAtRange(d,e),0===n.length)return h;i=new this.constructor(n),e+=d.getLength()}return h.insertDocumentAtRange(i,e)},c.prototype.addAttributeAtRange=function(t,e,o){var i;return i=this.blockList,this.eachBlockAtRange(o,function(o,r,s){return i=i.editObjectAtIndex(s,function(){return n(t)?o.addAttribute(t,e):r[0]===r[1]?o:o.copyWithText(o.text.addAttributeAtRange(t,e,r))})}),new this.constructor(i)},c.prototype.addAttribute=function(t,e){var n;return n=this.blockList,this.eachBlock(function(o,i){return n=n.editObjectAtIndex(i,function(){return o.addAttribute(t,e)})}),new this.constructor(n)},c.prototype.removeAttributeAtRange=function(t,e){var o;return o=this.blockList,this.eachBlockAtRange(e,function(e,i,r){return n(t)?o=o.editObjectAtIndex(r,function(){return e.removeAttribute(t)}):i[0]!==i[1]?o=o.editObjectAtIndex(r,function(){return e.copyWithText(e.text.removeAttributeAtRange(t,i))}):void 0}),new this.constructor(o)},c.prototype.updateAttributesForAttachment=function(t,e){var n,o,i,r;return i=(o=this.getRangeOfAttachment(e))[0],n=this.locationFromPosition(i).index,r=this.getTextAtIndex(n),new this.constructor(this.blockList.editObjectAtIndex(n,function(n){return n.copyWithText(r.updateAttributesForAttachment(t,e))}))},c.prototype.removeAttributeForAttachment=function(t,e){var n;return n=this.getRangeOfAttachment(e),this.removeAttributeAtRange(t,n)},c.prototype.insertBlockBreakAtRange=function(t){var n,i,r,s;return s=(t=o(t))[0],r=this.locationFromPosition(s).offset,i=this.removeTextAtRange(t),0===r&&(n=[new e.Block]),new this.constructor(i.blockList.insertSplittableListAtPosition(new e.SplittableList(n),s))},c.prototype.applyBlockAttributeAtRange=function(t,e,o){var i,r,s,a;return s=this.expandRangeToLineBreaksAndSplitBlocks(o),r=s.document,o=s.range,i=n(t),i.listAttribute?(r=r.removeLastListAttributeAtRange(o,{exceptAttributeName:t}),a=r.convertLineBreaksToBlockBreaksInRange(o),r=a.document,o=a.range):r=i.terminal?r.removeLastTerminalAttributeAtRange(o):r.consolidateBlocksAtRange(o),r.addAttributeAtRange(t,e,o)},c.prototype.removeLastListAttributeAtRange=function(t,e){var o;return null==e&&(e={}),o=this.blockList,this.eachBlockAtRange(t,function(t,i,r){var s;if((s=t.getLastAttribute())&&n(s).listAttribute&&s!==e.exceptAttributeName)return o=o.editObjectAtIndex(r,function(){return t.removeAttribute(s)})}),new this.constructor(o)},c.prototype.removeLastTerminalAttributeAtRange=function(t){var e;return e=this.blockList,this.eachBlockAtRange(t,function(t,o,i){var r;if((r=t.getLastAttribute())&&n(r).terminal)return e=e.editObjectAtIndex(i,function(){return t.removeAttribute(r)})}),new this.constructor(e)},c.prototype.firstBlockInRangeIsEntirelySelected=function(t){var e,n,i,r,s,a;return r=t=o(t),a=r[0],e=r[1],n=this.locationFromPosition(a),s=this.locationFromPosition(e),0===n.offset&&n.index<s.index?!0:n.index===s.index?(i=this.getBlockAtIndex(n.index).getLength(),0===n.offset&&s.offset===i):!1},c.prototype.expandRangeToLineBreaksAndSplitBlocks=function(t){var e,n,i,r,s,a,u,c,l;return a=t=o(t),l=a[0],r=a[1],c=this.locationFromPosition(l),i=this.locationFromPosition(r),e=this,u=e.getBlockAtIndex(c.index),null!=(c.offset=u.findLineBreakInDirectionFromPosition(\"backward\",c.offset))&&(s=e.positionFromLocation(c),e=e.insertBlockBreakAtRange([s,s+1]),i.index+=1,i.offset-=e.getBlockAtIndex(c.index).getLength(),c.index+=1),c.offset=0,0===i.offset&&i.index>c.index?(i.index-=1,i.offset=e.getBlockAtIndex(i.index).getBlockBreakPosition()):(n=e.getBlockAtIndex(i.index),\"\\n\"===n.text.getStringAtRange([i.offset-1,i.offset])?i.offset-=1:i.offset=n.findLineBreakInDirectionFromPosition(\"forward\",i.offset),i.offset!==n.getBlockBreakPosition()&&(s=e.positionFromLocation(i),e=e.insertBlockBreakAtRange([s,s+1]))),l=e.positionFromLocation(c),r=e.positionFromLocation(i),t=o([l,r]),{document:e,range:t}},c.prototype.convertLineBreaksToBlockBreaksInRange=function(t){var e,n,i;return n=(t=o(t))[0],i=this.getStringAtRange(t).slice(0,-1),e=this,i.replace(/.*?\\n/g,function(t){return n+=t.length,e=e.insertBlockBreakAtRange([n-1,n])}),{document:e,range:t}},c.prototype.consolidateBlocksAtRange=function(t){var e,n,i,r,s;return i=t=o(t),s=i[0],n=i[1],r=this.locationFromPosition(s).index,e=this.locationFromPosition(n).index,new this.constructor(this.blockList.consolidateFromIndexToIndex(r,e))},c.prototype.getDocumentAtRange=function(t){var e;return t=o(t),e=this.blockList.getSplittableListInRange(t).toArray(),new this.constructor(e)},c.prototype.getStringAtRange=function(t){return this.getDocumentAtRange(t).toString()},c.prototype.getBlockAtIndex=function(t){return this.blockList.getObjectAtIndex(t)},c.prototype.getBlockAtPosition=function(t){var e;return e=this.locationFromPosition(t).index,this.getBlockAtIndex(e)},c.prototype.getTextAtIndex=function(t){var e;return null!=(e=this.getBlockAtIndex(t))?e.text:void 0},c.prototype.getTextAtPosition=function(t){var e;return e=this.locationFromPosition(t).index,this.getTextAtIndex(e)},c.prototype.getPieceAtPosition=function(t){var e,n,o;return o=this.locationFromPosition(t),e=o.index,n=o.offset,this.getTextAtIndex(e).getPieceAtPosition(n)},c.prototype.getCharacterAtPosition=function(t){var e,n,o;return o=this.locationFromPosition(t),e=o.index,n=o.offset,this.getTextAtIndex(e).getStringAtRange([n,n+1])},c.prototype.getLength=function(){return this.blockList.getEndPosition()},c.prototype.getBlocks=function(){return this.blockList.toArray()},c.prototype.getBlockCount=function(){return this.blockList.length},c.prototype.getEditCount=function(){return this.editCount},c.prototype.eachBlock=function(t){return this.blockList.eachObject(t)},c.prototype.eachBlockAtRange=function(t,e){var n,i,r,s,a,u,c,l,h,p,d,f;if(u=t=o(t),d=u[0],r=u[1],p=this.locationFromPosition(d),i=this.locationFromPosition(r),p.index===i.index)return n=this.getBlockAtIndex(p.index),f=[p.offset,i.offset],e(n,f,p.index);for(h=[],a=s=c=p.index,l=i.index;l>=c?l>=s:s>=l;a=l>=c?++s:--s)(n=this.getBlockAtIndex(a))?(f=function(){switch(a){case p.index:return[p.offset,n.text.getLength()];case i.index:return[0,i.offset];default:return[0,n.text.getLength()]}}(),h.push(e(n,f,a))):h.push(void 0);return h},c.prototype.getCommonAttributesAtRange=function(t){var n,r,s;return r=(t=o(t))[0],i(t)?this.getCommonAttributesAtPosition(r):(s=[],n=[],this.eachBlockAtRange(t,function(t,e){return e[0]!==e[1]?(s.push(t.text.getCommonAttributesAtRange(e)),n.push(l(t))):void 0}),e.Hash.fromCommonAttributesOfObjects(s).merge(e.Hash.fromCommonAttributesOfObjects(n)).toObject())},c.prototype.getCommonAttributesAtPosition=function(t){var n,o,i,r,s,a,c,h,p,d;if(p=this.locationFromPosition(t),s=p.index,h=p.offset,i=this.getBlockAtIndex(s),!i)return{};r=l(i),n=i.text.getAttributesAtPosition(h),o=i.text.getAttributesAtPosition(h-1),a=function(){var t,n;t=e.config.textAttributes,n=[];for(c in t)d=t[c],d.inheritable&&n.push(c);return n}();for(c in o)d=o[c],(d===n[c]||u.call(a,c)>=0)&&(r[c]=d);return r},c.prototype.getRangeOfCommonAttributeAtPosition=function(t,e){var n,i,r,s,a,u,c,l,h;return a=this.locationFromPosition(e),r=a.index,s=a.offset,h=this.getTextAtIndex(r),u=h.getExpandedRangeForAttributeAtOffset(t,s),l=u[0],i=u[1],c=this.positionFromLocation({index:r,offset:l}),n=this.positionFromLocation({index:r,offset:i}),o([c,n])},c.prototype.getBaseBlockAttributes=function(){var t,e,n,o,i,r,s;for(t=this.getBlockAtIndex(0).getAttributes(),n=o=1,s=this.getBlockCount();s>=1?s>o:o>s;n=s>=1?++o:--o)e=this.getBlockAtIndex(n).getAttributes(),r=Math.min(t.length,e.length),t=function(){var n,o,s;for(s=[],i=n=0,o=r;(o>=0?o>n:n>o)&&e[i]===t[i];i=o>=0?++n:--n)s.push(e[i]);return s}();return t},l=function(t){var e,n;return n={},(e=t.getLastAttribute())&&(n[e]=!0),n},c.prototype.getAttachmentById=function(t){var e,n,o,i;for(i=this.getAttachments(),n=0,o=i.length;o>n;n++)if(e=i[n],e.id===t)return e},c.prototype.getAttachmentPieces=function(){var t;return t=[],this.blockList.eachObject(function(e){var n;return n=e.text,t=t.concat(n.getAttachmentPieces())}),t},c.prototype.getAttachments=function(){var t,e,n,o,i;for(o=this.getAttachmentPieces(),i=[],t=0,e=o.length;e>t;t++)n=o[t],i.push(n.attachment);return i},c.prototype.getRangeOfAttachment=function(t){var e,n,i,r,s,a,u;for(r=0,s=this.blockList.toArray(),n=e=0,i=s.length;i>e;n=++e){if(a=s[n].text,u=a.getRangeOfAttachment(t))return o([r+u[0],r+u[1]]);r+=a.getLength()}},c.prototype.getLocationRangeOfAttachment=function(t){var e;return e=this.getRangeOfAttachment(t),this.locationRangeFromRange(e)},c.prototype.getAttachmentPieceForAttachment=function(t){var e,n,o,i;for(i=this.getAttachmentPieces(),e=0,n=i.length;n>e;e++)if(o=i[e],o.attachment===t)return o},c.prototype.locationFromPosition=function(t){var e,n;return n=this.blockList.findIndexAndOffsetAtPosition(Math.max(0,t)),null!=n.index?n:(e=this.getBlocks(),{index:e.length-1,offset:e[e.length-1].getLength()})},c.prototype.positionFromLocation=function(t){return this.blockList.findPositionAtIndexAndOffset(t.index,t.offset)},c.prototype.locationRangeFromPosition=function(t){return o(this.locationFromPosition(t))},c.prototype.locationRangeFromRange=function(t){var e,n,i,r;if(t=o(t))return r=t[0],n=t[1],i=this.locationFromPosition(r),e=this.locationFromPosition(n),o([i,e])},c.prototype.rangeFromLocationRange=function(t){var e,n;return t=o(t),e=this.positionFromLocation(t[0]),i(t)||(n=this.positionFromLocation(t[1])),o([e,n])},c.prototype.isEqualTo=function(t){return this.blockList.isEqualTo(null!=t?t.blockList:void 0)},c.prototype.getTexts=function(){var t,e,n,o,i;for(o=this.getBlocks(),i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(t.text);return i},c.prototype.getPieces=function(){var t,e,n,o,i;for(n=[],o=this.getTexts(),t=0,e=o.length;e>t;t++)i=o[t],n.push.apply(n,i.getPieces());return n},c.prototype.getObjects=function(){return this.getBlocks().concat(this.getTexts()).concat(this.getPieces())},c.prototype.toSerializableDocument=function(){var t;return t=[],this.blockList.eachObject(function(e){return t.push(e.copyWithText(e.text.toSerializableText()))}),new this.constructor(t)},c.prototype.toString=function(){return this.blockList.toString()},c.prototype.toJSON=function(){return this.blockList.toJSON()},c.prototype.toConsole=function(){var t;return JSON.stringify(function(){var e,n,o,i;for(o=this.blockList.toArray(),i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(JSON.parse(t.text.toConsole()));return i}.call(this))},c}(e.Object)}.call(this),function(){e.LineBreakInsertion=function(){function t(t){var e;this.composition=t,this.document=this.composition.document,e=this.composition.getSelectedRange(),this.startPosition=e[0],this.endPosition=e[1],this.startLocation=this.document.locationFromPosition(this.startPosition),this.endLocation=this.document.locationFromPosition(this.endPosition),this.block=this.document.getBlockAtIndex(this.endLocation.index),this.breaksOnReturn=this.block.breaksOnReturn(),this.previousCharacter=this.block.text.getStringAtPosition(this.endLocation.offset-1),this.nextCharacter=this.block.text.getStringAtPosition(this.endLocation.offset)}return t.prototype.shouldInsertBlockBreak=function(){return this.block.hasAttributes()&&this.block.isListItem()&&!this.block.isEmpty()?0!==this.startLocation.offset:this.breaksOnReturn&&\"\\n\"!==this.nextCharacter},t.prototype.shouldBreakFormattedBlock=function(){return this.block.hasAttributes()&&!this.block.isListItem()&&(this.breaksOnReturn&&\"\\n\"===this.nextCharacter||\"\\n\"===this.previousCharacter)},t.prototype.shouldDecreaseListLevel=function(){return this.block.hasAttributes()&&this.block.isListItem()&&this.block.isEmpty()},t.prototype.shouldPrependListItem=function(){return this.block.isListItem()&&0===this.startLocation.offset&&!this.block.isEmpty()},t.prototype.shouldRemoveLastBlockAttribute=function(){return this.block.hasAttributes()&&!this.block.isListItem()&&this.block.isEmpty()},t}()}.call(this),function(){var t,n,o,i,r,s,a,u,c,l,h=function(t,e){function n(){this.constructor=t}for(var o in e)p.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},p={}.hasOwnProperty;s=e.normalizeRange,c=e.rangesAreEqual,u=e.rangeIsCollapsed,a=e.objectsAreEqual,t=e.arrayStartsWith,l=e.summarizeArrayChange,o=e.getAllAttributeNames,i=e.getBlockConfig,r=e.getTextConfig,n=e.extend,e.Composition=function(p){function d(){this.document=new e.Document,this.attachments=[],this.currentAttributes={},this.revision=0}var f;return h(d,p),d.prototype.setDocument=function(t){var e;return t.isEqualTo(this.document)?void 0:(this.document=t,this.refreshAttachments(),this.revision++,null!=(e=this.delegate)&&\"function\"==typeof e.compositionDidChangeDocument?e.compositionDidChangeDocument(t):void 0)},d.prototype.getSnapshot=function(){return{document:this.document,selectedRange:this.getSelectedRange()}},d.prototype.loadSnapshot=function(t){var n,o,i,r;return n=t.document,r=t.selectedRange,null!=(o=this.delegate)&&\"function\"==typeof o.compositionWillLoadSnapshot&&o.compositionWillLoadSnapshot(),this.setDocument(null!=n?n:new e.Document),this.setSelection(null!=r?r:[0,0]),null!=(i=this.delegate)&&\"function\"==typeof i.compositionDidLoadSnapshot?i.compositionDidLoadSnapshot():void 0},d.prototype.insertText=function(t,e){var n,o,i,r;return r=(null!=e?e:{updatePosition:!0}).updatePosition,o=this.getSelectedRange(),this.setDocument(this.document.insertTextAtRange(t,o)),i=o[0],n=i+t.getLength(),r&&this.setSelection(n),this.notifyDelegateOfInsertionAtRange([i,n])},d.prototype.insertBlock=function(t){var n;return null==t&&(t=new e.Block),n=new e.Document([t]),this.insertDocument(n)},d.prototype.insertDocument=function(t){var n,o,i;return null==t&&(t=new e.Document),o=this.getSelectedRange(),this.setDocument(this.document.insertDocumentAtRange(t,o)),i=o[0],n=i+t.getLength(),this.setSelection(n),this.notifyDelegateOfInsertionAtRange([i,n])},d.prototype.insertString=function(t,n){var o,i;return o=this.getCurrentTextAttributes(),i=e.Text.textForStringWithAttributes(t,o),this.insertText(i,n)},d.prototype.insertBlockBreak=function(){var t,e,n;return e=this.getSelectedRange(),this.setDocument(this.document.insertBlockBreakAtRange(e)),n=e[0],t=n+1,this.setSelection(t),this.notifyDelegateOfInsertionAtRange([n,t])},d.prototype.insertLineBreak=function(){var t,n;return n=new e.LineBreakInsertion(this),n.shouldDecreaseListLevel()?(this.decreaseListLevel(),this.setSelection(n.startPosition)):n.shouldPrependListItem()?(t=new e.Document([n.block.copyWithoutText()]),this.insertDocument(t)):n.shouldInsertBlockBreak()?this.insertBlockBreak():n.shouldRemoveLastBlockAttribute()?this.removeLastBlockAttribute():n.shouldBreakFormattedBlock()?this.breakFormattedBlock(n):this.insertString(\"\\n\")},d.prototype.insertHTML=function(t){var n,o,i,r,s;return s=this.getPosition(),r=this.document.getLength(),n=e.Document.fromHTML(t),this.setDocument(this.document.mergeDocumentAtRange(n,this.getSelectedRange())),o=this.document.getLength(),i=s+(o-r),this.setSelection(i),this.notifyDelegateOfInsertionAtRange([i,i])},d.prototype.replaceHTML=function(t){var n,o,i;return n=e.Document.fromHTML(t).copyUsingObjectsFromDocument(this.document),o=this.getLocationRange({strict:!1}),i=this.document.rangeFromLocationRange(o),this.setDocument(n),this.setSelection(i)},d.prototype.insertFile=function(t){var n,o;return(null!=(o=this.delegate)?o.compositionShouldAcceptFile(t):void 0)?(n=e.Attachment.attachmentForFile(t),this.insertAttachment(n)):void 0},d.prototype.insertFiles=function(t){var n,o,i,r,s,a,u;for(u=new e.Text,r=0,s=t.length;s>r;r++)i=t[r],(null!=(a=this.delegate)?a.compositionShouldAcceptFile(i):void 0)&&(n=e.Attachment.attachmentForFile(i),o=e.Text.textForAttachmentWithAttributes(n,this.currentAttributes),u=u.appendText(o));return this.insertText(u)},d.prototype.insertAttachment=function(t){var n;return n=e.Text.textForAttachmentWithAttributes(t,this.currentAttributes),this.insertText(n)},d.prototype.deleteInDirection=function(t){var e,n,o,i,r,s,a;return i=this.getLocationRange(),r=this.getSelectedRange(),s=u(r),s?o=\"backward\"===t&&0===i[0].offset:a=i[0].index!==i[1].index,o&&this.canDecreaseBlockAttributeLevel()&&(n=this.getBlock(),n.isListItem()?this.decreaseListLevel():this.decreaseBlockAttributeLevel(),this.setSelection(r[0]),n.isEmpty())?!1:(s&&(r=this.getExpandedRangeInDirection(t),\"backward\"===t&&(e=this.getAttachmentAtRange(r))),e?(this.editAttachment(e),!1):(this.setDocument(this.document.removeTextAtRange(r)),this.setSelection(r[0]),o||a?!1:void 0))},d.prototype.moveTextFromRange=function(t){var e;return e=this.getSelectedRange()[0],this.setDocument(this.document.moveTextFromRangeToPosition(t,e)),this.setSelection(e)},d.prototype.removeAttachment=function(t){var e;return(e=this.document.getRangeOfAttachment(t))?(this.stopEditingAttachment(),this.setDocument(this.document.removeTextAtRange(e)),this.setSelection(e[0])):void 0},d.prototype.removeLastBlockAttribute=function(){var t,e,n,o;return n=this.getSelectedRange(),o=n[0],e=n[1],t=this.document.getBlockAtPosition(e),this.removeCurrentAttribute(t.getLastAttribute()),this.setSelection(o)},f=\" \",d.prototype.insertPlaceholder=function(){return this.placeholderPosition=this.getPosition(),this.insertString(f)},d.prototype.selectPlaceholder=function(){return null!=this.placeholderPosition?(this.setSelectedRange([this.placeholderPosition,this.placeholderPosition+f.length]),this.getSelectedRange()):void 0},d.prototype.forgetPlaceholder=function(){return this.placeholderPosition=null},d.prototype.hasCurrentAttribute=function(t){var e;return e=this.currentAttributes[t],null!=e&&e!==!1},d.prototype.toggleCurrentAttribute=function(t){var e;return(e=!this.currentAttributes[t])?this.setCurrentAttribute(t,e):this.removeCurrentAttribute(t)},d.prototype.canSetCurrentAttribute=function(t){return i(t)?this.canSetCurrentBlockAttribute(t):this.canSetCurrentTextAttribute(t)},d.prototype.canSetCurrentTextAttribute=function(t){switch(t){case\"href\":return!this.selectionContainsAttachmentWithAttribute(t);default:return!0}},d.prototype.canSetCurrentBlockAttribute=function(){var t;if(t=this.getBlock())return!t.isTerminalBlock()},d.prototype.setCurrentAttribute=function(t,e){return i(t)?this.setBlockAttribute(t,e):(this.setTextAttribute(t,e),this.currentAttributes[t]=e,this.notifyDelegateOfCurrentAttributesChange())},d.prototype.setTextAttribute=function(t,n){var o,i,r,s;if(i=this.getSelectedRange())return r=i[0],o=i[1],r!==o?this.setDocument(this.document.addAttributeAtRange(t,n,i)):\"href\"===t?(s=e.Text.textForStringWithAttributes(n,{href:n}),this.insertText(s)):void 0},d.prototype.setBlockAttribute=function(t,e){var n,o;if(o=this.getSelectedRange())return this.canSetCurrentAttribute(t)?(n=this.getBlock(),this.setDocument(this.document.applyBlockAttributeAtRange(t,e,o)),this.setSelection(o)):void 0},d.prototype.removeCurrentAttribute=function(t){return i(t)?(this.removeBlockAttribute(t),this.updateCurrentAttributes()):(this.removeTextAttribute(t),delete this.currentAttributes[t],this.notifyDelegateOfCurrentAttributesChange())},d.prototype.removeTextAttribute=function(t){var e;if(e=this.getSelectedRange())return this.setDocument(this.document.removeAttributeAtRange(t,e))},d.prototype.removeBlockAttribute=function(t){var e;if(e=this.getSelectedRange())return this.setDocument(this.document.removeAttributeAtRange(t,e))},d.prototype.canDecreaseNestingLevel=function(){var t;return(null!=(t=this.getBlock())?t.getNestingLevel():void 0)>0},d.prototype.canIncreaseNestingLevel=function(){var e,n,o;if(e=this.getBlock())return(null!=(o=i(e.getLastNestableAttribute()))?o.listAttribute:0)?(n=this.getPreviousBlock())?t(n.getListItemAttributes(),e.getListItemAttributes()):void 0:e.getNestingLevel()>0},d.prototype.decreaseNestingLevel=function(){var t;if(t=this.getBlock())return this.setDocument(this.document.replaceBlock(t,t.decreaseNestingLevel()))},d.prototype.increaseNestingLevel=function(){var t;if(t=this.getBlock())return this.setDocument(this.document.replaceBlock(t,t.increaseNestingLevel()))},d.prototype.canDecreaseBlockAttributeLevel=function(){var t;return(null!=(t=this.getBlock())?t.getAttributeLevel():void 0)>0},d.prototype.decreaseBlockAttributeLevel=function(){var t,e;return(t=null!=(e=this.getBlock())?e.getLastAttribute():void 0)?this.removeCurrentAttribute(t):void 0},d.prototype.decreaseListLevel=function(){var t,e,n,o,i,r;for(r=this.getSelectedRange()[0],i=this.document.locationFromPosition(r).index,n=i,t=this.getBlock().getAttributeLevel();(e=this.document.getBlockAtIndex(n+1))&&e.isListItem()&&e.getAttributeLevel()>t;)n++;return r=this.document.positionFromLocation({index:i,offset:0}),o=this.document.positionFromLocation({index:n,offset:0}),this.setDocument(this.document.removeLastListAttributeAtRange([r,o]))},d.prototype.updateCurrentAttributes=function(){var t,e,n,i,r,s;if(s=this.getSelectedRange({ignoreLock:!0})){for(e=this.document.getCommonAttributesAtRange(s),r=o(),n=0,i=r.length;i>n;n++)t=r[n],e[t]||this.canSetCurrentAttribute(t)||(e[t]=!1);if(!a(e,this.currentAttributes))return this.currentAttributes=e,this.notifyDelegateOfCurrentAttributesChange()}},d.prototype.getCurrentAttributes=function(){return n.call({},this.currentAttributes)},d.prototype.getCurrentTextAttributes=function(){var t,e,n,o;t={},n=this.currentAttributes;for(e in n)o=n[e],r(e)&&(t[e]=o);return t},d.prototype.freezeSelection=function(){return this.setCurrentAttribute(\"frozen\",!0)},d.prototype.thawSelection=function(){return this.removeCurrentAttribute(\"frozen\")},d.prototype.hasFrozenSelection=function(){return this.hasCurrentAttribute(\"frozen\")},d.proxyMethod(\"getSelectionManager().getPointRange\"),d.proxyMethod(\"getSelectionManager().setLocationRangeFromPointRange\"),d.proxyMethod(\"getSelectionManager().locationIsCursorTarget\"),d.proxyMethod(\"getSelectionManager().selectionIsExpanded\"),d.proxyMethod(\"delegate?.getSelectionManager\"),d.prototype.setSelection=function(t){var e,n;return e=this.document.locationRangeFromRange(t),null!=(n=this.delegate)?n.compositionDidRequestChangingSelectionToLocationRange(e):void 0},d.prototype.getSelectedRange=function(){var t;return(t=this.getLocationRange())?this.document.rangeFromLocationRange(t):void 0},d.prototype.setSelectedRange=function(t){var e;return e=this.document.locationRangeFromRange(t),this.getSelectionManager().setLocationRange(e)},d.prototype.getPosition=function(){var t;return(t=this.getLocationRange())?this.document.positionFromLocation(t[0]):void 0},d.prototype.getLocationRange=function(t){var e;return null!=(e=this.getSelectionManager().getLocationRange(t))?e:s({index:0,offset:0})},d.prototype.getExpandedRangeInDirection=function(t){var e,n,o;return n=this.getSelectedRange(),o=n[0],e=n[1],\"backward\"===t?o=this.translateUTF16PositionFromOffset(o,-1):e=this.translateUTF16PositionFromOffset(e,1),s([o,e])},d.prototype.moveCursorInDirection=function(t){var e,n,o,i;return this.editingAttachment?o=this.document.getRangeOfAttachment(this.editingAttachment):(i=this.getSelectedRange(),o=this.getExpandedRangeInDirection(t),n=!c(i,o)),this.setSelectedRange(\"backward\"===t?o[0]:o[1]),n&&(e=this.getAttachmentAtRange(o))?this.editAttachment(e):void 0},d.prototype.expandSelectionInDirection=function(t){var e;return e=this.getExpandedRangeInDirection(t),this.setSelectedRange(e)},d.prototype.expandSelectionForEditing=function(){return this.hasCurrentAttribute(\"href\")?this.expandSelectionAroundCommonAttribute(\"href\"):void 0},d.prototype.expandSelectionAroundCommonAttribute=function(t){var e,n;return e=this.getPosition(),n=this.document.getRangeOfCommonAttributeAtPosition(t,e),this.setSelectedRange(n)},d.prototype.selectionContainsAttachmentWithAttribute=function(t){var e,n,o,i,r;if(r=this.getSelectedRange()){for(i=this.document.getDocumentAtRange(r).getAttachments(),n=0,o=i.length;o>n;n++)if(e=i[n],e.hasAttribute(t))return!0;return!1}},d.prototype.selectionIsInCursorTarget=function(){return this.editingAttachment||this.positionIsCursorTarget(this.getPosition())},d.prototype.positionIsCursorTarget=function(t){var e;return(e=this.document.locationFromPosition(t))?this.locationIsCursorTarget(e):void 0},d.prototype.positionIsBlockBreak=function(t){var e;return null!=(e=this.document.getPieceAtPosition(t))?e.isBlockBreak():void 0},d.prototype.getSelectedDocument=function(){var t;return(t=this.getSelectedRange())?this.document.getDocumentAtRange(t):void 0},d.prototype.getAttachments=function(){return this.attachments.slice(0)},d.prototype.refreshAttachments=function(){var t,e,n,o,i,r,s,a,u,c,h,p;for(n=this.document.getAttachments(),a=l(this.attachments,n),t=a.added,h=a.removed,this.attachments=n,o=0,r=h.length;r>o;o++)e=h[o],e.delegate=null,null!=(u=this.delegate)&&\"function\"==typeof u.compositionDidRemoveAttachment&&u.compositionDidRemoveAttachment(e);for(p=[],i=0,s=t.length;s>i;i++)e=t[i],e.delegate=this,p.push(null!=(c=this.delegate)&&\"function\"==typeof c.compositionDidAddAttachment?c.compositionDidAddAttachment(e):void 0);return p},d.prototype.attachmentDidChangeAttributes=function(t){var e;return this.revision++,null!=(e=this.delegate)&&\"function\"==typeof e.compositionDidEditAttachment?e.compositionDidEditAttachment(t):void 0},d.prototype.attachmentDidChangePreviewURL=function(t){var e;return this.revision++,null!=(e=this.delegate)&&\"function\"==typeof e.compositionDidChangeAttachmentPreviewURL?e.compositionDidChangeAttachmentPreviewURL(t):void 0},d.prototype.editAttachment=function(t){var e;if(t!==this.editingAttachment)return this.stopEditingAttachment(),this.editingAttachment=t,null!=(e=this.delegate)&&\"function\"==typeof e.compositionDidStartEditingAttachment?e.compositionDidStartEditingAttachment(this.editingAttachment):void 0},d.prototype.stopEditingAttachment=function(){var t;if(this.editingAttachment)return null!=(t=this.delegate)&&\"function\"==typeof t.compositionDidStopEditingAttachment&&t.compositionDidStopEditingAttachment(this.editingAttachment),this.editingAttachment=null},d.prototype.canEditAttachmentCaption=function(){var t;return null!=(t=this.editingAttachment)?t.isPreviewable():void 0},d.prototype.updateAttributesForAttachment=function(t,e){return this.setDocument(this.document.updateAttributesForAttachment(t,e))},d.prototype.removeAttributeForAttachment=function(t,e){return this.setDocument(this.document.removeAttributeForAttachment(t,e))},d.prototype.breakFormattedBlock=function(t){var n,o,i,r,s;return o=t.document,n=t.block,r=t.startPosition,s=[r-1,r],n.getBlockBreakPosition()===t.startLocation.offset?(n.breaksOnReturn()&&\"\\n\"===t.nextCharacter?r+=1:o=o.removeTextAtRange(s),s=[r,r]):\"\\n\"===t.nextCharacter?\"\\n\"===t.previousCharacter?s=[r-1,r+1]:(s=[r,r+1],r+=1):t.startLocation.offset-1!==0&&(r+=1),i=new e.Document([n.removeLastAttribute().copyWithoutText()]),this.setDocument(o.insertDocumentAtRange(i,s)),this.setSelection(r)},d.prototype.getPreviousBlock=function(){var t,e;return(e=this.getLocationRange())&&(t=e[0].index,t>0)?this.document.getBlockAtIndex(t-1):void 0},d.prototype.getBlock=function(){var t;return(t=this.getLocationRange())?this.document.getBlockAtIndex(t[0].index):void 0},d.prototype.getAttachmentAtRange=function(t){var n;return n=this.document.getDocumentAtRange(t),n.toString()===e.OBJECT_REPLACEMENT_CHARACTER+\"\\n\"?n.getAttachments()[0]:void 0},d.prototype.notifyDelegateOfCurrentAttributesChange=function(){var t;return null!=(t=this.delegate)&&\"function\"==typeof t.compositionDidChangeCurrentAttributes?t.compositionDidChangeCurrentAttributes(this.currentAttributes):void 0},d.prototype.notifyDelegateOfInsertionAtRange=function(t){var e;return null!=(e=this.delegate)&&\"function\"==typeof e.compositionDidPerformInsertionAtRange?e.compositionDidPerformInsertionAtRange(t):void 0},d.prototype.translateUTF16PositionFromOffset=function(t,e){var n,o;return o=this.document.toUTF16String(),n=o.offsetFromUCS2Offset(t),o.offsetToUCS2Offset(n+e)},d}(e.BasicObject)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.UndoManager=function(e){function n(t){this.composition=t,this.undoEntries=[],this.redoEntries=[]}var o;return t(n,e),n.prototype.recordUndoEntry=function(t,e){var n,i,r,s,a;return s=null!=e?e:{},i=s.context,n=s.consolidatable,r=this.undoEntries.slice(-1)[0],n&&o(r,t,i)?void 0:(a=this.createEntry({description:t,context:i}),this.undoEntries.push(a),this.redoEntries=[])},n.prototype.undo=function(){var t,e;return(e=this.undoEntries.pop())?(t=this.createEntry(e),this.redoEntries.push(t),this.composition.loadSnapshot(e.snapshot)):void 0},n.prototype.redo=function(){var t,e;return(t=this.redoEntries.pop())?(e=this.createEntry(t),this.undoEntries.push(e),this.composition.loadSnapshot(t.snapshot)):void 0},n.prototype.canUndo=function(){return this.undoEntries.length>0},n.prototype.canRedo=function(){return this.redoEntries.length>0},n.prototype.createEntry=function(t){var e,n,o;return o=null!=t?t:{},n=o.description,e=o.context,{description:null!=n?n.toString():void 0,context:JSON.stringify(e),snapshot:this.composition.getSnapshot()}},o=function(t,e,n){return(null!=t?t.description:void 0)===(null!=e?e.toString():void 0)&&(null!=t?t.context:void 0)===JSON.stringify(n)},n}(e.BasicObject)}.call(this),function(){e.Editor=function(){function t(t,n,o){this.composition=t,this.selectionManager=n,this.element=o,this.undoManager=new e.UndoManager(this.composition)}return t.prototype.loadDocument=function(t){return this.loadSnapshot({document:t,selectedRange:[0,0]})},t.prototype.loadHTML=function(t){return null==t&&(t=\"\"),this.loadDocument(e.Document.fromHTML(t,{referenceElement:this.element}))},t.prototype.loadJSON=function(t){var n,o;return n=t.document,o=t.selectedRange,n=e.Document.fromJSON(n),this.loadSnapshot({document:n,selectedRange:o})},t.prototype.loadSnapshot=function(t){return this.undoManager=new e.UndoManager(this.composition),this.composition.loadSnapshot(t)},t.prototype.getDocument=function(){return this.composition.document},t.prototype.getSelectedDocument=function(){return this.composition.getSelectedDocument()},t.prototype.getSnapshot=function(){return this.composition.getSnapshot()},t.prototype.toJSON=function(){return this.getSnapshot()},t.prototype.deleteInDirection=function(t){return this.composition.deleteInDirection(t)},t.prototype.insertAttachment=function(t){return this.composition.insertAttachment(t)},t.prototype.insertDocument=function(t){return this.composition.insertDocument(t)},t.prototype.insertFile=function(t){return this.composition.insertFile(t)},t.prototype.insertHTML=function(t){return this.composition.insertHTML(t)},t.prototype.insertString=function(t){return this.composition.insertString(t)},t.prototype.insertText=function(t){return this.composition.insertText(t)},t.prototype.insertLineBreak=function(){return this.composition.insertLineBreak()},t.prototype.getSelectedRange=function(){return this.composition.getSelectedRange()},t.prototype.getPosition=function(){return this.composition.getPosition()},t.prototype.getClientRectAtPosition=function(t){var e;return e=this.getDocument().locationRangeFromRange([t,t+1]),this.selectionManager.getClientRectAtLocationRange(e)},t.prototype.expandSelectionInDirection=function(t){return this.composition.expandSelectionInDirection(t)},t.prototype.moveCursorInDirection=function(t){return this.composition.moveCursorInDirection(t)},t.prototype.setSelectedRange=function(t){return this.composition.setSelectedRange(t)},t.prototype.activateAttribute=function(t,e){return null==e&&(e=!0),this.composition.setCurrentAttribute(t,e)},t.prototype.attributeIsActive=function(t){return this.composition.hasCurrentAttribute(t)},t.prototype.canActivateAttribute=function(t){return this.composition.canSetCurrentAttribute(t)},t.prototype.deactivateAttribute=function(t){return this.composition.removeCurrentAttribute(t)},t.prototype.canDecreaseNestingLevel=function(){return this.composition.canDecreaseNestingLevel()},t.prototype.canIncreaseNestingLevel=function(){return this.composition.canIncreaseNestingLevel()\n},t.prototype.decreaseNestingLevel=function(){return this.canDecreaseNestingLevel()?this.composition.decreaseNestingLevel():void 0},t.prototype.increaseNestingLevel=function(){return this.canIncreaseNestingLevel()?this.composition.increaseNestingLevel():void 0},t.prototype.canDecreaseIndentationLevel=function(){return this.canDecreaseNestingLevel()},t.prototype.canIncreaseIndentationLevel=function(){return this.canIncreaseNestingLevel()},t.prototype.decreaseIndentationLevel=function(){return this.decreaseNestingLevel()},t.prototype.increaseIndentationLevel=function(){return this.increaseNestingLevel()},t.prototype.canRedo=function(){return this.undoManager.canRedo()},t.prototype.canUndo=function(){return this.undoManager.canUndo()},t.prototype.recordUndoEntry=function(t,e){var n,o,i;return i=null!=e?e:{},o=i.context,n=i.consolidatable,this.undoManager.recordUndoEntry(t,{context:o,consolidatable:n})},t.prototype.redo=function(){return this.canRedo()?this.undoManager.redo():void 0},t.prototype.undo=function(){return this.canUndo()?this.undoManager.undo():void 0},t}()}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.ManagedAttachment=function(e){function n(t,e){var n;this.attachmentManager=t,this.attachment=e,n=this.attachment,this.id=n.id,this.file=n.file}return t(n,e),n.prototype.remove=function(){return this.attachmentManager.requestRemovalOfAttachment(this.attachment)},n.proxyMethod(\"attachment.getAttribute\"),n.proxyMethod(\"attachment.hasAttribute\"),n.proxyMethod(\"attachment.setAttribute\"),n.proxyMethod(\"attachment.getAttributes\"),n.proxyMethod(\"attachment.setAttributes\"),n.proxyMethod(\"attachment.isPending\"),n.proxyMethod(\"attachment.isPreviewable\"),n.proxyMethod(\"attachment.getURL\"),n.proxyMethod(\"attachment.getHref\"),n.proxyMethod(\"attachment.getFilename\"),n.proxyMethod(\"attachment.getFilesize\"),n.proxyMethod(\"attachment.getFormattedFilesize\"),n.proxyMethod(\"attachment.getExtension\"),n.proxyMethod(\"attachment.getContentType\"),n.proxyMethod(\"attachment.getFile\"),n.proxyMethod(\"attachment.setFile\"),n.proxyMethod(\"attachment.releaseFile\"),n.proxyMethod(\"attachment.getUploadProgress\"),n.proxyMethod(\"attachment.setUploadProgress\"),n}(e.BasicObject)}.call(this),function(){var t=function(t,e){function o(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;e.AttachmentManager=function(n){function o(t){var e,n,o;for(null==t&&(t=[]),this.managedAttachments={},n=0,o=t.length;o>n;n++)e=t[n],this.manageAttachment(e)}return t(o,n),o.prototype.getAttachments=function(){var t,e,n,o;n=this.managedAttachments,o=[];for(e in n)t=n[e],o.push(t);return o},o.prototype.manageAttachment=function(t){var n,o;return null!=(n=this.managedAttachments)[o=t.id]?n[o]:n[o]=new e.ManagedAttachment(this,t)},o.prototype.attachmentIsManaged=function(t){return t.id in this.managedAttachments},o.prototype.requestRemovalOfAttachment=function(t){var e;return this.attachmentIsManaged(t)&&null!=(e=this.delegate)&&\"function\"==typeof e.attachmentManagerDidRequestRemovalOfAttachment?e.attachmentManagerDidRequestRemovalOfAttachment(t):void 0},o.prototype.unmanageAttachment=function(t){var e;return e=this.managedAttachments[t.id],delete this.managedAttachments[t.id],e},o}(e.BasicObject)}.call(this),function(){var t,n,o,i,r,s,a,u,c,l,h;t=e.elementContainsNode,n=e.findChildIndexOfNode,r=e.nodeIsBlockStart,s=e.nodeIsBlockStartComment,i=e.nodeIsBlockContainer,a=e.nodeIsCursorTarget,u=e.nodeIsEmptyTextNode,c=e.nodeIsTextNode,o=e.nodeIsAttachmentElement,l=e.tagName,h=e.walkTree,e.LocationMapper=function(){function e(t){this.element=t}var p,d,f,g;return e.prototype.findLocationFromContainerAndOffset=function(e,o,i){var s,u,l,p,g,m,y;for(m=(null!=i?i:{strict:!0}).strict,u=0,l=!1,p={index:0,offset:0},(s=this.findAttachmentElementParentForNode(e))&&(e=s.parentNode,o=n(s)),y=h(this.element,{usingFilter:f});y.nextNode();){if(g=y.currentNode,g===e&&c(e)){a(g)||(p.offset+=o);break}if(g.parentNode===e){if(u++===o)break}else if(!t(e,g)&&u>0)break;r(g,{strict:m})?(l&&p.index++,p.offset=0,l=!0):p.offset+=d(g)}return p},e.prototype.findContainerAndOffsetFromLocation=function(t){var e,o,s,a,u,l;if(0===t.index&&0===t.offset){for(e=this.element,a=0;e.firstChild;)if(e=e.firstChild,i(e)){a=1;break}return[e,a]}if(u=this.findNodeAndOffsetFromLocation(t),o=u[0],s=u[1],o){if(c(o))e=o,l=o.textContent,a=t.offset-s;else{if(e=o.parentNode,!r(o.previousSibling)&&!i(e))for(;o===e.lastChild&&(o=e,e=e.parentNode,!i(e)););a=n(o),0!==t.offset&&a++}return[e,a]}},e.prototype.findNodeAndOffsetFromLocation=function(t){var e,n,o,i,r,s,u,l;for(u=0,l=this.getSignificantNodesForIndex(t.index),n=0,o=l.length;o>n;n++){if(e=l[n],i=d(e),t.offset<=u+i)if(c(e)){if(r=e,s=u,t.offset===s&&a(r))break}else r||(r=e,s=u);if(u+=i,u>t.offset)break}return[r,s]},e.prototype.findAttachmentElementParentForNode=function(t){for(;t&&t!==this.element;){if(o(t))return t;t=t.parentNode}},e.prototype.getSignificantNodesForIndex=function(t){var e,n,o,i,r;for(o=[],r=h(this.element,{usingFilter:p}),i=!1;r.nextNode();)if(n=r.currentNode,s(n)){if(\"undefined\"!=typeof e&&null!==e?e++:e=0,e===t)i=!0;else if(i)break}else i&&o.push(n);return o},d=function(t){var e;return t.nodeType===Node.TEXT_NODE?a(t)?0:(e=t.textContent,e.length):\"br\"===l(t)||o(t)?1:0},p=function(t){return g(t)===NodeFilter.FILTER_ACCEPT?f(t):NodeFilter.FILTER_REJECT},g=function(t){return u(t)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},f=function(t){return o(t.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},e}()}.call(this),function(){var t,n,o=[].slice;t=e.getDOMRange,n=e.setDOMRange,e.PointMapper=function(){function e(){}return e.prototype.createDOMRangeFromPoint=function(e){var o,i,r,s,a,u,c,l;if(c=e.x,l=e.y,document.caretPositionFromPoint)return a=document.caretPositionFromPoint(c,l),r=a.offsetNode,i=a.offset,o=document.createRange(),o.setStart(r,i),o;if(document.caretRangeFromPoint)return document.caretRangeFromPoint(c,l);if(document.body.createTextRange){s=t();try{u=document.body.createTextRange(),u.moveToPoint(c,l),u.select()}catch(h){}return o=t(),n(s),o}},e.prototype.getClientRectsForDOMRange=function(t){var e,n,i;return n=o.call(t.getClientRects()),i=n[0],e=n[n.length-1],[i,e]},e}()}.call(this),function(){var t,n=function(t,e){return function(){return t.apply(e,arguments)}},o=function(t,e){function n(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty,r=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=e.getDOMRange,e.SelectionChangeObserver=function(e){function i(){this.run=n(this.run,this),this.update=n(this.update,this),this.selectionManagers=[]}var s;return o(i,e),i.prototype.start=function(){return this.started?void 0:(this.started=!0,\"onselectionchange\"in document?document.addEventListener(\"selectionchange\",this.update,!0):this.run())},i.prototype.stop=function(){return this.started?(this.started=!1,document.removeEventListener(\"selectionchange\",this.update,!0)):void 0},i.prototype.registerSelectionManager=function(t){return r.call(this.selectionManagers,t)<0?(this.selectionManagers.push(t),this.start()):void 0},i.prototype.unregisterSelectionManager=function(t){var e;return this.selectionManagers=function(){var n,o,i,r;for(i=this.selectionManagers,r=[],n=0,o=i.length;o>n;n++)e=i[n],e!==t&&r.push(e);return r}.call(this),0===this.selectionManagers.length?this.stop():void 0},i.prototype.notifySelectionManagersOfSelectionChange=function(){var t,e,n,o,i;for(n=this.selectionManagers,o=[],t=0,e=n.length;e>t;t++)i=n[t],o.push(i.selectionDidChange());return o},i.prototype.update=function(){var e;return e=t(),s(e,this.domRange)?void 0:(this.domRange=e,this.notifySelectionManagersOfSelectionChange())},i.prototype.reset=function(){return this.domRange=null,this.update()},i.prototype.run=function(){return this.started?(this.update(),requestAnimationFrame(this.run)):void 0},s=function(t,e){return(null!=t?t.startContainer:void 0)===(null!=e?e.startContainer:void 0)&&(null!=t?t.startOffset:void 0)===(null!=e?e.startOffset:void 0)&&(null!=t?t.endContainer:void 0)===(null!=e?e.endContainer:void 0)&&(null!=t?t.endOffset:void 0)===(null!=e?e.endOffset:void 0)},i}(e.BasicObject),null==e.selectionChangeObserver&&(e.selectionChangeObserver=new e.SelectionChangeObserver)}.call(this),function(){var t,n,o,i,r,s,a,u,c,l,h=function(t,e){return function(){return t.apply(e,arguments)}},p=function(t,e){function n(){this.constructor=t}for(var o in e)d.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},d={}.hasOwnProperty;o=e.getDOMSelection,n=e.getDOMRange,l=e.setDOMRange,t=e.elementContainsNode,s=e.nodeIsCursorTarget,r=e.innerElementIsActive,i=e.handleEvent,a=e.normalizeRange,u=e.rangeIsCollapsed,c=e.rangesAreEqual,e.SelectionManager=function(d){function f(t){this.element=t,this.selectionDidChange=h(this.selectionDidChange,this),this.didMouseDown=h(this.didMouseDown,this),this.locationMapper=new e.LocationMapper(this.element),this.pointMapper=new e.PointMapper,this.lockCount=0,i(\"mousedown\",{onElement:this.element,withCallback:this.didMouseDown})}return p(f,d),f.prototype.getLocationRange=function(t){var e,o;return null==t&&(t={}),e=t.strict===!1?this.createLocationRangeFromDOMRange(n(),{strict:!1}):t.ignoreLock?this.currentLocationRange:null!=(o=this.lockedLocationRange)?o:this.currentLocationRange},f.prototype.setLocationRange=function(t){var e;if(!this.lockedLocationRange)return t=a(t),(e=this.createDOMRangeFromLocationRange(t))?(l(e),this.updateCurrentLocationRange(t)):void 0},f.prototype.setLocationRangeFromPointRange=function(t){var e,n;return t=a(t),n=this.getLocationAtPoint(t[0]),e=this.getLocationAtPoint(t[1]),this.setLocationRange([n,e])},f.prototype.getClientRectAtLocationRange=function(t){var e;return(e=this.createDOMRangeFromLocationRange(t))?this.getClientRectsForDOMRange(e)[1]:void 0},f.prototype.locationIsCursorTarget=function(t){var e,n,o;return o=this.findNodeAndOffsetFromLocation(t),e=o[0],n=o[1],s(e)},f.prototype.lock=function(){return 0===this.lockCount++?(this.updateCurrentLocationRange(),this.lockedLocationRange=this.getLocationRange()):void 0},f.prototype.unlock=function(){var t;return 0===--this.lockCount&&(t=this.lockedLocationRange,this.lockedLocationRange=null,null!=t)?this.setLocationRange(t):void 0},f.prototype.clearSelection=function(){var t;return null!=(t=o())?t.removeAllRanges():void 0},f.prototype.selectionIsCollapsed=function(){var t;return(null!=(t=n())?t.collapsed:void 0)===!0},f.prototype.selectionIsExpanded=function(){return!this.selectionIsCollapsed()},f.proxyMethod(\"locationMapper.findLocationFromContainerAndOffset\"),f.proxyMethod(\"locationMapper.findContainerAndOffsetFromLocation\"),f.proxyMethod(\"locationMapper.findNodeAndOffsetFromLocation\"),f.proxyMethod(\"pointMapper.createDOMRangeFromPoint\"),f.proxyMethod(\"pointMapper.getClientRectsForDOMRange\"),f.prototype.didMouseDown=function(){return this.pauseTemporarily()},f.prototype.pauseTemporarily=function(){var e,n,o,r;return this.paused=!0,n=function(e){return function(){var n,i,s;for(e.paused=!1,clearTimeout(r),i=0,s=o.length;s>i;i++)n=o[i],n.destroy();return t(document,e.element)?e.selectionDidChange():void 0}}(this),r=setTimeout(n,200),o=function(){var t,o,r,s;for(r=[\"mousemove\",\"keydown\"],s=[],t=0,o=r.length;o>t;t++)e=r[t],s.push(i(e,{onElement:document,withCallback:n}));return s}()},f.prototype.selectionDidChange=function(){return this.paused||r(this.element)?void 0:this.updateCurrentLocationRange()},f.prototype.updateCurrentLocationRange=function(t){var e;return(null!=t?t:t=this.createLocationRangeFromDOMRange(n()))&&!c(t,this.currentLocationRange)?(this.currentLocationRange=t,null!=(e=this.delegate)&&\"function\"==typeof e.locationRangeDidChange?e.locationRangeDidChange(this.currentLocationRange.slice(0)):void 0):void 0},f.prototype.createDOMRangeFromLocationRange=function(t){var e,n,o,i;return o=this.findContainerAndOffsetFromLocation(t[0]),n=u(t)?o:null!=(i=this.findContainerAndOffsetFromLocation(t[1]))?i:o,null!=o&&null!=n?(e=document.createRange(),e.setStart.apply(e,o),e.setEnd.apply(e,n),e):void 0},f.prototype.createLocationRangeFromDOMRange=function(t,e){var n,o;if(null!=t&&this.domRangeWithinElement(t)&&(o=this.findLocationFromContainerAndOffset(t.startContainer,t.startOffset,e)))return t.collapsed||(n=this.findLocationFromContainerAndOffset(t.endContainer,t.endOffset,e)),a([o,n])},f.prototype.getLocationAtPoint=function(t){var e,n;return(e=this.createDOMRangeFromPoint(t))&&null!=(n=this.createLocationRangeFromDOMRange(e))?n[0]:void 0},f.prototype.domRangeWithinElement=function(e){return e.collapsed?t(this.element,e.startContainer):t(this.element,e.startContainer)&&t(this.element,e.endContainer)},f}(e.BasicObject)}.call(this),function(){var t,n,o,i=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty,s=[].slice;n=e.rangeIsCollapsed,o=e.rangesAreEqual,t=e.objectsAreEqual,e.EditorController=function(r){function a(t){var n,o;this.editorElement=t.editorElement,n=t.document,o=t.html,this.selectionManager=new e.SelectionManager(this.editorElement),this.selectionManager.delegate=this,this.composition=new e.Composition,this.composition.delegate=this,this.attachmentManager=new e.AttachmentManager(this.composition.getAttachments()),this.attachmentManager.delegate=this,this.inputController=new e.InputController(this.editorElement),this.inputController.delegate=this,this.inputController.responder=this.composition,this.compositionController=new e.CompositionController(this.editorElement,this.composition),this.compositionController.delegate=this,this.toolbarController=new e.ToolbarController(this.editorElement.toolbarElement),this.toolbarController.delegate=this,this.editor=new e.Editor(this.composition,this.selectionManager,this.editorElement),null!=n?this.editor.loadDocument(n):this.editor.loadHTML(o)}return i(a,r),a.prototype.registerSelectionManager=function(){return e.selectionChangeObserver.registerSelectionManager(this.selectionManager)},a.prototype.unregisterSelectionManager=function(){return e.selectionChangeObserver.unregisterSelectionManager(this.selectionManager)},a.prototype.compositionDidChangeDocument=function(){return this.editorElement.notify(\"document-change\"),this.handlingInput?void 0:this.render()},a.prototype.compositionDidChangeCurrentAttributes=function(t){return this.currentAttributes=t,this.toolbarController.updateAttributes(this.currentAttributes),this.updateCurrentActions(),this.editorElement.notify(\"attributes-change\",{attributes:this.currentAttributes})},a.prototype.compositionDidPerformInsertionAtRange=function(t){return this.pasting?this.pastedRange=t:void 0},a.prototype.compositionShouldAcceptFile=function(t){return this.editorElement.notify(\"file-accept\",{file:t})},a.prototype.compositionDidAddAttachment=function(t){var e;return e=this.attachmentManager.manageAttachment(t),this.editorElement.notify(\"attachment-add\",{attachment:e})},a.prototype.compositionDidEditAttachment=function(t){var e;return this.compositionController.rerenderViewForObject(t),e=this.attachmentManager.manageAttachment(t),this.editorElement.notify(\"attachment-edit\",{attachment:e}),this.editorElement.notify(\"change\")},a.prototype.compositionDidChangeAttachmentPreviewURL=function(t){return this.compositionController.invalidateViewForObject(t),this.editorElement.notify(\"change\")},a.prototype.compositionDidRemoveAttachment=function(t){var e;return e=this.attachmentManager.unmanageAttachment(t),this.editorElement.notify(\"attachment-remove\",{attachment:e})},a.prototype.compositionDidStartEditingAttachment=function(t){return this.attachmentLocationRange=this.composition.document.getLocationRangeOfAttachment(t),this.compositionController.installAttachmentEditorForAttachment(t),this.selectionManager.setLocationRange(this.attachmentLocationRange)},a.prototype.compositionDidStopEditingAttachment=function(){return this.compositionController.uninstallAttachmentEditor(),this.attachmentLocationRange=null},a.prototype.compositionDidRequestChangingSelectionToLocationRange=function(t){return!this.loadingSnapshot||this.isFocused()?(this.requestedLocationRange=t,this.compositionRevisionWhenLocationRangeRequested=this.composition.revision,this.handlingInput?void 0:this.render()):void 0},a.prototype.compositionWillLoadSnapshot=function(){return this.loadingSnapshot=!0},a.prototype.compositionDidLoadSnapshot=function(){return this.compositionController.refreshViewCache(),this.render(),this.loadingSnapshot=!1},a.prototype.getSelectionManager=function(){return this.selectionManager},a.proxyMethod(\"getSelectionManager().setLocationRange\"),a.proxyMethod(\"getSelectionManager().getLocationRange\"),a.prototype.attachmentManagerDidRequestRemovalOfAttachment=function(t){return this.removeAttachment(t)},a.prototype.compositionControllerWillSyncDocumentView=function(){return this.inputController.editorWillSyncDocumentView(),this.selectionManager.lock(),this.selectionManager.clearSelection()},a.prototype.compositionControllerDidSyncDocumentView=function(){return this.inputController.editorDidSyncDocumentView(),this.selectionManager.unlock(),this.updateCurrentActions(),this.editorElement.notify(\"sync\")},a.prototype.compositionControllerDidRender=function(){return null!=this.requestedLocationRange&&(this.compositionRevisionWhenLocationRangeRequested===this.composition.revision&&this.selectionManager.setLocationRange(this.requestedLocationRange),this.requestedLocationRange=null,this.compositionRevisionWhenLocationRangeRequested=null),this.renderedCompositionRevision!==this.composition.revision&&(this.composition.updateCurrentAttributes(),this.editorElement.notify(\"render\")),this.renderedCompositionRevision=this.composition.revision},a.prototype.compositionControllerDidFocus=function(){return this.toolbarController.hideDialog(),this.editorElement.notify(\"focus\")},a.prototype.compositionControllerDidBlur=function(){return this.editorElement.notify(\"blur\")},a.prototype.compositionControllerDidSelectAttachment=function(t){return this.composition.editAttachment(t)},a.prototype.compositionControllerDidRequestDeselectingAttachment=function(t){var e,n;return e=null!=(n=this.attachmentLocationRange)?n:this.composition.document.getLocationRangeOfAttachment(t),this.selectionManager.setLocationRange(e[1])},a.prototype.compositionControllerWillUpdateAttachment=function(t){return this.editor.recordUndoEntry(\"Edit Attachment\",{context:t.id,consolidatable:!0})},a.prototype.compositionControllerDidRequestRemovalOfAttachment=function(t){return this.removeAttachment(t)},a.prototype.inputControllerWillHandleInput=function(){return this.handlingInput=!0,this.requestedRender=!1},a.prototype.inputControllerDidRequestRender=function(){return this.requestedRender=!0},a.prototype.inputControllerDidHandleInput=function(){return this.handlingInput=!1,this.requestedRender?(this.requestedRender=!1,this.render()):void 0},a.prototype.inputControllerDidAllowUnhandledInput=function(){return this.editorElement.notify(\"change\")},a.prototype.inputControllerDidRequestReparse=function(){return this.reparse()},a.prototype.inputControllerWillPerformTyping=function(){return this.recordTypingUndoEntry()},a.prototype.inputControllerWillCutText=function(){return this.editor.recordUndoEntry(\"Cut\")},a.prototype.inputControllerWillPasteText=function(){return this.editor.recordUndoEntry(\"Paste\"),this.pasting=!0},a.prototype.inputControllerDidPaste=function(t){var e;return e=this.pastedRange,this.pastedRange=null,this.pasting=null,this.editorElement.notify(\"paste\",{pasteData:t,range:e})},a.prototype.inputControllerWillMoveText=function(){return this.editor.recordUndoEntry(\"Move\")},a.prototype.inputControllerWillAttachFiles=function(){return this.editor.recordUndoEntry(\"Drop Files\")},a.prototype.inputControllerDidReceiveKeyboardCommand=function(t){return this.toolbarController.applyKeyboardCommand(t)},a.prototype.inputControllerDidStartDrag=function(){return this.locationRangeBeforeDrag=this.selectionManager.getLocationRange()},a.prototype.inputControllerDidReceiveDragOverPoint=function(t){return this.selectionManager.setLocationRangeFromPointRange(t)},a.prototype.inputControllerDidCancelDrag=function(){return this.selectionManager.setLocationRange(this.locationRangeBeforeDrag),this.locationRangeBeforeDrag=null},a.prototype.locationRangeDidChange=function(t){return this.composition.updateCurrentAttributes(),this.updateCurrentActions(),this.attachmentLocationRange&&!o(this.attachmentLocationRange,t)&&this.composition.stopEditingAttachment(),this.editorElement.notify(\"selection-change\")},a.prototype.toolbarDidClickButton=function(){return this.getLocationRange()?void 0:this.setLocationRange({index:0,offset:0})},a.prototype.toolbarDidInvokeAction=function(t){return this.invokeAction(t)},a.prototype.toolbarDidToggleAttribute=function(t){return this.recordFormattingUndoEntry(),this.composition.toggleCurrentAttribute(t),this.render(),this.selectionFrozen?void 0:this.editorElement.focus()},a.prototype.toolbarDidUpdateAttribute=function(t,e){return this.recordFormattingUndoEntry(),this.composition.setCurrentAttribute(t,e),this.render(),this.selectionFrozen?void 0:this.editorElement.focus()},a.prototype.toolbarDidRemoveAttribute=function(t){return this.recordFormattingUndoEntry(),this.composition.removeCurrentAttribute(t),this.render(),this.selectionFrozen?void 0:this.editorElement.focus()},a.prototype.toolbarWillShowDialog=function(){return this.composition.expandSelectionForEditing(),this.freezeSelection()},a.prototype.toolbarDidShowDialog=function(t){return this.editorElement.notify(\"toolbar-dialog-show\",{dialogName:t})},a.prototype.toolbarDidHideDialog=function(t){return this.thawSelection(),this.editorElement.focus(),this.editorElement.notify(\"toolbar-dialog-hide\",{dialogName:t})},a.prototype.freezeSelection=function(){return this.selectionFrozen?void 0:(this.selectionManager.lock(),this.composition.freezeSelection(),this.selectionFrozen=!0,this.render())},a.prototype.thawSelection=function(){return this.selectionFrozen?(this.composition.thawSelection(),this.selectionManager.unlock(),this.selectionFrozen=!1,this.render()):void 0},a.prototype.actions={undo:{test:function(){return this.editor.canUndo()},perform:function(){return this.editor.undo()}},redo:{test:function(){return this.editor.canRedo()},perform:function(){return this.editor.redo()}},link:{test:function(){return this.editor.canActivateAttribute(\"href\")}},increaseNestingLevel:{test:function(){return this.editor.canIncreaseNestingLevel()},perform:function(){return this.editor.increaseNestingLevel()&&this.render()}},decreaseNestingLevel:{test:function(){return this.editor.canDecreaseNestingLevel()},perform:function(){return this.editor.decreaseNestingLevel()&&this.render()}},increaseBlockLevel:{test:function(){return this.editor.canIncreaseNestingLevel()},perform:function(){return this.editor.increaseNestingLevel()&&this.render()}},decreaseBlockLevel:{test:function(){return this.editor.canDecreaseNestingLevel()},perform:function(){return this.editor.decreaseNestingLevel()&&this.render()}}},a.prototype.canInvokeAction=function(t){var e,n;return this.actionIsExternal(t)?!0:!!(null!=(e=this.actions[t])&&null!=(n=e.test)?n.call(this):void 0)},a.prototype.invokeAction=function(t){var e,n;return this.actionIsExternal(t)?this.editorElement.notify(\"action-invoke\",{actionName:t}):null!=(e=this.actions[t])&&null!=(n=e.perform)?n.call(this):void 0},a.prototype.actionIsExternal=function(t){return/^x-./.test(t)},a.prototype.getCurrentActions=function(){var t,e;e={};for(t in this.actions)e[t]=this.canInvokeAction(t);return e},a.prototype.updateCurrentActions=function(){var e;return e=this.getCurrentActions(),t(e,this.currentActions)?void 0:(this.currentActions=e,this.toolbarController.updateActions(this.currentActions),this.editorElement.notify(\"actions-change\",{actions:this.currentActions}))},a.prototype.reparse=function(){return this.composition.replaceHTML(this.editorElement.innerHTML)},a.prototype.render=function(){return this.compositionController.render()},a.prototype.removeAttachment=function(t){return this.editor.recordUndoEntry(\"Delete Attachment\"),this.composition.removeAttachment(t),this.render()},a.prototype.recordFormattingUndoEntry=function(){var t;return t=this.selectionManager.getLocationRange(),n(t)?void 0:this.editor.recordUndoEntry(\"Formatting\",{context:this.getUndoContext(),consolidatable:!0})},a.prototype.recordTypingUndoEntry=function(){return this.editor.recordUndoEntry(\"Typing\",{context:this.getUndoContext(this.currentAttributes),consolidatable:!0})},a.prototype.getUndoContext=function(){var t;return t=1<=arguments.length?s.call(arguments,0):[],[this.getLocationContext(),this.getTimeContext()].concat(s.call(t))},a.prototype.getLocationContext=function(){var t;return t=this.selectionManager.getLocationRange(),n(t)?t[0].index:t},a.prototype.getTimeContext=function(){return e.config.undoInterval>0?Math.floor((new Date).getTime()/e.config.undoInterval):0},a.prototype.isFocused=function(){var t;return this.editorElement===(null!=(t=this.editorElement.ownerDocument)?t.activeElement:void 0)},a}(e.Controller)}.call(this),function(){var t,n,o,i,r,s;i=e.makeElement,r=e.selectionElements,s=e.triggerEvent,n=e.handleEvent,o=e.handleEventOnce,t=e.AttachmentView.attachmentSelector,e.registerElement(\"trix-editor\",function(){var a,u,c,l,h,p;return l=0,a=function(t){return!document.querySelector(\":focus\")&&t.hasAttribute(\"autofocus\")&&document.querySelector(\"[autofocus]\")===t?t.focus():void 0},h=function(t){return t.hasAttribute(\"contenteditable\")?void 0:(t.setAttribute(\"contenteditable\",\"\"),o(\"focus\",{onElement:t,withCallback:function(){return u(t)}}))},u=function(t){return c(t),p(t)},c=function(t){return(\"function\"==typeof document.queryCommandSupported?document.queryCommandSupported(\"enableObjectResizing\"):void 0)?(document.execCommand(\"enableObjectResizing\",!1,!1),n(\"mscontrolselect\",{onElement:t,preventDefault:!0})):void 0},p=function(){var t;return(\"function\"==typeof document.queryCommandSupported?document.queryCommandSupported(\"DefaultParagraphSeparator\"):void 0)&&(t=e.config.blockAttributes[\"default\"].tagName,\"div\"===t||\"p\"===t)?document.execCommand(\"DefaultParagraphSeparator\",!1,t):void 0},{defaultCSS:\"%t:empty:not(:focus)::before {\\n  content: attr(placeholder);\\n  color: graytext;\\n}\\n\\n%t a[contenteditable=false] {\\n  cursor: text;\\n}\\n\\n%t img {\\n  max-width: 100%;\\n  height: auto;\\n}\\n\\n%t \"+t+\" figcaption textarea {\\n  resize: none;\\n}\\n\\n%t \"+t+\" figcaption textarea.trix-autoresize-clone {\\n  position: absolute;\\n  left: -9999px;\\n  max-height: 0px;\\n}\\n\\n%t \"+t+'[data-trix-mutable] figcaption:empty::before {\\n  content: \"'+e.config.lang.captionPrompt+'\";\\n  color: graytext;\\n}\\n\\n%t '+r.selector+\" { \"+r.cssText+\" }\",trixId:{get:function(){return this.hasAttribute(\"trix-id\")?this.getAttribute(\"trix-id\"):(this.setAttribute(\"trix-id\",++l),this.trixId)}},toolbarElement:{get:function(){var t,e,n;return this.hasAttribute(\"toolbar\")?null!=(e=this.ownerDocument)?e.getElementById(this.getAttribute(\"toolbar\")):void 0:this.parentElement?(n=\"trix-toolbar-\"+this.trixId,this.setAttribute(\"toolbar\",n),t=i(\"trix-toolbar\",{id:n}),this.parentElement.insertBefore(t,this),t):void 0}},inputElement:{get:function(){var t,e,n;return this.hasAttribute(\"input\")?null!=(n=this.ownerDocument)?n.getElementById(this.getAttribute(\"input\")):void 0:this.parentElement?(e=\"trix-input-\"+this.trixId,this.setAttribute(\"input\",e),t=i(\"input\",{type:\"hidden\",id:e}),this.parentElement.insertBefore(t,this.nextElementSibling),t):void 0}},editor:{get:function(){var t;return null!=(t=this.editorController)?t.editor:void 0}},name:{get:function(){var t;return null!=(t=this.inputElement)?t.name:void 0}},value:{get:function(){var t;return null!=(t=this.inputElement)?t.value:void 0},set:function(t){var e;return this.defaultValue=t,null!=(e=this.editor)?e.loadHTML(this.defaultValue):void 0}},notify:function(t,n){var o;switch(t){case\"document-change\":this.documentChangedSinceLastRender=!0;break;case\"render\":this.documentChangedSinceLastRender&&(this.documentChangedSinceLastRender=!1,this.notify(\"change\"));break;case\"change\":case\"attachment-add\":case\"attachment-edit\":case\"attachment-remove\":null!=(o=this.inputElement)&&(o.value=e.serializeToContentType(this,\"text/html\"))}return this.editorController?s(\"trix-\"+t,{onElement:this,attributes:n}):void 0},createdCallback:function(){return h(this)},attachedCallback:function(){return this.hasAttribute(\"data-trix-internal\")?void 0:(null==this.editorController&&(this.editorController=new e.EditorController({editorElement:this,html:this.defaultValue=this.value})),this.editorController.registerSelectionManager(),this.registerResetListener(),a(this),requestAnimationFrame(function(t){return function(){return t.notify(\"initialize\")}}(this)))},detachedCallback:function(){var t;return null!=(t=this.editorController)&&t.unregisterSelectionManager(),this.unregisterResetListener()},registerResetListener:function(){return this.resetListener=this.resetBubbled.bind(this),window.addEventListener(\"reset\",this.resetListener,!1)},unregisterResetListener:function(){return window.removeEventListener(\"reset\",this.resetListener,!1)},resetBubbled:function(t){var e;return t.target!==(null!=(e=this.inputElement)?e.form:void 0)||t.defaultPrevented?void 0:this.reset()},reset:function(){return this.value=this.defaultValue}}}())}.call(this),function(){}.call(this)}).call(this),\"object\"==typeof module&&module.exports?module.exports=e:\"function\"==\"function\"&&__webpack_require__(/*! !webpack amd options */ \"./node_modules/webpack/buildin/amd-options.js\")&&!(__WEBPACK_AMD_DEFINE_FACTORY__ = (e),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__))}.call(this);\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../timers-browserify/main.js */ \"./node_modules/timers-browserify/main.js\").setImmediate))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdHJpeC9kaXN0L3RyaXguanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvdHJpeC9kaXN0L3RyaXguanM/YWQ3ZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuVHJpeCAwLjEwLjFcbkNvcHlyaWdodCDCqSAyMDE3IEJhc2VjYW1wLCBMTENcbmh0dHA6Ly90cml4LWVkaXRvci5vcmcvXG4gKi9cbihmdW5jdGlvbigpe30pLmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdDtudWxsPT13aW5kb3cuU2V0JiYod2luZG93LlNldD10PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMuY2xlYXIoKX1yZXR1cm4gdC5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52YWx1ZXM9W119LHQucHJvdG90eXBlLmhhcz1mdW5jdGlvbih0KXtyZXR1cm4tMSE9PXRoaXMudmFsdWVzLmluZGV4T2YodCl9LHQucHJvdG90eXBlLmFkZD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5oYXModCl8fHRoaXMudmFsdWVzLnB1c2godCksdGhpc30sdC5wcm90b3R5cGVbXCJkZWxldGVcIl09ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuLTE9PT0oZT10aGlzLnZhbHVlcy5pbmRleE9mKHQpKT8hMToodGhpcy52YWx1ZXMuc3BsaWNlKGUsMSksITApfSx0LnByb3RvdHlwZS5mb3JFYWNoPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuKHQ9dGhpcy52YWx1ZXMpLmZvckVhY2guYXBwbHkodCxhcmd1bWVudHMpfSx0fSgpKX0uY2FsbCh0aGlzKSxmdW5jdGlvbih0KXtmdW5jdGlvbiBlKCl7fWZ1bmN0aW9uIG4odCxlKXtyZXR1cm4gZnVuY3Rpb24oKXt0LmFwcGx5KGUsYXJndW1lbnRzKX19ZnVuY3Rpb24gbyh0KXtpZihcIm9iamVjdFwiIT10eXBlb2YgdGhpcyl0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJvbWlzZXMgbXVzdCBiZSBjb25zdHJ1Y3RlZCB2aWEgbmV3XCIpO2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIHQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIm5vdCBhIGZ1bmN0aW9uXCIpO3RoaXMuX3N0YXRlPTAsdGhpcy5faGFuZGxlZD0hMSx0aGlzLl92YWx1ZT12b2lkIDAsdGhpcy5fZGVmZXJyZWRzPVtdLGModCx0aGlzKX1mdW5jdGlvbiBpKHQsZSl7Zm9yKDszPT09dC5fc3RhdGU7KXQ9dC5fdmFsdWU7cmV0dXJuIDA9PT10Ll9zdGF0ZT92b2lkIHQuX2RlZmVycmVkcy5wdXNoKGUpOih0Ll9oYW5kbGVkPSEwLHZvaWQgaChmdW5jdGlvbigpe3ZhciBuPTE9PT10Ll9zdGF0ZT9lLm9uRnVsZmlsbGVkOmUub25SZWplY3RlZDtpZihudWxsPT09bilyZXR1cm4gdm9pZCgxPT09dC5fc3RhdGU/cjpzKShlLnByb21pc2UsdC5fdmFsdWUpO3ZhciBvO3RyeXtvPW4odC5fdmFsdWUpfWNhdGNoKGkpe3JldHVybiB2b2lkIHMoZS5wcm9taXNlLGkpfXIoZS5wcm9taXNlLG8pfSkpfWZ1bmN0aW9uIHIodCxlKXt0cnl7aWYoZT09PXQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkEgcHJvbWlzZSBjYW5ub3QgYmUgcmVzb2x2ZWQgd2l0aCBpdHNlbGYuXCIpO2lmKGUmJihcIm9iamVjdFwiPT10eXBlb2YgZXx8XCJmdW5jdGlvblwiPT10eXBlb2YgZSkpe3ZhciBpPWUudGhlbjtpZihlIGluc3RhbmNlb2YgbylyZXR1cm4gdC5fc3RhdGU9Myx0Ll92YWx1ZT1lLHZvaWQgYSh0KTtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBpKXJldHVybiB2b2lkIGMobihpLGUpLHQpfXQuX3N0YXRlPTEsdC5fdmFsdWU9ZSxhKHQpfWNhdGNoKHIpe3ModCxyKX19ZnVuY3Rpb24gcyh0LGUpe3QuX3N0YXRlPTIsdC5fdmFsdWU9ZSxhKHQpfWZ1bmN0aW9uIGEodCl7Mj09PXQuX3N0YXRlJiYwPT09dC5fZGVmZXJyZWRzLmxlbmd0aCYmc2V0VGltZW91dChmdW5jdGlvbigpe3QuX2hhbmRsZWR8fHAodC5fdmFsdWUpfSwxKTtmb3IodmFyIGU9MCxuPXQuX2RlZmVycmVkcy5sZW5ndGg7bj5lO2UrKylpKHQsdC5fZGVmZXJyZWRzW2VdKTt0Ll9kZWZlcnJlZHM9bnVsbH1mdW5jdGlvbiB1KHQsZSxuKXt0aGlzLm9uRnVsZmlsbGVkPVwiZnVuY3Rpb25cIj09dHlwZW9mIHQ/dDpudWxsLHRoaXMub25SZWplY3RlZD1cImZ1bmN0aW9uXCI9PXR5cGVvZiBlP2U6bnVsbCx0aGlzLnByb21pc2U9bn1mdW5jdGlvbiBjKHQsZSl7dmFyIG49ITE7dHJ5e3QoZnVuY3Rpb24odCl7bnx8KG49ITAscihlLHQpKX0sZnVuY3Rpb24odCl7bnx8KG49ITAscyhlLHQpKX0pfWNhdGNoKG8pe2lmKG4pcmV0dXJuO249ITAscyhlLG8pfX12YXIgbD1zZXRUaW1lb3V0LGg9XCJmdW5jdGlvblwiPT10eXBlb2Ygc2V0SW1tZWRpYXRlJiZzZXRJbW1lZGlhdGV8fGZ1bmN0aW9uKHQpe2wodCwxKX0scD1mdW5jdGlvbih0KXtcInVuZGVmaW5lZFwiIT10eXBlb2YgY29uc29sZSYmY29uc29sZSYmY29uc29sZS53YXJuKFwiUG9zc2libGUgVW5oYW5kbGVkIFByb21pc2UgUmVqZWN0aW9uOlwiLHQpfTtvLnByb3RvdHlwZVtcImNhdGNoXCJdPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRoZW4obnVsbCx0KX0sby5wcm90b3R5cGUudGhlbj1mdW5jdGlvbih0LG4pe3ZhciByPW5ldyBvKGUpO3JldHVybiBpKHRoaXMsbmV3IHUodCxuLHIpKSxyfSxvLmFsbD1mdW5jdGlvbih0KXt2YXIgZT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0KTtyZXR1cm4gbmV3IG8oZnVuY3Rpb24odCxuKXtmdW5jdGlvbiBvKHIscyl7dHJ5e2lmKHMmJihcIm9iamVjdFwiPT10eXBlb2Ygc3x8XCJmdW5jdGlvblwiPT10eXBlb2Ygcykpe3ZhciBhPXMudGhlbjtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBhKXJldHVybiB2b2lkIGEuY2FsbChzLGZ1bmN0aW9uKHQpe28ocix0KX0sbil9ZVtyXT1zLDA9PT0tLWkmJnQoZSl9Y2F0Y2godSl7bih1KX19aWYoMD09PWUubGVuZ3RoKXJldHVybiB0KFtdKTtmb3IodmFyIGk9ZS5sZW5ndGgscj0wO3I8ZS5sZW5ndGg7cisrKW8ocixlW3JdKX0pfSxvLnJlc29sdmU9ZnVuY3Rpb24odCl7cmV0dXJuIHQmJlwib2JqZWN0XCI9PXR5cGVvZiB0JiZ0LmNvbnN0cnVjdG9yPT09bz90Om5ldyBvKGZ1bmN0aW9uKGUpe2UodCl9KX0sby5yZWplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvKGZ1bmN0aW9uKGUsbil7bih0KX0pfSxvLnJhY2U9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBvKGZ1bmN0aW9uKGUsbil7Zm9yKHZhciBvPTAsaT10Lmxlbmd0aDtpPm87bysrKXRbb10udGhlbihlLG4pfSl9LG8uX3NldEltbWVkaWF0ZUZuPWZ1bmN0aW9uKHQpe2g9dH0sby5fc2V0VW5oYW5kbGVkUmVqZWN0aW9uRm49ZnVuY3Rpb24odCl7cD10fSxcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1vOnQuUHJvbWlzZXx8KHQuUHJvbWlzZT1vKX0odGhpcyksLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IChjKSAyMDE0IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbiAqIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4gKiBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG5cInVuZGVmaW5lZFwiPT10eXBlb2YgV2Vha01hcCYmIWZ1bmN0aW9uKCl7dmFyIHQ9T2JqZWN0LmRlZmluZVByb3BlcnR5LGU9RGF0ZS5ub3coKSUxZTksbj1mdW5jdGlvbigpe3RoaXMubmFtZT1cIl9fc3RcIisoMWU5Kk1hdGgucmFuZG9tKCk+Pj4wKSsoZSsrICtcIl9fXCIpfTtuLnByb3RvdHlwZT17c2V0OmZ1bmN0aW9uKGUsbil7dmFyIG89ZVt0aGlzLm5hbWVdO3JldHVybiBvJiZvWzBdPT09ZT9vWzFdPW46dChlLHRoaXMubmFtZSx7dmFsdWU6W2Usbl0sd3JpdGFibGU6ITB9KSx0aGlzfSxnZXQ6ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuKGU9dFt0aGlzLm5hbWVdKSYmZVswXT09PXQ/ZVsxXTp2b2lkIDB9LFwiZGVsZXRlXCI6ZnVuY3Rpb24odCl7dmFyIGU9dFt0aGlzLm5hbWVdO3JldHVybiBlJiZlWzBdPT09dD8oZVswXT1lWzFdPXZvaWQgMCwhMCk6ITF9LGhhczpmdW5jdGlvbih0KXt2YXIgZT10W3RoaXMubmFtZV07cmV0dXJuIGU/ZVswXT09PXQ6ITF9fSx3aW5kb3cuV2Vha01hcD1ufSgpLGZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUodCl7QS5wdXNoKHQpLGJ8fChiPSEwLGcobykpfWZ1bmN0aW9uIG4odCl7cmV0dXJuIHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCYmd2luZG93LlNoYWRvd0RPTVBvbHlmaWxsLndyYXBJZk5lZWRlZCh0KXx8dH1mdW5jdGlvbiBvKCl7Yj0hMTt2YXIgdD1BO0E9W10sdC5zb3J0KGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQudWlkXy1lLnVpZF99KTt2YXIgZT0hMTt0LmZvckVhY2goZnVuY3Rpb24odCl7dmFyIG49dC50YWtlUmVjb3JkcygpO2kodCksbi5sZW5ndGgmJih0LmNhbGxiYWNrXyhuLHQpLGU9ITApfSksZSYmbygpfWZ1bmN0aW9uIGkodCl7dC5ub2Rlc18uZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgbj1tLmdldChlKTtuJiZuLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5vYnNlcnZlcj09PXQmJmUucmVtb3ZlVHJhbnNpZW50T2JzZXJ2ZXJzKCl9KX0pfWZ1bmN0aW9uIHIodCxlKXtmb3IodmFyIG49dDtuO249bi5wYXJlbnROb2RlKXt2YXIgbz1tLmdldChuKTtpZihvKWZvcih2YXIgaT0wO2k8by5sZW5ndGg7aSsrKXt2YXIgcj1vW2ldLHM9ci5vcHRpb25zO2lmKG49PT10fHxzLnN1YnRyZWUpe3ZhciBhPWUocyk7YSYmci5lbnF1ZXVlKGEpfX19fWZ1bmN0aW9uIHModCl7dGhpcy5jYWxsYmFja189dCx0aGlzLm5vZGVzXz1bXSx0aGlzLnJlY29yZHNfPVtdLHRoaXMudWlkXz0rK0N9ZnVuY3Rpb24gYSh0LGUpe3RoaXMudHlwZT10LHRoaXMudGFyZ2V0PWUsdGhpcy5hZGRlZE5vZGVzPVtdLHRoaXMucmVtb3ZlZE5vZGVzPVtdLHRoaXMucHJldmlvdXNTaWJsaW5nPW51bGwsdGhpcy5uZXh0U2libGluZz1udWxsLHRoaXMuYXR0cmlidXRlTmFtZT1udWxsLHRoaXMuYXR0cmlidXRlTmFtZXNwYWNlPW51bGwsdGhpcy5vbGRWYWx1ZT1udWxsfWZ1bmN0aW9uIHUodCl7dmFyIGU9bmV3IGEodC50eXBlLHQudGFyZ2V0KTtyZXR1cm4gZS5hZGRlZE5vZGVzPXQuYWRkZWROb2Rlcy5zbGljZSgpLGUucmVtb3ZlZE5vZGVzPXQucmVtb3ZlZE5vZGVzLnNsaWNlKCksZS5wcmV2aW91c1NpYmxpbmc9dC5wcmV2aW91c1NpYmxpbmcsZS5uZXh0U2libGluZz10Lm5leHRTaWJsaW5nLGUuYXR0cmlidXRlTmFtZT10LmF0dHJpYnV0ZU5hbWUsZS5hdHRyaWJ1dGVOYW1lc3BhY2U9dC5hdHRyaWJ1dGVOYW1lc3BhY2UsZS5vbGRWYWx1ZT10Lm9sZFZhbHVlLGV9ZnVuY3Rpb24gYyh0LGUpe3JldHVybiB3PW5ldyBhKHQsZSl9ZnVuY3Rpb24gbCh0KXtyZXR1cm4geD94Oih4PXUodykseC5vbGRWYWx1ZT10LHgpfWZ1bmN0aW9uIGgoKXt3PXg9dm9pZCAwfWZ1bmN0aW9uIHAodCl7cmV0dXJuIHQ9PT14fHx0PT09d31mdW5jdGlvbiBkKHQsZSl7cmV0dXJuIHQ9PT1lP3Q6eCYmcCh0KT94Om51bGx9ZnVuY3Rpb24gZih0LGUsbil7dGhpcy5vYnNlcnZlcj10LHRoaXMudGFyZ2V0PWUsdGhpcy5vcHRpb25zPW4sdGhpcy50cmFuc2llbnRPYnNlcnZlZE5vZGVzPVtdfWlmKCF0LkpzTXV0YXRpb25PYnNlcnZlcil7dmFyIGcsbT1uZXcgV2Vha01hcDtpZigvVHJpZGVudHxFZGdlLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKWc9c2V0VGltZW91dDtlbHNlIGlmKHdpbmRvdy5zZXRJbW1lZGlhdGUpZz13aW5kb3cuc2V0SW1tZWRpYXRlO2Vsc2V7dmFyIHk9W10sdj1TdHJpbmcoTWF0aC5yYW5kb20oKSk7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsZnVuY3Rpb24odCl7aWYodC5kYXRhPT09dil7dmFyIGU9eTt5PVtdLGUuZm9yRWFjaChmdW5jdGlvbih0KXt0KCl9KX19KSxnPWZ1bmN0aW9uKHQpe3kucHVzaCh0KSx3aW5kb3cucG9zdE1lc3NhZ2UodixcIipcIil9fXZhciBiPSExLEE9W10sQz0wO3MucHJvdG90eXBlPXtvYnNlcnZlOmZ1bmN0aW9uKHQsZSl7aWYodD1uKHQpLCFlLmNoaWxkTGlzdCYmIWUuYXR0cmlidXRlcyYmIWUuY2hhcmFjdGVyRGF0YXx8ZS5hdHRyaWJ1dGVPbGRWYWx1ZSYmIWUuYXR0cmlidXRlc3x8ZS5hdHRyaWJ1dGVGaWx0ZXImJmUuYXR0cmlidXRlRmlsdGVyLmxlbmd0aCYmIWUuYXR0cmlidXRlc3x8ZS5jaGFyYWN0ZXJEYXRhT2xkVmFsdWUmJiFlLmNoYXJhY3RlckRhdGEpdGhyb3cgbmV3IFN5bnRheEVycm9yO3ZhciBvPW0uZ2V0KHQpO298fG0uc2V0KHQsbz1bXSk7Zm9yKHZhciBpLHI9MDtyPG8ubGVuZ3RoO3IrKylpZihvW3JdLm9ic2VydmVyPT09dGhpcyl7aT1vW3JdLGkucmVtb3ZlTGlzdGVuZXJzKCksaS5vcHRpb25zPWU7YnJlYWt9aXx8KGk9bmV3IGYodGhpcyx0LGUpLG8ucHVzaChpKSx0aGlzLm5vZGVzXy5wdXNoKHQpKSxpLmFkZExpc3RlbmVycygpfSxkaXNjb25uZWN0OmZ1bmN0aW9uKCl7dGhpcy5ub2Rlc18uZm9yRWFjaChmdW5jdGlvbih0KXtmb3IodmFyIGU9bS5nZXQodCksbj0wO248ZS5sZW5ndGg7bisrKXt2YXIgbz1lW25dO2lmKG8ub2JzZXJ2ZXI9PT10aGlzKXtvLnJlbW92ZUxpc3RlbmVycygpLGUuc3BsaWNlKG4sMSk7YnJlYWt9fX0sdGhpcyksdGhpcy5yZWNvcmRzXz1bXX0sdGFrZVJlY29yZHM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnJlY29yZHNfO3JldHVybiB0aGlzLnJlY29yZHNfPVtdLHR9fTt2YXIgdyx4O2YucHJvdG90eXBlPXtlbnF1ZXVlOmZ1bmN0aW9uKHQpe3ZhciBuPXRoaXMub2JzZXJ2ZXIucmVjb3Jkc18sbz1uLmxlbmd0aDtpZihuLmxlbmd0aD4wKXt2YXIgaT1uW28tMV0scj1kKGksdCk7aWYocilyZXR1cm4gdm9pZChuW28tMV09cil9ZWxzZSBlKHRoaXMub2JzZXJ2ZXIpO25bb109dH0sYWRkTGlzdGVuZXJzOmZ1bmN0aW9uKCl7dGhpcy5hZGRMaXN0ZW5lcnNfKHRoaXMudGFyZ2V0KX0sYWRkTGlzdGVuZXJzXzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLm9wdGlvbnM7ZS5hdHRyaWJ1dGVzJiZ0LmFkZEV2ZW50TGlzdGVuZXIoXCJET01BdHRyTW9kaWZpZWRcIix0aGlzLCEwKSxlLmNoYXJhY3RlckRhdGEmJnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNoYXJhY3RlckRhdGFNb2RpZmllZFwiLHRoaXMsITApLGUuY2hpbGRMaXN0JiZ0LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Ob2RlSW5zZXJ0ZWRcIix0aGlzLCEwKSwoZS5jaGlsZExpc3R8fGUuc3VidHJlZSkmJnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTU5vZGVSZW1vdmVkXCIsdGhpcywhMCl9LHJlbW92ZUxpc3RlbmVyczpmdW5jdGlvbigpe3RoaXMucmVtb3ZlTGlzdGVuZXJzXyh0aGlzLnRhcmdldCl9LHJlbW92ZUxpc3RlbmVyc186ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5vcHRpb25zO2UuYXR0cmlidXRlcyYmdC5yZW1vdmVFdmVudExpc3RlbmVyKFwiRE9NQXR0ck1vZGlmaWVkXCIsdGhpcywhMCksZS5jaGFyYWN0ZXJEYXRhJiZ0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJET01DaGFyYWN0ZXJEYXRhTW9kaWZpZWRcIix0aGlzLCEwKSxlLmNoaWxkTGlzdCYmdC5yZW1vdmVFdmVudExpc3RlbmVyKFwiRE9NTm9kZUluc2VydGVkXCIsdGhpcywhMCksKGUuY2hpbGRMaXN0fHxlLnN1YnRyZWUpJiZ0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJET01Ob2RlUmVtb3ZlZFwiLHRoaXMsITApfSxhZGRUcmFuc2llbnRPYnNlcnZlcjpmdW5jdGlvbih0KXtpZih0IT09dGhpcy50YXJnZXQpe3RoaXMuYWRkTGlzdGVuZXJzXyh0KSx0aGlzLnRyYW5zaWVudE9ic2VydmVkTm9kZXMucHVzaCh0KTt2YXIgZT1tLmdldCh0KTtlfHxtLnNldCh0LGU9W10pLGUucHVzaCh0aGlzKX19LHJlbW92ZVRyYW5zaWVudE9ic2VydmVyczpmdW5jdGlvbigpe3ZhciB0PXRoaXMudHJhbnNpZW50T2JzZXJ2ZWROb2Rlczt0aGlzLnRyYW5zaWVudE9ic2VydmVkTm9kZXM9W10sdC5mb3JFYWNoKGZ1bmN0aW9uKHQpe3RoaXMucmVtb3ZlTGlzdGVuZXJzXyh0KTtmb3IodmFyIGU9bS5nZXQodCksbj0wO248ZS5sZW5ndGg7bisrKWlmKGVbbl09PT10aGlzKXtlLnNwbGljZShuLDEpO2JyZWFrfX0sdGhpcyl9LGhhbmRsZUV2ZW50OmZ1bmN0aW9uKHQpe3N3aXRjaCh0LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHQudHlwZSl7Y2FzZVwiRE9NQXR0ck1vZGlmaWVkXCI6dmFyIGU9dC5hdHRyTmFtZSxuPXQucmVsYXRlZE5vZGUubmFtZXNwYWNlVVJJLG89dC50YXJnZXQsaT1uZXcgYyhcImF0dHJpYnV0ZXNcIixvKTtpLmF0dHJpYnV0ZU5hbWU9ZSxpLmF0dHJpYnV0ZU5hbWVzcGFjZT1uO3ZhciBzPXQuYXR0ckNoYW5nZT09PU11dGF0aW9uRXZlbnQuQURESVRJT04/bnVsbDp0LnByZXZWYWx1ZTtyKG8sZnVuY3Rpb24odCl7cmV0dXJuIXQuYXR0cmlidXRlc3x8dC5hdHRyaWJ1dGVGaWx0ZXImJnQuYXR0cmlidXRlRmlsdGVyLmxlbmd0aCYmLTE9PT10LmF0dHJpYnV0ZUZpbHRlci5pbmRleE9mKGUpJiYtMT09PXQuYXR0cmlidXRlRmlsdGVyLmluZGV4T2Yobik/dm9pZCAwOnQuYXR0cmlidXRlT2xkVmFsdWU/bChzKTppfSk7YnJlYWs7Y2FzZVwiRE9NQ2hhcmFjdGVyRGF0YU1vZGlmaWVkXCI6dmFyIG89dC50YXJnZXQsaT1jKFwiY2hhcmFjdGVyRGF0YVwiLG8pLHM9dC5wcmV2VmFsdWU7cihvLGZ1bmN0aW9uKHQpe3JldHVybiB0LmNoYXJhY3RlckRhdGE/dC5jaGFyYWN0ZXJEYXRhT2xkVmFsdWU/bChzKTppOnZvaWQgMH0pO2JyZWFrO2Nhc2VcIkRPTU5vZGVSZW1vdmVkXCI6dGhpcy5hZGRUcmFuc2llbnRPYnNlcnZlcih0LnRhcmdldCk7Y2FzZVwiRE9NTm9kZUluc2VydGVkXCI6dmFyIGEsdSxwPXQudGFyZ2V0O1wiRE9NTm9kZUluc2VydGVkXCI9PT10LnR5cGU/KGE9W3BdLHU9W10pOihhPVtdLHU9W3BdKTt2YXIgZD1wLnByZXZpb3VzU2libGluZyxmPXAubmV4dFNpYmxpbmcsaT1jKFwiY2hpbGRMaXN0XCIsdC50YXJnZXQucGFyZW50Tm9kZSk7aS5hZGRlZE5vZGVzPWEsaS5yZW1vdmVkTm9kZXM9dSxpLnByZXZpb3VzU2libGluZz1kLGkubmV4dFNpYmxpbmc9ZixyKHQucmVsYXRlZE5vZGUsZnVuY3Rpb24odCl7cmV0dXJuIHQuY2hpbGRMaXN0P2k6dm9pZCAwfSl9aCgpfX0sdC5Kc011dGF0aW9uT2JzZXJ2ZXI9cyx0Lk11dGF0aW9uT2JzZXJ2ZXJ8fCh0Lk11dGF0aW9uT2JzZXJ2ZXI9cyxzLl9pc1BvbHlmaWxsZWQ9ITApfX0oc2VsZiksZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjtpZighd2luZG93LnBlcmZvcm1hbmNlKXt2YXIgdD1EYXRlLm5vdygpO3dpbmRvdy5wZXJmb3JtYW5jZT17bm93OmZ1bmN0aW9uKCl7cmV0dXJuIERhdGUubm93KCktdH19fXdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fCh3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lPWZ1bmN0aW9uKCl7dmFyIHQ9d2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZXx8d2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZTtyZXR1cm4gdD9mdW5jdGlvbihlKXtyZXR1cm4gdChmdW5jdGlvbigpe2UocGVyZm9ybWFuY2Uubm93KCkpfSl9OmZ1bmN0aW9uKHQpe3JldHVybiB3aW5kb3cuc2V0VGltZW91dCh0LDFlMy82MCl9fSgpKSx3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWV8fCh3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWU9ZnVuY3Rpb24oKXtyZXR1cm4gd2luZG93LndlYmtpdENhbmNlbEFuaW1hdGlvbkZyYW1lfHx3aW5kb3cubW96Q2FuY2VsQW5pbWF0aW9uRnJhbWV8fGZ1bmN0aW9uKHQpe2NsZWFyVGltZW91dCh0KX19KCkpO3ZhciBlPWZ1bmN0aW9uKCl7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtyZXR1cm4gdC5pbml0RXZlbnQoXCJmb29cIiwhMCwhMCksdC5wcmV2ZW50RGVmYXVsdCgpLHQuZGVmYXVsdFByZXZlbnRlZH0oKTtpZighZSl7dmFyIG49RXZlbnQucHJvdG90eXBlLnByZXZlbnREZWZhdWx0O0V2ZW50LnByb3RvdHlwZS5wcmV2ZW50RGVmYXVsdD1mdW5jdGlvbigpe3RoaXMuY2FuY2VsYWJsZSYmKG4uY2FsbCh0aGlzKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxcImRlZmF1bHRQcmV2ZW50ZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuITB9LGNvbmZpZ3VyYWJsZTohMH0pKX19dmFyIG89L1RyaWRlbnQvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7aWYoKCF3aW5kb3cuQ3VzdG9tRXZlbnR8fG8mJlwiZnVuY3Rpb25cIiE9dHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCkmJih3aW5kb3cuQ3VzdG9tRXZlbnQ9ZnVuY3Rpb24odCxlKXtlPWV8fHt9O3ZhciBuPWRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiQ3VzdG9tRXZlbnRcIik7cmV0dXJuIG4uaW5pdEN1c3RvbUV2ZW50KHQsQm9vbGVhbihlLmJ1YmJsZXMpLEJvb2xlYW4oZS5jYW5jZWxhYmxlKSxlLmRldGFpbCksbn0sd2luZG93LkN1c3RvbUV2ZW50LnByb3RvdHlwZT13aW5kb3cuRXZlbnQucHJvdG90eXBlKSwhd2luZG93LkV2ZW50fHxvJiZcImZ1bmN0aW9uXCIhPXR5cGVvZiB3aW5kb3cuRXZlbnQpe3ZhciBpPXdpbmRvdy5FdmVudDt3aW5kb3cuRXZlbnQ9ZnVuY3Rpb24odCxlKXtlPWV8fHt9O3ZhciBuPWRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiRXZlbnRcIik7cmV0dXJuIG4uaW5pdEV2ZW50KHQsQm9vbGVhbihlLmJ1YmJsZXMpLEJvb2xlYW4oZS5jYW5jZWxhYmxlKSksbn0sd2luZG93LkV2ZW50LnByb3RvdHlwZT1pLnByb3RvdHlwZX19KHdpbmRvdy5XZWJDb21wb25lbnRzKSx3aW5kb3cuQ3VzdG9tRWxlbWVudHM9d2luZG93LkN1c3RvbUVsZW1lbnRzfHx7ZmxhZ3M6e319LGZ1bmN0aW9uKHQpe3ZhciBlPXQuZmxhZ3Msbj1bXSxvPWZ1bmN0aW9uKHQpe24ucHVzaCh0KX0saT1mdW5jdGlvbigpe24uZm9yRWFjaChmdW5jdGlvbihlKXtlKHQpfSl9O3QuYWRkTW9kdWxlPW8sdC5pbml0aWFsaXplTW9kdWxlcz1pLHQuaGFzTmF0aXZlPUJvb2xlYW4oZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50KSx0LmlzSUU9L1RyaWRlbnQvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksdC51c2VOYXRpdmU9IWUucmVnaXN0ZXImJnQuaGFzTmF0aXZlJiYhd2luZG93LlNoYWRvd0RPTVBvbHlmaWxsJiYoIXdpbmRvdy5IVE1MSW1wb3J0c3x8d2luZG93LkhUTUxJbXBvcnRzLnVzZU5hdGl2ZSl9KHdpbmRvdy5DdXN0b21FbGVtZW50cyksd2luZG93LkN1c3RvbUVsZW1lbnRzLmFkZE1vZHVsZShmdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQsZSl7bih0LGZ1bmN0aW9uKHQpe3JldHVybiBlKHQpPyEwOnZvaWQgbyh0LGUpfSksbyh0LGUpfWZ1bmN0aW9uIG4odCxlLG8pe3ZhciBpPXQuZmlyc3RFbGVtZW50Q2hpbGQ7aWYoIWkpZm9yKGk9dC5maXJzdENoaWxkO2kmJmkubm9kZVR5cGUhPT1Ob2RlLkVMRU1FTlRfTk9ERTspaT1pLm5leHRTaWJsaW5nO2Zvcig7aTspZShpLG8pIT09ITAmJm4oaSxlLG8pLGk9aS5uZXh0RWxlbWVudFNpYmxpbmc7cmV0dXJuIG51bGx9ZnVuY3Rpb24gbyh0LG4pe2Zvcih2YXIgbz10LnNoYWRvd1Jvb3Q7bzspZShvLG4pLG89by5vbGRlclNoYWRvd1Jvb3R9ZnVuY3Rpb24gaSh0LGUpe3IodCxlLFtdKX1mdW5jdGlvbiByKHQsZSxuKXtpZih0PXdpbmRvdy53cmFwKHQpLCEobi5pbmRleE9mKHQpPj0wKSl7bi5wdXNoKHQpO2Zvcih2YXIgbyxpPXQucXVlcnlTZWxlY3RvckFsbChcImxpbmtbcmVsPVwiK3MrXCJdXCIpLGE9MCx1PWkubGVuZ3RoO3U+YSYmKG89aVthXSk7YSsrKW8uaW1wb3J0JiZyKG8uaW1wb3J0LGUsbik7ZSh0KX19dmFyIHM9d2luZG93LkhUTUxJbXBvcnRzP3dpbmRvdy5IVE1MSW1wb3J0cy5JTVBPUlRfTElOS19UWVBFOlwibm9uZVwiO3QuZm9yRG9jdW1lbnRUcmVlPWksdC5mb3JTdWJ0cmVlPWV9KSx3aW5kb3cuQ3VzdG9tRWxlbWVudHMuYWRkTW9kdWxlKGZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUodCxlKXtyZXR1cm4gbih0LGUpfHxvKHQsZSl9ZnVuY3Rpb24gbihlLG4pe3JldHVybiB0LnVwZ3JhZGUoZSxuKT8hMDp2b2lkKG4mJnMoZSkpfWZ1bmN0aW9uIG8odCxlKXtiKHQsZnVuY3Rpb24odCl7cmV0dXJuIG4odCxlKT8hMDp2b2lkIDB9KX1mdW5jdGlvbiBpKHQpe3gucHVzaCh0KSx3fHwodz0hMCxzZXRUaW1lb3V0KHIpKX1mdW5jdGlvbiByKCl7dz0hMTtmb3IodmFyIHQsZT14LG49MCxvPWUubGVuZ3RoO28+biYmKHQ9ZVtuXSk7bisrKXQoKTt4PVtdfWZ1bmN0aW9uIHModCl7Qz9pKGZ1bmN0aW9uKCl7YSh0KX0pOmEodCl9ZnVuY3Rpb24gYSh0KXt0Ll9fdXBncmFkZWRfXyYmIXQuX19hdHRhY2hlZCYmKHQuX19hdHRhY2hlZD0hMCx0LmF0dGFjaGVkQ2FsbGJhY2smJnQuYXR0YWNoZWRDYWxsYmFjaygpKX1mdW5jdGlvbiB1KHQpe2ModCksYih0LGZ1bmN0aW9uKHQpe2ModCl9KX1mdW5jdGlvbiBjKHQpe0M/aShmdW5jdGlvbigpe2wodCl9KTpsKHQpfWZ1bmN0aW9uIGwodCl7dC5fX3VwZ3JhZGVkX18mJnQuX19hdHRhY2hlZCYmKHQuX19hdHRhY2hlZD0hMSx0LmRldGFjaGVkQ2FsbGJhY2smJnQuZGV0YWNoZWRDYWxsYmFjaygpKX1mdW5jdGlvbiBoKHQpe2Zvcih2YXIgZT10LG49d2luZG93LndyYXAoZG9jdW1lbnQpO2U7KXtpZihlPT1uKXJldHVybiEwO2U9ZS5wYXJlbnROb2RlfHxlLm5vZGVUeXBlPT09Tm9kZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFJiZlLmhvc3R9fWZ1bmN0aW9uIHAodCl7aWYodC5zaGFkb3dSb290JiYhdC5zaGFkb3dSb290Ll9fd2F0Y2hlZCl7di5kb20mJmNvbnNvbGUubG9nKFwid2F0Y2hpbmcgc2hhZG93LXJvb3QgZm9yOiBcIix0LmxvY2FsTmFtZSk7Zm9yKHZhciBlPXQuc2hhZG93Um9vdDtlOylnKGUpLGU9ZS5vbGRlclNoYWRvd1Jvb3R9fWZ1bmN0aW9uIGQodCxuKXtpZih2LmRvbSl7dmFyIG89blswXTtpZihvJiZcImNoaWxkTGlzdFwiPT09by50eXBlJiZvLmFkZGVkTm9kZXMmJm8uYWRkZWROb2Rlcyl7Zm9yKHZhciBpPW8uYWRkZWROb2Rlc1swXTtpJiZpIT09ZG9jdW1lbnQmJiFpLmhvc3Q7KWk9aS5wYXJlbnROb2RlO3ZhciByPWkmJihpLlVSTHx8aS5fVVJMfHxpLmhvc3QmJmkuaG9zdC5sb2NhbE5hbWUpfHxcIlwiO3I9ci5zcGxpdChcIi8/XCIpLnNoaWZ0KCkuc3BsaXQoXCIvXCIpLnBvcCgpfWNvbnNvbGUuZ3JvdXAoXCJtdXRhdGlvbnMgKCVkKSBbJXNdXCIsbi5sZW5ndGgscnx8XCJcIil9dmFyIHM9aCh0KTtuLmZvckVhY2goZnVuY3Rpb24odCl7XCJjaGlsZExpc3RcIj09PXQudHlwZSYmKEUodC5hZGRlZE5vZGVzLGZ1bmN0aW9uKHQpe3QubG9jYWxOYW1lJiZlKHQscyl9KSxFKHQucmVtb3ZlZE5vZGVzLGZ1bmN0aW9uKHQpe3QubG9jYWxOYW1lJiZ1KHQpfSkpfSksdi5kb20mJmNvbnNvbGUuZ3JvdXBFbmQoKX1mdW5jdGlvbiBmKHQpe2Zvcih0PXdpbmRvdy53cmFwKHQpLHR8fCh0PXdpbmRvdy53cmFwKGRvY3VtZW50KSk7dC5wYXJlbnROb2RlOyl0PXQucGFyZW50Tm9kZTt2YXIgZT10Ll9fb2JzZXJ2ZXI7ZSYmKGQodCxlLnRha2VSZWNvcmRzKCkpLHIoKSl9ZnVuY3Rpb24gZyh0KXtpZighdC5fX29ic2VydmVyKXt2YXIgZT1uZXcgTXV0YXRpb25PYnNlcnZlcihkLmJpbmQodGhpcyx0KSk7ZS5vYnNlcnZlKHQse2NoaWxkTGlzdDohMCxzdWJ0cmVlOiEwfSksdC5fX29ic2VydmVyPWV9fWZ1bmN0aW9uIG0odCl7dD13aW5kb3cud3JhcCh0KSx2LmRvbSYmY29uc29sZS5ncm91cChcInVwZ3JhZGVEb2N1bWVudDogXCIsdC5iYXNlVVJJLnNwbGl0KFwiL1wiKS5wb3AoKSk7dmFyIG49dD09PXdpbmRvdy53cmFwKGRvY3VtZW50KTtlKHQsbiksZyh0KSx2LmRvbSYmY29uc29sZS5ncm91cEVuZCgpfWZ1bmN0aW9uIHkodCl7QSh0LG0pfXZhciB2PXQuZmxhZ3MsYj10LmZvclN1YnRyZWUsQT10LmZvckRvY3VtZW50VHJlZSxDPXdpbmRvdy5NdXRhdGlvbk9ic2VydmVyLl9pc1BvbHlmaWxsZWQmJnZbXCJ0aHJvdHRsZS1hdHRhY2hlZFwiXTt0Lmhhc1BvbHlmaWxsTXV0YXRpb25zPUMsdC5oYXNUaHJvdHRsZWRBdHRhY2hlZD1DO3ZhciB3PSExLHg9W10sRT1BcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsLmJpbmQoQXJyYXkucHJvdG90eXBlLmZvckVhY2gpLFM9RWxlbWVudC5wcm90b3R5cGUuY3JlYXRlU2hhZG93Um9vdDtTJiYoRWxlbWVudC5wcm90b3R5cGUuY3JlYXRlU2hhZG93Um9vdD1mdW5jdGlvbigpe3ZhciB0PVMuY2FsbCh0aGlzKTtyZXR1cm4gd2luZG93LkN1c3RvbUVsZW1lbnRzLndhdGNoU2hhZG93KHRoaXMpLHR9KSx0LndhdGNoU2hhZG93PXAsdC51cGdyYWRlRG9jdW1lbnRUcmVlPXksdC51cGdyYWRlRG9jdW1lbnQ9bSx0LnVwZ3JhZGVTdWJ0cmVlPW8sdC51cGdyYWRlQWxsPWUsdC5hdHRhY2hlZD1zLHQudGFrZVJlY29yZHM9Zn0pLHdpbmRvdy5DdXN0b21FbGVtZW50cy5hZGRNb2R1bGUoZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLG8pe2lmKFwidGVtcGxhdGVcIj09PWUubG9jYWxOYW1lJiZ3aW5kb3cuSFRNTFRlbXBsYXRlRWxlbWVudCYmSFRNTFRlbXBsYXRlRWxlbWVudC5kZWNvcmF0ZSYmSFRNTFRlbXBsYXRlRWxlbWVudC5kZWNvcmF0ZShlKSwhZS5fX3VwZ3JhZGVkX18mJmUubm9kZVR5cGU9PT1Ob2RlLkVMRU1FTlRfTk9ERSl7dmFyIGk9ZS5nZXRBdHRyaWJ1dGUoXCJpc1wiKSxyPXQuZ2V0UmVnaXN0ZXJlZERlZmluaXRpb24oZS5sb2NhbE5hbWUpfHx0LmdldFJlZ2lzdGVyZWREZWZpbml0aW9uKGkpO2lmKHImJihpJiZyLnRhZz09ZS5sb2NhbE5hbWV8fCFpJiYhci5leHRlbmRzKSlyZXR1cm4gbihlLHIsbyl9fWZ1bmN0aW9uIG4oZSxuLGkpe3JldHVybiBzLnVwZ3JhZGUmJmNvbnNvbGUuZ3JvdXAoXCJ1cGdyYWRlOlwiLGUubG9jYWxOYW1lKSxuLmlzJiZlLnNldEF0dHJpYnV0ZShcImlzXCIsbi5pcyksbyhlLG4pLGUuX191cGdyYWRlZF9fPSEwLHIoZSksaSYmdC5hdHRhY2hlZChlKSx0LnVwZ3JhZGVTdWJ0cmVlKGUsaSkscy51cGdyYWRlJiZjb25zb2xlLmdyb3VwRW5kKCksZX1mdW5jdGlvbiBvKHQsZSl7T2JqZWN0Ll9fcHJvdG9fXz90Ll9fcHJvdG9fXz1lLnByb3RvdHlwZTooaSh0LGUucHJvdG90eXBlLGUubmF0aXZlKSx0Ll9fcHJvdG9fXz1lLnByb3RvdHlwZSl9ZnVuY3Rpb24gaSh0LGUsbil7Zm9yKHZhciBvPXt9LGk9ZTtpIT09biYmaSE9PUhUTUxFbGVtZW50LnByb3RvdHlwZTspe2Zvcih2YXIgcixzPU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGkpLGE9MDtyPXNbYV07YSsrKW9bcl18fChPYmplY3QuZGVmaW5lUHJvcGVydHkodCxyLE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaSxyKSksb1tyXT0xKTtpPU9iamVjdC5nZXRQcm90b3R5cGVPZihpKX19ZnVuY3Rpb24gcih0KXt0LmNyZWF0ZWRDYWxsYmFjayYmdC5jcmVhdGVkQ2FsbGJhY2soKX12YXIgcz10LmZsYWdzO3QudXBncmFkZT1lLHQudXBncmFkZVdpdGhEZWZpbml0aW9uPW4sdC5pbXBsZW1lbnRQcm90b3R5cGU9b30pLHdpbmRvdy5DdXN0b21FbGVtZW50cy5hZGRNb2R1bGUoZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLG8pe3ZhciB1PW98fHt9O2lmKCFlKXRocm93IG5ldyBFcnJvcihcImRvY3VtZW50LnJlZ2lzdGVyRWxlbWVudDogZmlyc3QgYXJndW1lbnQgYG5hbWVgIG11c3Qgbm90IGJlIGVtcHR5XCIpO2lmKGUuaW5kZXhPZihcIi1cIik8MCl0aHJvdyBuZXcgRXJyb3IoXCJkb2N1bWVudC5yZWdpc3RlckVsZW1lbnQ6IGZpcnN0IGFyZ3VtZW50ICgnbmFtZScpIG11c3QgY29udGFpbiBhIGRhc2ggKCctJykuIEFyZ3VtZW50IHByb3ZpZGVkIHdhcyAnXCIrU3RyaW5nKGUpK1wiJy5cIik7aWYoaShlKSl0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZXhlY3V0ZSAncmVnaXN0ZXJFbGVtZW50JyBvbiAnRG9jdW1lbnQnOiBSZWdpc3RyYXRpb24gZmFpbGVkIGZvciB0eXBlICdcIitTdHJpbmcoZSkrXCInLiBUaGUgdHlwZSBuYW1lIGlzIGludmFsaWQuXCIpO2lmKGMoZSkpdGhyb3cgbmV3IEVycm9yKFwiRHVwbGljYXRlRGVmaW5pdGlvbkVycm9yOiBhIHR5cGUgd2l0aCBuYW1lICdcIitTdHJpbmcoZSkrXCInIGlzIGFscmVhZHkgcmVnaXN0ZXJlZFwiKTtyZXR1cm4gdS5wcm90b3R5cGV8fCh1LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKEhUTUxFbGVtZW50LnByb3RvdHlwZSkpLHUuX19uYW1lPWUudG9Mb3dlckNhc2UoKSx1LmV4dGVuZHMmJih1LmV4dGVuZHM9dS5leHRlbmRzLnRvTG93ZXJDYXNlKCkpLHUubGlmZWN5Y2xlPXUubGlmZWN5Y2xlfHx7fSx1LmFuY2VzdHJ5PXIodS5leHRlbmRzKSxzKHUpLGEodSksbih1LnByb3RvdHlwZSksbCh1Ll9fbmFtZSx1KSx1LmN0b3I9aCh1KSx1LmN0b3IucHJvdG90eXBlPXUucHJvdG90eXBlLHUucHJvdG90eXBlLmNvbnN0cnVjdG9yPXUuY3Rvcix0LnJlYWR5JiZtKGRvY3VtZW50KSx1LmN0b3J9ZnVuY3Rpb24gbih0KXtpZighdC5zZXRBdHRyaWJ1dGUuX3BvbHlmaWxsZWQpe3ZhciBlPXQuc2V0QXR0cmlidXRlO3Quc2V0QXR0cmlidXRlPWZ1bmN0aW9uKHQsbil7by5jYWxsKHRoaXMsdCxuLGUpfTt2YXIgbj10LnJlbW92ZUF0dHJpYnV0ZTt0LnJlbW92ZUF0dHJpYnV0ZT1mdW5jdGlvbih0KXtvLmNhbGwodGhpcyx0LG51bGwsbil9LHQuc2V0QXR0cmlidXRlLl9wb2x5ZmlsbGVkPSEwfX1mdW5jdGlvbiBvKHQsZSxuKXt0PXQudG9Mb3dlckNhc2UoKTt2YXIgbz10aGlzLmdldEF0dHJpYnV0ZSh0KTtuLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgaT10aGlzLmdldEF0dHJpYnV0ZSh0KTt0aGlzLmF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayYmaSE9PW8mJnRoaXMuYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrKHQsbyxpKX1mdW5jdGlvbiBpKHQpe2Zvcih2YXIgZT0wO2U8Qy5sZW5ndGg7ZSsrKWlmKHQ9PT1DW2VdKXJldHVybiEwfWZ1bmN0aW9uIHIodCl7dmFyIGU9Yyh0KTtyZXR1cm4gZT9yKGUuZXh0ZW5kcykuY29uY2F0KFtlXSk6W119ZnVuY3Rpb24gcyh0KXtmb3IodmFyIGUsbj10LmV4dGVuZHMsbz0wO2U9dC5hbmNlc3RyeVtvXTtvKyspbj1lLmlzJiZlLnRhZzt0LnRhZz1ufHx0Ll9fbmFtZSxuJiYodC5pcz10Ll9fbmFtZSl9ZnVuY3Rpb24gYSh0KXtpZighT2JqZWN0Ll9fcHJvdG9fXyl7dmFyIGU9SFRNTEVsZW1lbnQucHJvdG90eXBlO2lmKHQuaXMpe3ZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodC50YWcpO2U9T2JqZWN0LmdldFByb3RvdHlwZU9mKG4pfWZvcih2YXIgbyxpPXQucHJvdG90eXBlLHI9ITE7aTspaT09ZSYmKHI9ITApLG89T2JqZWN0LmdldFByb3RvdHlwZU9mKGkpLG8mJihpLl9fcHJvdG9fXz1vKSxpPW87cnx8Y29uc29sZS53YXJuKHQudGFnK1wiIHByb3RvdHlwZSBub3QgZm91bmQgaW4gcHJvdG90eXBlIGNoYWluIGZvciBcIit0LmlzKSx0Lm5hdGl2ZT1lfX1mdW5jdGlvbiB1KHQpe3JldHVybiB2KEUodC50YWcpLHQpfWZ1bmN0aW9uIGModCl7cmV0dXJuIHQ/d1t0LnRvTG93ZXJDYXNlKCldOnZvaWQgMH1mdW5jdGlvbiBsKHQsZSl7d1t0XT1lfWZ1bmN0aW9uIGgodCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHUodCl9fWZ1bmN0aW9uIHAodCxlLG4pe3JldHVybiB0PT09eD9kKGUsbik6Uyh0LGUpfWZ1bmN0aW9uIGQodCxlKXt0JiYodD10LnRvTG93ZXJDYXNlKCkpLGUmJihlPWUudG9Mb3dlckNhc2UoKSk7dmFyIG49YyhlfHx0KTtpZihuKXtpZih0PT1uLnRhZyYmZT09bi5pcylyZXR1cm4gbmV3IG4uY3RvcjtpZighZSYmIW4uaXMpcmV0dXJuIG5ldyBuLmN0b3J9dmFyIG87cmV0dXJuIGU/KG89ZCh0KSxvLnNldEF0dHJpYnV0ZShcImlzXCIsZSksbyk6KG89RSh0KSx0LmluZGV4T2YoXCItXCIpPj0wJiZiKG8sSFRNTEVsZW1lbnQpLG8pfWZ1bmN0aW9uIGYodCxlKXt2YXIgbj10W2VdO3RbZV09ZnVuY3Rpb24oKXt2YXIgdD1uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4geSh0KSx0fX12YXIgZyxtPSh0LmlzSUUsdC51cGdyYWRlRG9jdW1lbnRUcmVlKSx5PXQudXBncmFkZUFsbCx2PXQudXBncmFkZVdpdGhEZWZpbml0aW9uLGI9dC5pbXBsZW1lbnRQcm90b3R5cGUsQT10LnVzZU5hdGl2ZSxDPVtcImFubm90YXRpb24teG1sXCIsXCJjb2xvci1wcm9maWxlXCIsXCJmb250LWZhY2VcIixcImZvbnQtZmFjZS1zcmNcIixcImZvbnQtZmFjZS11cmlcIixcImZvbnQtZmFjZS1mb3JtYXRcIixcImZvbnQtZmFjZS1uYW1lXCIsXCJtaXNzaW5nLWdseXBoXCJdLHc9e30seD1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWxcIixFPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQuYmluZChkb2N1bWVudCksUz1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMuYmluZChkb2N1bWVudCk7Zz1PYmplY3QuX19wcm90b19ffHxBP2Z1bmN0aW9uKHQsZSl7cmV0dXJuIHQgaW5zdGFuY2VvZiBlfTpmdW5jdGlvbih0LGUpe2lmKHQgaW5zdGFuY2VvZiBlKXJldHVybiEwO2Zvcih2YXIgbj10O247KXtpZihuPT09ZS5wcm90b3R5cGUpcmV0dXJuITA7bj1uLl9fcHJvdG9fX31yZXR1cm4hMX0sZihOb2RlLnByb3RvdHlwZSxcImNsb25lTm9kZVwiKSxmKGRvY3VtZW50LFwiaW1wb3J0Tm9kZVwiKSxkb2N1bWVudC5yZWdpc3RlckVsZW1lbnQ9ZSxkb2N1bWVudC5jcmVhdGVFbGVtZW50PWQsZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TPXAsdC5yZWdpc3RyeT13LHQuaW5zdGFuY2VvZj1nLHQucmVzZXJ2ZWRUYWdMaXN0PUMsdC5nZXRSZWdpc3RlcmVkRGVmaW5pdGlvbj1jLGRvY3VtZW50LnJlZ2lzdGVyPWRvY3VtZW50LnJlZ2lzdGVyRWxlbWVudH0pLGZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoKXtyKHdpbmRvdy53cmFwKGRvY3VtZW50KSksd2luZG93LkN1c3RvbUVsZW1lbnRzLnJlYWR5PSEwO3ZhciB0PXdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZ1bmN0aW9uKHQpe3NldFRpbWVvdXQodCwxNil9O3QoZnVuY3Rpb24oKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7d2luZG93LkN1c3RvbUVsZW1lbnRzLnJlYWR5VGltZT1EYXRlLm5vdygpLHdpbmRvdy5IVE1MSW1wb3J0cyYmKHdpbmRvdy5DdXN0b21FbGVtZW50cy5lbGFwc2VkPXdpbmRvdy5DdXN0b21FbGVtZW50cy5yZWFkeVRpbWUtd2luZG93LkhUTUxJbXBvcnRzLnJlYWR5VGltZSksZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJXZWJDb21wb25lbnRzUmVhZHlcIix7YnViYmxlczohMH0pKX0pfSl9e3ZhciBuPXQudXNlTmF0aXZlLG89dC5pbml0aWFsaXplTW9kdWxlczt0LmlzSUV9aWYobil7dmFyIGk9ZnVuY3Rpb24oKXt9O3Qud2F0Y2hTaGFkb3c9aSx0LnVwZ3JhZGU9aSx0LnVwZ3JhZGVBbGw9aSx0LnVwZ3JhZGVEb2N1bWVudFRyZWU9aSx0LnVwZ3JhZGVTdWJ0cmVlPWksdC50YWtlUmVjb3Jkcz1pLHQuaW5zdGFuY2VvZj1mdW5jdGlvbih0LGUpe3JldHVybiB0IGluc3RhbmNlb2YgZX19ZWxzZSBvKCk7dmFyIHI9dC51cGdyYWRlRG9jdW1lbnRUcmVlLHM9dC51cGdyYWRlRG9jdW1lbnQ7aWYod2luZG93LndyYXB8fCh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGw/KHdpbmRvdy53cmFwPXdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbC53cmFwSWZOZWVkZWQsd2luZG93LnVud3JhcD13aW5kb3cuU2hhZG93RE9NUG9seWZpbGwudW53cmFwSWZOZWVkZWQpOndpbmRvdy53cmFwPXdpbmRvdy51bndyYXA9ZnVuY3Rpb24odCl7cmV0dXJuIHR9KSx3aW5kb3cuSFRNTEltcG9ydHMmJih3aW5kb3cuSFRNTEltcG9ydHMuX19pbXBvcnRzUGFyc2luZ0hvb2s9ZnVuY3Rpb24odCl7dC5pbXBvcnQmJnMod3JhcCh0LmltcG9ydCkpfSksXCJjb21wbGV0ZVwiPT09ZG9jdW1lbnQucmVhZHlTdGF0ZXx8dC5mbGFncy5lYWdlcillKCk7ZWxzZSBpZihcImludGVyYWN0aXZlXCIhPT1kb2N1bWVudC5yZWFkeVN0YXRlfHx3aW5kb3cuYXR0YWNoRXZlbnR8fHdpbmRvdy5IVE1MSW1wb3J0cyYmIXdpbmRvdy5IVE1MSW1wb3J0cy5yZWFkeSl7dmFyIGE9d2luZG93LkhUTUxJbXBvcnRzJiYhd2luZG93LkhUTUxJbXBvcnRzLnJlYWR5P1wiSFRNTEltcG9ydHNMb2FkZWRcIjpcIkRPTUNvbnRlbnRMb2FkZWRcIjt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihhLGUpfWVsc2UgZSgpfSh3aW5kb3cuQ3VzdG9tRWxlbWVudHMpLGZ1bmN0aW9uKCl7fS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpczsoZnVuY3Rpb24oKXsoZnVuY3Rpb24oKXt0aGlzLlRyaXg9e1ZFUlNJT046XCIwLjEwLjFcIixaRVJPX1dJRFRIX1NQQUNFOlwiXFx1ZmVmZlwiLE5PTl9CUkVBS0lOR19TUEFDRTpcIlxceGEwXCIsT0JKRUNUX1JFUExBQ0VNRU5UX0NIQVJBQ1RFUjpcIlxcdWZmZmNcIixjb25maWc6e319fSkuY2FsbCh0aGlzKX0pLmNhbGwodCk7dmFyIGU9dC5Ucml4OyhmdW5jdGlvbigpeyhmdW5jdGlvbigpe2UuQmFzaWNPYmplY3Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fXZhciBlLG4sbztyZXR1cm4gdC5wcm94eU1ldGhvZD1mdW5jdGlvbih0KXt2YXIgbyxpLHIscyxhO3JldHVybiByPW4odCksbz1yLm5hbWUscz1yLnRvTWV0aG9kLGE9ci50b1Byb3BlcnR5LGk9ci5vcHRpb25hbCx0aGlzLnByb3RvdHlwZVtvXT1mdW5jdGlvbigpe3ZhciB0LG47cmV0dXJuIHQ9bnVsbCE9cz9pP1wiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXNbc10/dGhpc1tzXSgpOnZvaWQgMDp0aGlzW3NdKCk6bnVsbCE9YT90aGlzW2FdOnZvaWQgMCxpPyhuPW51bGwhPXQ/dFtvXTp2b2lkIDAsbnVsbCE9bj9lLmNhbGwobix0LGFyZ3VtZW50cyk6dm9pZCAwKToobj10W29dLGUuY2FsbChuLHQsYXJndW1lbnRzKSl9fSxuPWZ1bmN0aW9uKHQpe3ZhciBlLG47aWYoIShuPXQubWF0Y2gobykpKXRocm93IG5ldyBFcnJvcihcImNhbid0IHBhcnNlIEBwcm94eU1ldGhvZCBleHByZXNzaW9uOiBcIit0KTtyZXR1cm4gZT17bmFtZTpuWzRdfSxudWxsIT1uWzJdP2UudG9NZXRob2Q9blsxXTplLnRvUHJvcGVydHk9blsxXSxudWxsIT1uWzNdJiYoZS5vcHRpb25hbD0hMCksZX0sZT1GdW5jdGlvbi5wcm90b3R5cGUuYXBwbHksbz0vXiguKz8pKFxcKFxcKSk/KFxcPyk/XFwuKC4rPykkLyx0fSgpfSkuY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbygpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIGkgaW4gZSluLmNhbGwoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIG8ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBvLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LG49e30uaGFzT3duUHJvcGVydHk7ZS5PYmplY3Q9ZnVuY3Rpb24obil7ZnVuY3Rpb24gbygpe3RoaXMuaWQ9KytpfXZhciBpO3JldHVybiB0KG8sbiksaT0wLG8uZnJvbUpTT05TdHJpbmc9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZnJvbUpTT04oSlNPTi5wYXJzZSh0KSl9LG8ucHJvdG90eXBlLmhhc1NhbWVDb25zdHJ1Y3RvckFzPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yPT09KG51bGwhPXQ/dC5jb25zdHJ1Y3Rvcjp2b2lkIDApfSxvLnByb3RvdHlwZS5pc0VxdWFsVG89ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXM9PT10fSxvLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7dmFyIHQsZSxuO3JldHVybiB0PWZ1bmN0aW9uKCl7dmFyIHQsbyxpO289bnVsbCE9KHQ9dGhpcy5jb250ZW50c0Zvckluc3BlY3Rpb24oKSk/dDp7fSxpPVtdO2ZvcihlIGluIG8pbj1vW2VdLGkucHVzaChlK1wiPVwiK24pO3JldHVybiBpfS5jYWxsKHRoaXMpLFwiIzxcIit0aGlzLmNvbnN0cnVjdG9yLm5hbWUrXCI6XCIrdGhpcy5pZCsodC5sZW5ndGg/XCIgXCIrdC5qb2luKFwiLCBcIik6XCJcIikrXCI+XCJ9LG8ucHJvdG90eXBlLmNvbnRlbnRzRm9ySW5zcGVjdGlvbj1mdW5jdGlvbigpe30sby5wcm90b3R5cGUudG9KU09OU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMpfSxvLnByb3RvdHlwZS50b1VURjE2U3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIGUuVVRGMTZTdHJpbmcuYm94KHRoaXMpfSxvLnByb3RvdHlwZS5nZXRDYWNoZUtleT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlkLnRvU3RyaW5nKCl9LG99KGUuQmFzaWNPYmplY3QpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7ZS5leHRlbmQ9ZnVuY3Rpb24odCl7dmFyIGUsbjtmb3IoZSBpbiB0KW49dFtlXSx0aGlzW2VdPW47cmV0dXJuIHRoaXN9fS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7ZS5leHRlbmQoe2RlZmVyOmZ1bmN0aW9uKHQpe3JldHVybiBzZXRUaW1lb3V0KHQsMSl9fSl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuO2UuZXh0ZW5kKHtub3JtYWxpemVTcGFjZXM6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZShSZWdFeHAoXCJcIitlLlpFUk9fV0lEVEhfU1BBQ0UsXCJnXCIpLFwiXCIpLnJlcGxhY2UoUmVnRXhwKFwiXCIrZS5OT05fQlJFQUtJTkdfU1BBQ0UsXCJnXCIpLFwiIFwiKX0sc3VtbWFyaXplU3RyaW5nQ2hhbmdlOmZ1bmN0aW9uKHQsbyl7dmFyIGkscixzLGE7cmV0dXJuIHQ9ZS5VVEYxNlN0cmluZy5ib3godCksbz1lLlVURjE2U3RyaW5nLmJveChvKSxvLmxlbmd0aDx0Lmxlbmd0aD8ocj1uKHQsbyksYT1yWzBdLGk9clsxXSk6KHM9bihvLHQpLGk9c1swXSxhPXNbMV0pLHthZGRlZDppLHJlbW92ZWQ6YX19fSksbj1mdW5jdGlvbihuLG8pe3ZhciBpLHIscyxhLHU7cmV0dXJuIG4uaXNFcXVhbFRvKG8pP1tcIlwiLFwiXCJdOihyPXQobixvKSxhPXIudXRmMTZTdHJpbmcubGVuZ3RoLHM9YT8odT1yLm9mZnNldCxyLGk9bi5jb2RlcG9pbnRzLnNsaWNlKDAsdSkuY29uY2F0KG4uY29kZXBvaW50cy5zbGljZSh1K2EpKSx0KG8sZS5VVEYxNlN0cmluZy5mcm9tQ29kZXBvaW50cyhpKSkpOnQobyxuKSxbci51dGYxNlN0cmluZy50b1N0cmluZygpLHMudXRmMTZTdHJpbmcudG9TdHJpbmcoKV0pfSx0PWZ1bmN0aW9uKHQsZSl7dmFyIG4sbyxpO2ZvcihuPTAsbz10Lmxlbmd0aCxpPWUubGVuZ3RoO28+biYmdC5jaGFyQXQobikuaXNFcXVhbFRvKGUuY2hhckF0KG4pKTspbisrO2Zvcig7bz5uKzEmJnQuY2hhckF0KG8tMSkuaXNFcXVhbFRvKGUuY2hhckF0KGktMSkpOylvLS0saS0tO3JldHVybnt1dGYxNlN0cmluZzp0LnNsaWNlKG4sbyksb2Zmc2V0Om59fX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe2UuZXh0ZW5kKHtjb3B5T2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlLG4sbztudWxsPT10JiYodD17fSksbj17fTtmb3IoZSBpbiB0KW89dFtlXSxuW2VdPW87cmV0dXJuIG59LG9iamVjdHNBcmVFcXVhbDpmdW5jdGlvbih0LGUpe3ZhciBuLG87aWYobnVsbD09dCYmKHQ9e30pLG51bGw9PWUmJihlPXt9KSxPYmplY3Qua2V5cyh0KS5sZW5ndGghPT1PYmplY3Qua2V5cyhlKS5sZW5ndGgpcmV0dXJuITE7Zm9yKG4gaW4gdClpZihvPXRbbl0sbyE9PWVbbl0pcmV0dXJuITE7cmV0dXJuITB9fSl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdD1bXS5zbGljZTtlLmV4dGVuZCh7YXJyYXlzQXJlRXF1YWw6ZnVuY3Rpb24odCxlKXt2YXIgbixvLGkscjtpZihudWxsPT10JiYodD1bXSksbnVsbD09ZSYmKGU9W10pLHQubGVuZ3RoIT09ZS5sZW5ndGgpcmV0dXJuITE7Zm9yKG89bj0wLGk9dC5sZW5ndGg7aT5uO289KytuKWlmKHI9dFtvXSxyIT09ZVtvXSlyZXR1cm4hMTtyZXR1cm4hMH0sYXJyYXlTdGFydHNXaXRoOmZ1bmN0aW9uKHQsbil7cmV0dXJuIG51bGw9PXQmJih0PVtdKSxudWxsPT1uJiYobj1bXSksZS5hcnJheXNBcmVFcXVhbCh0LnNsaWNlKDAsbi5sZW5ndGgpLG4pfSxzcGxpY2VBcnJheTpmdW5jdGlvbigpe3ZhciBlLG4sbztyZXR1cm4gbj1hcmd1bWVudHNbMF0sZT0yPD1hcmd1bWVudHMubGVuZ3RoP3QuY2FsbChhcmd1bWVudHMsMSk6W10sbz1uLnNsaWNlKDApLG8uc3BsaWNlLmFwcGx5KG8sZSksb30sc3VtbWFyaXplQXJyYXlDaGFuZ2U6ZnVuY3Rpb24odCxlKXt2YXIgbixvLGkscixzLGEsdSxjLGwsaCxwO2ZvcihudWxsPT10JiYodD1bXSksbnVsbD09ZSYmKGU9W10pLG49W10saD1bXSxpPW5ldyBTZXQscj0wLHU9dC5sZW5ndGg7dT5yO3IrKylwPXRbcl0saS5hZGQocCk7Zm9yKG89bmV3IFNldCxzPTAsYz1lLmxlbmd0aDtjPnM7cysrKXA9ZVtzXSxvLmFkZChwKSxpLmhhcyhwKXx8bi5wdXNoKHApO2ZvcihhPTAsbD10Lmxlbmd0aDtsPmE7YSsrKXA9dFthXSxvLmhhcyhwKXx8aC5wdXNoKHApO3JldHVybnthZGRlZDpuLHJlbW92ZWQ6aH19fSl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuLG8saTt0PW51bGwsbj1udWxsLGk9bnVsbCxvPW51bGwsZS5leHRlbmQoe2dldEFsbEF0dHJpYnV0ZU5hbWVzOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPXQ/dDp0PWUuZ2V0VGV4dEF0dHJpYnV0ZU5hbWVzKCkuY29uY2F0KGUuZ2V0QmxvY2tBdHRyaWJ1dGVOYW1lcygpKX0sZ2V0QmxvY2tDb25maWc6ZnVuY3Rpb24odCl7cmV0dXJuIGUuY29uZmlnLmJsb2NrQXR0cmlidXRlc1t0XX0sZ2V0QmxvY2tBdHRyaWJ1dGVOYW1lczpmdW5jdGlvbigpe3JldHVybiBudWxsIT1uP246bj1PYmplY3Qua2V5cyhlLmNvbmZpZy5ibG9ja0F0dHJpYnV0ZXMpfSxnZXRUZXh0Q29uZmlnOmZ1bmN0aW9uKHQpe3JldHVybiBlLmNvbmZpZy50ZXh0QXR0cmlidXRlc1t0XX0sZ2V0VGV4dEF0dHJpYnV0ZU5hbWVzOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPWk/aTppPU9iamVjdC5rZXlzKGUuY29uZmlnLnRleHRBdHRyaWJ1dGVzKX0sZ2V0TGlzdEF0dHJpYnV0ZU5hbWVzOmZ1bmN0aW9uKCl7dmFyIHQsbjtyZXR1cm4gbnVsbCE9bz9vOm89ZnVuY3Rpb24oKXt2YXIgbyxpO289ZS5jb25maWcuYmxvY2tBdHRyaWJ1dGVzLGk9W107Zm9yKHQgaW4gbyluPW9bdF0ubGlzdEF0dHJpYnV0ZSxudWxsIT1uJiZpLnB1c2gobik7cmV0dXJuIGl9KCl9fSl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuLG8saSxyLHM9W10uaW5kZXhPZnx8ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsbj10aGlzLmxlbmd0aDtuPmU7ZSsrKWlmKGUgaW4gdGhpcyYmdGhpc1tlXT09PXQpcmV0dXJuIGU7cmV0dXJuLTF9O3Q9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LG49bnVsbCE9KG89bnVsbCE9KGk9bnVsbCE9KHI9dC5tYXRjaGVzU2VsZWN0b3IpP3I6dC53ZWJraXRNYXRjaGVzU2VsZWN0b3IpP2k6dC5tc01hdGNoZXNTZWxlY3Rvcik/bzp0Lm1vek1hdGNoZXNTZWxlY3RvcixlLmV4dGVuZCh7aGFuZGxlRXZlbnQ6ZnVuY3Rpb24obixvKXt2YXIgaSxyLHMsYSx1LGMsbCxoLHAsZCxmLGc7cmV0dXJuIGg9bnVsbCE9bz9vOnt9LGM9aC5vbkVsZW1lbnQsdT1oLm1hdGNoaW5nU2VsZWN0b3IsZz1oLndpdGhDYWxsYmFjayxhPWguaW5QaGFzZSxsPWgucHJldmVudERlZmF1bHQsZD1oLnRpbWVzLHI9bnVsbCE9Yz9jOnQscD11LGk9ZyxmPVwiY2FwdHVyaW5nXCI9PT1hLHM9ZnVuY3Rpb24odCl7dmFyIG47cmV0dXJuIG51bGwhPWQmJjA9PT0tLWQmJnMuZGVzdHJveSgpLG49ZS5maW5kQ2xvc2VzdEVsZW1lbnRGcm9tTm9kZSh0LnRhcmdldCx7bWF0Y2hpbmdTZWxlY3RvcjpwfSksbnVsbCE9biYmKG51bGwhPWcmJmcuY2FsbChuLHQsbiksbCk/dC5wcmV2ZW50RGVmYXVsdCgpOnZvaWQgMH0scy5kZXN0cm95PWZ1bmN0aW9uKCl7cmV0dXJuIHIucmVtb3ZlRXZlbnRMaXN0ZW5lcihuLHMsZil9LHIuYWRkRXZlbnRMaXN0ZW5lcihuLHMsZiksc30saGFuZGxlRXZlbnRPbmNlOmZ1bmN0aW9uKHQsbil7cmV0dXJuIG51bGw9PW4mJihuPXt9KSxuLnRpbWVzPTEsZS5oYW5kbGVFdmVudCh0LG4pfSx0cmlnZ2VyRXZlbnQ6ZnVuY3Rpb24obixvKXt2YXIgaSxyLHMsYSx1LGMsbDtyZXR1cm4gbD1udWxsIT1vP286e30sYz1sLm9uRWxlbWVudCxyPWwuYnViYmxlcyxzPWwuY2FuY2VsYWJsZSxpPWwuYXR0cmlidXRlcyxhPW51bGwhPWM/Yzp0LHI9ciE9PSExLHM9cyE9PSExLHU9ZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudHNcIiksdS5pbml0RXZlbnQobixyLHMpLG51bGwhPWkmJmUuZXh0ZW5kLmNhbGwodSxpKSxhLmRpc3BhdGNoRXZlbnQodSl9LGVsZW1lbnRNYXRjaGVzU2VsZWN0b3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMT09PShudWxsIT10P3Qubm9kZVR5cGU6dm9pZCAwKT9uLmNhbGwodCxlKTp2b2lkIDB9LGZpbmRDbG9zZXN0RWxlbWVudEZyb21Ob2RlOmZ1bmN0aW9uKHQsbil7dmFyIG8saSxyO2ZvcihpPW51bGwhPW4/bjp7fSxvPWkubWF0Y2hpbmdTZWxlY3RvcixyPWkudW50aWxOb2RlO251bGwhPXQmJnQubm9kZVR5cGUhPT1Ob2RlLkVMRU1FTlRfTk9ERTspdD10LnBhcmVudE5vZGU7aWYobnVsbCE9dCl7aWYobnVsbD09bylyZXR1cm4gdDtpZih0LmNsb3Nlc3QmJm51bGw9PXIpcmV0dXJuIHQuY2xvc2VzdChvKTtmb3IoO3QmJnQhPT1yOyl7aWYoZS5lbGVtZW50TWF0Y2hlc1NlbGVjdG9yKHQsbykpcmV0dXJuIHQ7dD10LnBhcmVudE5vZGV9fX0sZmluZElubmVyRWxlbWVudDpmdW5jdGlvbih0KXtmb3IoO251bGwhPXQ/dC5maXJzdEVsZW1lbnRDaGlsZDp2b2lkIDA7KXQ9dC5maXJzdEVsZW1lbnRDaGlsZDtyZXR1cm4gdH0saW5uZXJFbGVtZW50SXNBY3RpdmU6ZnVuY3Rpb24odCl7cmV0dXJuIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQhPT10JiZlLmVsZW1lbnRDb250YWluc05vZGUodCxkb2N1bWVudC5hY3RpdmVFbGVtZW50KX0sZWxlbWVudENvbnRhaW5zTm9kZTpmdW5jdGlvbih0LGUpe2lmKHQmJmUpZm9yKDtlOyl7aWYoZT09PXQpcmV0dXJuITA7ZT1lLnBhcmVudE5vZGV9fSxmaW5kTm9kZUZyb21Db250YWluZXJBbmRPZmZzZXQ6ZnVuY3Rpb24odCxlKXt2YXIgbjtpZih0KXJldHVybiB0Lm5vZGVUeXBlPT09Tm9kZS5URVhUX05PREU/dDowPT09ZT9udWxsIT0obj10LmZpcnN0Q2hpbGQpP246dDp0LmNoaWxkTm9kZXMuaXRlbShlLTEpfSxmaW5kRWxlbWVudEZyb21Db250YWluZXJBbmRPZmZzZXQ6ZnVuY3Rpb24odCxuKXt2YXIgbztyZXR1cm4gbz1lLmZpbmROb2RlRnJvbUNvbnRhaW5lckFuZE9mZnNldCh0LG4pLGUuZmluZENsb3Nlc3RFbGVtZW50RnJvbU5vZGUobyl9LGZpbmRDaGlsZEluZGV4T2ZOb2RlOmZ1bmN0aW9uKHQpe3ZhciBlO2lmKG51bGwhPXQ/dC5wYXJlbnROb2RlOnZvaWQgMCl7Zm9yKGU9MDt0PXQucHJldmlvdXNTaWJsaW5nOyllKys7cmV0dXJuIGV9fSx3YWxrVHJlZTpmdW5jdGlvbih0LGUpe3ZhciBuLG8saSxyLHM7cmV0dXJuIGk9bnVsbCE9ZT9lOnt9LG89aS5vbmx5Tm9kZXNPZlR5cGUscj1pLnVzaW5nRmlsdGVyLG49aS5leHBhbmRFbnRpdHlSZWZlcmVuY2VzLHM9ZnVuY3Rpb24oKXtzd2l0Y2gobyl7Y2FzZVwiZWxlbWVudFwiOnJldHVybiBOb2RlRmlsdGVyLlNIT1dfRUxFTUVOVDtjYXNlXCJ0ZXh0XCI6cmV0dXJuIE5vZGVGaWx0ZXIuU0hPV19URVhUO2Nhc2VcImNvbW1lbnRcIjpyZXR1cm4gTm9kZUZpbHRlci5TSE9XX0NPTU1FTlQ7ZGVmYXVsdDpyZXR1cm4gTm9kZUZpbHRlci5TSE9XX0FMTH19KCksZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcih0LHMsbnVsbCE9cj9yOm51bGwsbj09PSEwKX0sdGFnTmFtZTpmdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gbnVsbCE9dCYmbnVsbCE9KGU9dC50YWdOYW1lKT9lLnRvTG93ZXJDYXNlKCk6dm9pZCAwfSxtYWtlRWxlbWVudDpmdW5jdGlvbih0LGUpe3ZhciBuLG8saSxyLHMsYSx1LGMsbCxoO2lmKG51bGw9PWUmJihlPXt9KSxcIm9iamVjdFwiPT10eXBlb2YgdD8oZT10LHQ9ZS50YWdOYW1lKTplPXthdHRyaWJ1dGVzOmV9LG89ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0KSxudWxsIT1lLmVkaXRhYmxlJiYobnVsbD09ZS5hdHRyaWJ1dGVzJiYoZS5hdHRyaWJ1dGVzPXt9KSxlLmF0dHJpYnV0ZXMuY29udGVudGVkaXRhYmxlPWUuZWRpdGFibGUpLGUuYXR0cmlidXRlcyl7YT1lLmF0dHJpYnV0ZXM7Zm9yKHIgaW4gYSloPWFbcl0sby5zZXRBdHRyaWJ1dGUocixoKX1pZihlLnN0eWxlKXt1PWUuc3R5bGU7Zm9yKHIgaW4gdSloPXVbcl0sby5zdHlsZVtyXT1ofWlmKGUuZGF0YSl7Yz1lLmRhdGE7Zm9yKHIgaW4gYyloPWNbcl0sby5kYXRhc2V0W3JdPWh9aWYoZS5jbGFzc05hbWUpZm9yKGw9ZS5jbGFzc05hbWUuc3BsaXQoXCIgXCIpLGk9MCxzPWwubGVuZ3RoO3M+aTtpKyspbj1sW2ldLG8uY2xhc3NMaXN0LmFkZChuKTtyZXR1cm4gZS50ZXh0Q29udGVudCYmKG8udGV4dENvbnRlbnQ9ZS50ZXh0Q29udGVudCksb30sY2xvbmVGcmFnbWVudDpmdW5jdGlvbih0KXt2YXIgZSxuLG8saSxyO2ZvcihlPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxyPXQuY2hpbGROb2RlcyxuPTAsbz1yLmxlbmd0aDtvPm47bisrKWk9cltuXSxlLmFwcGVuZENoaWxkKGkuY2xvbmVOb2RlKCEwKSk7cmV0dXJuIGV9LG1ha2VGcmFnbWVudDpmdW5jdGlvbih0KXt2YXIgZSxuLG87Zm9yKG51bGw9PXQmJih0PVwiXCIpLGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxlLmlubmVySFRNTD10LG49ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO289ZS5maXJzdENoaWxkOyluLmFwcGVuZENoaWxkKG8pO3JldHVybiBufSxnZXRCbG9ja1RhZ05hbWVzOmZ1bmN0aW9uKCl7dmFyIHQsbjtyZXR1cm4gbnVsbCE9ZS5ibG9ja1RhZ05hbWVzP2UuYmxvY2tUYWdOYW1lczplLmJsb2NrVGFnTmFtZXM9ZnVuY3Rpb24oKXt2YXIgbyxpO289ZS5jb25maWcuYmxvY2tBdHRyaWJ1dGVzLGk9W107Zm9yKHQgaW4gbyluPW9bdF0saS5wdXNoKG4udGFnTmFtZSk7cmV0dXJuIGl9KCl9LG5vZGVJc0Jsb2NrQ29udGFpbmVyOmZ1bmN0aW9uKHQpe3JldHVybiBlLm5vZGVJc0Jsb2NrU3RhcnRDb21tZW50KG51bGwhPXQ/dC5maXJzdENoaWxkOnZvaWQgMCl9LG5vZGVQcm9iYWJseUlzQmxvY2tDb250YWluZXI6ZnVuY3Rpb24odCl7dmFyIG4sbztyZXR1cm4gbj1lLnRhZ05hbWUodCkscy5jYWxsKGUuZ2V0QmxvY2tUYWdOYW1lcygpLG4pPj0wJiYobz1lLnRhZ05hbWUodC5maXJzdENoaWxkKSxzLmNhbGwoZS5nZXRCbG9ja1RhZ05hbWVzKCksbyk8MCl9LG5vZGVJc0Jsb2NrU3RhcnQ6ZnVuY3Rpb24odCxuKXt2YXIgbztyZXR1cm4gbz0obnVsbCE9bj9uOntzdHJpY3Q6ITB9KS5zdHJpY3Qsbz9lLm5vZGVJc0Jsb2NrU3RhcnRDb21tZW50KHQpOmUubm9kZUlzQmxvY2tTdGFydENvbW1lbnQodCl8fCFlLm5vZGVJc0Jsb2NrU3RhcnRDb21tZW50KHQuZmlyc3RDaGlsZCkmJmUubm9kZVByb2JhYmx5SXNCbG9ja0NvbnRhaW5lcih0KX0sbm9kZUlzQmxvY2tTdGFydENvbW1lbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIGUubm9kZUlzQ29tbWVudE5vZGUodCkmJlwiYmxvY2tcIj09PShudWxsIT10P3QuZGF0YTp2b2lkIDApfSxub2RlSXNDb21tZW50Tm9kZTpmdW5jdGlvbih0KXtyZXR1cm4obnVsbCE9dD90Lm5vZGVUeXBlOnZvaWQgMCk9PT1Ob2RlLkNPTU1FTlRfTk9ERX0sbm9kZUlzQ3Vyc29yVGFyZ2V0OmZ1bmN0aW9uKHQpe3JldHVybiB0P2Uubm9kZUlzVGV4dE5vZGUodCk/dC5kYXRhPT09ZS5aRVJPX1dJRFRIX1NQQUNFOmUubm9kZUlzQ3Vyc29yVGFyZ2V0KHQuZmlyc3RDaGlsZCk6dm9pZCAwfSxub2RlSXNBdHRhY2htZW50RWxlbWVudDpmdW5jdGlvbih0KXtyZXR1cm4gZS5lbGVtZW50TWF0Y2hlc1NlbGVjdG9yKHQsZS5BdHRhY2htZW50Vmlldy5hdHRhY2htZW50U2VsZWN0b3IpfSxub2RlSXNFbXB0eVRleHROb2RlOmZ1bmN0aW9uKHQpe3JldHVybiBlLm5vZGVJc1RleHROb2RlKHQpJiZcIlwiPT09KG51bGwhPXQ/dC5kYXRhOnZvaWQgMCl9LG5vZGVJc1RleHROb2RlOmZ1bmN0aW9uKHQpe3JldHVybihudWxsIT10P3Qubm9kZVR5cGU6dm9pZCAwKT09PU5vZGUuVEVYVF9OT0RFfX0pfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbixvLGkscjt0PWUuY29weU9iamVjdCxpPWUub2JqZWN0c0FyZUVxdWFsLGUuZXh0ZW5kKHtub3JtYWxpemVSYW5nZTpvPWZ1bmN0aW9uKHQpe3ZhciBlO2lmKG51bGwhPXQpcmV0dXJuIEFycmF5LmlzQXJyYXkodCl8fCh0PVt0LHRdKSxbbih0WzBdKSxuKG51bGwhPShlPXRbMV0pP2U6dFswXSldfSxyYW5nZUlzQ29sbGFwc2VkOmZ1bmN0aW9uKHQpe3ZhciBlLG4saTtpZihudWxsIT10KXJldHVybiBuPW8odCksaT1uWzBdLGU9blsxXSxyKGksZSl9LHJhbmdlc0FyZUVxdWFsOmZ1bmN0aW9uKHQsZSl7dmFyIG4saSxzLGEsdSxjO2lmKG51bGwhPXQmJm51bGwhPWUpcmV0dXJuIHM9byh0KSxpPXNbMF0sbj1zWzFdLGE9byhlKSxjPWFbMF0sdT1hWzFdLHIoaSxjKSYmcihuLHUpfX0pLG49ZnVuY3Rpb24oZSl7cmV0dXJuXCJudW1iZXJcIj09dHlwZW9mIGU/ZTp0KGUpfSxyPWZ1bmN0aW9uKHQsZSl7cmV0dXJuXCJudW1iZXJcIj09dHlwZW9mIHQ/dD09PWU6aSh0LGUpfX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0LG4sbyxpO3Q9e2V4dGVuZHNUYWdOYW1lOlwiZGl2XCIsY3NzOlwiJXQgeyBkaXNwbGF5OiBibG9jazsgfVwifSxlLnJlZ2lzdGVyRWxlbWVudD1mdW5jdGlvbihlLG4pe3ZhciByLHMsYSx1LGMsbCxoO3JldHVybiBudWxsPT1uJiYobj17fSksZT1lLnRvTG93ZXJDYXNlKCksYz1pKG4pLHU9bnVsbCE9KGg9Yy5leHRlbmRzVGFnTmFtZSk/aDp0LmV4dGVuZHNUYWdOYW1lLGRlbGV0ZSBjLmV4dGVuZHNUYWdOYW1lLHM9Yy5kZWZhdWx0Q1NTLGRlbGV0ZSBjLmRlZmF1bHRDU1MsbnVsbCE9cyYmdT09PXQuZXh0ZW5kc1RhZ05hbWU/cys9XCJcXG5cIit0LmNzczpzPXQuY3NzLG8ocyxlKSxhPU9iamVjdC5nZXRQcm90b3R5cGVPZihkb2N1bWVudC5jcmVhdGVFbGVtZW50KHUpKSxhLl9fc3VwZXJfXz1hLGw9T2JqZWN0LmNyZWF0ZShhLGMpLHI9ZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50KGUse3Byb3RvdHlwZTpsfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGwsXCJjb25zdHJ1Y3RvclwiLHt2YWx1ZTpyfSkscn0sbz1mdW5jdGlvbih0LGUpe3ZhciBvO3JldHVybiBvPW4oZSksby50ZXh0Q29udGVudD10LnJlcGxhY2UoLyV0L2csZSl9LG49ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpLGUuc2V0QXR0cmlidXRlKFwidHlwZVwiLFwidGV4dC9jc3NcIiksZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXRhZy1uYW1lXCIsdC50b0xvd2VyQ2FzZSgpKSxkb2N1bWVudC5oZWFkLmluc2VydEJlZm9yZShlLGRvY3VtZW50LmhlYWQuZmlyc3RDaGlsZCksZX0saT1mdW5jdGlvbih0KXt2YXIgZSxuLG87bj17fTtmb3IoZSBpbiB0KW89dFtlXSxuW2VdPVwiZnVuY3Rpb25cIj09dHlwZW9mIG8/e3ZhbHVlOm99Om87cmV0dXJuIG59fS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbjtlLmV4dGVuZCh7Z2V0RE9NU2VsZWN0aW9uOmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHQ9d2luZG93LmdldFNlbGVjdGlvbigpLHQucmFuZ2VDb3VudD4wP3Q6dm9pZCAwfSxnZXRET01SYW5nZTpmdW5jdGlvbigpe3ZhciBuLG87cmV0dXJuKG49bnVsbCE9KG89ZS5nZXRET01TZWxlY3Rpb24oKSk/by5nZXRSYW5nZUF0KDApOnZvaWQgMCkmJiF0KG4pP246dm9pZCAwfSxzZXRET01SYW5nZTpmdW5jdGlvbih0KXt2YXIgbjtyZXR1cm4gbj13aW5kb3cuZ2V0U2VsZWN0aW9uKCksbi5yZW1vdmVBbGxSYW5nZXMoKSxuLmFkZFJhbmdlKHQpLGUuc2VsZWN0aW9uQ2hhbmdlT2JzZXJ2ZXIudXBkYXRlKCl9fSksdD1mdW5jdGlvbih0KXtyZXR1cm4gbih0LnN0YXJ0Q29udGFpbmVyKXx8bih0LmVuZENvbnRhaW5lcil9LG49ZnVuY3Rpb24odCl7cmV0dXJuIU9iamVjdC5nZXRQcm90b3R5cGVPZih0KX19LmNhbGwodGhpcyksZnVuY3Rpb24oKXt9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIGkgaW4gZSlvLmNhbGwoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIG4ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBuLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LG89e30uaGFzT3duUHJvcGVydHk7dD1lLmFycmF5c0FyZUVxdWFsLGUuSGFzaD1mdW5jdGlvbihvKXtmdW5jdGlvbiBpKHQpe251bGw9PXQmJih0PXt9KSx0aGlzLnZhbHVlcz1zKHQpLGkuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKX12YXIgcixzLGEsdSxjO3JldHVybiBuKGksbyksaS5mcm9tQ29tbW9uQXR0cmlidXRlc09mT2JqZWN0cz1mdW5jdGlvbih0KXt2YXIgZSxuLG8saSxzLGE7aWYobnVsbD09dCYmKHQ9W10pLCF0Lmxlbmd0aClyZXR1cm4gbmV3IHRoaXM7Zm9yKGU9cih0WzBdKSxvPWUuZ2V0S2V5cygpLGE9dC5zbGljZSgxKSxuPTAsaT1hLmxlbmd0aDtpPm47bisrKXM9YVtuXSxvPWUuZ2V0S2V5c0NvbW1vblRvSGFzaChyKHMpKSxlPWUuc2xpY2Uobyk7cmV0dXJuIGV9LGkuYm94PWZ1bmN0aW9uKHQpe3JldHVybiByKHQpfSxpLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5tZXJnZSh1KHQsZSkpfSxpLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkhhc2gocyh0aGlzLnZhbHVlcyx0KSl9LGkucHJvdG90eXBlLmdldD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy52YWx1ZXNbdF19LGkucHJvdG90eXBlLmhhcz1mdW5jdGlvbih0KXtyZXR1cm4gdCBpbiB0aGlzLnZhbHVlc30saS5wcm90b3R5cGUubWVyZ2U9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkhhc2goYSh0aGlzLnZhbHVlcyxjKHQpKSl9LGkucHJvdG90eXBlLnNsaWNlPWZ1bmN0aW9uKHQpe3ZhciBuLG8saSxyO2ZvcihyPXt9LG49MCxpPXQubGVuZ3RoO2k+bjtuKyspbz10W25dLHRoaXMuaGFzKG8pJiYocltvXT10aGlzLnZhbHVlc1tvXSk7cmV0dXJuIG5ldyBlLkhhc2gocil9LGkucHJvdG90eXBlLmdldEtleXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2JqZWN0LmtleXModGhpcy52YWx1ZXMpfSxpLnByb3RvdHlwZS5nZXRLZXlzQ29tbW9uVG9IYXNoPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbyxpLHM7Zm9yKHQ9cih0KSxpPXRoaXMuZ2V0S2V5cygpLHM9W10sZT0wLG89aS5sZW5ndGg7bz5lO2UrKyluPWlbZV0sdGhpcy52YWx1ZXNbbl09PT10LnZhbHVlc1tuXSYmcy5wdXNoKG4pO3JldHVybiBzfSxpLnByb3RvdHlwZS5pc0VxdWFsVG89ZnVuY3Rpb24oZSl7cmV0dXJuIHQodGhpcy50b0FycmF5KCkscihlKS50b0FycmF5KCkpfSxpLnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmdldEtleXMoKS5sZW5ndGh9LGkucHJvdG90eXBlLnRvQXJyYXk9ZnVuY3Rpb24oKXt2YXIgdCxlLG47cmV0dXJuKG51bGwhPXRoaXMuYXJyYXk/dGhpcy5hcnJheTp0aGlzLmFycmF5PWZ1bmN0aW9uKCl7dmFyIG87ZT1bXSxvPXRoaXMudmFsdWVzO2Zvcih0IGluIG8pbj1vW3RdLGUucHVzaCh0LG4pO3JldHVybiBlfS5jYWxsKHRoaXMpKS5zbGljZSgwKX0saS5wcm90b3R5cGUudG9PYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gcyh0aGlzLnZhbHVlcyl9LGkucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvT2JqZWN0KCl9LGkucHJvdG90eXBlLmNvbnRlbnRzRm9ySW5zcGVjdGlvbj1mdW5jdGlvbigpe3JldHVybnt2YWx1ZXM6SlNPTi5zdHJpbmdpZnkodGhpcy52YWx1ZXMpfX0sdT1mdW5jdGlvbih0LGUpe3ZhciBuO3JldHVybiBuPXt9LG5bdF09ZSxufSxhPWZ1bmN0aW9uKHQsZSl7dmFyIG4sbyxpO289cyh0KTtmb3IobiBpbiBlKWk9ZVtuXSxvW25dPWk7cmV0dXJuIG99LHM9ZnVuY3Rpb24odCxlKXt2YXIgbixvLGkscixzO2ZvcihyPXt9LHM9T2JqZWN0LmtleXModCkuc29ydCgpLG49MCxpPXMubGVuZ3RoO2k+bjtuKyspbz1zW25dLG8hPT1lJiYocltvXT10W29dKTtyZXR1cm4gcn0scj1mdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIGUuSGFzaD90Om5ldyBlLkhhc2godCl9LGM9ZnVuY3Rpb24odCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBlLkhhc2g/dC52YWx1ZXM6dH0saX0oZS5PYmplY3QpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7ZS5PYmplY3RHcm91cD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXt2YXIgbixvO3RoaXMub2JqZWN0cz1udWxsIT10P3Q6W10sbz1lLmRlcHRoLG49ZS5hc1RyZWUsbiYmKHRoaXMuZGVwdGg9byx0aGlzLm9iamVjdHM9dGhpcy5jb25zdHJ1Y3Rvci5ncm91cE9iamVjdHModGhpcy5vYmplY3RzLHthc1RyZWU6bixkZXB0aDp0aGlzLmRlcHRoKzF9KSl9cmV0dXJuIHQuZ3JvdXBPYmplY3RzPWZ1bmN0aW9uKHQsZSl7dmFyIG4sbyxpLHIscyxhLHUsYyxsO2ZvcihudWxsPT10JiYodD1bXSksbD1udWxsIT1lP2U6e30saT1sLmRlcHRoLG49bC5hc1RyZWUsbiYmbnVsbD09aSYmKGk9MCksYz1bXSxzPTAsYT10Lmxlbmd0aDthPnM7cysrKXtpZih1PXRbc10scil7aWYoKFwiZnVuY3Rpb25cIj09dHlwZW9mIHUuY2FuQmVHcm91cGVkP3UuY2FuQmVHcm91cGVkKGkpOnZvaWQgMCkmJihcImZ1bmN0aW9uXCI9PXR5cGVvZihvPXJbci5sZW5ndGgtMV0pLmNhbkJlR3JvdXBlZFdpdGg/by5jYW5CZUdyb3VwZWRXaXRoKHUsaSk6dm9pZCAwKSl7ci5wdXNoKHUpO2NvbnRpbnVlfWMucHVzaChuZXcgdGhpcyhyLHtkZXB0aDppLGFzVHJlZTpufSkpLHI9bnVsbH0oXCJmdW5jdGlvblwiPT10eXBlb2YgdS5jYW5CZUdyb3VwZWQ/dS5jYW5CZUdyb3VwZWQoaSk6dm9pZCAwKT9yPVt1XTpjLnB1c2godSl9cmV0dXJuIHImJmMucHVzaChuZXcgdGhpcyhyLHtkZXB0aDppLGFzVHJlZTpufSkpLGN9LHQucHJvdG90eXBlLmdldE9iamVjdHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vYmplY3RzfSx0LnByb3RvdHlwZS5nZXREZXB0aD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRlcHRofSx0LnByb3RvdHlwZS5nZXRDYWNoZUtleT1mdW5jdGlvbigpe3ZhciB0LGUsbixvLGk7Zm9yKGU9W1wib2JqZWN0R3JvdXBcIl0saT10aGlzLmdldE9iamVjdHMoKSx0PTAsbj1pLmxlbmd0aDtuPnQ7dCsrKW89aVt0XSxlLnB1c2goby5nZXRDYWNoZUtleSgpKTtyZXR1cm4gZS5qb2luKFwiL1wiKX0sdH0oKX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbygpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIGkgaW4gZSluLmNhbGwoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIG8ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBvLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LG49e30uaGFzT3duUHJvcGVydHk7ZS5PYmplY3RNYXA9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gbih0KXt2YXIgZSxuLG8saSxyO2ZvcihudWxsPT10JiYodD1bXSksdGhpcy5vYmplY3RzPXt9LG89MCxpPXQubGVuZ3RoO2k+bztvKyspcj10W29dLG49SlNPTi5zdHJpbmdpZnkociksbnVsbD09KGU9dGhpcy5vYmplY3RzKVtuXSYmKGVbbl09cil9cmV0dXJuIHQobixlKSxuLnByb3RvdHlwZS5maW5kPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBlPUpTT04uc3RyaW5naWZ5KHQpLHRoaXMub2JqZWN0c1tlXX0sbn0oZS5CYXNpY09iamVjdCl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXtlLkVsZW1lbnRTdG9yZT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5yZXNldCh0KX12YXIgZTtyZXR1cm4gdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQpe3ZhciBuO3JldHVybiBuPWUodCksdGhpcy5lbGVtZW50c1tuXT10fSx0LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24odCl7dmFyIG4sbztyZXR1cm4gbj1lKHQpLChvPXRoaXMuZWxlbWVudHNbbl0pPyhkZWxldGUgdGhpcy5lbGVtZW50c1tuXSxvKTp2b2lkIDB9LHQucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKHQpe3ZhciBlLG4sbztmb3IobnVsbD09dCYmKHQ9W10pLHRoaXMuZWxlbWVudHM9e30sbj0wLG89dC5sZW5ndGg7bz5uO24rKyllPXRbbl0sdGhpcy5hZGQoZSk7cmV0dXJuIHR9LGU9ZnVuY3Rpb24odCl7cmV0dXJuIHQuZGF0YXNldC50cml4U3RvcmVLZXl9LHR9KCl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdD1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG8oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBpIGluIGUpbi5jYWxsKGUsaSkmJih0W2ldPWVbaV0pO3JldHVybiBvLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbyx0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxuPXt9Lmhhc093blByb3BlcnR5O2UuT3BlcmF0aW9uPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIG4oKXtyZXR1cm4gbi5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiB0KG4sZSksbi5wcm90b3R5cGUuaXNQZXJmb3JtaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGVyZm9ybWluZz09PSEwfSxuLnByb3RvdHlwZS5oYXNQZXJmb3JtZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wZXJmb3JtZWQ9PT0hMH0sbi5wcm90b3R5cGUuaGFzU3VjY2VlZGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGVyZm9ybWVkJiZ0aGlzLnN1Y2NlZWRlZH0sbi5wcm90b3R5cGUuaGFzRmFpbGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGVyZm9ybWVkJiYhdGhpcy5zdWNjZWVkZWR9LG4ucHJvdG90eXBlLmdldFByb21pc2U9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbCE9dGhpcy5wcm9taXNlP3RoaXMucHJvbWlzZTp0aGlzLnByb21pc2U9bmV3IFByb21pc2UoZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUsbil7cmV0dXJuIHQucGVyZm9ybWluZz0hMCx0LnBlcmZvcm0oZnVuY3Rpb24obyxpKXtyZXR1cm4gdC5zdWNjZWVkZWQ9byx0LnBlcmZvcm1pbmc9ITEsdC5wZXJmb3JtZWQ9ITAsdC5zdWNjZWVkZWQ/ZShpKTpuKGkpfSl9fSh0aGlzKSl9LG4ucHJvdG90eXBlLnBlcmZvcm09ZnVuY3Rpb24odCl7cmV0dXJuIHQoITEpfSxuLnByb3RvdHlwZS5yZWxlYXNlPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIG51bGwhPSh0PXRoaXMucHJvbWlzZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQuY2FuY2VsJiZ0LmNhbmNlbCgpLHRoaXMucHJvbWlzZT1udWxsLHRoaXMucGVyZm9ybWluZz1udWxsLHRoaXMucGVyZm9ybWVkPW51bGwsdGhpcy5zdWNjZWVkZWQ9bnVsbFxufSxuLnByb3h5TWV0aG9kKFwiZ2V0UHJvbWlzZSgpLnRoZW5cIiksbi5wcm94eU1ldGhvZChcImdldFByb21pc2UoKS5jYXRjaFwiKSxufShlLkJhc2ljT2JqZWN0KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0LG4sbyxpLHIscz1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBvIGluIGUpYS5jYWxsKGUsbykmJih0W29dPWVbb10pO3JldHVybiBuLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbix0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxhPXt9Lmhhc093blByb3BlcnR5O2UuVVRGMTZTdHJpbmc9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZSh0LGUpe3RoaXMudWNzMlN0cmluZz10LHRoaXMuY29kZXBvaW50cz1lLHRoaXMubGVuZ3RoPXRoaXMuY29kZXBvaW50cy5sZW5ndGgsdGhpcy51Y3MyTGVuZ3RoPXRoaXMudWNzMlN0cmluZy5sZW5ndGh9cmV0dXJuIHMoZSx0KSxlLmJveD1mdW5jdGlvbih0KXtyZXR1cm4gbnVsbD09dCYmKHQ9XCJcIiksdCBpbnN0YW5jZW9mIHRoaXM/dDp0aGlzLmZyb21VQ1MyU3RyaW5nKG51bGwhPXQ/dC50b1N0cmluZygpOnZvaWQgMCl9LGUuZnJvbVVDUzJTdHJpbmc9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyB0aGlzKHQsaSh0KSl9LGUuZnJvbUNvZGVwb2ludHM9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyB0aGlzKHIodCksdCl9LGUucHJvdG90eXBlLm9mZnNldFRvVUNTMk9mZnNldD1mdW5jdGlvbih0KXtyZXR1cm4gcih0aGlzLmNvZGVwb2ludHMuc2xpY2UoMCxNYXRoLm1heCgwLHQpKSkubGVuZ3RofSxlLnByb3RvdHlwZS5vZmZzZXRGcm9tVUNTMk9mZnNldD1mdW5jdGlvbih0KXtyZXR1cm4gaSh0aGlzLnVjczJTdHJpbmcuc2xpY2UoMCxNYXRoLm1heCgwLHQpKSkubGVuZ3RofSxlLnByb3RvdHlwZS5zbGljZT1mdW5jdGlvbigpe3ZhciB0O3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLmZyb21Db2RlcG9pbnRzKCh0PXRoaXMuY29kZXBvaW50cykuc2xpY2UuYXBwbHkodCxhcmd1bWVudHMpKX0sZS5wcm90b3R5cGUuY2hhckF0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNsaWNlKHQsdCsxKX0sZS5wcm90b3R5cGUuaXNFcXVhbFRvPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLmJveCh0KS51Y3MyU3RyaW5nPT09dGhpcy51Y3MyU3RyaW5nfSxlLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51Y3MyU3RyaW5nfSxlLnByb3RvdHlwZS5nZXRDYWNoZUtleT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnVjczJTdHJpbmd9LGUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudWNzMlN0cmluZ30sZX0oZS5CYXNpY09iamVjdCksdD0xPT09KFwiZnVuY3Rpb25cIj09dHlwZW9mIEFycmF5LmZyb20/QXJyYXkuZnJvbShcIlxcdWQ4M2RcXHVkYzdjXCIpLmxlbmd0aDp2b2lkIDApLG49bnVsbCE9KFwiZnVuY3Rpb25cIj09dHlwZW9mXCIgXCIuY29kZVBvaW50QXQ/XCIgXCIuY29kZVBvaW50QXQoMCk6dm9pZCAwKSxvPVwiIFxcdWQ4M2RcXHVkYzdjXCI9PT0oXCJmdW5jdGlvblwiPT10eXBlb2YgU3RyaW5nLmZyb21Db2RlUG9pbnQ/U3RyaW5nLmZyb21Db2RlUG9pbnQoMzIsMTI4MTI0KTp2b2lkIDApLGk9dCYmbj9mdW5jdGlvbih0KXtyZXR1cm4gQXJyYXkuZnJvbSh0KS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHQuY29kZVBvaW50QXQoMCl9KX06ZnVuY3Rpb24odCl7dmFyIGUsbixvLGkscjtmb3IoaT1bXSxlPTAsbz10Lmxlbmd0aDtvPmU7KXI9dC5jaGFyQ29kZUF0KGUrKykscj49NTUyOTYmJjU2MzE5Pj1yJiZvPmUmJihuPXQuY2hhckNvZGVBdChlKyspLDU2MzIwPT09KDY0NTEyJm4pP3I9KCgxMDIzJnIpPDwxMCkrKDEwMjMmbikrNjU1MzY6ZS0tKSxpLnB1c2gocik7cmV0dXJuIGl9LHI9bz9mdW5jdGlvbih0KXtyZXR1cm4gU3RyaW5nLmZyb21Db2RlUG9pbnQuYXBwbHkoU3RyaW5nLHQpfTpmdW5jdGlvbih0KXt2YXIgZSxuLG87cmV0dXJuIGU9ZnVuY3Rpb24oKXt2YXIgZSxpLHI7Zm9yKHI9W10sZT0wLGk9dC5sZW5ndGg7aT5lO2UrKylvPXRbZV0sbj1cIlwiLG8+NjU1MzUmJihvLT02NTUzNixuKz1TdHJpbmcuZnJvbUNoYXJDb2RlKG8+Pj4xMCYxMDIzfDU1Mjk2KSxvPTU2MzIwfDEwMjMmbyksci5wdXNoKG4rU3RyaW5nLmZyb21DaGFyQ29kZShvKSk7cmV0dXJuIHJ9KCksZS5qb2luKFwiXCIpfX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe30uY2FsbCh0aGlzKSxmdW5jdGlvbigpe30uY2FsbCh0aGlzKSxmdW5jdGlvbigpe2UuY29uZmlnLmxhbmc9e2JvbGQ6XCJCb2xkXCIsYnVsbGV0czpcIkJ1bGxldHNcIixcImJ5dGVcIjpcIkJ5dGVcIixieXRlczpcIkJ5dGVzXCIsY2FwdGlvblBsYWNlaG9sZGVyOlwiVHlwZSBhIGNhcHRpb24gaGVyZVxcdTIwMjZcIixjYXB0aW9uUHJvbXB0OlwiQWRkIGEgY2FwdGlvblxcdTIwMjZcIixjb2RlOlwiQ29kZVwiLGhlYWRpbmcxOlwiSGVhZGluZ1wiLGluZGVudDpcIkluY3JlYXNlIExldmVsXCIsaXRhbGljOlwiSXRhbGljXCIsbGluazpcIkxpbmtcIixudW1iZXJzOlwiTnVtYmVyc1wiLG91dGRlbnQ6XCJEZWNyZWFzZSBMZXZlbFwiLHF1b3RlOlwiUXVvdGVcIixyZWRvOlwiUmVkb1wiLHJlbW92ZTpcIlJlbW92ZVwiLHN0cmlrZTpcIlN0cmlrZXRocm91Z2hcIix1bmRvOlwiVW5kb1wiLHVubGluazpcIlVubGlua1wiLHVybFBsYWNlaG9sZGVyOlwiRW50ZXIgYSBVUkxcXHUyMDI2XCIsR0I6XCJHQlwiLEtCOlwiS0JcIixNQjpcIk1CXCIsUEI6XCJQQlwiLFRCOlwiVEJcIn19LmNhbGwodGhpcyksZnVuY3Rpb24oKXtlLmNvbmZpZy5jc3M9e2NsYXNzTmFtZXM6e2F0dGFjaG1lbnQ6e2NvbnRhaW5lcjpcImF0dGFjaG1lbnRcIix0eXBlUHJlZml4OlwiYXR0YWNobWVudC1cIixjYXB0aW9uOlwiY2FwdGlvblwiLGNhcHRpb25FZGl0ZWQ6XCJjYXB0aW9uLWVkaXRlZFwiLGNhcHRpb25FZGl0b3I6XCJjYXB0aW9uLWVkaXRvclwiLGVkaXRpbmdDYXB0aW9uOlwiY2FwdGlvbi1lZGl0aW5nXCIscHJvZ3Jlc3NCYXI6XCJwcm9ncmVzc1wiLHJlbW92ZUJ1dHRvbjpcInJlbW92ZSBpY29uXCIsc2l6ZTpcInNpemVcIn19fX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0O2UuY29uZmlnLmJsb2NrQXR0cmlidXRlcz10PXtcImRlZmF1bHRcIjp7dGFnTmFtZTpcImRpdlwiLHBhcnNlOiExfSxxdW90ZTp7dGFnTmFtZTpcImJsb2NrcXVvdGVcIixuZXN0YWJsZTohMH0saGVhZGluZzE6e3RhZ05hbWU6XCJoMVwiLHRlcm1pbmFsOiEwLGJyZWFrT25SZXR1cm46ITAsZ3JvdXA6ITF9LGNvZGU6e3RhZ05hbWU6XCJwcmVcIix0ZXJtaW5hbDohMCx0ZXh0OntwbGFpbnRleHQ6ITB9fSxidWxsZXRMaXN0Ont0YWdOYW1lOlwidWxcIixwYXJzZTohMX0sYnVsbGV0Ont0YWdOYW1lOlwibGlcIixsaXN0QXR0cmlidXRlOlwiYnVsbGV0TGlzdFwiLGdyb3VwOiExLG5lc3RhYmxlOiEwLHRlc3Q6ZnVuY3Rpb24obil7cmV0dXJuIGUudGFnTmFtZShuLnBhcmVudE5vZGUpPT09dFt0aGlzLmxpc3RBdHRyaWJ1dGVdLnRhZ05hbWV9fSxudW1iZXJMaXN0Ont0YWdOYW1lOlwib2xcIixwYXJzZTohMX0sbnVtYmVyOnt0YWdOYW1lOlwibGlcIixsaXN0QXR0cmlidXRlOlwibnVtYmVyTGlzdFwiLGdyb3VwOiExLG5lc3RhYmxlOiEwLHRlc3Q6ZnVuY3Rpb24obil7cmV0dXJuIGUudGFnTmFtZShuLnBhcmVudE5vZGUpPT09dFt0aGlzLmxpc3RBdHRyaWJ1dGVdLnRhZ05hbWV9fX19LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuO3Q9ZS5jb25maWcubGFuZyxuPVt0LmJ5dGVzLHQuS0IsdC5NQix0LkdCLHQuVEIsdC5QQl0sZS5jb25maWcuZmlsZVNpemU9e3ByZWZpeDpcIklFQ1wiLHByZWNpc2lvbjoyLGZvcm1hdHRlcjpmdW5jdGlvbihlKXt2YXIgbyxpLHIscyxhO3N3aXRjaChlKXtjYXNlIDA6cmV0dXJuXCIwIFwiK3QuYnl0ZXM7Y2FzZSAxOnJldHVyblwiMSBcIit0LmJ5dGU7ZGVmYXVsdDpyZXR1cm4gbz1mdW5jdGlvbigpe3N3aXRjaCh0aGlzLnByZWZpeCl7Y2FzZVwiU0lcIjpyZXR1cm4gMWUzO2Nhc2VcIklFQ1wiOnJldHVybiAxMDI0fX0uY2FsbCh0aGlzKSxpPU1hdGguZmxvb3IoTWF0aC5sb2coZSkvTWF0aC5sb2cobykpLHI9ZS9NYXRoLnBvdyhvLGkpLHM9ci50b0ZpeGVkKHRoaXMucHJlY2lzaW9uKSxhPXMucmVwbGFjZSgvMCokLyxcIlwiKS5yZXBsYWNlKC9cXC4kLyxcIlwiKSxhK1wiIFwiK25baV19fX19LmNhbGwodGhpcyksZnVuY3Rpb24oKXtlLmNvbmZpZy50ZXh0QXR0cmlidXRlcz17Ym9sZDp7dGFnTmFtZTpcInN0cm9uZ1wiLGluaGVyaXRhYmxlOiEwLHBhcnNlcjpmdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gZT13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KSxcImJvbGRcIj09PWUuZm9udFdlaWdodHx8ZS5mb250V2VpZ2h0Pj02MDB9fSxpdGFsaWM6e3RhZ05hbWU6XCJlbVwiLGluaGVyaXRhYmxlOiEwLHBhcnNlcjpmdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gZT13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KSxcIml0YWxpY1wiPT09ZS5mb250U3R5bGV9fSxocmVmOntncm91cFRhZ05hbWU6XCJhXCIscGFyc2VyOmZ1bmN0aW9uKHQpe3ZhciBuLG8saTtyZXR1cm4gbj1lLkF0dGFjaG1lbnRWaWV3LmF0dGFjaG1lbnRTZWxlY3RvcixpPVwiYTpub3QoXCIrbitcIilcIiwobz1lLmZpbmRDbG9zZXN0RWxlbWVudEZyb21Ob2RlKHQse21hdGNoaW5nU2VsZWN0b3I6aX0pKT9vLmdldEF0dHJpYnV0ZShcImhyZWZcIik6dm9pZCAwfX0sc3RyaWtlOnt0YWdOYW1lOlwiZGVsXCIsaW5oZXJpdGFibGU6ITB9LGZyb3plbjp7c3R5bGU6e2JhY2tncm91bmRDb2xvcjpcImhpZ2hsaWdodFwifX19fS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbixvLGkscjtyPVwiW2RhdGEtdHJpeC1zZXJpYWxpemU9ZmFsc2VdXCIsaT1bXCJjb250ZW50ZWRpdGFibGVcIixcImRhdGEtdHJpeC1pZFwiLFwiZGF0YS10cml4LXN0b3JlLWtleVwiLFwiZGF0YS10cml4LW11dGFibGVcIl0sbj1cImRhdGEtdHJpeC1zZXJpYWxpemVkLWF0dHJpYnV0ZXNcIixvPVwiW1wiK24rXCJdXCIsdD1uZXcgUmVnRXhwKFwiPCEtLWJsb2NrLS0+XCIsXCJnXCIpLGUuZXh0ZW5kKHtzZXJpYWxpemVyczp7XCJhcHBsaWNhdGlvbi9qc29uXCI6ZnVuY3Rpb24odCl7dmFyIG47aWYodCBpbnN0YW5jZW9mIGUuRG9jdW1lbnQpbj10O2Vsc2V7aWYoISh0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKXRocm93IG5ldyBFcnJvcihcInVuc2VyaWFsaXphYmxlIG9iamVjdFwiKTtuPWUuRG9jdW1lbnQuZnJvbUhUTUwodC5pbm5lckhUTUwpfXJldHVybiBuLnRvU2VyaWFsaXphYmxlRG9jdW1lbnQoKS50b0pTT05TdHJpbmcoKX0sXCJ0ZXh0L2h0bWxcIjpmdW5jdGlvbihzKXt2YXIgYSx1LGMsbCxoLHAsZCxmLGcsbSx5LHYsYixBLEMsdyx4O2lmKHMgaW5zdGFuY2VvZiBlLkRvY3VtZW50KWw9ZS5Eb2N1bWVudFZpZXcucmVuZGVyKHMpO2Vsc2V7aWYoIShzIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKXRocm93IG5ldyBFcnJvcihcInVuc2VyaWFsaXphYmxlIG9iamVjdFwiKTtsPXMuY2xvbmVOb2RlKCEwKX1mb3IoQT1sLnF1ZXJ5U2VsZWN0b3JBbGwociksaD0wLGc9QS5sZW5ndGg7Zz5oO2grKyljPUFbaF0sYy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGMpO2ZvcihwPTAsbT1pLmxlbmd0aDttPnA7cCsrKWZvcihhPWlbcF0sQz1sLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbXCIrYStcIl1cIiksZD0wLHk9Qy5sZW5ndGg7eT5kO2QrKyljPUNbZF0sYy5yZW1vdmVBdHRyaWJ1dGUoYSk7Zm9yKHc9bC5xdWVyeVNlbGVjdG9yQWxsKG8pLGY9MCx2PXcubGVuZ3RoO3Y+ZjtmKyspe2M9d1tmXTt0cnl7dT1KU09OLnBhcnNlKGMuZ2V0QXR0cmlidXRlKG4pKSxjLnJlbW92ZUF0dHJpYnV0ZShuKTtmb3IoYiBpbiB1KXg9dVtiXSxjLnNldEF0dHJpYnV0ZShiLHgpfWNhdGNoKEUpe319cmV0dXJuIGwuaW5uZXJIVE1MLnJlcGxhY2UodCxcIlwiKX19LGRlc2VyaWFsaXplcnM6e1wiYXBwbGljYXRpb24vanNvblwiOmZ1bmN0aW9uKHQpe3JldHVybiBlLkRvY3VtZW50LmZyb21KU09OU3RyaW5nKHQpfSxcInRleHQvaHRtbFwiOmZ1bmN0aW9uKHQpe3JldHVybiBlLkRvY3VtZW50LmZyb21IVE1MKHQpfX0sc2VyaWFsaXplVG9Db250ZW50VHlwZTpmdW5jdGlvbih0LG4pe3ZhciBvO2lmKG89ZS5zZXJpYWxpemVyc1tuXSlyZXR1cm4gbyh0KTt0aHJvdyBuZXcgRXJyb3IoXCJ1bmtub3duIGNvbnRlbnQgdHlwZTogXCIrbil9LGRlc2VyaWFsaXplRnJvbUNvbnRlbnRUeXBlOmZ1bmN0aW9uKHQsbil7dmFyIG87aWYobz1lLmRlc2VyaWFsaXplcnNbbl0pcmV0dXJuIG8odCk7dGhyb3cgbmV3IEVycm9yKFwidW5rbm93biBjb250ZW50IHR5cGU6IFwiK24pfX0pfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbjtuPWUubWFrZUZyYWdtZW50LHQ9ZS5jb25maWcubGFuZyxlLmNvbmZpZy50b29sYmFyPXtjb250ZW50Om4oJzxkaXYgY2xhc3M9XCJidXR0b25fcm93XCI+XFxuICA8c3BhbiBjbGFzcz1cImJ1dHRvbl9ncm91cCB0ZXh0X3Rvb2xzXCI+XFxuICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiaWNvbiBib2xkXCIgZGF0YS10cml4LWF0dHJpYnV0ZT1cImJvbGRcIiBkYXRhLXRyaXgta2V5PVwiYlwiIHRpdGxlPVwiJyt0LmJvbGQrJ1wiPicrdC5ib2xkKyc8L2J1dHRvbj5cXG4gICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJpY29uIGl0YWxpY1wiIGRhdGEtdHJpeC1hdHRyaWJ1dGU9XCJpdGFsaWNcIiBkYXRhLXRyaXgta2V5PVwiaVwiIHRpdGxlPVwiJyt0Lml0YWxpYysnXCI+Jyt0Lml0YWxpYysnPC9idXR0b24+XFxuICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiaWNvbiBzdHJpa2VcIiBkYXRhLXRyaXgtYXR0cmlidXRlPVwic3RyaWtlXCIgdGl0bGU9XCInK3Quc3RyaWtlKydcIj4nK3Quc3RyaWtlKyc8L2J1dHRvbj5cXG4gICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJpY29uIGxpbmtcIiBkYXRhLXRyaXgtYXR0cmlidXRlPVwiaHJlZlwiIGRhdGEtdHJpeC1hY3Rpb249XCJsaW5rXCIgZGF0YS10cml4LWtleT1cImtcIiB0aXRsZT1cIicrdC5saW5rKydcIj4nK3QubGluaysnPC9idXR0b24+XFxuICA8L3NwYW4+XFxuXFxuICA8c3BhbiBjbGFzcz1cImJ1dHRvbl9ncm91cCBibG9ja190b29sc1wiPlxcbiAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImljb24gaGVhZGluZy0xXCIgZGF0YS10cml4LWF0dHJpYnV0ZT1cImhlYWRpbmcxXCIgdGl0bGU9XCInK3QuaGVhZGluZzErJ1wiPicrdC5oZWFkaW5nMSsnPC9idXR0b24+XFxuICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiaWNvbiBxdW90ZVwiIGRhdGEtdHJpeC1hdHRyaWJ1dGU9XCJxdW90ZVwiIHRpdGxlPVwiJyt0LnF1b3RlKydcIj4nK3QucXVvdGUrJzwvYnV0dG9uPlxcbiAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImljb24gY29kZVwiIGRhdGEtdHJpeC1hdHRyaWJ1dGU9XCJjb2RlXCIgdGl0bGU9XCInK3QuY29kZSsnXCI+Jyt0LmNvZGUrJzwvYnV0dG9uPlxcbiAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImljb24gbGlzdCBidWxsZXRzXCIgZGF0YS10cml4LWF0dHJpYnV0ZT1cImJ1bGxldFwiIHRpdGxlPVwiJyt0LmJ1bGxldHMrJ1wiPicrdC5idWxsZXRzKyc8L2J1dHRvbj5cXG4gICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJpY29uIGxpc3QgbnVtYmVyc1wiIGRhdGEtdHJpeC1hdHRyaWJ1dGU9XCJudW1iZXJcIiB0aXRsZT1cIicrdC5udW1iZXJzKydcIj4nK3QubnVtYmVycysnPC9idXR0b24+XFxuICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiaWNvbiBuZXN0aW5nLWxldmVsIGRlY3JlYXNlXCIgZGF0YS10cml4LWFjdGlvbj1cImRlY3JlYXNlTmVzdGluZ0xldmVsXCIgdGl0bGU9XCInK3Qub3V0ZGVudCsnXCI+Jyt0Lm91dGRlbnQrJzwvYnV0dG9uPlxcbiAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImljb24gbmVzdGluZy1sZXZlbCBpbmNyZWFzZVwiIGRhdGEtdHJpeC1hY3Rpb249XCJpbmNyZWFzZU5lc3RpbmdMZXZlbFwiIHRpdGxlPVwiJyt0LmluZGVudCsnXCI+Jyt0LmluZGVudCsnPC9idXR0b24+XFxuICA8L3NwYW4+XFxuXFxuICA8c3BhbiBjbGFzcz1cImJ1dHRvbl9ncm91cCBoaXN0b3J5X3Rvb2xzXCI+XFxuICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiaWNvbiB1bmRvXCIgZGF0YS10cml4LWFjdGlvbj1cInVuZG9cIiBkYXRhLXRyaXgta2V5PVwielwiIHRpdGxlPVwiJyt0LnVuZG8rJ1wiPicrdC51bmRvKyc8L2J1dHRvbj5cXG4gICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJpY29uIHJlZG9cIiBkYXRhLXRyaXgtYWN0aW9uPVwicmVkb1wiIGRhdGEtdHJpeC1rZXk9XCJzaGlmdCt6XCIgdGl0bGU9XCInK3QucmVkbysnXCI+Jyt0LnJlZG8rJzwvYnV0dG9uPlxcbiAgPC9zcGFuPlxcbjwvZGl2PlxcblxcbjxkaXYgY2xhc3M9XCJkaWFsb2dzXCI+XFxuICA8ZGl2IGNsYXNzPVwiZGlhbG9nIGxpbmtfZGlhbG9nXCIgZGF0YS10cml4LWF0dHJpYnV0ZT1cImhyZWZcIiBkYXRhLXRyaXgtZGlhbG9nPVwiaHJlZlwiPlxcbiAgICA8ZGl2IGNsYXNzPVwibGlua191cmxfZmllbGRzXCI+XFxuICAgICAgPGlucHV0IHR5cGU9XCJ1cmxcIiByZXF1aXJlZCBuYW1lPVwiaHJlZlwiIHBsYWNlaG9sZGVyPVwiJyt0LnVybFBsYWNlaG9sZGVyKydcIj5cXG4gICAgICA8ZGl2IGNsYXNzPVwiYnV0dG9uX2dyb3VwXCI+XFxuICAgICAgICA8aW5wdXQgdHlwZT1cImJ1dHRvblwiIHZhbHVlPVwiJyt0LmxpbmsrJ1wiIGRhdGEtdHJpeC1tZXRob2Q9XCJzZXRBdHRyaWJ1dGVcIj5cXG4gICAgICAgIDxpbnB1dCB0eXBlPVwiYnV0dG9uXCIgdmFsdWU9XCInK3QudW5saW5rKydcIiBkYXRhLXRyaXgtbWV0aG9kPVwicmVtb3ZlQXR0cmlidXRlXCI+XFxuICAgICAgPC9kaXY+XFxuICAgIDwvZGl2PlxcbiAgPC9kaXY+XFxuPC9kaXY+Jyl9fS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7ZS5jb25maWcudW5kb0ludGVydmFsPTVlM30uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0LG47dD1lLm1ha2VFbGVtZW50LG49e2N1cnNvclRhcmdldDp0KHt0YWdOYW1lOlwic3BhblwiLHRleHRDb250ZW50OmUuWkVST19XSURUSF9TUEFDRSxkYXRhOnt0cml4U2VsZWN0aW9uOiEwLHRyaXhDdXJzb3JUYXJnZXQ6ITAsdHJpeFNlcmlhbGl6ZTohMX19KX0sZS5leHRlbmQoe3NlbGVjdGlvbkVsZW1lbnRzOntzZWxlY3RvcjpcIltkYXRhLXRyaXgtc2VsZWN0aW9uXVwiLGNzc1RleHQ6XCJmb250LXNpemU6IDAgIWltcG9ydGFudDtcXG5wYWRkaW5nOiAwICFpbXBvcnRhbnQ7XFxubWFyZ2luOiAwICFpbXBvcnRhbnQ7XFxuYm9yZGVyOiBub25lICFpbXBvcnRhbnQ7XFxubGluZS1oZWlnaHQ6IDAgIWltcG9ydGFudDtcIixjcmVhdGU6ZnVuY3Rpb24odCl7cmV0dXJuIG5bdF0uY2xvbmVOb2RlKCEwKX19fSl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdDt0PWUuY2xvbmVGcmFnbWVudCxlLnJlZ2lzdGVyRWxlbWVudChcInRyaXgtdG9vbGJhclwiLHtkZWZhdWx0Q1NTOlwiJXQge1xcbiAgd2hpdGUtc3BhY2U6IGNvbGxhcHNlO1xcbn1cXG5cXG4ldCAuZGlhbG9nIHtcXG4gIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbiV0IC5kaWFsb2cuYWN0aXZlIHtcXG4gIGRpc3BsYXk6IGJsb2NrO1xcbn1cXG5cXG4ldCAuZGlhbG9nIGlucHV0LnZhbGlkYXRlOmludmFsaWQge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZGRkZDtcXG59XFxuXFxuJXRbbmF0aXZlXSB7XFxuICBkaXNwbGF5OiBub25lO1xcbn1cIixjcmVhdGVkQ2FsbGJhY2s6ZnVuY3Rpb24oKXtyZXR1cm5cIlwiPT09dGhpcy5pbm5lckhUTUw/dGhpcy5hcHBlbmRDaGlsZCh0KGUuY29uZmlnLnRvb2xiYXIuY29udGVudCkpOnZvaWQgMH19KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbygpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIGkgaW4gZSluLmNhbGwoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIG8ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBvLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LG49e30uaGFzT3duUHJvcGVydHksbz1bXS5pbmRleE9mfHxmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxuPXRoaXMubGVuZ3RoO24+ZTtlKyspaWYoZSBpbiB0aGlzJiZ0aGlzW2VdPT09dClyZXR1cm4gZTtyZXR1cm4tMX07ZS5PYmplY3RWaWV3PWZ1bmN0aW9uKG4pe2Z1bmN0aW9uIGkodCxlKXt0aGlzLm9iamVjdD10LHRoaXMub3B0aW9ucz1udWxsIT1lP2U6e30sdGhpcy5jaGlsZFZpZXdzPVtdLHRoaXMucm9vdFZpZXc9dGhpc31yZXR1cm4gdChpLG4pLGkucHJvdG90eXBlLmdldE5vZGVzPWZ1bmN0aW9uKCl7dmFyIHQsZSxuLG8saTtmb3IobnVsbD09dGhpcy5ub2RlcyYmKHRoaXMubm9kZXM9dGhpcy5jcmVhdGVOb2RlcygpKSxvPXRoaXMubm9kZXMsaT1bXSx0PTAsZT1vLmxlbmd0aDtlPnQ7dCsrKW49b1t0XSxpLnB1c2gobi5jbG9uZU5vZGUoITApKTtyZXR1cm4gaX0saS5wcm90b3R5cGUuaW52YWxpZGF0ZT1mdW5jdGlvbigpe3ZhciB0O3JldHVybiB0aGlzLm5vZGVzPW51bGwsbnVsbCE9KHQ9dGhpcy5wYXJlbnRWaWV3KT90LmludmFsaWRhdGUoKTp2b2lkIDB9LGkucHJvdG90eXBlLmludmFsaWRhdGVWaWV3Rm9yT2JqZWN0PWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBudWxsIT0oZT10aGlzLmZpbmRWaWV3Rm9yT2JqZWN0KHQpKT9lLmludmFsaWRhdGUoKTp2b2lkIDB9LGkucHJvdG90eXBlLmZpbmRPckNyZWF0ZUNhY2hlZENoaWxkVmlldz1mdW5jdGlvbih0LGUpe3ZhciBuO3JldHVybihuPXRoaXMuZ2V0Q2FjaGVkVmlld0Zvck9iamVjdChlKSk/dGhpcy5yZWNvcmRDaGlsZFZpZXcobik6KG49dGhpcy5jcmVhdGVDaGlsZFZpZXcuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuY2FjaGVWaWV3Rm9yT2JqZWN0KG4sZSkpLG59LGkucHJvdG90eXBlLmNyZWF0ZUNoaWxkVmlldz1mdW5jdGlvbih0LG4sbyl7dmFyIGk7cmV0dXJuIG51bGw9PW8mJihvPXt9KSxuIGluc3RhbmNlb2YgZS5PYmplY3RHcm91cCYmKG8udmlld0NsYXNzPXQsdD1lLk9iamVjdEdyb3VwVmlldyksaT1uZXcgdChuLG8pLHRoaXMucmVjb3JkQ2hpbGRWaWV3KGkpfSxpLnByb3RvdHlwZS5yZWNvcmRDaGlsZFZpZXc9ZnVuY3Rpb24odCl7cmV0dXJuIHQucGFyZW50Vmlldz10aGlzLHQucm9vdFZpZXc9dGhpcy5yb290VmlldyxvLmNhbGwodGhpcy5jaGlsZFZpZXdzLHQpPDAmJnRoaXMuY2hpbGRWaWV3cy5wdXNoKHQpLHR9LGkucHJvdG90eXBlLmdldEFsbENoaWxkVmlld3M9ZnVuY3Rpb24oKXt2YXIgdCxlLG4sbyxpO2ZvcihpPVtdLG89dGhpcy5jaGlsZFZpZXdzLGU9MCxuPW8ubGVuZ3RoO24+ZTtlKyspdD1vW2VdLGkucHVzaCh0KSxpPWkuY29uY2F0KHQuZ2V0QWxsQ2hpbGRWaWV3cygpKTtyZXR1cm4gaX0saS5wcm90b3R5cGUuZmluZEVsZW1lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maW5kRWxlbWVudEZvck9iamVjdCh0aGlzLm9iamVjdCl9LGkucHJvdG90eXBlLmZpbmRFbGVtZW50Rm9yT2JqZWN0PWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybihlPW51bGwhPXQ/dC5pZDp2b2lkIDApP3RoaXMucm9vdFZpZXcuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiW2RhdGEtdHJpeC1pZD0nXCIrZStcIiddXCIpOnZvaWQgMH0saS5wcm90b3R5cGUuZmluZFZpZXdGb3JPYmplY3Q9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGk7Zm9yKG89dGhpcy5nZXRBbGxDaGlsZFZpZXdzKCksZT0wLG49by5sZW5ndGg7bj5lO2UrKylpZihpPW9bZV0saS5vYmplY3Q9PT10KXJldHVybiBpfSxpLnByb3RvdHlwZS5nZXRWaWV3Q2FjaGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb290VmlldyE9PXRoaXM/dGhpcy5yb290Vmlldy5nZXRWaWV3Q2FjaGUoKTp0aGlzLmlzVmlld0NhY2hpbmdFbmFibGVkKCk/bnVsbCE9dGhpcy52aWV3Q2FjaGU/dGhpcy52aWV3Q2FjaGU6dGhpcy52aWV3Q2FjaGU9e306dm9pZCAwfSxpLnByb3RvdHlwZS5pc1ZpZXdDYWNoaW5nRW5hYmxlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNob3VsZENhY2hlVmlld3MhPT0hMX0saS5wcm90b3R5cGUuZW5hYmxlVmlld0NhY2hpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaG91bGRDYWNoZVZpZXdzPSEwfSxpLnByb3RvdHlwZS5kaXNhYmxlVmlld0NhY2hpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaG91bGRDYWNoZVZpZXdzPSExfSxpLnByb3RvdHlwZS5nZXRDYWNoZWRWaWV3Rm9yT2JqZWN0PWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBudWxsIT0oZT10aGlzLmdldFZpZXdDYWNoZSgpKT9lW3QuZ2V0Q2FjaGVLZXkoKV06dm9pZCAwfSxpLnByb3RvdHlwZS5jYWNoZVZpZXdGb3JPYmplY3Q9ZnVuY3Rpb24odCxlKXt2YXIgbjtyZXR1cm4gbnVsbCE9KG49dGhpcy5nZXRWaWV3Q2FjaGUoKSk/bltlLmdldENhY2hlS2V5KCldPXQ6dm9pZCAwfSxpLnByb3RvdHlwZS5nYXJiYWdlQ29sbGVjdENhY2hlZFZpZXdzPWZ1bmN0aW9uKCl7dmFyIHQsZSxuLGkscixzO2lmKHQ9dGhpcy5nZXRWaWV3Q2FjaGUoKSl7cz10aGlzLmdldEFsbENoaWxkVmlld3MoKS5jb25jYXQodGhpcyksbj1mdW5jdGlvbigpe3ZhciB0LGUsbjtmb3Iobj1bXSx0PTAsZT1zLmxlbmd0aDtlPnQ7dCsrKXI9c1t0XSxuLnB1c2goci5vYmplY3QuZ2V0Q2FjaGVLZXkoKSk7cmV0dXJuIG59KCksaT1bXTtmb3IoZSBpbiB0KW8uY2FsbChuLGUpPDAmJmkucHVzaChkZWxldGUgdFtlXSk7cmV0dXJuIGl9fSxpfShlLkJhc2ljT2JqZWN0KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbygpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIGkgaW4gZSluLmNhbGwoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIG8ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBvLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LG49e30uaGFzT3duUHJvcGVydHk7ZS5PYmplY3RHcm91cFZpZXc9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gbigpe24uX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLm9iamVjdEdyb3VwPXRoaXMub2JqZWN0LHRoaXMudmlld0NsYXNzPXRoaXMub3B0aW9ucy52aWV3Q2xhc3MsZGVsZXRlIHRoaXMub3B0aW9ucy52aWV3Q2xhc3N9cmV0dXJuIHQobixlKSxuLnByb3RvdHlwZS5nZXRDaGlsZFZpZXdzPWZ1bmN0aW9uKCl7dmFyIHQsZSxuLG87aWYoIXRoaXMuY2hpbGRWaWV3cy5sZW5ndGgpZm9yKG89dGhpcy5vYmplY3RHcm91cC5nZXRPYmplY3RzKCksdD0wLGU9by5sZW5ndGg7ZT50O3QrKyluPW9bdF0sdGhpcy5maW5kT3JDcmVhdGVDYWNoZWRDaGlsZFZpZXcodGhpcy52aWV3Q2xhc3Msbix0aGlzLm9wdGlvbnMpO3JldHVybiB0aGlzLmNoaWxkVmlld3N9LG4ucHJvdG90eXBlLmNyZWF0ZU5vZGVzPWZ1bmN0aW9uKCl7dmFyIHQsZSxuLG8saSxyLHMsYSx1O2Zvcih0PXRoaXMuY3JlYXRlQ29udGFpbmVyRWxlbWVudCgpLHM9dGhpcy5nZXRDaGlsZFZpZXdzKCksZT0wLG89cy5sZW5ndGg7bz5lO2UrKylmb3IodT1zW2VdLGE9dS5nZXROb2RlcygpLG49MCxpPWEubGVuZ3RoO2k+bjtuKyspcj1hW25dLHQuYXBwZW5kQ2hpbGQocik7cmV0dXJuW3RdfSxuLnByb3RvdHlwZS5jcmVhdGVDb250YWluZXJFbGVtZW50PWZ1bmN0aW9uKHQpe3JldHVybiBudWxsPT10JiYodD10aGlzLm9iamVjdEdyb3VwLmdldERlcHRoKCkpLHRoaXMuZ2V0Q2hpbGRWaWV3cygpWzBdLmNyZWF0ZUNvbnRhaW5lckVsZW1lbnQodCl9LG59KGUuT2JqZWN0Vmlldyl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdD1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG8oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBpIGluIGUpbi5jYWxsKGUsaSkmJih0W2ldPWVbaV0pO3JldHVybiBvLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbyx0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxuPXt9Lmhhc093blByb3BlcnR5O2UuQ29udHJvbGxlcj1mdW5jdGlvbihlKXtmdW5jdGlvbiBuKCl7cmV0dXJuIG4uX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gdChuLGUpLG59KGUuQmFzaWNPYmplY3QpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbixvLGkscixzLGE9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdC5hcHBseShlLGFyZ3VtZW50cyl9fSx1PWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIG8gaW4gZSljLmNhbGwoZSxvKSYmKHRbb109ZVtvXSk7cmV0dXJuIG4ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBuLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LGM9e30uaGFzT3duUHJvcGVydHksbD1bXS5pbmRleE9mfHxmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxuPXRoaXMubGVuZ3RoO24+ZTtlKyspaWYoZSBpbiB0aGlzJiZ0aGlzW2VdPT09dClyZXR1cm4gZTtyZXR1cm4tMX07dD1lLmZpbmRDbG9zZXN0RWxlbWVudEZyb21Ob2RlLG89ZS5ub2RlSXNFbXB0eVRleHROb2RlLG49ZS5ub2RlSXNCbG9ja1N0YXJ0Q29tbWVudCxpPWUubm9ybWFsaXplU3BhY2VzLHI9ZS5zdW1tYXJpemVTdHJpbmdDaGFuZ2Uscz1lLnRhZ05hbWUsZS5NdXRhdGlvbk9ic2VydmVyPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIGModCl7dGhpcy5lbGVtZW50PXQsdGhpcy5kaWRNdXRhdGU9YSh0aGlzLmRpZE11dGF0ZSx0aGlzKSx0aGlzLm9ic2VydmVyPW5ldyB3aW5kb3cuTXV0YXRpb25PYnNlcnZlcih0aGlzLmRpZE11dGF0ZSksdGhpcy5zdGFydCgpfXZhciBoLHAsZCxmO3JldHVybiB1KGMsZSkscD1cImRhdGEtdHJpeC1tdXRhYmxlXCIsZD1cIltcIitwK1wiXVwiLGY9e2F0dHJpYnV0ZXM6ITAsY2hpbGRMaXN0OiEwLGNoYXJhY3RlckRhdGE6ITAsY2hhcmFjdGVyRGF0YU9sZFZhbHVlOiEwLHN1YnRyZWU6ITB9LGMucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzZXQoKSx0aGlzLm9ic2VydmVyLm9ic2VydmUodGhpcy5lbGVtZW50LGYpfSxjLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub2JzZXJ2ZXIuZGlzY29ubmVjdCgpfSxjLnByb3RvdHlwZS5kaWRNdXRhdGU9ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4oZT10aGlzLm11dGF0aW9ucykucHVzaC5hcHBseShlLHRoaXMuZmluZFNpZ25pZmljYW50TXV0YXRpb25zKHQpKSx0aGlzLm11dGF0aW9ucy5sZW5ndGg/KG51bGwhPShuPXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmVsZW1lbnREaWRNdXRhdGUmJm4uZWxlbWVudERpZE11dGF0ZSh0aGlzLmdldE11dGF0aW9uU3VtbWFyeSgpKSx0aGlzLnJlc2V0KCkpOnZvaWQgMH0sYy5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tdXRhdGlvbnM9W119LGMucHJvdG90eXBlLmZpbmRTaWduaWZpY2FudE11dGF0aW9ucz1mdW5jdGlvbih0KXt2YXIgZSxuLG8saTtmb3IoaT1bXSxlPTAsbj10Lmxlbmd0aDtuPmU7ZSsrKW89dFtlXSx0aGlzLm11dGF0aW9uSXNTaWduaWZpY2FudChvKSYmaS5wdXNoKG8pO3JldHVybiBpfSxjLnByb3RvdHlwZS5tdXRhdGlvbklzU2lnbmlmaWNhbnQ9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGk7Zm9yKGk9dGhpcy5ub2Rlc01vZGlmaWVkQnlNdXRhdGlvbih0KSxlPTAsbj1pLmxlbmd0aDtuPmU7ZSsrKWlmKG89aVtlXSx0aGlzLm5vZGVJc1NpZ25pZmljYW50KG8pKXJldHVybiEwO3JldHVybiExfSxjLnByb3RvdHlwZS5ub2RlSXNTaWduaWZpY2FudD1mdW5jdGlvbih0KXtyZXR1cm4gdCE9PXRoaXMuZWxlbWVudCYmIXRoaXMubm9kZUlzTXV0YWJsZSh0KSYmIW8odCl9LGMucHJvdG90eXBlLm5vZGVJc011dGFibGU9ZnVuY3Rpb24oZSl7cmV0dXJuIHQoZSx7bWF0Y2hpbmdTZWxlY3RvcjpkfSl9LGMucHJvdG90eXBlLm5vZGVzTW9kaWZpZWRCeU11dGF0aW9uPWZ1bmN0aW9uKHQpe3ZhciBlO3N3aXRjaChlPVtdLHQudHlwZSl7Y2FzZVwiYXR0cmlidXRlc1wiOnQuYXR0cmlidXRlTmFtZSE9PXAmJmUucHVzaCh0LnRhcmdldCk7YnJlYWs7Y2FzZVwiY2hhcmFjdGVyRGF0YVwiOmUucHVzaCh0LnRhcmdldC5wYXJlbnROb2RlKSxlLnB1c2godC50YXJnZXQpO2JyZWFrO2Nhc2VcImNoaWxkTGlzdFwiOmUucHVzaC5hcHBseShlLHQuYWRkZWROb2RlcyksZS5wdXNoLmFwcGx5KGUsdC5yZW1vdmVkTm9kZXMpfXJldHVybiBlfSxjLnByb3RvdHlwZS5nZXRNdXRhdGlvblN1bW1hcnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRUZXh0TXV0YXRpb25TdW1tYXJ5KCl9LGMucHJvdG90eXBlLmdldFRleHRNdXRhdGlvblN1bW1hcnk9ZnVuY3Rpb24oKXt2YXIgdCxlLG4sbyxpLHIscyxhLHUsYyxoO2ZvcihhPXRoaXMuZ2V0VGV4dENoYW5nZXNGcm9tQ2hhcmFjdGVyRGF0YSgpLG49YS5hZGRpdGlvbnMsaT1hLmRlbGV0aW9ucyxoPXRoaXMuZ2V0VGV4dENoYW5nZXNGcm9tQ2hpbGRMaXN0KCksdT1oLmFkZGl0aW9ucyxyPTAscz11Lmxlbmd0aDtzPnI7cisrKWU9dVtyXSxsLmNhbGwobixlKTwwJiZuLnB1c2goZSk7cmV0dXJuIGkucHVzaC5hcHBseShpLGguZGVsZXRpb25zKSxjPXt9LCh0PW4uam9pbihcIlwiKSkmJihjLnRleHRBZGRlZD10KSwobz1pLmpvaW4oXCJcIikpJiYoYy50ZXh0RGVsZXRlZD1vKSxjfSxjLnByb3RvdHlwZS5nZXRNdXRhdGlvbnNCeVR5cGU9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGkscjtmb3IoaT10aGlzLm11dGF0aW9ucyxyPVtdLGU9MCxuPWkubGVuZ3RoO24+ZTtlKyspbz1pW2VdLG8udHlwZT09PXQmJnIucHVzaChvKTtyZXR1cm4gcn0sYy5wcm90b3R5cGUuZ2V0VGV4dENoYW5nZXNGcm9tQ2hpbGRMaXN0PWZ1bmN0aW9uKCl7dmFyIHQsZSxvLHIscyxhLHUsYyxsLHAsZDtmb3IodD1bXSx1PVtdLGE9dGhpcy5nZXRNdXRhdGlvbnNCeVR5cGUoXCJjaGlsZExpc3RcIiksZT0wLHI9YS5sZW5ndGg7cj5lO2UrKylzPWFbZV0sdC5wdXNoLmFwcGx5KHQscy5hZGRlZE5vZGVzKSx1LnB1c2guYXBwbHkodSxzLnJlbW92ZWROb2Rlcyk7cmV0dXJuIGM9MD09PXQubGVuZ3RoJiYxPT09dS5sZW5ndGgmJm4odVswXSksYz8ocD1bXSxkPVtcIlxcblwiXSk6KHA9aCh0KSxkPWgodSkpLHthZGRpdGlvbnM6ZnVuY3Rpb24oKXt2YXIgdCxlLG47Zm9yKG49W10sbz10PTAsZT1wLmxlbmd0aDtlPnQ7bz0rK3QpbD1wW29dLGwhPT1kW29dJiZuLnB1c2goaShsKSk7cmV0dXJuIG59KCksZGVsZXRpb25zOmZ1bmN0aW9uKCl7dmFyIHQsZSxuO2ZvcihuPVtdLG89dD0wLGU9ZC5sZW5ndGg7ZT50O289Kyt0KWw9ZFtvXSxsIT09cFtvXSYmbi5wdXNoKGkobCkpO3JldHVybiBufSgpfX0sYy5wcm90b3R5cGUuZ2V0VGV4dENoYW5nZXNGcm9tQ2hhcmFjdGVyRGF0YT1mdW5jdGlvbigpe3ZhciB0LGUsbixvLHMsYSx1LGM7cmV0dXJuIGU9dGhpcy5nZXRNdXRhdGlvbnNCeVR5cGUoXCJjaGFyYWN0ZXJEYXRhXCIpLGUubGVuZ3RoJiYoYz1lWzBdLG49ZVtlLmxlbmd0aC0xXSxzPWkoYy5vbGRWYWx1ZSksbz1pKG4udGFyZ2V0LmRhdGEpLGE9cihzLG8pLHQ9YS5hZGRlZCx1PWEucmVtb3ZlZCkse2FkZGl0aW9uczp0P1t0XTpbXSxkZWxldGlvbnM6dT9bdV06W119fSxoPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbyxpO2ZvcihudWxsPT10JiYodD1bXSksaT1bXSxlPTAsbj10Lmxlbmd0aDtuPmU7ZSsrKXN3aXRjaChvPXRbZV0sby5ub2RlVHlwZSl7Y2FzZSBOb2RlLlRFWFRfTk9ERTppLnB1c2goby5kYXRhKTticmVhaztjYXNlIE5vZGUuRUxFTUVOVF9OT0RFOlwiYnJcIj09PXMobyk/aS5wdXNoKFwiXFxuXCIpOmkucHVzaC5hcHBseShpLGgoby5jaGlsZE5vZGVzKSl9cmV0dXJuIGl9LGN9KGUuQmFzaWNPYmplY3QpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQ9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBvKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgaSBpbiBlKW4uY2FsbChlLGkpJiYodFtpXT1lW2ldKTtyZXR1cm4gby5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG8sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0sbj17fS5oYXNPd25Qcm9wZXJ0eTtlLkZpbGVWZXJpZmljYXRpb25PcGVyYXRpb249ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gbih0KXt0aGlzLmZpbGU9dH1yZXR1cm4gdChuLGUpLG4ucHJvdG90eXBlLnBlcmZvcm09ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIGU9bmV3IEZpbGVSZWFkZXIsZS5vbmVycm9yPWZ1bmN0aW9uKCl7cmV0dXJuIHQoITEpfSxlLm9ubG9hZD1mdW5jdGlvbihuKXtyZXR1cm4gZnVuY3Rpb24oKXtlLm9uZXJyb3I9bnVsbDt0cnl7ZS5hYm9ydCgpfWNhdGNoKG8pe31yZXR1cm4gdCghMCxuLmZpbGUpfX0odGhpcyksZS5yZWFkQXNBcnJheUJ1ZmZlcih0aGlzLmZpbGUpfSxufShlLk9wZXJhdGlvbil9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdD1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG8oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBpIGluIGUpbi5jYWxsKGUsaSkmJih0W2ldPWVbaV0pO3JldHVybiBvLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbyx0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxuPXt9Lmhhc093blByb3BlcnR5O2UuQ29tcG9zaXRpb25JbnB1dD1mdW5jdGlvbihlKXtmdW5jdGlvbiBuKHQpe3ZhciBlO3RoaXMuaW5wdXRDb250cm9sbGVyPXQsZT10aGlzLmlucHV0Q29udHJvbGxlcix0aGlzLnJlc3BvbmRlcj1lLnJlc3BvbmRlcix0aGlzLmRlbGVnYXRlPWUuZGVsZWdhdGUsdGhpcy5pbnB1dFN1bW1hcnk9ZS5pbnB1dFN1bW1hcnksdGhpcy5kYXRhPXt9fXJldHVybiB0KG4sZSksbi5wcm90b3R5cGUuc3RhcnQ9ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4gdGhpcy5kYXRhLnN0YXJ0PXQsXCJrZXlwcmVzc1wiPT09dGhpcy5pbnB1dFN1bW1hcnkuZXZlbnROYW1lJiZ0aGlzLmlucHV0U3VtbWFyeS50ZXh0QWRkZWQmJm51bGwhPShlPXRoaXMucmVzcG9uZGVyKSYmZS5kZWxldGVJbkRpcmVjdGlvbihcImxlZnRcIiksdGhpcy5zZWxlY3Rpb25Jc0V4cGFuZGVkKCl8fCh0aGlzLmluc2VydFBsYWNlaG9sZGVyKCksdGhpcy5yZXF1ZXN0UmVuZGVyKCkpLHRoaXMucmFuZ2U9bnVsbCE9KG49dGhpcy5yZXNwb25kZXIpP24uZ2V0U2VsZWN0ZWRSYW5nZSgpOnZvaWQgMH0sbi5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiB0aGlzLmRhdGEudXBkYXRlPXQsKGU9dGhpcy5zZWxlY3RQbGFjZWhvbGRlcigpKT8odGhpcy5mb3JnZXRQbGFjZWhvbGRlcigpLHRoaXMucmFuZ2U9ZSk6dm9pZCAwfSxuLnByb3RvdHlwZS5lbmQ9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGk7cmV0dXJuIHRoaXMuZGF0YS5lbmQ9dCx0aGlzLmZvcmdldFBsYWNlaG9sZGVyKCksdGhpcy5jYW5BcHBseVRvRG9jdW1lbnQoKT8odGhpcy5zZXRJbnB1dFN1bW1hcnkoe3ByZWZlckRvY3VtZW50OiEwfSksbnVsbCE9KGU9dGhpcy5kZWxlZ2F0ZSkmJmUuaW5wdXRDb250cm9sbGVyV2lsbFBlcmZvcm1UeXBpbmcoKSxudWxsIT0obj10aGlzLnJlc3BvbmRlcikmJm4uc2V0U2VsZWN0ZWRSYW5nZSh0aGlzLnJhbmdlKSxudWxsIT0obz10aGlzLnJlc3BvbmRlcikmJm8uaW5zZXJ0U3RyaW5nKHRoaXMuZGF0YS5lbmQpLG51bGwhPShpPXRoaXMucmVzcG9uZGVyKT9pLnNldFNlbGVjdGVkUmFuZ2UodGhpcy5yYW5nZVswXSt0aGlzLmRhdGEuZW5kLmxlbmd0aCk6dm9pZCAwKTpudWxsIT10aGlzLmRhdGEuc3RhcnR8fG51bGwhPXRoaXMuZGF0YS51cGRhdGU/KHRoaXMucmVxdWVzdFJlcGFyc2UoKSx0aGlzLmlucHV0Q29udHJvbGxlci5yZXNldCgpKTp2b2lkIDB9LG4ucHJvdG90eXBlLmdldEVuZERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kYXRhLmVuZH0sbi5wcm90b3R5cGUuaXNFbmRlZD1mdW5jdGlvbigpe3JldHVybiBudWxsIT10aGlzLmdldEVuZERhdGEoKX0sbi5wcm90b3R5cGUuY2FuQXBwbHlUb0RvY3VtZW50PWZ1bmN0aW9uKCl7dmFyIHQsZTtyZXR1cm4gMD09PShudWxsIT0odD10aGlzLmRhdGEuc3RhcnQpP3QubGVuZ3RoOnZvaWQgMCkmJihudWxsIT0oZT10aGlzLmRhdGEuZW5kKT9lLmxlbmd0aDp2b2lkIDApPjAmJm51bGwhPXRoaXMucmFuZ2V9LG4ucHJveHlNZXRob2QoXCJpbnB1dENvbnRyb2xsZXIuc2V0SW5wdXRTdW1tYXJ5XCIpLG4ucHJveHlNZXRob2QoXCJpbnB1dENvbnRyb2xsZXIucmVxdWVzdFJlbmRlclwiKSxuLnByb3h5TWV0aG9kKFwiaW5wdXRDb250cm9sbGVyLnJlcXVlc3RSZXBhcnNlXCIpLG4ucHJveHlNZXRob2QoXCJyZXNwb25kZXI/LnNlbGVjdGlvbklzRXhwYW5kZWRcIiksbi5wcm94eU1ldGhvZChcInJlc3BvbmRlcj8uaW5zZXJ0UGxhY2Vob2xkZXJcIiksbi5wcm94eU1ldGhvZChcInJlc3BvbmRlcj8uc2VsZWN0UGxhY2Vob2xkZXJcIiksbi5wcm94eU1ldGhvZChcInJlc3BvbmRlcj8uZm9yZ2V0UGxhY2Vob2xkZXJcIiksbn0oZS5CYXNpY09iamVjdCl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuLG8saSxyLHMsYSx1LGMsbCxoLHAsZCxmPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIG8gaW4gZSlnLmNhbGwoZSxvKSYmKHRbb109ZVtvXSk7cmV0dXJuIG4ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBuLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LGc9e30uaGFzT3duUHJvcGVydHksbT1bXS5pbmRleE9mfHxmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxuPXRoaXMubGVuZ3RoO24+ZTtlKyspaWYoZSBpbiB0aGlzJiZ0aGlzW2VdPT09dClyZXR1cm4gZTtyZXR1cm4tMX07aT1lLmhhbmRsZUV2ZW50LGM9ZS5tYWtlRWxlbWVudCxyPWUuaW5uZXJFbGVtZW50SXNBY3RpdmUsbD1lLm9iamVjdHNBcmVFcXVhbCxwPWUudGFnTmFtZSxlLklucHV0Q29udHJvbGxlcj1mdW5jdGlvbihwKXtmdW5jdGlvbiBkKHQpe3ZhciBuO3RoaXMuZWxlbWVudD10LHRoaXMucmVzZXRJbnB1dFN1bW1hcnkoKSx0aGlzLm11dGF0aW9uT2JzZXJ2ZXI9bmV3IGUuTXV0YXRpb25PYnNlcnZlcih0aGlzLmVsZW1lbnQpLHRoaXMubXV0YXRpb25PYnNlcnZlci5kZWxlZ2F0ZT10aGlzO2ZvcihuIGluIHRoaXMuZXZlbnRzKWkobix7b25FbGVtZW50OnRoaXMuZWxlbWVudCx3aXRoQ2FsbGJhY2s6dGhpcy5oYW5kbGVyRm9yKG4pLGluUGhhc2U6XCJjYXB0dXJpbmdcIn0pfXZhciBnO3JldHVybiBmKGQscCksZz0wLGQua2V5TmFtZXM9ezg6XCJiYWNrc3BhY2VcIiw5OlwidGFiXCIsMTM6XCJyZXR1cm5cIiwzNzpcImxlZnRcIiwzOTpcInJpZ2h0XCIsNDY6XCJkZWxldGVcIiw2ODpcImRcIiw3MjpcImhcIiw3OTpcIm9cIn0sZC5wcm90b3R5cGUuaGFuZGxlckZvcj1mdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKG4pe3JldHVybiBlLmhhbmRsZUlucHV0KGZ1bmN0aW9uKCl7cmV0dXJuIHIodGhpcy5lbGVtZW50KT92b2lkIDA6KHRoaXMuZXZlbnROYW1lPXQsdGhpcy5ldmVudHNbdF0uY2FsbCh0aGlzLG4pKX0pfX0odGhpcyl9LGQucHJvdG90eXBlLnNldElucHV0U3VtbWFyeT1mdW5jdGlvbih0KXt2YXIgZSxuO251bGw9PXQmJih0PXt9KSx0aGlzLmlucHV0U3VtbWFyeS5ldmVudE5hbWU9dGhpcy5ldmVudE5hbWU7Zm9yKGUgaW4gdCluPXRbZV0sdGhpcy5pbnB1dFN1bW1hcnlbZV09bjtyZXR1cm4gdGhpcy5pbnB1dFN1bW1hcnl9LGQucHJvdG90eXBlLnJlc2V0SW5wdXRTdW1tYXJ5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5wdXRTdW1tYXJ5PXt9fSxkLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlc2V0SW5wdXRTdW1tYXJ5KCksZS5zZWxlY3Rpb25DaGFuZ2VPYnNlcnZlci5yZXNldCgpfSxkLnByb3RvdHlwZS5lZGl0b3JXaWxsU3luY0RvY3VtZW50Vmlldz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIuc3RvcCgpfSxkLnByb3RvdHlwZS5lZGl0b3JEaWRTeW5jRG9jdW1lbnRWaWV3PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubXV0YXRpb25PYnNlcnZlci5zdGFydCgpfSxkLnByb3RvdHlwZS5yZXF1ZXN0UmVuZGVyPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIG51bGwhPSh0PXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0LmlucHV0Q29udHJvbGxlckRpZFJlcXVlc3RSZW5kZXI/dC5pbnB1dENvbnRyb2xsZXJEaWRSZXF1ZXN0UmVuZGVyKCk6dm9pZCAwfSxkLnByb3RvdHlwZS5yZXF1ZXN0UmVwYXJzZT1mdW5jdGlvbigpe3ZhciB0O3JldHVybiBudWxsIT0odD10aGlzLmRlbGVnYXRlKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgdC5pbnB1dENvbnRyb2xsZXJEaWRSZXF1ZXN0UmVwYXJzZSYmdC5pbnB1dENvbnRyb2xsZXJEaWRSZXF1ZXN0UmVwYXJzZSgpLHRoaXMucmVxdWVzdFJlbmRlcigpfSxkLnByb3RvdHlwZS5lbGVtZW50RGlkTXV0YXRlPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiB0aGlzLmlzQ29tcG9zaW5nKCk/bnVsbCE9KGU9dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGUuaW5wdXRDb250cm9sbGVyRGlkQWxsb3dVbmhhbmRsZWRJbnB1dD9lLmlucHV0Q29udHJvbGxlckRpZEFsbG93VW5oYW5kbGVkSW5wdXQoKTp2b2lkIDA6dGhpcy5oYW5kbGVJbnB1dChmdW5jdGlvbigpe3JldHVybiB0aGlzLm11dGF0aW9uSXNTaWduaWZpY2FudCh0KSYmKHRoaXMubXV0YXRpb25Jc0V4cGVjdGVkKHQpP3RoaXMucmVxdWVzdFJlbmRlcigpOnRoaXMucmVxdWVzdFJlcGFyc2UoKSksdGhpcy5yZXNldCgpfSl9LGQucHJvdG90eXBlLm11dGF0aW9uSXNFeHBlY3RlZD1mdW5jdGlvbih0KXt2YXIgZSxuLG8saSxyLHMsYSx1LGMsbDtyZXR1cm4gYT10LnRleHRBZGRlZCx1PXQudGV4dERlbGV0ZWQsdGhpcy5pbnB1dFN1bW1hcnkucHJlZmVyRG9jdW1lbnQ/ITA6KGU9bnVsbCE9YT9hPT09dGhpcy5pbnB1dFN1bW1hcnkudGV4dEFkZGVkOiF0aGlzLmlucHV0U3VtbWFyeS50ZXh0QWRkZWQsbj1udWxsIT11P3RoaXMuaW5wdXRTdW1tYXJ5LmRpZERlbGV0ZTohdGhpcy5pbnB1dFN1bW1hcnkuZGlkRGVsZXRlLGM9XCJcXG5cIj09PWEmJiFlLGw9XCJcXG5cIj09PXUmJiFuLHM9YyYmIWx8fGwmJiFjLHMmJihpPXRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpKSYmKG89Yz8tMToxLG51bGwhPShyPXRoaXMucmVzcG9uZGVyKT9yLnBvc2l0aW9uSXNCbG9ja0JyZWFrKGlbMV0rbyk6dm9pZCAwKT8hMDplJiZuKX0sZC5wcm90b3R5cGUubXV0YXRpb25Jc1NpZ25pZmljYW50PWZ1bmN0aW9uKHQpe3ZhciBlLG4sbztyZXR1cm4gbz1PYmplY3Qua2V5cyh0KS5sZW5ndGg+MCxlPVwiXCI9PT0obnVsbCE9KG49dGhpcy5jb21wb3NpdGlvbklucHV0KT9uLmdldEVuZERhdGEoKTp2b2lkIDApLG98fCFlfSxkLnByb3RvdHlwZS5hdHRhY2hGaWxlcz1mdW5jdGlvbih0KXt2YXIgbixvO3JldHVybiBvPWZ1bmN0aW9uKCl7dmFyIG8saSxyO2ZvcihyPVtdLG89MCxpPXQubGVuZ3RoO2k+bztvKyspbj10W29dLHIucHVzaChuZXcgZS5GaWxlVmVyaWZpY2F0aW9uT3BlcmF0aW9uKG4pKTtyZXR1cm4gcn0oKSxQcm9taXNlLmFsbChvKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gdC5oYW5kbGVJbnB1dChmdW5jdGlvbigpe3ZhciB0LG47cmV0dXJuIG51bGwhPSh0PXRoaXMuZGVsZWdhdGUpJiZ0LmlucHV0Q29udHJvbGxlcldpbGxBdHRhY2hGaWxlcygpLG51bGwhPShuPXRoaXMucmVzcG9uZGVyKSYmbi5pbnNlcnRGaWxlcyhlKSx0aGlzLnJlcXVlc3RSZW5kZXIoKX0pfX0odGhpcykpfSxkLnByb3RvdHlwZS5ldmVudHM9e2tleWRvd246ZnVuY3Rpb24odCl7dmFyIG4sbyxpLHIsYSx1LGMsbCxoO2lmKHRoaXMuaXNDb21wb3NpbmcoKXx8dGhpcy5yZXNldElucHV0U3VtbWFyeSgpLHI9dGhpcy5jb25zdHJ1Y3Rvci5rZXlOYW1lc1t0LmtleUNvZGVdKXtmb3Iobz10aGlzLmtleXMsbD1bXCJjdHJsXCIsXCJhbHRcIixcInNoaWZ0XCIsXCJtZXRhXCJdLGk9MCx1PWwubGVuZ3RoO3U+aTtpKyspYz1sW2ldLHRbYytcIktleVwiXSYmKFwiY3RybFwiPT09YyYmKGM9XCJjb250cm9sXCIpLG89bnVsbCE9bz9vW2NdOnZvaWQgMCk7bnVsbCE9KG51bGwhPW8/b1tyXTp2b2lkIDApJiYodGhpcy5zZXRJbnB1dFN1bW1hcnkoe2tleU5hbWU6cn0pLGUuc2VsZWN0aW9uQ2hhbmdlT2JzZXJ2ZXIucmVzZXQoKSxvW3JdLmNhbGwodGhpcyx0KSl9cmV0dXJuIHModCkmJihuPVN0cmluZy5mcm9tQ2hhckNvZGUodC5rZXlDb2RlKS50b0xvd2VyQ2FzZSgpKSYmKGE9ZnVuY3Rpb24oKXt2YXIgZSxuLG8saTtmb3Iobz1bXCJhbHRcIixcInNoaWZ0XCJdLGk9W10sZT0wLG49by5sZW5ndGg7bj5lO2UrKyljPW9bZV0sdFtjK1wiS2V5XCJdJiZpLnB1c2goYyk7cmV0dXJuIGl9KCksYS5wdXNoKG4pLG51bGwhPShoPXRoaXMuZGVsZWdhdGUpP2guaW5wdXRDb250cm9sbGVyRGlkUmVjZWl2ZUtleWJvYXJkQ29tbWFuZChhKTp2b2lkIDApP3QucHJldmVudERlZmF1bHQoKTp2b2lkIDB9LGtleXByZXNzOmZ1bmN0aW9uKHQpe3ZhciBlLG4sbztpZihudWxsPT10aGlzLmlucHV0U3VtbWFyeS5ldmVudE5hbWUmJighdC5tZXRhS2V5JiYhdC5jdHJsS2V5fHx0LmFsdEtleSkmJiF1KHQpJiYhYSh0KSlyZXR1cm4gbnVsbD09PXQud2hpY2g/ZT1TdHJpbmcuZnJvbUNoYXJDb2RlKHQua2V5Q29kZSk6MCE9PXQud2hpY2gmJjAhPT10LmNoYXJDb2RlJiYoZT1TdHJpbmcuZnJvbUNoYXJDb2RlKHQuY2hhckNvZGUpKSxudWxsIT1lPyhudWxsIT0obj10aGlzLmRlbGVnYXRlKSYmbi5pbnB1dENvbnRyb2xsZXJXaWxsUGVyZm9ybVR5cGluZygpLG51bGwhPShvPXRoaXMucmVzcG9uZGVyKSYmby5pbnNlcnRTdHJpbmcoZSksdGhpcy5zZXRJbnB1dFN1bW1hcnkoe3RleHRBZGRlZDplLGRpZERlbGV0ZTp0aGlzLnNlbGVjdGlvbklzRXhwYW5kZWQoKX0pKTp2b2lkIDB9LHRleHRJbnB1dDpmdW5jdGlvbih0KXt2YXIgZSxuLG8saTtyZXR1cm4gZT10LmRhdGEsaT10aGlzLmlucHV0U3VtbWFyeS50ZXh0QWRkZWQsaSYmaSE9PWUmJmkudG9VcHBlckNhc2UoKT09PWU/KG49dGhpcy5nZXRTZWxlY3RlZFJhbmdlKCksdGhpcy5zZXRTZWxlY3RlZFJhbmdlKFtuWzBdLG5bMV0raS5sZW5ndGhdKSxudWxsIT0obz10aGlzLnJlc3BvbmRlcikmJm8uaW5zZXJ0U3RyaW5nKGUpLHRoaXMuc2V0SW5wdXRTdW1tYXJ5KHt0ZXh0QWRkZWQ6ZX0pLHRoaXMuc2V0U2VsZWN0ZWRSYW5nZShuKSk6dm9pZCAwfSxkcmFnZW50ZXI6ZnVuY3Rpb24odCl7cmV0dXJuIHQucHJldmVudERlZmF1bHQoKX0sZHJhZ3N0YXJ0OmZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIG49dC50YXJnZXQsdGhpcy5zZXJpYWxpemVTZWxlY3Rpb25Ub0RhdGFUcmFuc2Zlcih0LmRhdGFUcmFuc2ZlciksdGhpcy5kcmFnZ2VkUmFuZ2U9dGhpcy5nZXRTZWxlY3RlZFJhbmdlKCksbnVsbCE9KGU9dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGUuaW5wdXRDb250cm9sbGVyRGlkU3RhcnREcmFnP2UuaW5wdXRDb250cm9sbGVyRGlkU3RhcnREcmFnKCk6dm9pZCAwfSxkcmFnb3ZlcjpmdW5jdGlvbih0KXt2YXIgZSxuO3JldHVybiF0aGlzLmRyYWdnZWRSYW5nZSYmIXRoaXMuY2FuQWNjZXB0RGF0YVRyYW5zZmVyKHQuZGF0YVRyYW5zZmVyKXx8KHQucHJldmVudERlZmF1bHQoKSxlPXt4OnQuY2xpZW50WCx5OnQuY2xpZW50WX0sbChlLHRoaXMuZHJhZ2dpbmdQb2ludCkpP3ZvaWQgMDoodGhpcy5kcmFnZ2luZ1BvaW50PWUsbnVsbCE9KG49dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4uaW5wdXRDb250cm9sbGVyRGlkUmVjZWl2ZURyYWdPdmVyUG9pbnQ/bi5pbnB1dENvbnRyb2xsZXJEaWRSZWNlaXZlRHJhZ092ZXJQb2ludCh0aGlzLmRyYWdnaW5nUG9pbnQpOnZvaWQgMCl9LGRyYWdlbmQ6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gbnVsbCE9KHQ9dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQuaW5wdXRDb250cm9sbGVyRGlkQ2FuY2VsRHJhZyYmdC5pbnB1dENvbnRyb2xsZXJEaWRDYW5jZWxEcmFnKCksdGhpcy5kcmFnZ2VkUmFuZ2U9bnVsbCx0aGlzLmRyYWdnaW5nUG9pbnQ9bnVsbH0sZHJvcDpmdW5jdGlvbih0KXt2YXIgbixvLGkscixzLGEsdSxjLGw7cmV0dXJuIHQucHJldmVudERlZmF1bHQoKSxpPW51bGwhPShzPXQuZGF0YVRyYW5zZmVyKT9zLmZpbGVzOnZvaWQgMCxyPXt4OnQuY2xpZW50WCx5OnQuY2xpZW50WX0sbnVsbCE9KGE9dGhpcy5yZXNwb25kZXIpJiZhLnNldExvY2F0aW9uUmFuZ2VGcm9tUG9pbnRSYW5nZShyKSwobnVsbCE9aT9pLmxlbmd0aDp2b2lkIDApP3RoaXMuYXR0YWNoRmlsZXMoaSk6dGhpcy5kcmFnZ2VkUmFuZ2U/KG51bGwhPSh1PXRoaXMuZGVsZWdhdGUpJiZ1LmlucHV0Q29udHJvbGxlcldpbGxNb3ZlVGV4dCgpLG51bGwhPShjPXRoaXMucmVzcG9uZGVyKSYmYy5tb3ZlVGV4dEZyb21SYW5nZSh0aGlzLmRyYWdnZWRSYW5nZSksdGhpcy5kcmFnZ2VkUmFuZ2U9bnVsbCx0aGlzLnJlcXVlc3RSZW5kZXIoKSk6KG89dC5kYXRhVHJhbnNmZXIuZ2V0RGF0YShcImFwcGxpY2F0aW9uL3gtdHJpeC1kb2N1bWVudFwiKSkmJihuPWUuRG9jdW1lbnQuZnJvbUpTT05TdHJpbmcobyksbnVsbCE9KGw9dGhpcy5yZXNwb25kZXIpJiZsLmluc2VydERvY3VtZW50KG4pLHRoaXMucmVxdWVzdFJlbmRlcigpKSx0aGlzLmRyYWdnZWRSYW5nZT1udWxsLHRoaXMuZHJhZ2dpbmdQb2ludD1udWxsfSxjdXQ6ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIHRoaXMuc2VyaWFsaXplU2VsZWN0aW9uVG9EYXRhVHJhbnNmZXIodC5jbGlwYm9hcmREYXRhKSYmdC5wcmV2ZW50RGVmYXVsdCgpLG51bGwhPShlPXRoaXMuZGVsZWdhdGUpJiZlLmlucHV0Q29udHJvbGxlcldpbGxDdXRUZXh0KCksdGhpcy5kZWxldGVJbkRpcmVjdGlvbihcImJhY2t3YXJkXCIpLHQuZGVmYXVsdFByZXZlbnRlZD90aGlzLnJlcXVlc3RSZW5kZXIoKTp2b2lkIDB9LGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2VyaWFsaXplU2VsZWN0aW9uVG9EYXRhVHJhbnNmZXIodC5jbGlwYm9hcmREYXRhKT90LnByZXZlbnREZWZhdWx0KCk6dm9pZCAwfSxwYXN0ZTpmdW5jdGlvbihuKXt2YXIgaSxyLHMsYSx1LGMsbCxwLGQsZix5LHYsYixBLEMsdyx4LEUsUyxrLFIsTDtyZXR1cm4gdT1udWxsIT0obD1uLmNsaXBib2FyZERhdGEpP2w6bi50ZXN0Q2xpcGJvYXJkRGF0YSxjPXtwYXN0ZTp1fSxudWxsPT11fHxoKG4pP3ZvaWQgdGhpcy5nZXRQYXN0ZWRIVE1MVXNpbmdIaWRkZW5FbGVtZW50KGZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlKXt2YXIgbixvLGk7cmV0dXJuIGMuaHRtbD1lLG51bGwhPShuPXQuZGVsZWdhdGUpJiZuLmlucHV0Q29udHJvbGxlcldpbGxQYXN0ZVRleHQoYyksbnVsbCE9KG89dC5yZXNwb25kZXIpJiZvLmluc2VydEhUTUwoZSksdC5yZXF1ZXN0UmVuZGVyKCksbnVsbCE9KGk9dC5kZWxlZ2F0ZSk/aS5pbnB1dENvbnRyb2xsZXJEaWRQYXN0ZShjKTp2b2lkIDB9fSh0aGlzKSk6KChzPXUuZ2V0RGF0YShcIlVSTFwiKSk/KEw9dS5nZXREYXRhKFwicHVibGljLnVybC1uYW1lXCIpfHxzLGMuc3RyaW5nPUwsdGhpcy5zZXRJbnB1dFN1bW1hcnkoe3RleHRBZGRlZDpMLGRpZERlbGV0ZTp0aGlzLnNlbGVjdGlvbklzRXhwYW5kZWQoKX0pLG51bGwhPShwPXRoaXMuZGVsZWdhdGUpJiZwLmlucHV0Q29udHJvbGxlcldpbGxQYXN0ZVRleHQoYyksbnVsbCE9KEE9dGhpcy5yZXNwb25kZXIpJiZBLmluc2VydFRleHQoZS5UZXh0LnRleHRGb3JTdHJpbmdXaXRoQXR0cmlidXRlcyhMLHtocmVmOnN9KSksdGhpcy5yZXF1ZXN0UmVuZGVyKCksbnVsbCE9KEM9dGhpcy5kZWxlZ2F0ZSkmJkMuaW5wdXRDb250cm9sbGVyRGlkUGFzdGUoYykpOnQodSk/KEw9dS5nZXREYXRhKFwidGV4dC9wbGFpblwiKSxjLnN0cmluZz1MLHRoaXMuc2V0SW5wdXRTdW1tYXJ5KHt0ZXh0QWRkZWQ6TCxkaWREZWxldGU6dGhpcy5zZWxlY3Rpb25Jc0V4cGFuZGVkKCl9KSxudWxsIT0odz10aGlzLmRlbGVnYXRlKSYmdy5pbnB1dENvbnRyb2xsZXJXaWxsUGFzdGVUZXh0KGMpLG51bGwhPSh4PXRoaXMucmVzcG9uZGVyKSYmeC5pbnNlcnRTdHJpbmcoTCksdGhpcy5yZXF1ZXN0UmVuZGVyKCksbnVsbCE9KEU9dGhpcy5kZWxlZ2F0ZSkmJkUuaW5wdXRDb250cm9sbGVyRGlkUGFzdGUoYykpOihhPXUuZ2V0RGF0YShcInRleHQvaHRtbFwiKSk/KGMuaHRtbD1hLG51bGwhPShTPXRoaXMuZGVsZWdhdGUpJiZTLmlucHV0Q29udHJvbGxlcldpbGxQYXN0ZVRleHQoYyksbnVsbCE9KGs9dGhpcy5yZXNwb25kZXIpJiZrLmluc2VydEhUTUwoYSksdGhpcy5yZXF1ZXN0UmVuZGVyKCksbnVsbCE9KFI9dGhpcy5kZWxlZ2F0ZSkmJlIuaW5wdXRDb250cm9sbGVyRGlkUGFzdGUoYykpOm0uY2FsbCh1LnR5cGVzLFwiRmlsZXNcIik+PTAmJihyPW51bGwhPShkPXUuaXRlbXMpJiZudWxsIT0oZj1kWzBdKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgZi5nZXRBc0ZpbGU/Zi5nZXRBc0ZpbGUoKTp2b2lkIDApJiYoIXIubmFtZSYmKGk9byhyKSkmJihyLm5hbWU9XCJwYXN0ZWQtZmlsZS1cIisgKytnK1wiLlwiK2kpLGMuZmlsZT1yLG51bGwhPSh5PXRoaXMuZGVsZWdhdGUpJiZ5LmlucHV0Q29udHJvbGxlcldpbGxBdHRhY2hGaWxlcygpLG51bGwhPSh2PXRoaXMucmVzcG9uZGVyKSYmdi5pbnNlcnRGaWxlKHIpLHRoaXMucmVxdWVzdFJlbmRlcigpLG51bGwhPShiPXRoaXMuZGVsZWdhdGUpJiZiLmlucHV0Q29udHJvbGxlckRpZFBhc3RlKGMpKSxuLnByZXZlbnREZWZhdWx0KCkpfSxjb21wb3NpdGlvbnN0YXJ0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldENvbXBvc2l0aW9uSW5wdXQoKS5zdGFydCh0LmRhdGEpfSxjb21wb3NpdGlvbnVwZGF0ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5nZXRDb21wb3NpdGlvbklucHV0KCkudXBkYXRlKHQuZGF0YSl9LGNvbXBvc2l0aW9uZW5kOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldENvbXBvc2l0aW9uSW5wdXQoKS5lbmQodC5kYXRhKX0saW5wdXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQuc3RvcFByb3BhZ2F0aW9uKCl9fSxkLnByb3RvdHlwZS5rZXlzPXtiYWNrc3BhY2U6ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIG51bGwhPShlPXRoaXMuZGVsZWdhdGUpJiZlLmlucHV0Q29udHJvbGxlcldpbGxQZXJmb3JtVHlwaW5nKCksdGhpcy5kZWxldGVJbkRpcmVjdGlvbihcImJhY2t3YXJkXCIsdCl9LFwiZGVsZXRlXCI6ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIG51bGwhPShlPXRoaXMuZGVsZWdhdGUpJiZlLmlucHV0Q29udHJvbGxlcldpbGxQZXJmb3JtVHlwaW5nKCksdGhpcy5kZWxldGVJbkRpcmVjdGlvbihcImZvcndhcmRcIix0KX0sXCJyZXR1cm5cIjpmdW5jdGlvbigpe3ZhciB0LGU7cmV0dXJuIHRoaXMuc2V0SW5wdXRTdW1tYXJ5KHtwcmVmZXJEb2N1bWVudDohMH0pLG51bGwhPSh0PXRoaXMuZGVsZWdhdGUpJiZ0LmlucHV0Q29udHJvbGxlcldpbGxQZXJmb3JtVHlwaW5nKCksbnVsbCE9KGU9dGhpcy5yZXNwb25kZXIpP2UuaW5zZXJ0TGluZUJyZWFrKCk6dm9pZCAwfSx0YWI6ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4obnVsbCE9KGU9dGhpcy5yZXNwb25kZXIpP2UuY2FuSW5jcmVhc2VOZXN0aW5nTGV2ZWwoKTp2b2lkIDApPyhudWxsIT0obj10aGlzLnJlc3BvbmRlcikmJm4uaW5jcmVhc2VOZXN0aW5nTGV2ZWwoKSx0aGlzLnJlcXVlc3RSZW5kZXIoKSx0LnByZXZlbnREZWZhdWx0KCkpOnZvaWQgMH0sbGVmdDpmdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gdGhpcy5zZWxlY3Rpb25Jc0luQ3Vyc29yVGFyZ2V0KCk/KHQucHJldmVudERlZmF1bHQoKSxudWxsIT0oZT10aGlzLnJlc3BvbmRlcik/ZS5tb3ZlQ3Vyc29ySW5EaXJlY3Rpb24oXCJiYWNrd2FyZFwiKTp2b2lkIDApOnZvaWQgMH0scmlnaHQ6ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIHRoaXMuc2VsZWN0aW9uSXNJbkN1cnNvclRhcmdldCgpPyh0LnByZXZlbnREZWZhdWx0KCksbnVsbCE9KGU9dGhpcy5yZXNwb25kZXIpP2UubW92ZUN1cnNvckluRGlyZWN0aW9uKFwiZm9yd2FyZFwiKTp2b2lkIDApOnZvaWQgMH0sY29udHJvbDp7ZDpmdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gbnVsbCE9KGU9dGhpcy5kZWxlZ2F0ZSkmJmUuaW5wdXRDb250cm9sbGVyV2lsbFBlcmZvcm1UeXBpbmcoKSx0aGlzLmRlbGV0ZUluRGlyZWN0aW9uKFwiZm9yd2FyZFwiLHQpfSxoOmZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBudWxsIT0oZT10aGlzLmRlbGVnYXRlKSYmZS5pbnB1dENvbnRyb2xsZXJXaWxsUGVyZm9ybVR5cGluZygpLHRoaXMuZGVsZXRlSW5EaXJlY3Rpb24oXCJiYWNrd2FyZFwiLHQpfSxvOmZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIHQucHJldmVudERlZmF1bHQoKSxudWxsIT0oZT10aGlzLmRlbGVnYXRlKSYmZS5pbnB1dENvbnRyb2xsZXJXaWxsUGVyZm9ybVR5cGluZygpLG51bGwhPShuPXRoaXMucmVzcG9uZGVyKSYmbi5pbnNlcnRTdHJpbmcoXCJcXG5cIix7dXBkYXRlUG9zaXRpb246ITF9KSx0aGlzLnJlcXVlc3RSZW5kZXIoKX19LHNoaWZ0OntcInJldHVyblwiOmZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIG51bGwhPShlPXRoaXMuZGVsZWdhdGUpJiZlLmlucHV0Q29udHJvbGxlcldpbGxQZXJmb3JtVHlwaW5nKCksbnVsbCE9KG49dGhpcy5yZXNwb25kZXIpJiZuLmluc2VydFN0cmluZyhcIlxcblwiKSx0aGlzLnJlcXVlc3RSZW5kZXIoKSx0LnByZXZlbnREZWZhdWx0KCl9LHRhYjpmdW5jdGlvbih0KXt2YXIgZSxuO3JldHVybihudWxsIT0oZT10aGlzLnJlc3BvbmRlcik/ZS5jYW5EZWNyZWFzZU5lc3RpbmdMZXZlbCgpOnZvaWQgMCk/KG51bGwhPShuPXRoaXMucmVzcG9uZGVyKSYmbi5kZWNyZWFzZU5lc3RpbmdMZXZlbCgpLHRoaXMucmVxdWVzdFJlbmRlcigpLHQucHJldmVudERlZmF1bHQoKSk6dm9pZCAwfSxsZWZ0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNlbGVjdGlvbklzSW5DdXJzb3JUYXJnZXQoKT8odC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuZXhwYW5kU2VsZWN0aW9uSW5EaXJlY3Rpb24oXCJiYWNrd2FyZFwiKSk6dm9pZCAwfSxyaWdodDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zZWxlY3Rpb25Jc0luQ3Vyc29yVGFyZ2V0KCk/KHQucHJldmVudERlZmF1bHQoKSx0aGlzLmV4cGFuZFNlbGVjdGlvbkluRGlyZWN0aW9uKFwiZm9yd2FyZFwiKSk6dm9pZCAwfX0sYWx0OntiYWNrc3BhY2U6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdGhpcy5zZXRJbnB1dFN1bW1hcnkoe3ByZWZlckRvY3VtZW50OiExfSksbnVsbCE9KHQ9dGhpcy5kZWxlZ2F0ZSk/dC5pbnB1dENvbnRyb2xsZXJXaWxsUGVyZm9ybVR5cGluZygpOnZvaWQgMH19LG1ldGE6e2JhY2tzcGFjZTpmdW5jdGlvbigpe3ZhciB0O3JldHVybiB0aGlzLnNldElucHV0U3VtbWFyeSh7cHJlZmVyRG9jdW1lbnQ6ITF9KSxudWxsIT0odD10aGlzLmRlbGVnYXRlKT90LmlucHV0Q29udHJvbGxlcldpbGxQZXJmb3JtVHlwaW5nKCk6dm9pZCAwfX19LGQucHJvdG90eXBlLmhhbmRsZUlucHV0PWZ1bmN0aW9uKHQpe3ZhciBlLG47dHJ5e3JldHVybiBudWxsIT0oZT10aGlzLmRlbGVnYXRlKSYmZS5pbnB1dENvbnRyb2xsZXJXaWxsSGFuZGxlSW5wdXQoKSx0LmNhbGwodGhpcyl9ZmluYWxseXtudWxsIT0obj10aGlzLmRlbGVnYXRlKSYmbi5pbnB1dENvbnRyb2xsZXJEaWRIYW5kbGVJbnB1dCgpfX0sZC5wcm90b3R5cGUuZ2V0Q29tcG9zaXRpb25JbnB1dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzQ29tcG9zaW5nKCk/dGhpcy5jb21wb3NpdGlvbklucHV0OnRoaXMuY29tcG9zaXRpb25JbnB1dD1uZXcgZS5Db21wb3NpdGlvbklucHV0KHRoaXMpfSxkLnByb3RvdHlwZS5pc0NvbXBvc2luZz1mdW5jdGlvbigpe3JldHVybiBudWxsIT10aGlzLmNvbXBvc2l0aW9uSW5wdXQmJiF0aGlzLmNvbXBvc2l0aW9uSW5wdXQuaXNFbmRlZCgpfSxkLnByb3RvdHlwZS5kZWxldGVJbkRpcmVjdGlvbj1mdW5jdGlvbih0LGUpe3ZhciBuO3JldHVybihudWxsIT0obj10aGlzLnJlc3BvbmRlcik/bi5kZWxldGVJbkRpcmVjdGlvbih0KTp2b2lkIDApIT09ITE/dGhpcy5zZXRJbnB1dFN1bW1hcnkoe2RpZERlbGV0ZTohMH0pOmU/KGUucHJldmVudERlZmF1bHQoKSx0aGlzLnJlcXVlc3RSZW5kZXIoKSk6dm9pZCAwfSxkLnByb3RvdHlwZS5zZXJpYWxpemVTZWxlY3Rpb25Ub0RhdGFUcmFuc2Zlcj1mdW5jdGlvbih0KXt2YXIgbyxpO2lmKG4odCkpcmV0dXJuIG89bnVsbCE9KGk9dGhpcy5yZXNwb25kZXIpP2kuZ2V0U2VsZWN0ZWREb2N1bWVudCgpLnRvU2VyaWFsaXphYmxlRG9jdW1lbnQoKTp2b2lkIDAsdC5zZXREYXRhKFwiYXBwbGljYXRpb24veC10cml4LWRvY3VtZW50XCIsSlNPTi5zdHJpbmdpZnkobykpLHQuc2V0RGF0YShcInRleHQvaHRtbFwiLGUuRG9jdW1lbnRWaWV3LnJlbmRlcihvKS5pbm5lckhUTUwpLHQuc2V0RGF0YShcInRleHQvcGxhaW5cIixvLnRvU3RyaW5nKCkucmVwbGFjZSgvXFxuJC8sXCJcIikpLCEwfSxkLnByb3RvdHlwZS5jYW5BY2NlcHREYXRhVHJhbnNmZXI9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGkscixzO2ZvcihzPXt9LGk9bnVsbCE9KG89bnVsbCE9dD90LnR5cGVzOnZvaWQgMCk/bzpbXSxlPTAsbj1pLmxlbmd0aDtuPmU7ZSsrKXI9aVtlXSxzW3JdPSEwO3JldHVybiBzLkZpbGVzfHxzW1wiYXBwbGljYXRpb24veC10cml4LWRvY3VtZW50XCJdfHxzW1widGV4dC9odG1sXCJdfHxzW1widGV4dC9wbGFpblwiXX0sZC5wcm90b3R5cGUuZ2V0UGFzdGVkSFRNTFVzaW5nSGlkZGVuRWxlbWVudD1mdW5jdGlvbih0KXt2YXIgZSxuLG87cmV0dXJuIG49dGhpcy5nZXRTZWxlY3RlZFJhbmdlKCksbz17cG9zaXRpb246XCJhYnNvbHV0ZVwiLGxlZnQ6d2luZG93LnBhZ2VYT2Zmc2V0K1wicHhcIix0b3A6d2luZG93LnBhZ2VZT2Zmc2V0K1wicHhcIixvcGFjaXR5OjB9LGU9Yyh7c3R5bGU6byx0YWdOYW1lOlwiZGl2XCIsZWRpdGFibGU6ITB9KSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGUpLGUuZm9jdXMoKSxyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24obyl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGk7cmV0dXJuIGk9ZS5pbm5lckhUTUwsZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlKSxvLnNldFNlbGVjdGVkUmFuZ2UobiksdChpKX19KHRoaXMpKX0sZC5wcm94eU1ldGhvZChcInJlc3BvbmRlcj8uZ2V0U2VsZWN0ZWRSYW5nZVwiKSxkLnByb3h5TWV0aG9kKFwicmVzcG9uZGVyPy5zZXRTZWxlY3RlZFJhbmdlXCIpLGQucHJveHlNZXRob2QoXCJyZXNwb25kZXI/LmV4cGFuZFNlbGVjdGlvbkluRGlyZWN0aW9uXCIpLGQucHJveHlNZXRob2QoXCJyZXNwb25kZXI/LnNlbGVjdGlvbklzSW5DdXJzb3JUYXJnZXRcIiksZC5wcm94eU1ldGhvZChcInJlc3BvbmRlcj8uc2VsZWN0aW9uSXNFeHBhbmRlZFwiKSxkXG59KGUuQmFzaWNPYmplY3QpLG89ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4gbnVsbCE9KGU9dC50eXBlKSYmbnVsbCE9KG49ZS5tYXRjaCgvXFwvKFxcdyspJC8pKT9uWzFdOnZvaWQgMH0sdT1mdW5jdGlvbih0KXtyZXR1cm4gdC5tZXRhS2V5JiZ0LmFsdEtleSYmIXQuc2hpZnRLZXkmJjk0PT09dC5rZXlDb2RlfSxhPWZ1bmN0aW9uKHQpe3JldHVybiB0Lm1ldGFLZXkmJnQuYWx0S2V5JiZ0LnNoaWZ0S2V5JiY5Njc0PT09dC5rZXlDb2RlfSxzPWZ1bmN0aW9uKHQpe3JldHVybi9NYWN8XmlQLy50ZXN0KG5hdmlnYXRvci5wbGF0Zm9ybSk/dC5tZXRhS2V5OnQuY3RybEtleX0saD1mdW5jdGlvbih0KXt2YXIgZSxuO3JldHVybihuPW51bGwhPShlPXQuY2xpcGJvYXJkRGF0YSk/ZS50eXBlczp2b2lkIDApP20uY2FsbChuLFwidGV4dC9odG1sXCIpPDAmJihtLmNhbGwobixcImNvbS5hcHBsZS53ZWJhcmNoaXZlXCIpPj0wfHxtLmNhbGwobixcImNvbS5hcHBsZS5mbGF0LXJ0ZmRcIik+PTApOnZvaWQgMH0sdD1mdW5jdGlvbih0KXt2YXIgZSxuLG87cmV0dXJuIG89dC5nZXREYXRhKFwidGV4dC9wbGFpblwiKSxuPXQuZ2V0RGF0YShcInRleHQvaHRtbFwiKSxvJiZuPyhlPWMoXCJkaXZcIiksZS5pbm5lckhUTUw9bixlLnRleHRDb250ZW50PT09bz8hZS5xdWVyeVNlbGVjdG9yKFwiOm5vdChtZXRhKVwiKTp2b2lkIDApOm51bGwhPW8/by5sZW5ndGg6dm9pZCAwfSxkPXtcImFwcGxpY2F0aW9uL3gtdHJpeC1mZWF0dXJlLWRldGVjdGlvblwiOlwidGVzdFwifSxuPWZ1bmN0aW9uKHQpe3ZhciBlLG47aWYobnVsbCE9KG51bGwhPXQ/dC5zZXREYXRhOnZvaWQgMCkpe2ZvcihlIGluIGQpaWYobj1kW2VdLHQuc2V0RGF0YShlLG4pLHQuZ2V0RGF0YShlKSE9PW4pcmV0dXJuO3JldHVybiEwfX19LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuLG8saSxyLHMsYT1mdW5jdGlvbih0LGUpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiB0LmFwcGx5KGUsYXJndW1lbnRzKX19LHU9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBuKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgbyBpbiBlKWMuY2FsbChlLG8pJiYodFtvXT1lW29dKTtyZXR1cm4gbi5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG4sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0sYz17fS5oYXNPd25Qcm9wZXJ0eTtuPWUuaGFuZGxlRXZlbnQscj1lLm1ha2VFbGVtZW50LHM9ZS50YWdOYW1lLG89ZS5JbnB1dENvbnRyb2xsZXIua2V5TmFtZXMsaT1lLmNvbmZpZy5sYW5nLHQ9ZS5jb25maWcuY3NzLmNsYXNzTmFtZXMsZS5BdHRhY2htZW50RWRpdG9yQ29udHJvbGxlcj1mdW5jdGlvbihlKXtmdW5jdGlvbiBjKHQsZSxuKXt0aGlzLmF0dGFjaG1lbnRQaWVjZT10LHRoaXMuZWxlbWVudD1lLHRoaXMuY29udGFpbmVyPW4sdGhpcy51bmluc3RhbGw9YSh0aGlzLnVuaW5zdGFsbCx0aGlzKSx0aGlzLmRpZEtleURvd25DYXB0aW9uPWEodGhpcy5kaWRLZXlEb3duQ2FwdGlvbix0aGlzKSx0aGlzLmRpZENoYW5nZUNhcHRpb249YSh0aGlzLmRpZENoYW5nZUNhcHRpb24sdGhpcyksdGhpcy5kaWRDbGlja0NhcHRpb249YSh0aGlzLmRpZENsaWNrQ2FwdGlvbix0aGlzKSx0aGlzLmRpZENsaWNrUmVtb3ZlQnV0dG9uPWEodGhpcy5kaWRDbGlja1JlbW92ZUJ1dHRvbix0aGlzKSx0aGlzLmF0dGFjaG1lbnQ9dGhpcy5hdHRhY2htZW50UGllY2UuYXR0YWNobWVudCxcImFcIj09PXModGhpcy5lbGVtZW50KSYmKHRoaXMuZWxlbWVudD10aGlzLmVsZW1lbnQuZmlyc3RDaGlsZCksdGhpcy5pbnN0YWxsKCl9dmFyIGw7cmV0dXJuIHUoYyxlKSxsPWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbigpe3ZhciBlO3JldHVybiBlPXQuYXBwbHkodGhpcyxhcmd1bWVudHMpLGVbXCJkb1wiXSgpLG51bGw9PXRoaXMudW5kb3MmJih0aGlzLnVuZG9zPVtdKSx0aGlzLnVuZG9zLnB1c2goZS51bmRvKX19LGMucHJvdG90eXBlLmluc3RhbGw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYWtlRWxlbWVudE11dGFibGUoKSx0aGlzLmF0dGFjaG1lbnQuaXNQcmV2aWV3YWJsZSgpJiZ0aGlzLm1ha2VDYXB0aW9uRWRpdGFibGUoKSx0aGlzLmFkZFJlbW92ZUJ1dHRvbigpfSxjLnByb3RvdHlwZS5tYWtlRWxlbWVudE11dGFibGU9bChmdW5jdGlvbigpe3JldHVybntcImRvXCI6ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuZWxlbWVudC5kYXRhc2V0LnRyaXhNdXRhYmxlPSEwfX0odGhpcyksdW5kbzpmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZGVsZXRlIHQuZWxlbWVudC5kYXRhc2V0LnRyaXhNdXRhYmxlfX0odGhpcyl9fSksYy5wcm90b3R5cGUubWFrZUNhcHRpb25FZGl0YWJsZT1sKGZ1bmN0aW9uKCl7dmFyIHQsZTtyZXR1cm4gdD10aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcImZpZ2NhcHRpb25cIiksZT1udWxsLHtcImRvXCI6ZnVuY3Rpb24obyl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGU9bihcImNsaWNrXCIse29uRWxlbWVudDp0LHdpdGhDYWxsYmFjazpvLmRpZENsaWNrQ2FwdGlvbixpblBoYXNlOlwiY2FwdHVyaW5nXCJ9KX19KHRoaXMpLHVuZG86ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZS5kZXN0cm95KCl9fSh0aGlzKX19KSxjLnByb3RvdHlwZS5hZGRSZW1vdmVCdXR0b249bChmdW5jdGlvbigpe3ZhciBlO3JldHVybiBlPXIoe3RhZ05hbWU6XCJidXR0b25cIix0ZXh0Q29udGVudDppLnJlbW92ZSxjbGFzc05hbWU6dC5hdHRhY2htZW50LnJlbW92ZUJ1dHRvbixhdHRyaWJ1dGVzOnt0eXBlOlwiYnV0dG9uXCIsdGl0bGU6aS5yZW1vdmV9LGRhdGE6e3RyaXhNdXRhYmxlOiEwfX0pLG4oXCJjbGlja1wiLHtvbkVsZW1lbnQ6ZSx3aXRoQ2FsbGJhY2s6dGhpcy5kaWRDbGlja1JlbW92ZUJ1dHRvbn0pLHtcImRvXCI6ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuZWxlbWVudC5hcHBlbmRDaGlsZChlKX19KHRoaXMpLHVuZG86ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuZWxlbWVudC5yZW1vdmVDaGlsZChlKX19KHRoaXMpfX0pLGMucHJvdG90eXBlLmVkaXRDYXB0aW9uPWwoZnVuY3Rpb24oKXt2YXIgZSxvLHMsYSx1O3JldHVybiBhPXIoe3RhZ05hbWU6XCJ0ZXh0YXJlYVwiLGNsYXNzTmFtZTp0LmF0dGFjaG1lbnQuY2FwdGlvbkVkaXRvcixhdHRyaWJ1dGVzOntwbGFjZWhvbGRlcjppLmNhcHRpb25QbGFjZWhvbGRlcn19KSxhLnZhbHVlPXRoaXMuYXR0YWNobWVudFBpZWNlLmdldENhcHRpb24oKSx1PWEuY2xvbmVOb2RlKCksdS5jbGFzc0xpc3QuYWRkKFwidHJpeC1hdXRvcmVzaXplLWNsb25lXCIpLGU9ZnVuY3Rpb24oKXtyZXR1cm4gdS52YWx1ZT1hLnZhbHVlLGEuc3R5bGUuaGVpZ2h0PXUuc2Nyb2xsSGVpZ2h0K1wicHhcIn0sbihcImlucHV0XCIse29uRWxlbWVudDphLHdpdGhDYWxsYmFjazplfSksbihcImtleWRvd25cIix7b25FbGVtZW50OmEsd2l0aENhbGxiYWNrOnRoaXMuZGlkS2V5RG93bkNhcHRpb259KSxuKFwiY2hhbmdlXCIse29uRWxlbWVudDphLHdpdGhDYWxsYmFjazp0aGlzLmRpZENoYW5nZUNhcHRpb259KSxuKFwiYmx1clwiLHtvbkVsZW1lbnQ6YSx3aXRoQ2FsbGJhY2s6dGhpcy51bmluc3RhbGx9KSxzPXRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiZmlnY2FwdGlvblwiKSxvPXMuY2xvbmVOb2RlKCkse1wiZG9cIjpmdW5jdGlvbigpe3JldHVybiBzLnN0eWxlLmRpc3BsYXk9XCJub25lXCIsby5hcHBlbmRDaGlsZChhKSxvLmFwcGVuZENoaWxkKHUpLG8uY2xhc3NMaXN0LmFkZCh0LmF0dGFjaG1lbnQuZWRpdGluZ0NhcHRpb24pLHMucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUobyxzKSxlKCksYS5mb2N1cygpfSx1bmRvOmZ1bmN0aW9uKCl7cmV0dXJuIG8ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChvKSxzLnN0eWxlLmRpc3BsYXk9bnVsbH19fSksYy5wcm90b3R5cGUuZGlkQ2xpY2tSZW1vdmVCdXR0b249ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIHQucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLG51bGwhPShlPXRoaXMuZGVsZWdhdGUpP2UuYXR0YWNobWVudEVkaXRvckRpZFJlcXVlc3RSZW1vdmFsT2ZBdHRhY2htZW50KHRoaXMuYXR0YWNobWVudCk6dm9pZCAwfSxjLnByb3RvdHlwZS5kaWRDbGlja0NhcHRpb249ZnVuY3Rpb24odCl7cmV0dXJuIHQucHJldmVudERlZmF1bHQoKSx0aGlzLmVkaXRDYXB0aW9uKCl9LGMucHJvdG90eXBlLmRpZENoYW5nZUNhcHRpb249ZnVuY3Rpb24odCl7dmFyIGUsbixvO3JldHVybiBlPXQudGFyZ2V0LnZhbHVlLnJlcGxhY2UoL1xccy9nLFwiIFwiKS50cmltKCksZT9udWxsIT0obj10aGlzLmRlbGVnYXRlKSYmXCJmdW5jdGlvblwiPT10eXBlb2Ygbi5hdHRhY2htZW50RWRpdG9yRGlkUmVxdWVzdFVwZGF0aW5nQXR0cmlidXRlc0ZvckF0dGFjaG1lbnQ/bi5hdHRhY2htZW50RWRpdG9yRGlkUmVxdWVzdFVwZGF0aW5nQXR0cmlidXRlc0ZvckF0dGFjaG1lbnQoe2NhcHRpb246ZX0sdGhpcy5hdHRhY2htZW50KTp2b2lkIDA6bnVsbCE9KG89dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG8uYXR0YWNobWVudEVkaXRvckRpZFJlcXVlc3RSZW1vdmluZ0F0dHJpYnV0ZUZvckF0dGFjaG1lbnQ/by5hdHRhY2htZW50RWRpdG9yRGlkUmVxdWVzdFJlbW92aW5nQXR0cmlidXRlRm9yQXR0YWNobWVudChcImNhcHRpb25cIix0aGlzLmF0dGFjaG1lbnQpOnZvaWQgMH0sYy5wcm90b3R5cGUuZGlkS2V5RG93bkNhcHRpb249ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuXCJyZXR1cm5cIj09PW9bdC5rZXlDb2RlXT8odC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuZGlkQ2hhbmdlQ2FwdGlvbih0KSxudWxsIT0oZT10aGlzLmRlbGVnYXRlKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgZS5hdHRhY2htZW50RWRpdG9yRGlkUmVxdWVzdERlc2VsZWN0aW5nQXR0YWNobWVudD9lLmF0dGFjaG1lbnRFZGl0b3JEaWRSZXF1ZXN0RGVzZWxlY3RpbmdBdHRhY2htZW50KHRoaXMuYXR0YWNobWVudCk6dm9pZCAwKTp2b2lkIDB9LGMucHJvdG90eXBlLnVuaW5zdGFsbD1mdW5jdGlvbigpe2Zvcih2YXIgdCxlO2U9dGhpcy51bmRvcy5wb3AoKTspZSgpO3JldHVybiBudWxsIT0odD10aGlzLmRlbGVnYXRlKT90LmRpZFVuaW5zdGFsbEF0dGFjaG1lbnRFZGl0b3IodGhpcyk6dm9pZCAwfSxjfShlLkJhc2ljT2JqZWN0KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0LG4sbyxpLHI9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBuKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgbyBpbiBlKXMuY2FsbChlLG8pJiYodFtvXT1lW29dKTtyZXR1cm4gbi5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG4sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0scz17fS5oYXNPd25Qcm9wZXJ0eTtvPWUubWFrZUVsZW1lbnQsaT1lLnNlbGVjdGlvbkVsZW1lbnRzLHQ9ZS5jb25maWcuY3NzLmNsYXNzTmFtZXMsZS5BdHRhY2htZW50Vmlldz1mdW5jdGlvbihlKXtmdW5jdGlvbiBzKCl7cy5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuYXR0YWNobWVudD10aGlzLm9iamVjdCx0aGlzLmF0dGFjaG1lbnQudXBsb2FkUHJvZ3Jlc3NEZWxlZ2F0ZT10aGlzLHRoaXMuYXR0YWNobWVudFBpZWNlPXRoaXMub3B0aW9ucy5waWVjZX1yZXR1cm4gcihzLGUpLHMuYXR0YWNobWVudFNlbGVjdG9yPVwiW2RhdGEtdHJpeC1hdHRhY2htZW50XVwiLHMucHJvdG90eXBlLmNyZWF0ZUNvbnRlbnROb2Rlcz1mdW5jdGlvbigpe3JldHVybltdfSxzLnByb3RvdHlwZS5jcmVhdGVOb2Rlcz1mdW5jdGlvbigpe3ZhciBlLG4scixzLGEsdSxjLGwsaCxwLGQ7aWYocz1vKHt0YWdOYW1lOlwiZmlndXJlXCIsY2xhc3NOYW1lOnRoaXMuZ2V0Q2xhc3NOYW1lKCl9KSx0aGlzLmF0dGFjaG1lbnQuaGFzQ29udGVudCgpKXMuaW5uZXJIVE1MPXRoaXMuYXR0YWNobWVudC5nZXRDb250ZW50KCk7ZWxzZSBmb3IocD10aGlzLmNyZWF0ZUNvbnRlbnROb2RlcygpLHU9MCxsPXAubGVuZ3RoO2w+dTt1KyspaD1wW3VdLHMuYXBwZW5kQ2hpbGQoaCk7cy5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUNhcHRpb25FbGVtZW50KCkpLG49e3RyaXhBdHRhY2htZW50OkpTT04uc3RyaW5naWZ5KHRoaXMuYXR0YWNobWVudCksdHJpeENvbnRlbnRUeXBlOnRoaXMuYXR0YWNobWVudC5nZXRDb250ZW50VHlwZSgpLHRyaXhJZDp0aGlzLmF0dGFjaG1lbnQuaWR9LGU9dGhpcy5hdHRhY2htZW50UGllY2UuZ2V0QXR0cmlidXRlc0ZvckF0dGFjaG1lbnQoKSxlLmlzRW1wdHkoKXx8KG4udHJpeEF0dHJpYnV0ZXM9SlNPTi5zdHJpbmdpZnkoZSkpLHRoaXMuYXR0YWNobWVudC5pc1BlbmRpbmcoKSYmKHRoaXMucHJvZ3Jlc3NFbGVtZW50PW8oe3RhZ05hbWU6XCJwcm9ncmVzc1wiLGF0dHJpYnV0ZXM6e1wiY2xhc3NcIjp0LmF0dGFjaG1lbnQucHJvZ3Jlc3NCYXIsdmFsdWU6dGhpcy5hdHRhY2htZW50LmdldFVwbG9hZFByb2dyZXNzKCksbWF4OjEwMH0sZGF0YTp7dHJpeE11dGFibGU6ITAsdHJpeFN0b3JlS2V5OltcInByb2dyZXNzRWxlbWVudFwiLHRoaXMuYXR0YWNobWVudC5pZF0uam9pbihcIi9cIil9fSkscy5hcHBlbmRDaGlsZCh0aGlzLnByb2dyZXNzRWxlbWVudCksbi50cml4U2VyaWFsaXplPSExKSwoYT10aGlzLmdldEhyZWYoKSk/KHI9byhcImFcIix7aHJlZjphfSksci5hcHBlbmRDaGlsZChzKSk6cj1zO2ZvcihjIGluIG4pZD1uW2NdLHIuZGF0YXNldFtjXT1kO3JldHVybiByLnNldEF0dHJpYnV0ZShcImNvbnRlbnRlZGl0YWJsZVwiLCExKSxbaS5jcmVhdGUoXCJjdXJzb3JUYXJnZXRcIikscixpLmNyZWF0ZShcImN1cnNvclRhcmdldFwiKV19LHMucHJvdG90eXBlLmNyZWF0ZUNhcHRpb25FbGVtZW50PWZ1bmN0aW9uKCl7dmFyIGUsbixpLHIscztyZXR1cm4gbj1vKHt0YWdOYW1lOlwiZmlnY2FwdGlvblwiLGNsYXNzTmFtZTp0LmF0dGFjaG1lbnQuY2FwdGlvbn0pLChlPXRoaXMuYXR0YWNobWVudFBpZWNlLmdldENhcHRpb24oKSk/KG4uY2xhc3NMaXN0LmFkZCh0LmF0dGFjaG1lbnQuY2FwdGlvbkVkaXRlZCksbi50ZXh0Q29udGVudD1lKTooaT10aGlzLmF0dGFjaG1lbnQuZ2V0RmlsZW5hbWUoKSkmJihuLnRleHRDb250ZW50PWksKHI9dGhpcy5hdHRhY2htZW50LmdldEZvcm1hdHRlZEZpbGVzaXplKCkpJiYobi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIiBcIikpLHM9byh7dGFnTmFtZTpcInNwYW5cIixjbGFzc05hbWU6dC5hdHRhY2htZW50LnNpemUsdGV4dENvbnRlbnQ6cn0pLG4uYXBwZW5kQ2hpbGQocykpKSxufSxzLnByb3RvdHlwZS5nZXRDbGFzc05hbWU9ZnVuY3Rpb24oKXt2YXIgZSxuO3JldHVybiBuPVt0LmF0dGFjaG1lbnQuY29udGFpbmVyLFwiXCIrdC5hdHRhY2htZW50LnR5cGVQcmVmaXgrdGhpcy5hdHRhY2htZW50LmdldFR5cGUoKV0sKGU9dGhpcy5hdHRhY2htZW50LmdldEV4dGVuc2lvbigpKSYmbi5wdXNoKGUpLG4uam9pbihcIiBcIil9LHMucHJvdG90eXBlLmdldEhyZWY9ZnVuY3Rpb24oKXtyZXR1cm4gbih0aGlzLmF0dGFjaG1lbnQuZ2V0Q29udGVudCgpLFwiYVwiKT92b2lkIDA6dGhpcy5hdHRhY2htZW50LmdldEhyZWYoKX0scy5wcm90b3R5cGUuZmluZFByb2dyZXNzRWxlbWVudD1mdW5jdGlvbigpe3ZhciB0O3JldHVybiBudWxsIT0odD10aGlzLmZpbmRFbGVtZW50KCkpP3QucXVlcnlTZWxlY3RvcihcInByb2dyZXNzXCIpOnZvaWQgMH0scy5wcm90b3R5cGUuYXR0YWNobWVudERpZENoYW5nZVVwbG9hZFByb2dyZXNzPWZ1bmN0aW9uKCl7dmFyIHQsZTtyZXR1cm4gZT10aGlzLmF0dGFjaG1lbnQuZ2V0VXBsb2FkUHJvZ3Jlc3MoKSxudWxsIT0odD10aGlzLmZpbmRQcm9ncmVzc0VsZW1lbnQoKSk/dC52YWx1ZT1lOnZvaWQgMH0sc30oZS5PYmplY3RWaWV3KSxuPWZ1bmN0aW9uKHQsZSl7dmFyIG47cmV0dXJuIG49byhcImRpdlwiKSxuLmlubmVySFRNTD1udWxsIT10P3Q6XCJcIixuLnF1ZXJ5U2VsZWN0b3IoZSl9fS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbj1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBpIGluIGUpby5jYWxsKGUsaSkmJih0W2ldPWVbaV0pO3JldHVybiBuLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbix0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxvPXt9Lmhhc093blByb3BlcnR5O3Q9ZS5tYWtlRWxlbWVudCxlLlByZXZpZXdhYmxlQXR0YWNobWVudFZpZXc9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gbygpe28uX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmF0dGFjaG1lbnQucHJldmlld0RlbGVnYXRlPXRoaXN9cmV0dXJuIG4obyxlKSxvLnByb3RvdHlwZS5jcmVhdGVDb250ZW50Tm9kZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbWFnZT10KHt0YWdOYW1lOlwiaW1nXCIsYXR0cmlidXRlczp7c3JjOlwiXCJ9LGRhdGE6e3RyaXhNdXRhYmxlOiEwfX0pLHRoaXMucmVmcmVzaCh0aGlzLmltYWdlKSxbdGhpcy5pbWFnZV19LG8ucHJvdG90eXBlLnJlZnJlc2g9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIG51bGw9PXQmJih0PW51bGwhPShlPXRoaXMuZmluZEVsZW1lbnQoKSk/ZS5xdWVyeVNlbGVjdG9yKFwiaW1nXCIpOnZvaWQgMCksdD90aGlzLnVwZGF0ZUF0dHJpYnV0ZXNGb3JJbWFnZSh0KTp2b2lkIDB9LG8ucHJvdG90eXBlLnVwZGF0ZUF0dHJpYnV0ZXNGb3JJbWFnZT1mdW5jdGlvbih0KXt2YXIgZSxuLG8saSxyLHM7cmV0dXJuIHI9dGhpcy5hdHRhY2htZW50LmdldFVSTCgpLG49dGhpcy5hdHRhY2htZW50LmdldFByZXZpZXdVUkwoKSx0LnNyYz1ufHxyLG49PT1yP3QucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS10cml4LXNlcmlhbGl6ZWQtYXR0cmlidXRlc1wiKToobz1KU09OLnN0cmluZ2lmeSh7c3JjOnJ9KSx0LnNldEF0dHJpYnV0ZShcImRhdGEtdHJpeC1zZXJpYWxpemVkLWF0dHJpYnV0ZXNcIixvKSkscz10aGlzLmF0dGFjaG1lbnQuZ2V0V2lkdGgoKSxlPXRoaXMuYXR0YWNobWVudC5nZXRIZWlnaHQoKSxudWxsIT1zJiYodC53aWR0aD1zKSxudWxsIT1lJiYodC5oZWlnaHQ9ZSksaT1bXCJpbWFnZUVsZW1lbnRcIix0aGlzLmF0dGFjaG1lbnQuaWQsdC5zcmMsdC53aWR0aCx0LmhlaWdodF0uam9pbihcIi9cIiksdC5kYXRhc2V0LnRyaXhTdG9yZUtleT1pfSxvLnByb3RvdHlwZS5hdHRhY2htZW50RGlkQ2hhbmdlUHJldmlld1VSTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlZnJlc2godGhpcy5pbWFnZSksdGhpcy5yZWZyZXNoKCl9LG99KGUuQXR0YWNobWVudFZpZXcpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbixvLGk9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBuKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgbyBpbiBlKXIuY2FsbChlLG8pJiYodFtvXT1lW29dKTtyZXR1cm4gbi5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG4sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0scj17fS5oYXNPd25Qcm9wZXJ0eTtvPWUubWFrZUVsZW1lbnQsdD1lLmZpbmRJbm5lckVsZW1lbnQsbj1lLmdldFRleHRDb25maWcsZS5QaWVjZVZpZXc9ZnVuY3Rpb24ocil7ZnVuY3Rpb24gcygpe3ZhciB0O3MuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLnBpZWNlPXRoaXMub2JqZWN0LHRoaXMuYXR0cmlidXRlcz10aGlzLnBpZWNlLmdldEF0dHJpYnV0ZXMoKSx0PXRoaXMub3B0aW9ucyx0aGlzLnRleHRDb25maWc9dC50ZXh0Q29uZmlnLHRoaXMuY29udGV4dD10LmNvbnRleHQsdGhpcy5waWVjZS5hdHRhY2htZW50P3RoaXMuYXR0YWNobWVudD10aGlzLnBpZWNlLmF0dGFjaG1lbnQ6dGhpcy5zdHJpbmc9dGhpcy5waWVjZS50b1N0cmluZygpfXZhciBhO3JldHVybiBpKHMscikscy5wcm90b3R5cGUuY3JlYXRlTm9kZXM9ZnVuY3Rpb24oKXt2YXIgZSxuLG8saSxyLHM7aWYocz10aGlzLmF0dGFjaG1lbnQ/dGhpcy5jcmVhdGVBdHRhY2htZW50Tm9kZXMoKTp0aGlzLmNyZWF0ZVN0cmluZ05vZGVzKCksZT10aGlzLmNyZWF0ZUVsZW1lbnQoKSl7Zm9yKG89dChlKSxuPTAsaT1zLmxlbmd0aDtpPm47bisrKXI9c1tuXSxvLmFwcGVuZENoaWxkKHIpO3M9W2VdfXJldHVybiBzfSxzLnByb3RvdHlwZS5jcmVhdGVBdHRhY2htZW50Tm9kZXM9ZnVuY3Rpb24oKXt2YXIgdCxuO3JldHVybiB0PXRoaXMuYXR0YWNobWVudC5pc1ByZXZpZXdhYmxlKCk/ZS5QcmV2aWV3YWJsZUF0dGFjaG1lbnRWaWV3OmUuQXR0YWNobWVudFZpZXcsbj10aGlzLmNyZWF0ZUNoaWxkVmlldyh0LHRoaXMucGllY2UuYXR0YWNobWVudCx7cGllY2U6dGhpcy5waWVjZX0pLG4uZ2V0Tm9kZXMoKX0scy5wcm90b3R5cGUuY3JlYXRlU3RyaW5nTm9kZXM9ZnVuY3Rpb24oKXt2YXIgdCxlLG4saSxyLHMsYSx1LGMsbDtpZihudWxsIT0odT10aGlzLnRleHRDb25maWcpP3UucGxhaW50ZXh0OnZvaWQgMClyZXR1cm5bZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5zdHJpbmcpXTtmb3IoYT1bXSxjPXRoaXMuc3RyaW5nLnNwbGl0KFwiXFxuXCIpLG49ZT0wLGk9Yy5sZW5ndGg7aT5lO249KytlKWw9Y1tuXSxuPjAmJih0PW8oXCJiclwiKSxhLnB1c2godCkpLChyPWwubGVuZ3RoKSYmKHM9ZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5wcmVzZXJ2ZVNwYWNlcyhsKSksYS5wdXNoKHMpKTtyZXR1cm4gYX0scy5wcm90b3R5cGUuY3JlYXRlRWxlbWVudD1mdW5jdGlvbigpe3ZhciB0LGUsaSxyLHMsYSx1LGM7Zm9yKHIgaW4gdGhpcy5hdHRyaWJ1dGVzKWlmKCh0PW4ocikpJiYodC50YWdOYW1lJiYocz1vKHQudGFnTmFtZSksaT8oaS5hcHBlbmRDaGlsZChzKSxpPXMpOmU9aT1zKSx0LnN0eWxlKSlpZih1KXthPXQuc3R5bGU7Zm9yKHIgaW4gYSljPWFbcl0sdVtyXT1jfWVsc2UgdT10LnN0eWxlO2lmKHUpe251bGw9PWUmJihlPW8oXCJzcGFuXCIpKTtmb3IociBpbiB1KWM9dVtyXSxlLnN0eWxlW3JdPWN9cmV0dXJuIGV9LHMucHJvdG90eXBlLmNyZWF0ZUNvbnRhaW5lckVsZW1lbnQ9ZnVuY3Rpb24oKXt2YXIgdCxlLGkscixzO3I9dGhpcy5hdHRyaWJ1dGVzO2ZvcihpIGluIHIpaWYocz1yW2ldLChlPW4oaSkpJiZlLmdyb3VwVGFnTmFtZSlyZXR1cm4gdD17fSx0W2ldPXMsbyhlLmdyb3VwVGFnTmFtZSx0KX0sYT1lLk5PTl9CUkVBS0lOR19TUEFDRSxzLnByb3RvdHlwZS5wcmVzZXJ2ZVNwYWNlcz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb250ZXh0LmlzTGFzdCYmKHQ9dC5yZXBsYWNlKC9cXCAkLyxhKSksdD10LnJlcGxhY2UoLyhcXFMpXFwgezN9KFxcUykvZyxcIiQxIFwiK2ErXCIgJDJcIikucmVwbGFjZSgvXFwgezJ9L2csYStcIiBcIikucmVwbGFjZSgvXFwgezJ9L2csXCIgXCIrYSksKHRoaXMuY29udGV4dC5pc0ZpcnN0fHx0aGlzLmNvbnRleHQuZm9sbG93c1doaXRlc3BhY2UpJiYodD10LnJlcGxhY2UoL15cXCAvLGEpKSx0fSxzfShlLk9iamVjdFZpZXcpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQ9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBvKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgaSBpbiBlKW4uY2FsbChlLGkpJiYodFtpXT1lW2ldKTtyZXR1cm4gby5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG8sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0sbj17fS5oYXNPd25Qcm9wZXJ0eTtlLlRleHRWaWV3PWZ1bmN0aW9uKG4pe2Z1bmN0aW9uIG8oKXtvLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy50ZXh0PXRoaXMub2JqZWN0LHRoaXMudGV4dENvbmZpZz10aGlzLm9wdGlvbnMudGV4dENvbmZpZ312YXIgaTtyZXR1cm4gdChvLG4pLG8ucHJvdG90eXBlLmNyZWF0ZU5vZGVzPWZ1bmN0aW9uKCl7dmFyIHQsbixvLHIscyxhLHUsYyxsLGg7Zm9yKGE9W10sYz1lLk9iamVjdEdyb3VwLmdyb3VwT2JqZWN0cyh0aGlzLmdldFBpZWNlcygpKSxyPWMubGVuZ3RoLTEsbz1uPTAscz1jLmxlbmd0aDtzPm47bz0rK24pdT1jW29dLHQ9e30sMD09PW8mJih0LmlzRmlyc3Q9ITApLG89PT1yJiYodC5pc0xhc3Q9ITApLGkobCkmJih0LmZvbGxvd3NXaGl0ZXNwYWNlPSEwKSxoPXRoaXMuZmluZE9yQ3JlYXRlQ2FjaGVkQ2hpbGRWaWV3KGUuUGllY2VWaWV3LHUse3RleHRDb25maWc6dGhpcy50ZXh0Q29uZmlnLGNvbnRleHQ6dH0pLGEucHVzaC5hcHBseShhLGguZ2V0Tm9kZXMoKSksbD11O3JldHVybiBhfSxvLnByb3RvdHlwZS5nZXRQaWVjZXM9ZnVuY3Rpb24oKXt2YXIgdCxlLG4sbyxpO2ZvcihvPXRoaXMudGV4dC5nZXRQaWVjZXMoKSxpPVtdLHQ9MCxlPW8ubGVuZ3RoO2U+dDt0Kyspbj1vW3RdLG4uaGFzQXR0cmlidXRlKFwiYmxvY2tCcmVha1wiKXx8aS5wdXNoKG4pO3JldHVybiBpfSxpPWZ1bmN0aW9uKHQpe3JldHVybi9cXHMkLy50ZXN0KG51bGwhPXQ/dC50b1N0cmluZygpOnZvaWQgMCl9LG99KGUuT2JqZWN0Vmlldyl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuLG89ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBuKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgbyBpbiBlKWkuY2FsbChlLG8pJiYodFtvXT1lW29dKTtyZXR1cm4gbi5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG4sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0saT17fS5oYXNPd25Qcm9wZXJ0eTtuPWUubWFrZUVsZW1lbnQsdD1lLmdldEJsb2NrQ29uZmlnLGUuQmxvY2tWaWV3PWZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIoKXtyLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5ibG9jaz10aGlzLm9iamVjdCx0aGlzLmF0dHJpYnV0ZXM9dGhpcy5ibG9jay5nZXRBdHRyaWJ1dGVzKCl9cmV0dXJuIG8ocixpKSxyLnByb3RvdHlwZS5jcmVhdGVOb2Rlcz1mdW5jdGlvbigpe3ZhciBvLGkscixzLGEsdSxjLGwsaDtpZihvPWRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoXCJibG9ja1wiKSx1PVtvXSx0aGlzLmJsb2NrLmlzRW1wdHkoKT91LnB1c2gobihcImJyXCIpKToobD1udWxsIT0oYz10KHRoaXMuYmxvY2suZ2V0TGFzdEF0dHJpYnV0ZSgpKSk/Yy50ZXh0OnZvaWQgMCxoPXRoaXMuZmluZE9yQ3JlYXRlQ2FjaGVkQ2hpbGRWaWV3KGUuVGV4dFZpZXcsdGhpcy5ibG9jay50ZXh0LHt0ZXh0Q29uZmlnOmx9KSx1LnB1c2guYXBwbHkodSxoLmdldE5vZGVzKCkpLHRoaXMuc2hvdWxkQWRkRXh0cmFOZXdsaW5lRWxlbWVudCgpJiZ1LnB1c2gobihcImJyXCIpKSksdGhpcy5hdHRyaWJ1dGVzLmxlbmd0aClyZXR1cm4gdTtmb3IoaT1uKGUuY29uZmlnLmJsb2NrQXR0cmlidXRlc1tcImRlZmF1bHRcIl0udGFnTmFtZSkscj0wLHM9dS5sZW5ndGg7cz5yO3IrKylhPXVbcl0saS5hcHBlbmRDaGlsZChhKTtyZXR1cm5baV19LHIucHJvdG90eXBlLmNyZWF0ZUNvbnRhaW5lckVsZW1lbnQ9ZnVuY3Rpb24oZSl7dmFyIG8saTtyZXR1cm4gbz10aGlzLmF0dHJpYnV0ZXNbZV0saT10KG8pLG4oaS50YWdOYW1lKX0sci5wcm90b3R5cGUuc2hvdWxkQWRkRXh0cmFOZXdsaW5lRWxlbWVudD1mdW5jdGlvbigpe3JldHVybi9cXG5cXG4kLy50ZXN0KHRoaXMuYmxvY2sudG9TdHJpbmcoKSl9LHJ9KGUuT2JqZWN0Vmlldyl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuLG89ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBuKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgbyBpbiBlKWkuY2FsbChlLG8pJiYodFtvXT1lW29dKTtyZXR1cm4gbi5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG4sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0saT17fS5oYXNPd25Qcm9wZXJ0eTt0PWUuZGVmZXIsbj1lLm1ha2VFbGVtZW50LGUuRG9jdW1lbnRWaWV3PWZ1bmN0aW9uKGkpe2Z1bmN0aW9uIHIoKXtyLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5lbGVtZW50PXRoaXMub3B0aW9ucy5lbGVtZW50LHRoaXMuZWxlbWVudFN0b3JlPW5ldyBlLkVsZW1lbnRTdG9yZSx0aGlzLnNldERvY3VtZW50KHRoaXMub2JqZWN0KX12YXIgcyxhLHU7cmV0dXJuIG8ocixpKSxyLnJlbmRlcj1mdW5jdGlvbih0KXt2YXIgZSxvO3JldHVybiBlPW4oXCJkaXZcIiksbz1uZXcgdGhpcyh0LHtlbGVtZW50OmV9KSxvLnJlbmRlcigpLG8uc3luYygpLGV9LHIucHJvdG90eXBlLnNldERvY3VtZW50PWZ1bmN0aW9uKHQpe3JldHVybiB0LmlzRXF1YWxUbyh0aGlzLmRvY3VtZW50KT92b2lkIDA6dGhpcy5kb2N1bWVudD10aGlzLm9iamVjdD10fSxyLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgdCxvLGkscixzLGEsdTtpZih0aGlzLmNoaWxkVmlld3M9W10sdGhpcy5zaGFkb3dFbGVtZW50PW4oXCJkaXZcIiksIXRoaXMuZG9jdW1lbnQuaXNFbXB0eSgpKXtmb3Iocz1lLk9iamVjdEdyb3VwLmdyb3VwT2JqZWN0cyh0aGlzLmRvY3VtZW50LmdldEJsb2NrcygpLHthc1RyZWU6ITB9KSxhPVtdLHQ9MCxvPXMubGVuZ3RoO28+dDt0Kyspcj1zW3RdLHU9dGhpcy5maW5kT3JDcmVhdGVDYWNoZWRDaGlsZFZpZXcoZS5CbG9ja1ZpZXcsciksYS5wdXNoKGZ1bmN0aW9uKCl7dmFyIHQsZSxuLG87Zm9yKG49dS5nZXROb2RlcygpLG89W10sdD0wLGU9bi5sZW5ndGg7ZT50O3QrKylpPW5bdF0sby5wdXNoKHRoaXMuc2hhZG93RWxlbWVudC5hcHBlbmRDaGlsZChpKSk7cmV0dXJuIG99LmNhbGwodGhpcykpO3JldHVybiBhfX0sci5wcm90b3R5cGUuaXNTeW5jZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gcyh0aGlzLnNoYWRvd0VsZW1lbnQsdGhpcy5lbGVtZW50KX0sci5wcm90b3R5cGUuc3luYz1mdW5jdGlvbigpe3ZhciB0O2Zvcih0PXRoaXMuY3JlYXRlRG9jdW1lbnRGcmFnbWVudEZvclN5bmMoKTt0aGlzLmVsZW1lbnQubGFzdENoaWxkOyl0aGlzLmVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50Lmxhc3RDaGlsZCk7cmV0dXJuIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZCh0KSx0aGlzLmRpZFN5bmMoKX0sci5wcm90b3R5cGUuZGlkU3luYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVsZW1lbnRTdG9yZS5yZXNldChhKHRoaXMuZWxlbWVudCkpLHQoZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuZ2FyYmFnZUNvbGxlY3RDYWNoZWRWaWV3cygpfX0odGhpcykpfSxyLnByb3RvdHlwZS5jcmVhdGVEb2N1bWVudEZyYWdtZW50Rm9yU3luYz1mdW5jdGlvbigpe3ZhciB0LGUsbixvLGkscixzLHUsYyxsO2ZvcihlPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSx1PXRoaXMuc2hhZG93RWxlbWVudC5jaGlsZE5vZGVzLG49MCxpPXUubGVuZ3RoO2k+bjtuKyspcz11W25dLGUuYXBwZW5kQ2hpbGQocy5jbG9uZU5vZGUoITApKTtmb3IoYz1hKGUpLG89MCxyPWMubGVuZ3RoO3I+bztvKyspdD1jW29dLChsPXRoaXMuZWxlbWVudFN0b3JlLnJlbW92ZSh0KSkmJnQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobCx0KTtyZXR1cm4gZX0sYT1mdW5jdGlvbih0KXtyZXR1cm4gdC5xdWVyeVNlbGVjdG9yQWxsKFwiW2RhdGEtdHJpeC1zdG9yZS1rZXldXCIpfSxzPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHUodC5pbm5lckhUTUwpPT09dShlLmlubmVySFRNTCl9LHU9ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvJm5ic3A7L2csXCIgXCIpfSxyfShlLk9iamVjdFZpZXcpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbixvLGkscj1mdW5jdGlvbih0LGUpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiB0LmFwcGx5KGUsYXJndW1lbnRzKX19LHM9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBuKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgbyBpbiBlKWEuY2FsbChlLG8pJiYodFtvXT1lW29dKTtyZXR1cm4gbi5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG4sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0sYT17fS5oYXNPd25Qcm9wZXJ0eTtvPWUuaGFuZGxlRXZlbnQsaT1lLmlubmVyRWxlbWVudElzQWN0aXZlLG49ZS5kZWZlcix0PWUuQXR0YWNobWVudFZpZXcuYXR0YWNobWVudFNlbGVjdG9yLGUuQ29tcG9zaXRpb25Db250cm9sbGVyPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIHUobixpKXt0aGlzLmVsZW1lbnQ9bix0aGlzLmNvbXBvc2l0aW9uPWksdGhpcy5kaWRDbGlja0F0dGFjaG1lbnQ9cih0aGlzLmRpZENsaWNrQXR0YWNobWVudCx0aGlzKSx0aGlzLmRpZEJsdXI9cih0aGlzLmRpZEJsdXIsdGhpcyksdGhpcy5kaWRGb2N1cz1yKHRoaXMuZGlkRm9jdXMsdGhpcyksdGhpcy5kb2N1bWVudFZpZXc9bmV3IGUuRG9jdW1lbnRWaWV3KHRoaXMuY29tcG9zaXRpb24uZG9jdW1lbnQse2VsZW1lbnQ6dGhpcy5lbGVtZW50fSksbyhcImZvY3VzXCIse29uRWxlbWVudDp0aGlzLmVsZW1lbnQsd2l0aENhbGxiYWNrOnRoaXMuZGlkRm9jdXN9KSxvKFwiYmx1clwiLHtvbkVsZW1lbnQ6dGhpcy5lbGVtZW50LHdpdGhDYWxsYmFjazp0aGlzLmRpZEJsdXJ9KSxvKFwiY2xpY2tcIix7b25FbGVtZW50OnRoaXMuZWxlbWVudCxtYXRjaGluZ1NlbGVjdG9yOlwiYVtjb250ZW50ZWRpdGFibGU9ZmFsc2VdXCIscHJldmVudERlZmF1bHQ6ITB9KSxvKFwibW91c2Vkb3duXCIse29uRWxlbWVudDp0aGlzLmVsZW1lbnQsbWF0Y2hpbmdTZWxlY3Rvcjp0LHdpdGhDYWxsYmFjazp0aGlzLmRpZENsaWNrQXR0YWNobWVudH0pLG8oXCJjbGlja1wiLHtvbkVsZW1lbnQ6dGhpcy5lbGVtZW50LG1hdGNoaW5nU2VsZWN0b3I6XCJhXCIrdCxwcmV2ZW50RGVmYXVsdDohMH0pfXJldHVybiBzKHUsYSksdS5wcm90b3R5cGUuZGlkRm9jdXM9ZnVuY3Rpb24oKXt2YXIgdCxlLG47cmV0dXJuIHQ9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGU7cmV0dXJuIHQuZm9jdXNlZD92b2lkIDA6KHQuZm9jdXNlZD0hMCxudWxsIT0oZT10LmRlbGVnYXRlKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgZS5jb21wb3NpdGlvbkNvbnRyb2xsZXJEaWRGb2N1cz9lLmNvbXBvc2l0aW9uQ29udHJvbGxlckRpZEZvY3VzKCk6dm9pZCAwKX19KHRoaXMpLG51bGwhPShlPW51bGwhPShuPXRoaXMuYmx1clByb21pc2UpP24udGhlbih0KTp2b2lkIDApP2U6dCgpfSx1LnByb3RvdHlwZS5kaWRCbHVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmx1clByb21pc2U9bmV3IFByb21pc2UoZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBuKGZ1bmN0aW9uKCl7dmFyIG47cmV0dXJuIGkodC5lbGVtZW50KXx8KHQuZm9jdXNlZD1udWxsLG51bGwhPShuPXQuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmNvbXBvc2l0aW9uQ29udHJvbGxlckRpZEJsdXImJm4uY29tcG9zaXRpb25Db250cm9sbGVyRGlkQmx1cigpKSx0LmJsdXJQcm9taXNlPW51bGwsZSgpfSl9fSh0aGlzKSl9LHUucHJvdG90eXBlLmRpZENsaWNrQXR0YWNobWVudD1mdW5jdGlvbih0LGUpe3ZhciBuLG87cmV0dXJuIG49dGhpcy5maW5kQXR0YWNobWVudEZvckVsZW1lbnQoZSksbnVsbCE9KG89dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG8uY29tcG9zaXRpb25Db250cm9sbGVyRGlkU2VsZWN0QXR0YWNobWVudD9vLmNvbXBvc2l0aW9uQ29udHJvbGxlckRpZFNlbGVjdEF0dGFjaG1lbnQobik6dm9pZCAwfSx1LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgdCxlLG47cmV0dXJuIHRoaXMucmV2aXNpb24hPT10aGlzLmNvbXBvc2l0aW9uLnJldmlzaW9uJiYodGhpcy5kb2N1bWVudFZpZXcuc2V0RG9jdW1lbnQodGhpcy5jb21wb3NpdGlvbi5kb2N1bWVudCksdGhpcy5kb2N1bWVudFZpZXcucmVuZGVyKCksdGhpcy5yZXZpc2lvbj10aGlzLmNvbXBvc2l0aW9uLnJldmlzaW9uKSx0aGlzLmRvY3VtZW50Vmlldy5pc1N5bmNlZCgpfHwobnVsbCE9KHQ9dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQuY29tcG9zaXRpb25Db250cm9sbGVyV2lsbFN5bmNEb2N1bWVudFZpZXcmJnQuY29tcG9zaXRpb25Db250cm9sbGVyV2lsbFN5bmNEb2N1bWVudFZpZXcoKSx0aGlzLmRvY3VtZW50Vmlldy5zeW5jKCksdGhpcy5yZWluc3RhbGxBdHRhY2htZW50RWRpdG9yKCksbnVsbCE9KGU9dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGUuY29tcG9zaXRpb25Db250cm9sbGVyRGlkU3luY0RvY3VtZW50VmlldyYmZS5jb21wb3NpdGlvbkNvbnRyb2xsZXJEaWRTeW5jRG9jdW1lbnRWaWV3KCkpLG51bGwhPShuPXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmNvbXBvc2l0aW9uQ29udHJvbGxlckRpZFJlbmRlcj9uLmNvbXBvc2l0aW9uQ29udHJvbGxlckRpZFJlbmRlcigpOnZvaWQgMH0sdS5wcm90b3R5cGUucmVyZW5kZXJWaWV3Rm9yT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmludmFsaWRhdGVWaWV3Rm9yT2JqZWN0KHQpLHRoaXMucmVuZGVyKCl9LHUucHJvdG90eXBlLmludmFsaWRhdGVWaWV3Rm9yT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRvY3VtZW50Vmlldy5pbnZhbGlkYXRlVmlld0Zvck9iamVjdCh0KX0sdS5wcm90b3R5cGUuaXNWaWV3Q2FjaGluZ0VuYWJsZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb2N1bWVudFZpZXcuaXNWaWV3Q2FjaGluZ0VuYWJsZWQoKX0sdS5wcm90b3R5cGUuZW5hYmxlVmlld0NhY2hpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb2N1bWVudFZpZXcuZW5hYmxlVmlld0NhY2hpbmcoKX0sdS5wcm90b3R5cGUuZGlzYWJsZVZpZXdDYWNoaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9jdW1lbnRWaWV3LmRpc2FibGVWaWV3Q2FjaGluZygpfSx1LnByb3RvdHlwZS5yZWZyZXNoVmlld0NhY2hlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9jdW1lbnRWaWV3LmdhcmJhZ2VDb2xsZWN0Q2FjaGVkVmlld3MoKX0sdS5wcm90b3R5cGUuaW5zdGFsbEF0dGFjaG1lbnRFZGl0b3JGb3JBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3ZhciBuLG8saTtpZigobnVsbCE9KGk9dGhpcy5hdHRhY2htZW50RWRpdG9yKT9pLmF0dGFjaG1lbnQ6dm9pZCAwKSE9PXQmJihvPXRoaXMuZG9jdW1lbnRWaWV3LmZpbmRFbGVtZW50Rm9yT2JqZWN0KHQpKSlyZXR1cm4gdGhpcy51bmluc3RhbGxBdHRhY2htZW50RWRpdG9yKCksbj10aGlzLmNvbXBvc2l0aW9uLmRvY3VtZW50LmdldEF0dGFjaG1lbnRQaWVjZUZvckF0dGFjaG1lbnQodCksdGhpcy5hdHRhY2htZW50RWRpdG9yPW5ldyBlLkF0dGFjaG1lbnRFZGl0b3JDb250cm9sbGVyKG4sbyx0aGlzLmVsZW1lbnQpLHRoaXMuYXR0YWNobWVudEVkaXRvci5kZWxlZ2F0ZT10aGlzfSx1LnByb3RvdHlwZS51bmluc3RhbGxBdHRhY2htZW50RWRpdG9yPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIG51bGwhPSh0PXRoaXMuYXR0YWNobWVudEVkaXRvcik/dC51bmluc3RhbGwoKTp2b2lkIDB9LHUucHJvdG90eXBlLnJlaW5zdGFsbEF0dGFjaG1lbnRFZGl0b3I9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdGhpcy5hdHRhY2htZW50RWRpdG9yPyh0PXRoaXMuYXR0YWNobWVudEVkaXRvci5hdHRhY2htZW50LHRoaXMudW5pbnN0YWxsQXR0YWNobWVudEVkaXRvcigpLHRoaXMuaW5zdGFsbEF0dGFjaG1lbnRFZGl0b3JGb3JBdHRhY2htZW50KHQpKTp2b2lkIDB9LHUucHJvdG90eXBlLmVkaXRBdHRhY2htZW50Q2FwdGlvbj1mdW5jdGlvbigpe3ZhciB0O3JldHVybiBudWxsIT0odD10aGlzLmF0dGFjaG1lbnRFZGl0b3IpP3QuZWRpdENhcHRpb24oKTp2b2lkIDB9LHUucHJvdG90eXBlLmRpZFVuaW5zdGFsbEF0dGFjaG1lbnRFZGl0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRhY2htZW50RWRpdG9yPW51bGwsdGhpcy5yZW5kZXIoKX0sdS5wcm90b3R5cGUuYXR0YWNobWVudEVkaXRvckRpZFJlcXVlc3RVcGRhdGluZ0F0dHJpYnV0ZXNGb3JBdHRhY2htZW50PWZ1bmN0aW9uKHQsZSl7dmFyIG47cmV0dXJuIG51bGwhPShuPXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmNvbXBvc2l0aW9uQ29udHJvbGxlcldpbGxVcGRhdGVBdHRhY2htZW50JiZuLmNvbXBvc2l0aW9uQ29udHJvbGxlcldpbGxVcGRhdGVBdHRhY2htZW50KGUpLHRoaXMuY29tcG9zaXRpb24udXBkYXRlQXR0cmlidXRlc0ZvckF0dGFjaG1lbnQodCxlKX0sdS5wcm90b3R5cGUuYXR0YWNobWVudEVkaXRvckRpZFJlcXVlc3RSZW1vdmluZ0F0dHJpYnV0ZUZvckF0dGFjaG1lbnQ9ZnVuY3Rpb24odCxlKXt2YXIgbjtyZXR1cm4gbnVsbCE9KG49dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4uY29tcG9zaXRpb25Db250cm9sbGVyV2lsbFVwZGF0ZUF0dGFjaG1lbnQmJm4uY29tcG9zaXRpb25Db250cm9sbGVyV2lsbFVwZGF0ZUF0dGFjaG1lbnQoZSksdGhpcy5jb21wb3NpdGlvbi5yZW1vdmVBdHRyaWJ1dGVGb3JBdHRhY2htZW50KHQsZSl9LHUucHJvdG90eXBlLmF0dGFjaG1lbnRFZGl0b3JEaWRSZXF1ZXN0UmVtb3ZhbE9mQXR0YWNobWVudD1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gbnVsbCE9KGU9dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGUuY29tcG9zaXRpb25Db250cm9sbGVyRGlkUmVxdWVzdFJlbW92YWxPZkF0dGFjaG1lbnQ/ZS5jb21wb3NpdGlvbkNvbnRyb2xsZXJEaWRSZXF1ZXN0UmVtb3ZhbE9mQXR0YWNobWVudCh0KTp2b2lkIDB9LHUucHJvdG90eXBlLmF0dGFjaG1lbnRFZGl0b3JEaWRSZXF1ZXN0RGVzZWxlY3RpbmdBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBudWxsIT0oZT10aGlzLmRlbGVnYXRlKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgZS5jb21wb3NpdGlvbkNvbnRyb2xsZXJEaWRSZXF1ZXN0RGVzZWxlY3RpbmdBdHRhY2htZW50P2UuY29tcG9zaXRpb25Db250cm9sbGVyRGlkUmVxdWVzdERlc2VsZWN0aW5nQXR0YWNobWVudCh0KTp2b2lkIDB9LHUucHJvdG90eXBlLmZpbmRBdHRhY2htZW50Rm9yRWxlbWVudD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb21wb3NpdGlvbi5kb2N1bWVudC5nZXRBdHRhY2htZW50QnlJZChwYXJzZUludCh0LmRhdGFzZXQudHJpeElkLDEwKSl9LHV9KGUuQmFzaWNPYmplY3QpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbixvLGk9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdC5hcHBseShlLGFyZ3VtZW50cyl9fSxyPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIG8gaW4gZSlzLmNhbGwoZSxvKSYmKHRbb109ZVtvXSk7cmV0dXJuIG4ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBuLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LHM9e30uaGFzT3duUHJvcGVydHk7bj1lLmhhbmRsZUV2ZW50LG89ZS50cmlnZ2VyRXZlbnQsdD1lLmZpbmRDbG9zZXN0RWxlbWVudEZyb21Ob2RlLGUuVG9vbGJhckNvbnRyb2xsZXI9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gcyh0KXt0aGlzLmVsZW1lbnQ9dCx0aGlzLmRpZEtleURvd25EaWFsb2dJbnB1dD1pKHRoaXMuZGlkS2V5RG93bkRpYWxvZ0lucHV0LHRoaXMpLHRoaXMuZGlkQ2xpY2tEaWFsb2dCdXR0b249aSh0aGlzLmRpZENsaWNrRGlhbG9nQnV0dG9uLHRoaXMpLHRoaXMuZGlkQ2xpY2tBdHRyaWJ1dGVCdXR0b249aSh0aGlzLmRpZENsaWNrQXR0cmlidXRlQnV0dG9uLHRoaXMpLHRoaXMuZGlkQ2xpY2tBY3Rpb25CdXR0b249aSh0aGlzLmRpZENsaWNrQWN0aW9uQnV0dG9uLHRoaXMpLHRoaXMuYXR0cmlidXRlcz17fSx0aGlzLmFjdGlvbnM9e30sdGhpcy5yZXNldERpYWxvZ0lucHV0cygpLG4oXCJtb3VzZWRvd25cIix7b25FbGVtZW50OnRoaXMuZWxlbWVudCxtYXRjaGluZ1NlbGVjdG9yOmEsd2l0aENhbGxiYWNrOnRoaXMuZGlkQ2xpY2tBY3Rpb25CdXR0b259KSxuKFwibW91c2Vkb3duXCIse29uRWxlbWVudDp0aGlzLmVsZW1lbnQsbWF0Y2hpbmdTZWxlY3RvcjpjLHdpdGhDYWxsYmFjazp0aGlzLmRpZENsaWNrQXR0cmlidXRlQnV0dG9ufSksbihcImNsaWNrXCIse29uRWxlbWVudDp0aGlzLmVsZW1lbnQsbWF0Y2hpbmdTZWxlY3Rvcjp5LHByZXZlbnREZWZhdWx0OiEwfSksbihcImNsaWNrXCIse29uRWxlbWVudDp0aGlzLmVsZW1lbnQsbWF0Y2hpbmdTZWxlY3RvcjpsLHdpdGhDYWxsYmFjazp0aGlzLmRpZENsaWNrRGlhbG9nQnV0dG9ufSksbihcImtleWRvd25cIix7b25FbGVtZW50OnRoaXMuZWxlbWVudCxtYXRjaGluZ1NlbGVjdG9yOmgsd2l0aENhbGxiYWNrOnRoaXMuZGlkS2V5RG93bkRpYWxvZ0lucHV0fSl9dmFyIGEsdSxjLGwsaCxwLGQsZixnLG0seTtyZXR1cm4gcihzLGUpLGE9XCJidXR0b25bZGF0YS10cml4LWFjdGlvbl1cIixjPVwiYnV0dG9uW2RhdGEtdHJpeC1hdHRyaWJ1dGVdXCIseT1bYSxjXS5qb2luKFwiLCBcIikscD1cIi5kaWFsb2dbZGF0YS10cml4LWRpYWxvZ11cIix1PXArXCIuYWN0aXZlXCIsbD1wK1wiIGlucHV0W2RhdGEtdHJpeC1tZXRob2RdXCIsaD1wK1wiIGlucHV0W3R5cGU9dGV4dF0sIFwiK3ArXCIgaW5wdXRbdHlwZT11cmxdXCIscy5wcm90b3R5cGUuZGlkQ2xpY2tBY3Rpb25CdXR0b249ZnVuY3Rpb24odCxlKXt2YXIgbixvLGk7cmV0dXJuIG51bGwhPShvPXRoaXMuZGVsZWdhdGUpJiZvLnRvb2xiYXJEaWRDbGlja0J1dHRvbigpLHQucHJldmVudERlZmF1bHQoKSxuPWQoZSksdGhpcy5nZXREaWFsb2cobik/dGhpcy50b2dnbGVEaWFsb2cobik6bnVsbCE9KGk9dGhpcy5kZWxlZ2F0ZSk/aS50b29sYmFyRGlkSW52b2tlQWN0aW9uKG4pOnZvaWQgMH0scy5wcm90b3R5cGUuZGlkQ2xpY2tBdHRyaWJ1dGVCdXR0b249ZnVuY3Rpb24odCxlKXt2YXIgbixvLGk7cmV0dXJuIG51bGwhPShvPXRoaXMuZGVsZWdhdGUpJiZvLnRvb2xiYXJEaWRDbGlja0J1dHRvbigpLHQucHJldmVudERlZmF1bHQoKSxuPWYoZSksdGhpcy5nZXREaWFsb2cobik/dGhpcy50b2dnbGVEaWFsb2cobik6bnVsbCE9KGk9dGhpcy5kZWxlZ2F0ZSkmJmkudG9vbGJhckRpZFRvZ2dsZUF0dHJpYnV0ZShuKSx0aGlzLnJlZnJlc2hBdHRyaWJ1dGVCdXR0b25zKCl9LHMucHJvdG90eXBlLmRpZENsaWNrRGlhbG9nQnV0dG9uPWZ1bmN0aW9uKGUsbil7dmFyIG8saTtyZXR1cm4gbz10KG4se21hdGNoaW5nU2VsZWN0b3I6cH0pLGk9bi5nZXRBdHRyaWJ1dGUoXCJkYXRhLXRyaXgtbWV0aG9kXCIpLHRoaXNbaV0uY2FsbCh0aGlzLG8pfSxzLnByb3RvdHlwZS5kaWRLZXlEb3duRGlhbG9nSW5wdXQ9ZnVuY3Rpb24odCxlKXt2YXIgbixvO3JldHVybiAxMz09PXQua2V5Q29kZSYmKHQucHJldmVudERlZmF1bHQoKSxuPWUuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSxvPXRoaXMuZ2V0RGlhbG9nKG4pLHRoaXMuc2V0QXR0cmlidXRlKG8pKSwyNz09PXQua2V5Q29kZT8odC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuaGlkZURpYWxvZygpKTp2b2lkIDB9LHMucHJvdG90eXBlLnVwZGF0ZUFjdGlvbnM9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuYWN0aW9ucz10LHRoaXMucmVmcmVzaEFjdGlvbkJ1dHRvbnMoKX0scy5wcm90b3R5cGUucmVmcmVzaEFjdGlvbkJ1dHRvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lYWNoQWN0aW9uQnV0dG9uKGZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlLG4pe3JldHVybiBlLmRpc2FibGVkPXQuYWN0aW9uc1tuXT09PSExfX0odGhpcykpfSxzLnByb3RvdHlwZS5lYWNoQWN0aW9uQnV0dG9uPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbyxpLHI7Zm9yKGk9dGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYSkscj1bXSxuPTAsbz1pLmxlbmd0aDtvPm47bisrKWU9aVtuXSxyLnB1c2godChlLGQoZSkpKTtyZXR1cm4gcn0scy5wcm90b3R5cGUudXBkYXRlQXR0cmlidXRlcz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzPXQsdGhpcy5yZWZyZXNoQXR0cmlidXRlQnV0dG9ucygpfSxzLnByb3RvdHlwZS5yZWZyZXNoQXR0cmlidXRlQnV0dG9ucz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVhY2hBdHRyaWJ1dGVCdXR0b24oZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUsbil7cmV0dXJuIGUuZGlzYWJsZWQ9dC5hdHRyaWJ1dGVzW25dPT09ITEsdC5hdHRyaWJ1dGVzW25dfHx0LmRpYWxvZ0lzVmlzaWJsZShuKT9lLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik6ZS5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpfX0odGhpcykpfSxzLnByb3RvdHlwZS5lYWNoQXR0cmlidXRlQnV0dG9uPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbyxpLHI7Zm9yKGk9dGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYykscj1bXSxuPTAsbz1pLmxlbmd0aDtvPm47bisrKWU9aVtuXSxyLnB1c2godChlLGYoZSkpKTtyZXR1cm4gcn0scy5wcm90b3R5cGUuYXBwbHlLZXlib2FyZENvbW1hbmQ9ZnVuY3Rpb24odCl7dmFyIGUsbixpLHIscyxhLHU7Zm9yKHM9SlNPTi5zdHJpbmdpZnkodC5zb3J0KCkpLHU9dGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS10cml4LWtleV1cIikscj0wLGE9dS5sZW5ndGg7YT5yO3IrKylpZihlPXVbcl0saT1lLmdldEF0dHJpYnV0ZShcImRhdGEtdHJpeC1rZXlcIikuc3BsaXQoXCIrXCIpLG49SlNPTi5zdHJpbmdpZnkoaS5zb3J0KCkpLG49PT1zKXJldHVybiBvKFwibW91c2Vkb3duXCIse29uRWxlbWVudDplfSksITA7cmV0dXJuITF9LHMucHJvdG90eXBlLmRpYWxvZ0lzVmlzaWJsZT1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4oZT10aGlzLmdldERpYWxvZyh0KSk/ZS5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIik6dm9pZCAwfSxzLnByb3RvdHlwZS50b2dnbGVEaWFsb2c9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZGlhbG9nSXNWaXNpYmxlKHQpP3RoaXMuaGlkZURpYWxvZygpOnRoaXMuc2hvd0RpYWxvZyh0KX0scy5wcm90b3R5cGUuc2hvd0RpYWxvZz1mdW5jdGlvbih0KXt2YXIgZSxuLG8saSxyLHMsYSx1LGMsbDtmb3IodGhpcy5oaWRlRGlhbG9nKCksbnVsbCE9KGE9dGhpcy5kZWxlZ2F0ZSkmJmEudG9vbGJhcldpbGxTaG93RGlhbG9nKCksbz10aGlzLmdldERpYWxvZyh0KSxvLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIiksdT1vLnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFtkaXNhYmxlZF1cIiksaT0wLHM9dS5sZW5ndGg7cz5pO2krKyluPXVbaV0sbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtyZXR1cm4oZT1mKG8pKSYmKHI9bShvLHQpKSYmKHIudmFsdWU9bnVsbCE9KGM9dGhpcy5hdHRyaWJ1dGVzW2VdKT9jOlwiaHR0cDovL1wiLHIuc2VsZWN0KCkpLG51bGwhPShsPXRoaXMuZGVsZWdhdGUpP2wudG9vbGJhckRpZFNob3dEaWFsb2codCk6dm9pZCAwfSxzLnByb3RvdHlwZS5zZXRBdHRyaWJ1dGU9ZnVuY3Rpb24odCl7dmFyIGUsbixvO3JldHVybiBlPWYodCksbj1tKHQsZSksbi53aWxsVmFsaWRhdGUmJiFuLmNoZWNrVmFsaWRpdHkoKT8obi5jbGFzc0xpc3QuYWRkKFwidmFsaWRhdGVcIiksbi5mb2N1cygpKToobnVsbCE9KG89dGhpcy5kZWxlZ2F0ZSkmJm8udG9vbGJhckRpZFVwZGF0ZUF0dHJpYnV0ZShlLG4udmFsdWUpLHRoaXMuaGlkZURpYWxvZygpKX0scy5wcm90b3R5cGUucmVtb3ZlQXR0cmlidXRlPWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIGU9Zih0KSxudWxsIT0obj10aGlzLmRlbGVnYXRlKSYmbi50b29sYmFyRGlkUmVtb3ZlQXR0cmlidXRlKGUpLHRoaXMuaGlkZURpYWxvZygpfSxzLnByb3RvdHlwZS5oaWRlRGlhbG9nPWZ1bmN0aW9uKCl7dmFyIHQsZTtyZXR1cm4odD10aGlzLmVsZW1lbnQucXVlcnlTZWxlY3Rvcih1KSk/KHQuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKSx0aGlzLnJlc2V0RGlhbG9nSW5wdXRzKCksbnVsbCE9KGU9dGhpcy5kZWxlZ2F0ZSk/ZS50b29sYmFyRGlkSGlkZURpYWxvZyhnKHQpKTp2b2lkIDApOnZvaWQgMH0scy5wcm90b3R5cGUucmVzZXREaWFsb2dJbnB1dHM9ZnVuY3Rpb24oKXt2YXIgdCxlLG4sbyxpO2ZvcihvPXRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGgpLGk9W10sdD0wLG49by5sZW5ndGg7bj50O3QrKyllPW9bdF0sZS5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLFwiZGlzYWJsZWRcIiksaS5wdXNoKGUuY2xhc3NMaXN0LnJlbW92ZShcInZhbGlkYXRlXCIpKTtyZXR1cm4gaX0scy5wcm90b3R5cGUuZ2V0RGlhbG9nPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaWFsb2dbZGF0YS10cml4LWRpYWxvZz1cIit0K1wiXVwiKX0sbT1mdW5jdGlvbih0LGUpe3JldHVybiBudWxsPT1lJiYoZT1mKHQpKSx0LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFtuYW1lPSdcIitlK1wiJ11cIil9LGQ9ZnVuY3Rpb24odCl7cmV0dXJuIHQuZ2V0QXR0cmlidXRlKFwiZGF0YS10cml4LWFjdGlvblwiKX0sZj1mdW5jdGlvbih0KXtyZXR1cm4gdC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXRyaXgtYXR0cmlidXRlXCIpfSxnPWZ1bmN0aW9uKHQpe3JldHVybiB0LmdldEF0dHJpYnV0ZShcImRhdGEtdHJpeC1kaWFsb2dcIil9LHN9KGUuQmFzaWNPYmplY3QpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQ9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBvKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgaSBpbiBlKW4uY2FsbChlLGkpJiYodFtpXT1lW2ldKTtyZXR1cm4gby5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG8sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0sbj17fS5oYXNPd25Qcm9wZXJ0eTtlLkltYWdlUHJlbG9hZE9wZXJhdGlvbj1mdW5jdGlvbihlKXtmdW5jdGlvbiBuKHQpe3RoaXMudXJsPXR9cmV0dXJuIHQobixlKSxuLnByb3RvdHlwZS5wZXJmb3JtPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBlPW5ldyBJbWFnZSxlLm9ubG9hZD1mdW5jdGlvbihuKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gZS53aWR0aD1uLndpZHRoPWUubmF0dXJhbFdpZHRoLGUuaGVpZ2h0PW4uaGVpZ2h0PWUubmF0dXJhbEhlaWdodCx0KCEwLGUpfX0odGhpcyksZS5vbmVycm9yPWZ1bmN0aW9uKCl7cmV0dXJuIHQoITEpfSxlLnNyYz10aGlzLnVybH0sbn0oZS5PcGVyYXRpb24pfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdC5hcHBseShlLGFyZ3VtZW50cyl9fSxuPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIGkgaW4gZSlvLmNhbGwoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIG4ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBuLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LG89e30uaGFzT3duUHJvcGVydHk7ZS5BdHRhY2htZW50PWZ1bmN0aW9uKG8pe2Z1bmN0aW9uIGkobil7bnVsbD09biYmKG49e30pLHRoaXMucmVsZWFzZUZpbGU9dCh0aGlzLnJlbGVhc2VGaWxlLHRoaXMpLGkuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmF0dHJpYnV0ZXM9ZS5IYXNoLmJveChuKSx0aGlzLmRpZENoYW5nZUF0dHJpYnV0ZXMoKX1yZXR1cm4gbihpLG8pLGkucHJldmlld2FibGVQYXR0ZXJuPS9eaW1hZ2UoXFwvKGdpZnxwbmd8anBlP2cpfCQpLyxpLmF0dGFjaG1lbnRGb3JGaWxlPWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIG49dGhpcy5hdHRyaWJ1dGVzRm9yRmlsZSh0KSxlPW5ldyB0aGlzKG4pLGUuc2V0RmlsZSh0KSxlfSxpLmF0dHJpYnV0ZXNGb3JGaWxlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5IYXNoKHtmaWxlbmFtZTp0Lm5hbWUsZmlsZXNpemU6dC5zaXplLGNvbnRlbnRUeXBlOnQudHlwZX0pfSxpLmZyb21KU09OPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgdGhpcyh0KX0saS5wcm90b3R5cGUuZ2V0QXR0cmlidXRlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXMuZ2V0KHQpfSxpLnByb3RvdHlwZS5oYXNBdHRyaWJ1dGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuYXR0cmlidXRlcy5oYXModCl9LGkucHJvdG90eXBlLmdldEF0dHJpYnV0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLnRvT2JqZWN0KCl9LGkucHJvdG90eXBlLnNldEF0dHJpYnV0ZXM9ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4gbnVsbD09dCYmKHQ9e30pLGU9dGhpcy5hdHRyaWJ1dGVzLm1lcmdlKHQpLHRoaXMuYXR0cmlidXRlcy5pc0VxdWFsVG8oZSk/dm9pZCAwOih0aGlzLmF0dHJpYnV0ZXM9ZSx0aGlzLmRpZENoYW5nZUF0dHJpYnV0ZXMoKSxudWxsIT0obj10aGlzLmRlbGVnYXRlKSYmXCJmdW5jdGlvblwiPT10eXBlb2Ygbi5hdHRhY2htZW50RGlkQ2hhbmdlQXR0cmlidXRlcz9uLmF0dGFjaG1lbnREaWRDaGFuZ2VBdHRyaWJ1dGVzKHRoaXMpOnZvaWQgMCl9LGkucHJvdG90eXBlLmRpZENoYW5nZUF0dHJpYnV0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc1ByZXZpZXdhYmxlKCk/dGhpcy5wcmVsb2FkVVJMKCk6dm9pZCAwfSxpLnByb3RvdHlwZS5pc1BlbmRpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbCE9dGhpcy5maWxlJiYhKHRoaXMuZ2V0VVJMKCl8fHRoaXMuZ2V0SHJlZigpKX0saS5wcm90b3R5cGUuaXNQcmV2aWV3YWJsZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXMuaGFzKFwicHJldmlld2FibGVcIik/dGhpcy5hdHRyaWJ1dGVzLmdldChcInByZXZpZXdhYmxlXCIpOnRoaXMuY29uc3RydWN0b3IucHJldmlld2FibGVQYXR0ZXJuLnRlc3QodGhpcy5nZXRDb250ZW50VHlwZSgpKX0saS5wcm90b3R5cGUuZ2V0VHlwZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc0NvbnRlbnQoKT9cImNvbnRlbnRcIjp0aGlzLmlzUHJldmlld2FibGUoKT9cInByZXZpZXdcIjpcImZpbGVcIn0saS5wcm90b3R5cGUuZ2V0VVJMPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXR0cmlidXRlcy5nZXQoXCJ1cmxcIil9LGkucHJvdG90eXBlLmdldEhyZWY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLmdldChcImhyZWZcIil9LGkucHJvdG90eXBlLmdldEZpbGVuYW1lPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIG51bGwhPSh0PXRoaXMuYXR0cmlidXRlcy5nZXQoXCJmaWxlbmFtZVwiKSk/dDpcIlwifSxpLnByb3RvdHlwZS5nZXRGaWxlc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXMuZ2V0KFwiZmlsZXNpemVcIil9LGkucHJvdG90eXBlLmdldEZvcm1hdHRlZEZpbGVzaXplPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHQ9dGhpcy5hdHRyaWJ1dGVzLmdldChcImZpbGVzaXplXCIpLFwibnVtYmVyXCI9PXR5cGVvZiB0P2UuY29uZmlnLmZpbGVTaXplLmZvcm1hdHRlcih0KTpcIlwifSxpLnByb3RvdHlwZS5nZXRFeHRlbnNpb249ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gbnVsbCE9KHQ9dGhpcy5nZXRGaWxlbmFtZSgpLm1hdGNoKC9cXC4oXFx3KykkLykpP3RbMV0udG9Mb3dlckNhc2UoKTp2b2lkIDB9LGkucHJvdG90eXBlLmdldENvbnRlbnRUeXBlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXR0cmlidXRlcy5nZXQoXCJjb250ZW50VHlwZVwiKX0saS5wcm90b3R5cGUuaGFzQ29udGVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXMuaGFzKFwiY29udGVudFwiKX0saS5wcm90b3R5cGUuZ2V0Q29udGVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXMuZ2V0KFwiY29udGVudFwiKX0saS5wcm90b3R5cGUuZ2V0V2lkdGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLmdldChcIndpZHRoXCIpfSxpLnByb3RvdHlwZS5nZXRIZWlnaHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLmdldChcImhlaWdodFwiKX0saS5wcm90b3R5cGUuZ2V0RmlsZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbGV9LGkucHJvdG90eXBlLnNldEZpbGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZmlsZT10LHRoaXMuaXNQcmV2aWV3YWJsZSgpP3RoaXMucHJlbG9hZEZpbGUoKTp2b2lkIDB9LGkucHJvdG90eXBlLnJlbGVhc2VGaWxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVsZWFzZVByZWxvYWRlZEZpbGUoKSx0aGlzLmZpbGU9bnVsbH0saS5wcm90b3R5cGUuZ2V0VXBsb2FkUHJvZ3Jlc3M9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gbnVsbCE9KHQ9dGhpcy51cGxvYWRQcm9ncmVzcyk/dDowfSxpLnByb3RvdHlwZS5zZXRVcGxvYWRQcm9ncmVzcz1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gdGhpcy51cGxvYWRQcm9ncmVzcyE9PXQ/KHRoaXMudXBsb2FkUHJvZ3Jlc3M9dCxudWxsIT0oZT10aGlzLnVwbG9hZFByb2dyZXNzRGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBlLmF0dGFjaG1lbnREaWRDaGFuZ2VVcGxvYWRQcm9ncmVzcz9lLmF0dGFjaG1lbnREaWRDaGFuZ2VVcGxvYWRQcm9ncmVzcyh0aGlzKTp2b2lkIDApOnZvaWQgMH0saS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlcygpfSxpLnByb3RvdHlwZS5nZXRDYWNoZUtleT1mdW5jdGlvbigpe3JldHVybltpLl9fc3VwZXJfXy5nZXRDYWNoZUtleS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5hdHRyaWJ1dGVzLmdldENhY2hlS2V5KCksdGhpcy5nZXRQcmV2aWV3VVJMKCldLmpvaW4oXCIvXCIpfSxpLnByb3RvdHlwZS5nZXRQcmV2aWV3VVJMPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJldmlld1VSTHx8dGhpcy5wcmVsb2FkaW5nVVJMfSxpLnByb3RvdHlwZS5zZXRQcmV2aWV3VVJMPWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIHQhPT10aGlzLmdldFByZXZpZXdVUkwoKT8odGhpcy5wcmV2aWV3VVJMPXQsbnVsbCE9KGU9dGhpcy5wcmV2aWV3RGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBlLmF0dGFjaG1lbnREaWRDaGFuZ2VQcmV2aWV3VVJMJiZlLmF0dGFjaG1lbnREaWRDaGFuZ2VQcmV2aWV3VVJMKHRoaXMpLG51bGwhPShuPXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmF0dGFjaG1lbnREaWRDaGFuZ2VQcmV2aWV3VVJMP24uYXR0YWNobWVudERpZENoYW5nZVByZXZpZXdVUkwodGhpcyk6dm9pZCAwKTp2b2lkIDB9LGkucHJvdG90eXBlLnByZWxvYWRVUkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmVsb2FkKHRoaXMuZ2V0VVJMKCksdGhpcy5yZWxlYXNlRmlsZSl9LGkucHJvdG90eXBlLnByZWxvYWRGaWxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlsZT8odGhpcy5maWxlT2JqZWN0VVJMPVVSTC5jcmVhdGVPYmplY3RVUkwodGhpcy5maWxlKSx0aGlzLnByZWxvYWQodGhpcy5maWxlT2JqZWN0VVJMKSk6dm9pZCAwfSxpLnByb3RvdHlwZS5yZWxlYXNlUHJlbG9hZGVkRmlsZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZpbGVPYmplY3RVUkw/KFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5maWxlT2JqZWN0VVJMKSx0aGlzLmZpbGVPYmplY3RVUkw9bnVsbCk6dm9pZCAwfSxpLnByb3RvdHlwZS5wcmVsb2FkPWZ1bmN0aW9uKHQsbil7dmFyIG87cmV0dXJuIHQmJnQhPT10aGlzLmdldFByZXZpZXdVUkwoKT8odGhpcy5wcmVsb2FkaW5nVVJMPXQsbz1uZXcgZS5JbWFnZVByZWxvYWRPcGVyYXRpb24odCksby50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbihvKXt2YXIgaSxyO3JldHVybiByPW8ud2lkdGgsaT1vLmhlaWdodCxlLnNldEF0dHJpYnV0ZXMoe3dpZHRoOnIsaGVpZ2h0Oml9KSxlLnByZWxvYWRpbmdVUkw9bnVsbCxlLnNldFByZXZpZXdVUkwodCksXCJmdW5jdGlvblwiPT10eXBlb2Ygbj9uKCk6dm9pZCAwfX0odGhpcykpKTp2b2lkIDB9LGl9KGUuT2JqZWN0KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbygpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIGkgaW4gZSluLmNhbGwoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIG8ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBvLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LG49e30uaGFzT3duUHJvcGVydHk7ZS5QaWVjZT1mdW5jdGlvbihuKXtmdW5jdGlvbiBvKHQsbil7bnVsbD09biYmKG49e30pLG8uX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmF0dHJpYnV0ZXM9ZS5IYXNoLmJveChuKX1yZXR1cm4gdChvLG4pLG8udHlwZXM9e30sby5yZWdpc3RlclR5cGU9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS50eXBlPXQsdGhpcy50eXBlc1t0XT1lfSxvLmZyb21KU09OPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybihlPXRoaXMudHlwZXNbdC50eXBlXSk/ZS5mcm9tSlNPTih0KTp2b2lkIDB9LG8ucHJvdG90eXBlLmNvcHlXaXRoQXR0cmlidXRlcz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5nZXRWYWx1ZSgpLHQpfSxvLnByb3RvdHlwZS5jb3B5V2l0aEFkZGl0aW9uYWxBdHRyaWJ1dGVzPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvcHlXaXRoQXR0cmlidXRlcyh0aGlzLmF0dHJpYnV0ZXMubWVyZ2UodCkpfSxvLnByb3RvdHlwZS5jb3B5V2l0aG91dEF0dHJpYnV0ZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb3B5V2l0aEF0dHJpYnV0ZXModGhpcy5hdHRyaWJ1dGVzLnJlbW92ZSh0KSl9LG8ucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb3B5V2l0aEF0dHJpYnV0ZXModGhpcy5hdHRyaWJ1dGVzKX0sby5wcm90b3R5cGUuZ2V0QXR0cmlidXRlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXMuZ2V0KHQpfSxvLnByb3RvdHlwZS5nZXRBdHRyaWJ1dGVzSGFzaD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXN9LG8ucHJvdG90eXBlLmdldEF0dHJpYnV0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLnRvT2JqZWN0KCl9LG8ucHJvdG90eXBlLmdldENvbW1vbkF0dHJpYnV0ZXM9ZnVuY3Rpb24oKXt2YXIgdCxlLG47cmV0dXJuKG49cGllY2VMaXN0LmdldFBpZWNlQXRJbmRleCgwKSk/KHQ9bi5hdHRyaWJ1dGVzLGU9dC5nZXRLZXlzKCkscGllY2VMaXN0LmVhY2hQaWVjZShmdW5jdGlvbihuKXtyZXR1cm4gZT10LmdldEtleXNDb21tb25Ub0hhc2gobi5hdHRyaWJ1dGVzKSx0PXQuc2xpY2UoZSl9KSx0LnRvT2JqZWN0KCkpOnt9fSxvLnByb3RvdHlwZS5oYXNBdHRyaWJ1dGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuYXR0cmlidXRlcy5oYXModCl9LG8ucHJvdG90eXBlLmhhc1NhbWVTdHJpbmdWYWx1ZUFzUGllY2U9ZnVuY3Rpb24odCl7cmV0dXJuIG51bGwhPXQmJnRoaXMudG9TdHJpbmcoKT09PXQudG9TdHJpbmcoKVxufSxvLnByb3RvdHlwZS5oYXNTYW1lQXR0cmlidXRlc0FzUGllY2U9ZnVuY3Rpb24odCl7cmV0dXJuIG51bGwhPXQmJih0aGlzLmF0dHJpYnV0ZXM9PT10LmF0dHJpYnV0ZXN8fHRoaXMuYXR0cmlidXRlcy5pc0VxdWFsVG8odC5hdHRyaWJ1dGVzKSl9LG8ucHJvdG90eXBlLmlzQmxvY2tCcmVhaz1mdW5jdGlvbigpe3JldHVybiExfSxvLnByb3RvdHlwZS5pc0VxdWFsVG89ZnVuY3Rpb24odCl7cmV0dXJuIG8uX19zdXBlcl9fLmlzRXF1YWxUby5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXMuaGFzU2FtZUNvbnN0cnVjdG9yQXModCkmJnRoaXMuaGFzU2FtZVN0cmluZ1ZhbHVlQXNQaWVjZSh0KSYmdGhpcy5oYXNTYW1lQXR0cmlidXRlc0FzUGllY2UodCl9LG8ucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMubGVuZ3RofSxvLnByb3RvdHlwZS5pc1NlcmlhbGl6YWJsZT1mdW5jdGlvbigpe3JldHVybiEwfSxvLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm57dHlwZTp0aGlzLmNvbnN0cnVjdG9yLnR5cGUsYXR0cmlidXRlczp0aGlzLmdldEF0dHJpYnV0ZXMoKX19LG8ucHJvdG90eXBlLmNvbnRlbnRzRm9ySW5zcGVjdGlvbj1mdW5jdGlvbigpe3JldHVybnt0eXBlOnRoaXMuY29uc3RydWN0b3IudHlwZSxhdHRyaWJ1dGVzOnRoaXMuYXR0cmlidXRlcy5pbnNwZWN0KCl9fSxvLnByb3RvdHlwZS5jYW5CZUdyb3VwZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNBdHRyaWJ1dGUoXCJocmVmXCIpfSxvLnByb3RvdHlwZS5jYW5CZUdyb3VwZWRXaXRoPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldEF0dHJpYnV0ZShcImhyZWZcIik9PT10LmdldEF0dHJpYnV0ZShcImhyZWZcIil9LG8ucHJvdG90eXBlLmdldExlbmd0aD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxlbmd0aH0sby5wcm90b3R5cGUuY2FuQmVDb25zb2xpZGF0ZWRXaXRoPWZ1bmN0aW9uKCl7cmV0dXJuITF9LG99KGUuT2JqZWN0KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbygpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIGkgaW4gZSluLmNhbGwoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIG8ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBvLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LG49e30uaGFzT3duUHJvcGVydHk7ZS5QaWVjZS5yZWdpc3RlclR5cGUoXCJhdHRhY2htZW50XCIsZS5BdHRhY2htZW50UGllY2U9ZnVuY3Rpb24obil7ZnVuY3Rpb24gbyh0KXt0aGlzLmF0dGFjaG1lbnQ9dCxvLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5sZW5ndGg9MSx0aGlzLmVuc3VyZUF0dGFjaG1lbnRFeGNsdXNpdmVseUhhc0F0dHJpYnV0ZShcImhyZWZcIil9cmV0dXJuIHQobyxuKSxvLmZyb21KU09OPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgdGhpcyhlLkF0dGFjaG1lbnQuZnJvbUpTT04odC5hdHRhY2htZW50KSx0LmF0dHJpYnV0ZXMpfSxvLnByb3RvdHlwZS5lbnN1cmVBdHRhY2htZW50RXhjbHVzaXZlbHlIYXNBdHRyaWJ1dGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuaGFzQXR0cmlidXRlKHQpJiZ0aGlzLmF0dGFjaG1lbnQuaGFzQXR0cmlidXRlKHQpP3RoaXMuYXR0cmlidXRlcz10aGlzLmF0dHJpYnV0ZXMucmVtb3ZlKHQpOnZvaWQgMH0sby5wcm90b3R5cGUuZ2V0VmFsdWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRhY2htZW50fSxvLnByb3RvdHlwZS5pc1NlcmlhbGl6YWJsZT1mdW5jdGlvbigpe3JldHVybiF0aGlzLmF0dGFjaG1lbnQuaXNQZW5kaW5nKCl9LG8ucHJvdG90eXBlLmdldENhcHRpb249ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gbnVsbCE9KHQ9dGhpcy5hdHRyaWJ1dGVzLmdldChcImNhcHRpb25cIikpP3Q6XCJcIn0sby5wcm90b3R5cGUuZ2V0QXR0cmlidXRlc0ZvckF0dGFjaG1lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLnNsaWNlKFtcImNhcHRpb25cIl0pfSxvLnByb3RvdHlwZS5jYW5CZUdyb3VwZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gby5fX3N1cGVyX18uY2FuQmVHcm91cGVkLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmIXRoaXMuYXR0YWNobWVudC5oYXNBdHRyaWJ1dGUoXCJocmVmXCIpfSxvLnByb3RvdHlwZS5pc0VxdWFsVG89ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIG8uX19zdXBlcl9fLmlzRXF1YWxUby5hcHBseSh0aGlzLGFyZ3VtZW50cykmJnRoaXMuYXR0YWNobWVudC5pZD09PShudWxsIT10JiZudWxsIT0oZT10LmF0dGFjaG1lbnQpP2UuaWQ6dm9pZCAwKX0sby5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gZS5PQkpFQ1RfUkVQTEFDRU1FTlRfQ0hBUkFDVEVSfSxvLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdD1vLl9fc3VwZXJfXy50b0pTT04uYXBwbHkodGhpcyxhcmd1bWVudHMpLHQuYXR0YWNobWVudD10aGlzLmF0dGFjaG1lbnQsdH0sby5wcm90b3R5cGUuZ2V0Q2FjaGVLZXk9ZnVuY3Rpb24oKXtyZXR1cm5bby5fX3N1cGVyX18uZ2V0Q2FjaGVLZXkuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuYXR0YWNobWVudC5nZXRDYWNoZUtleSgpXS5qb2luKFwiL1wiKX0sby5wcm90b3R5cGUudG9Db25zb2xlPWZ1bmN0aW9uKCl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMudG9TdHJpbmcoKSl9LG99KGUuUGllY2UpKX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbygpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIGkgaW4gZSluLmNhbGwoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIG8ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBvLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LG49e30uaGFzT3duUHJvcGVydHk7ZS5QaWVjZS5yZWdpc3RlclR5cGUoXCJzdHJpbmdcIixlLlN0cmluZ1BpZWNlPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIG4odCl7bi5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuc3RyaW5nPXQsdGhpcy5sZW5ndGg9dGhpcy5zdHJpbmcubGVuZ3RofXJldHVybiB0KG4sZSksbi5mcm9tSlNPTj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IHRoaXModC5zdHJpbmcsdC5hdHRyaWJ1dGVzKX0sbi5wcm90b3R5cGUuZ2V0VmFsdWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdHJpbmd9LG4ucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RyaW5nLnRvU3RyaW5nKCl9LG4ucHJvdG90eXBlLmlzQmxvY2tCcmVhaz1mdW5jdGlvbigpe3JldHVyblwiXFxuXCI9PT10aGlzLnRvU3RyaW5nKCkmJnRoaXMuZ2V0QXR0cmlidXRlKFwiYmxvY2tCcmVha1wiKT09PSEwfSxuLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdD1uLl9fc3VwZXJfXy50b0pTT04uYXBwbHkodGhpcyxhcmd1bWVudHMpLHQuc3RyaW5nPXRoaXMuc3RyaW5nLHR9LG4ucHJvdG90eXBlLmNhbkJlQ29uc29saWRhdGVkV2l0aD1mdW5jdGlvbih0KXtyZXR1cm4gbnVsbCE9dCYmdGhpcy5oYXNTYW1lQ29uc3RydWN0b3JBcyh0KSYmdGhpcy5oYXNTYW1lQXR0cmlidXRlc0FzUGllY2UodCl9LG4ucHJvdG90eXBlLmNvbnNvbGlkYXRlV2l0aD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy50b1N0cmluZygpK3QudG9TdHJpbmcoKSx0aGlzLmF0dHJpYnV0ZXMpfSxuLnByb3RvdHlwZS5zcGxpdEF0T2Zmc2V0PWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIDA9PT10PyhlPW51bGwsbj10aGlzKTp0PT09dGhpcy5sZW5ndGg/KGU9dGhpcyxuPW51bGwpOihlPW5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuc3RyaW5nLnNsaWNlKDAsdCksdGhpcy5hdHRyaWJ1dGVzKSxuPW5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuc3RyaW5nLnNsaWNlKHQpLHRoaXMuYXR0cmlidXRlcykpLFtlLG5dfSxuLnByb3RvdHlwZS50b0NvbnNvbGU9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdD10aGlzLnN0cmluZyx0Lmxlbmd0aD4xNSYmKHQ9dC5zbGljZSgwLDE0KStcIlxcdTIwMjZcIiksSlNPTi5zdHJpbmdpZnkodC50b1N0cmluZygpKX0sbn0oZS5QaWVjZSkpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbj1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBpIGluIGUpby5jYWxsKGUsaSkmJih0W2ldPWVbaV0pO3JldHVybiBuLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbix0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxvPXt9Lmhhc093blByb3BlcnR5LGk9W10uc2xpY2U7dD1lLnNwbGljZUFycmF5LGUuU3BsaXR0YWJsZUxpc3Q9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gbyh0KXtudWxsPT10JiYodD1bXSksby5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMub2JqZWN0cz10LnNsaWNlKDApLHRoaXMubGVuZ3RoPXRoaXMub2JqZWN0cy5sZW5ndGh9dmFyIHIscyxhO3JldHVybiBuKG8sZSksby5ib3g9ZnVuY3Rpb24odCl7cmV0dXJuIHQgaW5zdGFuY2VvZiB0aGlzP3Q6bmV3IHRoaXModCl9LG8ucHJvdG90eXBlLmluZGV4T2Y9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMub2JqZWN0cy5pbmRleE9mKHQpfSxvLnByb3RvdHlwZS5zcGxpY2U9ZnVuY3Rpb24oKXt2YXIgZTtyZXR1cm4gZT0xPD1hcmd1bWVudHMubGVuZ3RoP2kuY2FsbChhcmd1bWVudHMsMCk6W10sbmV3IHRoaXMuY29uc3RydWN0b3IodC5hcHBseShudWxsLFt0aGlzLm9iamVjdHNdLmNvbmNhdChpLmNhbGwoZSkpKSl9LG8ucHJvdG90eXBlLmVhY2hPYmplY3Q9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGkscixzO2ZvcihyPXRoaXMub2JqZWN0cyxzPVtdLG49ZT0wLG89ci5sZW5ndGg7bz5lO249KytlKWk9cltuXSxzLnB1c2godChpLG4pKTtyZXR1cm4gc30sby5wcm90b3R5cGUuaW5zZXJ0T2JqZWN0QXRJbmRleD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnNwbGljZShlLDAsdCl9LG8ucHJvdG90eXBlLmluc2VydFNwbGl0dGFibGVMaXN0QXRJbmRleD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnNwbGljZS5hcHBseSh0aGlzLFtlLDBdLmNvbmNhdChpLmNhbGwodC5vYmplY3RzKSkpfSxvLnByb3RvdHlwZS5pbnNlcnRTcGxpdHRhYmxlTGlzdEF0UG9zaXRpb249ZnVuY3Rpb24odCxlKXt2YXIgbixvLGk7cmV0dXJuIGk9dGhpcy5zcGxpdE9iamVjdEF0UG9zaXRpb24oZSksbz1pWzBdLG49aVsxXSxuZXcgdGhpcy5jb25zdHJ1Y3RvcihvKS5pbnNlcnRTcGxpdHRhYmxlTGlzdEF0SW5kZXgodCxuKX0sby5wcm90b3R5cGUuZWRpdE9iamVjdEF0SW5kZXg9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5yZXBsYWNlT2JqZWN0QXRJbmRleChlKHRoaXMub2JqZWN0c1t0XSksdCl9LG8ucHJvdG90eXBlLnJlcGxhY2VPYmplY3RBdEluZGV4PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuc3BsaWNlKGUsMSx0KX0sby5wcm90b3R5cGUucmVtb3ZlT2JqZWN0QXRJbmRleD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zcGxpY2UodCwxKX0sby5wcm90b3R5cGUuZ2V0T2JqZWN0QXRJbmRleD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5vYmplY3RzW3RdfSxvLnByb3RvdHlwZS5nZXRTcGxpdHRhYmxlTGlzdEluUmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGk7cmV0dXJuIG89dGhpcy5zcGxpdE9iamVjdHNBdFJhbmdlKHQpLG49b1swXSxlPW9bMV0saT1vWzJdLG5ldyB0aGlzLmNvbnN0cnVjdG9yKG4uc2xpY2UoZSxpKzEpKX0sby5wcm90b3R5cGUuc2VsZWN0U3BsaXR0YWJsZUxpc3Q9ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4gbj1mdW5jdGlvbigpe3ZhciBuLG8saSxyO2ZvcihpPXRoaXMub2JqZWN0cyxyPVtdLG49MCxvPWkubGVuZ3RoO28+bjtuKyspZT1pW25dLHQoZSkmJnIucHVzaChlKTtyZXR1cm4gcn0uY2FsbCh0aGlzKSxuZXcgdGhpcy5jb25zdHJ1Y3RvcihuKX0sby5wcm90b3R5cGUucmVtb3ZlT2JqZWN0c0luUmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGk7cmV0dXJuIG89dGhpcy5zcGxpdE9iamVjdHNBdFJhbmdlKHQpLG49b1swXSxlPW9bMV0saT1vWzJdLG5ldyB0aGlzLmNvbnN0cnVjdG9yKG4pLnNwbGljZShlLGktZSsxKX0sby5wcm90b3R5cGUudHJhbnNmb3JtT2JqZWN0c0luUmFuZ2U9ZnVuY3Rpb24odCxlKXt2YXIgbixvLGkscixzLGEsdTtyZXR1cm4gcz10aGlzLnNwbGl0T2JqZWN0c0F0UmFuZ2UodCkscj1zWzBdLG89c1sxXSxhPXNbMl0sdT1mdW5jdGlvbigpe3ZhciB0LHMsdTtmb3IodT1bXSxuPXQ9MCxzPXIubGVuZ3RoO3M+dDtuPSsrdClpPXJbbl0sdS5wdXNoKG4+PW8mJmE+PW4/ZShpKTppKTtyZXR1cm4gdX0oKSxuZXcgdGhpcy5jb25zdHJ1Y3Rvcih1KX0sby5wcm90b3R5cGUuc3BsaXRPYmplY3RzQXRSYW5nZT1mdW5jdGlvbih0KXt2YXIgZSxuLG8saSxzLHU7cmV0dXJuIGk9dGhpcy5zcGxpdE9iamVjdEF0UG9zaXRpb24oYSh0KSksbj1pWzBdLGU9aVsxXSxvPWlbMl0scz1uZXcgdGhpcy5jb25zdHJ1Y3RvcihuKS5zcGxpdE9iamVjdEF0UG9zaXRpb24ocih0KStvKSxuPXNbMF0sdT1zWzFdLFtuLGUsdS0xXX0sby5wcm90b3R5cGUuZ2V0T2JqZWN0QXRQb3NpdGlvbj1mdW5jdGlvbih0KXt2YXIgZSxuLG87cmV0dXJuIG89dGhpcy5maW5kSW5kZXhBbmRPZmZzZXRBdFBvc2l0aW9uKHQpLGU9by5pbmRleCxuPW8ub2Zmc2V0LHRoaXMub2JqZWN0c1tlXX0sby5wcm90b3R5cGUuc3BsaXRPYmplY3RBdFBvc2l0aW9uPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbyxpLHIscyxhLHUsYyxsO3JldHVybiBzPXRoaXMuZmluZEluZGV4QW5kT2Zmc2V0QXRQb3NpdGlvbih0KSxlPXMuaW5kZXgscj1zLm9mZnNldCxpPXRoaXMub2JqZWN0cy5zbGljZSgwKSxudWxsIT1lPzA9PT1yPyhjPWUsbD0wKToobz10aGlzLmdldE9iamVjdEF0SW5kZXgoZSksYT1vLnNwbGl0QXRPZmZzZXQociksbj1hWzBdLHU9YVsxXSxpLnNwbGljZShlLDEsbix1KSxjPWUrMSxsPW4uZ2V0TGVuZ3RoKCktcik6KGM9aS5sZW5ndGgsbD0wKSxbaSxjLGxdfSxvLnByb3RvdHlwZS5jb25zb2xpZGF0ZT1mdW5jdGlvbigpe3ZhciB0LGUsbixvLGkscjtmb3Iobz1bXSxpPXRoaXMub2JqZWN0c1swXSxyPXRoaXMub2JqZWN0cy5zbGljZSgxKSx0PTAsZT1yLmxlbmd0aDtlPnQ7dCsrKW49clt0XSwoXCJmdW5jdGlvblwiPT10eXBlb2YgaS5jYW5CZUNvbnNvbGlkYXRlZFdpdGg/aS5jYW5CZUNvbnNvbGlkYXRlZFdpdGgobik6dm9pZCAwKT9pPWkuY29uc29saWRhdGVXaXRoKG4pOihvLnB1c2goaSksaT1uKTtyZXR1cm4gbnVsbCE9aSYmby5wdXNoKGkpLG5ldyB0aGlzLmNvbnN0cnVjdG9yKG8pfSxvLnByb3RvdHlwZS5jb25zb2xpZGF0ZUZyb21JbmRleFRvSW5kZXg9ZnVuY3Rpb24odCxlKXt2YXIgbixvLHI7cmV0dXJuIG89dGhpcy5vYmplY3RzLnNsaWNlKDApLHI9by5zbGljZSh0LGUrMSksbj1uZXcgdGhpcy5jb25zdHJ1Y3RvcihyKS5jb25zb2xpZGF0ZSgpLnRvQXJyYXkoKSx0aGlzLnNwbGljZS5hcHBseSh0aGlzLFt0LHIubGVuZ3RoXS5jb25jYXQoaS5jYWxsKG4pKSl9LG8ucHJvdG90eXBlLmZpbmRJbmRleEFuZE9mZnNldEF0UG9zaXRpb249ZnVuY3Rpb24odCl7dmFyIGUsbixvLGkscixzLGE7Zm9yKGU9MCxhPXRoaXMub2JqZWN0cyxvPW49MCxpPWEubGVuZ3RoO2k+bjtvPSsrbil7aWYocz1hW29dLHI9ZStzLmdldExlbmd0aCgpLHQ+PWUmJnI+dClyZXR1cm57aW5kZXg6byxvZmZzZXQ6dC1lfTtlPXJ9cmV0dXJue2luZGV4Om51bGwsb2Zmc2V0Om51bGx9fSxvLnByb3RvdHlwZS5maW5kUG9zaXRpb25BdEluZGV4QW5kT2Zmc2V0PWZ1bmN0aW9uKHQsZSl7dmFyIG4sbyxpLHIscyxhO2ZvcihzPTAsYT10aGlzLm9iamVjdHMsbj1vPTAsaT1hLmxlbmd0aDtpPm87bj0rK28paWYocj1hW25dLHQ+bilzKz1yLmdldExlbmd0aCgpO2Vsc2UgaWYobj09PXQpe3MrPWU7YnJlYWt9cmV0dXJuIHN9LG8ucHJvdG90eXBlLmdldEVuZFBvc2l0aW9uPWZ1bmN0aW9uKCl7dmFyIHQsZTtyZXR1cm4gbnVsbCE9dGhpcy5lbmRQb3NpdGlvbj90aGlzLmVuZFBvc2l0aW9uOnRoaXMuZW5kUG9zaXRpb249ZnVuY3Rpb24oKXt2YXIgbixvLGk7Zm9yKGU9MCxpPXRoaXMub2JqZWN0cyxuPTAsbz1pLmxlbmd0aDtvPm47bisrKXQ9aVtuXSxlKz10LmdldExlbmd0aCgpO3JldHVybiBlfS5jYWxsKHRoaXMpfSxvLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm9iamVjdHMuam9pbihcIlwiKX0sby5wcm90b3R5cGUudG9BcnJheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm9iamVjdHMuc2xpY2UoMCl9LG8ucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvQXJyYXkoKX0sby5wcm90b3R5cGUuaXNFcXVhbFRvPWZ1bmN0aW9uKHQpe3JldHVybiBvLl9fc3VwZXJfXy5pc0VxdWFsVG8uYXBwbHkodGhpcyxhcmd1bWVudHMpfHxzKHRoaXMub2JqZWN0cyxudWxsIT10P3Qub2JqZWN0czp2b2lkIDApfSxzPWZ1bmN0aW9uKHQsZSl7dmFyIG4sbyxpLHIscztpZihudWxsPT1lJiYoZT1bXSksdC5sZW5ndGghPT1lLmxlbmd0aClyZXR1cm4hMTtmb3Iocz0hMCxvPW49MCxpPXQubGVuZ3RoO2k+bjtvPSsrbilyPXRbb10scyYmIXIuaXNFcXVhbFRvKGVbb10pJiYocz0hMSk7cmV0dXJuIHN9LG8ucHJvdG90eXBlLmNvbnRlbnRzRm9ySW5zcGVjdGlvbj1mdW5jdGlvbigpe3ZhciB0O3JldHVybntvYmplY3RzOlwiW1wiK2Z1bmN0aW9uKCl7dmFyIGUsbixvLGk7Zm9yKG89dGhpcy5vYmplY3RzLGk9W10sZT0wLG49by5sZW5ndGg7bj5lO2UrKyl0PW9bZV0saS5wdXNoKHQuaW5zcGVjdCgpKTtyZXR1cm4gaX0uY2FsbCh0aGlzKS5qb2luKFwiLCBcIikrXCJdXCJ9fSxhPWZ1bmN0aW9uKHQpe3JldHVybiB0WzBdfSxyPWZ1bmN0aW9uKHQpe3JldHVybiB0WzFdfSxvfShlLk9iamVjdCl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdD1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG8oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBpIGluIGUpbi5jYWxsKGUsaSkmJih0W2ldPWVbaV0pO3JldHVybiBvLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbyx0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxuPXt9Lmhhc093blByb3BlcnR5O2UuVGV4dD1mdW5jdGlvbihuKXtmdW5jdGlvbiBvKHQpe3ZhciBuO251bGw9PXQmJih0PVtdKSxvLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5waWVjZUxpc3Q9bmV3IGUuU3BsaXR0YWJsZUxpc3QoZnVuY3Rpb24oKXt2YXIgZSxvLGk7Zm9yKGk9W10sZT0wLG89dC5sZW5ndGg7bz5lO2UrKyluPXRbZV0sbi5pc0VtcHR5KCl8fGkucHVzaChuKTtyZXR1cm4gaX0oKSl9cmV0dXJuIHQobyxuKSxvLnRleHRGb3JBdHRhY2htZW50V2l0aEF0dHJpYnV0ZXM9ZnVuY3Rpb24odCxuKXt2YXIgbztyZXR1cm4gbz1uZXcgZS5BdHRhY2htZW50UGllY2UodCxuKSxuZXcgdGhpcyhbb10pfSxvLnRleHRGb3JTdHJpbmdXaXRoQXR0cmlidXRlcz1mdW5jdGlvbih0LG4pe3ZhciBvO3JldHVybiBvPW5ldyBlLlN0cmluZ1BpZWNlKHQsbiksbmV3IHRoaXMoW29dKX0sby5mcm9tSlNPTj1mdW5jdGlvbih0KXt2YXIgbixvO3JldHVybiBvPWZ1bmN0aW9uKCl7dmFyIG8saSxyO2ZvcihyPVtdLG89MCxpPXQubGVuZ3RoO2k+bztvKyspbj10W29dLHIucHVzaChlLlBpZWNlLmZyb21KU09OKG4pKTtyZXR1cm4gcn0oKSxuZXcgdGhpcyhvKX0sby5wcm90b3R5cGUuY29weT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvcHlXaXRoUGllY2VMaXN0KHRoaXMucGllY2VMaXN0KX0sby5wcm90b3R5cGUuY29weVdpdGhQaWVjZUxpc3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHQuY29uc29saWRhdGUoKS50b0FycmF5KCkpfSxvLnByb3RvdHlwZS5jb3B5VXNpbmdPYmplY3RNYXA9ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4gbj1mdW5jdGlvbigpe3ZhciBuLG8saSxyLHM7Zm9yKGk9dGhpcy5nZXRQaWVjZXMoKSxzPVtdLG49MCxvPWkubGVuZ3RoO28+bjtuKyspZT1pW25dLHMucHVzaChudWxsIT0ocj10LmZpbmQoZSkpP3I6ZSk7cmV0dXJuIHN9LmNhbGwodGhpcyksbmV3IHRoaXMuY29uc3RydWN0b3Iobil9LG8ucHJvdG90eXBlLmFwcGVuZFRleHQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuaW5zZXJ0VGV4dEF0UG9zaXRpb24odCx0aGlzLmdldExlbmd0aCgpKX0sby5wcm90b3R5cGUuaW5zZXJ0VGV4dEF0UG9zaXRpb249ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5jb3B5V2l0aFBpZWNlTGlzdCh0aGlzLnBpZWNlTGlzdC5pbnNlcnRTcGxpdHRhYmxlTGlzdEF0UG9zaXRpb24odC5waWVjZUxpc3QsZSkpfSxvLnByb3RvdHlwZS5yZW1vdmVUZXh0QXRSYW5nZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb3B5V2l0aFBpZWNlTGlzdCh0aGlzLnBpZWNlTGlzdC5yZW1vdmVPYmplY3RzSW5SYW5nZSh0KSl9LG8ucHJvdG90eXBlLnJlcGxhY2VUZXh0QXRSYW5nZT1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnJlbW92ZVRleHRBdFJhbmdlKGUpLmluc2VydFRleHRBdFBvc2l0aW9uKHQsZVswXSl9LG8ucHJvdG90eXBlLm1vdmVUZXh0RnJvbVJhbmdlVG9Qb3NpdGlvbj1mdW5jdGlvbih0LGUpe3ZhciBuLG87aWYoISh0WzBdPD1lJiZlPD10WzFdKSlyZXR1cm4gbz10aGlzLmdldFRleHRBdFJhbmdlKHQpLG49by5nZXRMZW5ndGgoKSx0WzBdPGUmJihlLT1uKSx0aGlzLnJlbW92ZVRleHRBdFJhbmdlKHQpLmluc2VydFRleHRBdFBvc2l0aW9uKG8sZSl9LG8ucHJvdG90eXBlLmFkZEF0dHJpYnV0ZUF0UmFuZ2U9ZnVuY3Rpb24odCxlLG4pe3ZhciBvO3JldHVybiBvPXt9LG9bdF09ZSx0aGlzLmFkZEF0dHJpYnV0ZXNBdFJhbmdlKG8sbil9LG8ucHJvdG90eXBlLmFkZEF0dHJpYnV0ZXNBdFJhbmdlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuY29weVdpdGhQaWVjZUxpc3QodGhpcy5waWVjZUxpc3QudHJhbnNmb3JtT2JqZWN0c0luUmFuZ2UoZSxmdW5jdGlvbihlKXtyZXR1cm4gZS5jb3B5V2l0aEFkZGl0aW9uYWxBdHRyaWJ1dGVzKHQpfSkpfSxvLnByb3RvdHlwZS5yZW1vdmVBdHRyaWJ1dGVBdFJhbmdlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuY29weVdpdGhQaWVjZUxpc3QodGhpcy5waWVjZUxpc3QudHJhbnNmb3JtT2JqZWN0c0luUmFuZ2UoZSxmdW5jdGlvbihlKXtyZXR1cm4gZS5jb3B5V2l0aG91dEF0dHJpYnV0ZSh0KX0pKX0sby5wcm90b3R5cGUuc2V0QXR0cmlidXRlc0F0UmFuZ2U9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5jb3B5V2l0aFBpZWNlTGlzdCh0aGlzLnBpZWNlTGlzdC50cmFuc2Zvcm1PYmplY3RzSW5SYW5nZShlLGZ1bmN0aW9uKGUpe3JldHVybiBlLmNvcHlXaXRoQXR0cmlidXRlcyh0KX0pKX0sby5wcm90b3R5cGUuZ2V0QXR0cmlidXRlc0F0UG9zaXRpb249ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4gbnVsbCE9KGU9bnVsbCE9KG49dGhpcy5waWVjZUxpc3QuZ2V0T2JqZWN0QXRQb3NpdGlvbih0KSk/bi5nZXRBdHRyaWJ1dGVzKCk6dm9pZCAwKT9lOnt9fSxvLnByb3RvdHlwZS5nZXRDb21tb25BdHRyaWJ1dGVzPWZ1bmN0aW9uKCl7dmFyIHQsbjtyZXR1cm4gdD1mdW5jdGlvbigpe3ZhciB0LGUsbyxpO2ZvcihvPXRoaXMucGllY2VMaXN0LnRvQXJyYXkoKSxpPVtdLHQ9MCxlPW8ubGVuZ3RoO2U+dDt0Kyspbj1vW3RdLGkucHVzaChuLmdldEF0dHJpYnV0ZXMoKSk7cmV0dXJuIGl9LmNhbGwodGhpcyksZS5IYXNoLmZyb21Db21tb25BdHRyaWJ1dGVzT2ZPYmplY3RzKHQpLnRvT2JqZWN0KCl9LG8ucHJvdG90eXBlLmdldENvbW1vbkF0dHJpYnV0ZXNBdFJhbmdlPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBudWxsIT0oZT10aGlzLmdldFRleHRBdFJhbmdlKHQpLmdldENvbW1vbkF0dHJpYnV0ZXMoKSk/ZTp7fX0sby5wcm90b3R5cGUuZ2V0RXhwYW5kZWRSYW5nZUZvckF0dHJpYnV0ZUF0T2Zmc2V0PWZ1bmN0aW9uKHQsZSl7dmFyIG4sbyxpO2ZvcihuPWk9ZSxvPXRoaXMuZ2V0TGVuZ3RoKCk7bj4wJiZ0aGlzLmdldENvbW1vbkF0dHJpYnV0ZXNBdFJhbmdlKFtuLTEsaV0pW3RdOyluLS07Zm9yKDtvPmkmJnRoaXMuZ2V0Q29tbW9uQXR0cmlidXRlc0F0UmFuZ2UoW2UsaSsxXSlbdF07KWkrKztyZXR1cm5bbixpXX0sby5wcm90b3R5cGUuZ2V0VGV4dEF0UmFuZ2U9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29weVdpdGhQaWVjZUxpc3QodGhpcy5waWVjZUxpc3QuZ2V0U3BsaXR0YWJsZUxpc3RJblJhbmdlKHQpKX0sby5wcm90b3R5cGUuZ2V0U3RyaW5nQXRSYW5nZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5waWVjZUxpc3QuZ2V0U3BsaXR0YWJsZUxpc3RJblJhbmdlKHQpLnRvU3RyaW5nKCl9LG8ucHJvdG90eXBlLmdldFN0cmluZ0F0UG9zaXRpb249ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ2V0U3RyaW5nQXRSYW5nZShbdCx0KzFdKX0sby5wcm90b3R5cGUuc3RhcnRzV2l0aFN0cmluZz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5nZXRTdHJpbmdBdFJhbmdlKFswLHQubGVuZ3RoXSk9PT10fSxvLnByb3RvdHlwZS5lbmRzV2l0aFN0cmluZz1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gZT10aGlzLmdldExlbmd0aCgpLHRoaXMuZ2V0U3RyaW5nQXRSYW5nZShbZS10Lmxlbmd0aCxlXSk9PT10fSxvLnByb3RvdHlwZS5nZXRBdHRhY2htZW50UGllY2VzPWZ1bmN0aW9uKCl7dmFyIHQsZSxuLG8saTtmb3Iobz10aGlzLnBpZWNlTGlzdC50b0FycmF5KCksaT1bXSx0PTAsZT1vLmxlbmd0aDtlPnQ7dCsrKW49b1t0XSxudWxsIT1uLmF0dGFjaG1lbnQmJmkucHVzaChuKTtyZXR1cm4gaX0sby5wcm90b3R5cGUuZ2V0QXR0YWNobWVudHM9ZnVuY3Rpb24oKXt2YXIgdCxlLG4sbyxpO2ZvcihvPXRoaXMuZ2V0QXR0YWNobWVudFBpZWNlcygpLGk9W10sdD0wLGU9by5sZW5ndGg7ZT50O3QrKyluPW9bdF0saS5wdXNoKG4uYXR0YWNobWVudCk7cmV0dXJuIGl9LG8ucHJvdG90eXBlLmdldEF0dGFjaG1lbnRBbmRQb3NpdGlvbkJ5SWQ9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGkscixzO2ZvcihpPTAscj10aGlzLnBpZWNlTGlzdC50b0FycmF5KCksZT0wLG49ci5sZW5ndGg7bj5lO2UrKyl7aWYobz1yW2VdLChudWxsIT0ocz1vLmF0dGFjaG1lbnQpP3MuaWQ6dm9pZCAwKT09PXQpcmV0dXJue2F0dGFjaG1lbnQ6by5hdHRhY2htZW50LHBvc2l0aW9uOml9O2krPW8ubGVuZ3RofXJldHVybnthdHRhY2htZW50Om51bGwscG9zaXRpb246bnVsbH19LG8ucHJvdG90eXBlLmdldEF0dGFjaG1lbnRCeUlkPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbztyZXR1cm4gbz10aGlzLmdldEF0dGFjaG1lbnRBbmRQb3NpdGlvbkJ5SWQodCksZT1vLmF0dGFjaG1lbnQsbj1vLnBvc2l0aW9uLGV9LG8ucHJvdG90eXBlLmdldFJhbmdlT2ZBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIG49dGhpcy5nZXRBdHRhY2htZW50QW5kUG9zaXRpb25CeUlkKHQuaWQpLHQ9bi5hdHRhY2htZW50LGU9bi5wb3NpdGlvbixudWxsIT10P1tlLGUrMV06dm9pZCAwfSxvLnByb3RvdHlwZS51cGRhdGVBdHRyaWJ1dGVzRm9yQXR0YWNobWVudD1mdW5jdGlvbih0LGUpe3ZhciBuO3JldHVybihuPXRoaXMuZ2V0UmFuZ2VPZkF0dGFjaG1lbnQoZSkpP3RoaXMuYWRkQXR0cmlidXRlc0F0UmFuZ2UodCxuKTp0aGlzfSxvLnByb3RvdHlwZS5nZXRMZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5waWVjZUxpc3QuZ2V0RW5kUG9zaXRpb24oKX0sby5wcm90b3R5cGUuaXNFbXB0eT1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5nZXRMZW5ndGgoKX0sby5wcm90b3R5cGUuaXNFcXVhbFRvPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBvLl9fc3VwZXJfXy5pc0VxdWFsVG8uYXBwbHkodGhpcyxhcmd1bWVudHMpfHwobnVsbCE9dCYmbnVsbCE9KGU9dC5waWVjZUxpc3QpP2UuaXNFcXVhbFRvKHRoaXMucGllY2VMaXN0KTp2b2lkIDApfSxvLnByb3RvdHlwZS5pc0Jsb2NrQnJlYWs9ZnVuY3Rpb24oKXtyZXR1cm4gMT09PXRoaXMuZ2V0TGVuZ3RoKCkmJnRoaXMucGllY2VMaXN0LmdldE9iamVjdEF0SW5kZXgoMCkuaXNCbG9ja0JyZWFrKCl9LG8ucHJvdG90eXBlLmVhY2hQaWVjZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5waWVjZUxpc3QuZWFjaE9iamVjdCh0KX0sby5wcm90b3R5cGUuZ2V0UGllY2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGllY2VMaXN0LnRvQXJyYXkoKX0sby5wcm90b3R5cGUuZ2V0UGllY2VBdFBvc2l0aW9uPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnBpZWNlTGlzdC5nZXRPYmplY3RBdFBvc2l0aW9uKHQpfSxvLnByb3RvdHlwZS5jb250ZW50c0Zvckluc3BlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm57cGllY2VMaXN0OnRoaXMucGllY2VMaXN0Lmluc3BlY3QoKX19LG8ucHJvdG90eXBlLnRvU2VyaWFsaXphYmxlVGV4dD1mdW5jdGlvbigpe3ZhciB0O3JldHVybiB0PXRoaXMucGllY2VMaXN0LnNlbGVjdFNwbGl0dGFibGVMaXN0KGZ1bmN0aW9uKHQpe3JldHVybiB0LmlzU2VyaWFsaXphYmxlKCl9KSx0aGlzLmNvcHlXaXRoUGllY2VMaXN0KHQpfSxvLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBpZWNlTGlzdC50b1N0cmluZygpfSxvLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5waWVjZUxpc3QudG9KU09OKCl9LG8ucHJvdG90eXBlLnRvQ29uc29sZT1mdW5jdGlvbigpe3ZhciB0O3JldHVybiBKU09OLnN0cmluZ2lmeShmdW5jdGlvbigpe3ZhciBlLG4sbyxpO2ZvcihvPXRoaXMucGllY2VMaXN0LnRvQXJyYXkoKSxpPVtdLGU9MCxuPW8ubGVuZ3RoO24+ZTtlKyspdD1vW2VdLGkucHVzaChKU09OLnBhcnNlKHQudG9Db25zb2xlKCkpKTtyZXR1cm4gaX0uY2FsbCh0aGlzKSl9LG99KGUuT2JqZWN0KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0LG4sbyxpLHIscz1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBvIGluIGUpYS5jYWxsKGUsbykmJih0W29dPWVbb10pO3JldHVybiBuLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbix0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxhPXt9Lmhhc093blByb3BlcnR5LHU9W10uc2xpY2UsYz1bXS5pbmRleE9mfHxmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxuPXRoaXMubGVuZ3RoO24+ZTtlKyspaWYoZSBpbiB0aGlzJiZ0aGlzW2VdPT09dClyZXR1cm4gZTtyZXR1cm4tMX07dD1lLmFycmF5c0FyZUVxdWFsLHI9ZS5zcGxpY2VBcnJheSxvPWUuZ2V0QmxvY2tDb25maWcsbj1lLmdldEJsb2NrQXR0cmlidXRlTmFtZXMsaT1lLmdldExpc3RBdHRyaWJ1dGVOYW1lcyxlLkJsb2NrPWZ1bmN0aW9uKG4pe2Z1bmN0aW9uIGEodCxuKXtudWxsPT10JiYodD1uZXcgZS5UZXh0KSxudWxsPT1uJiYobj1bXSksYS5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMudGV4dD1oKHQpLHRoaXMuYXR0cmlidXRlcz1ufXZhciBsLGgscCxkLGYsZyxtLHksdjtyZXR1cm4gcyhhLG4pLGEuZnJvbUpTT049ZnVuY3Rpb24odCl7dmFyIG47cmV0dXJuIG49ZS5UZXh0LmZyb21KU09OKHQudGV4dCksbmV3IHRoaXMobix0LmF0dHJpYnV0ZXMpfSxhLnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGV4dC5pc0Jsb2NrQnJlYWsoKX0sYS5wcm90b3R5cGUuaXNFcXVhbFRvPWZ1bmN0aW9uKGUpe3JldHVybiBhLl9fc3VwZXJfXy5pc0VxdWFsVG8uYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzLnRleHQuaXNFcXVhbFRvKG51bGwhPWU/ZS50ZXh0OnZvaWQgMCkmJnQodGhpcy5hdHRyaWJ1dGVzLG51bGwhPWU/ZS5hdHRyaWJ1dGVzOnZvaWQgMCl9LGEucHJvdG90eXBlLmNvcHlXaXRoVGV4dD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodCx0aGlzLmF0dHJpYnV0ZXMpfSxhLnByb3RvdHlwZS5jb3B5V2l0aG91dFRleHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb3B5V2l0aFRleHQobnVsbCl9LGEucHJvdG90eXBlLmNvcHlXaXRoQXR0cmlidXRlcz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy50ZXh0LHQpfSxhLnByb3RvdHlwZS5jb3B5VXNpbmdPYmplY3RNYXA9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIHRoaXMuY29weVdpdGhUZXh0KChlPXQuZmluZCh0aGlzLnRleHQpKT9lOnRoaXMudGV4dC5jb3B5VXNpbmdPYmplY3RNYXAodCkpfSxhLnByb3RvdHlwZS5hZGRBdHRyaWJ1dGU9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIGU9dGhpcy5hdHRyaWJ1dGVzLmNvbmNhdChkKHQpKSx0aGlzLmNvcHlXaXRoQXR0cmlidXRlcyhlKX0sYS5wcm90b3R5cGUucmVtb3ZlQXR0cmlidXRlPWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIG49byh0KS5saXN0QXR0cmlidXRlLGU9ZyhnKHRoaXMuYXR0cmlidXRlcyx0KSxuKSx0aGlzLmNvcHlXaXRoQXR0cmlidXRlcyhlKX0sYS5wcm90b3R5cGUucmVtb3ZlTGFzdEF0dHJpYnV0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLmdldExhc3RBdHRyaWJ1dGUoKSl9LGEucHJvdG90eXBlLmdldExhc3RBdHRyaWJ1dGU9ZnVuY3Rpb24oKXtyZXR1cm4gZih0aGlzLmF0dHJpYnV0ZXMpfSxhLnByb3RvdHlwZS5nZXRBdHRyaWJ1dGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXR0cmlidXRlcy5zbGljZSgwKX0sYS5wcm90b3R5cGUuZ2V0QXR0cmlidXRlTGV2ZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLmxlbmd0aH0sYS5wcm90b3R5cGUuZ2V0QXR0cmlidXRlQXRMZXZlbD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzW3QtMV19LGEucHJvdG90eXBlLmhhc0F0dHJpYnV0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGVMZXZlbCgpPjB9LGEucHJvdG90eXBlLmdldExhc3ROZXN0YWJsZUF0dHJpYnV0ZT1mdW5jdGlvbigpe3JldHVybiBmKHRoaXMuZ2V0TmVzdGFibGVBdHRyaWJ1dGVzKCkpfSxhLnByb3RvdHlwZS5nZXROZXN0YWJsZUF0dHJpYnV0ZXM9ZnVuY3Rpb24oKXt2YXIgdCxlLG4saSxyO2ZvcihpPXRoaXMuYXR0cmlidXRlcyxyPVtdLGU9MCxuPWkubGVuZ3RoO24+ZTtlKyspdD1pW2VdLG8odCkubmVzdGFibGUmJnIucHVzaCh0KTtyZXR1cm4gcn0sYS5wcm90b3R5cGUuZ2V0TmVzdGluZ0xldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0TmVzdGFibGVBdHRyaWJ1dGVzKCkubGVuZ3RofSxhLnByb3RvdHlwZS5kZWNyZWFzZU5lc3RpbmdMZXZlbD1mdW5jdGlvbigpe3ZhciB0O3JldHVybih0PXRoaXMuZ2V0TGFzdE5lc3RhYmxlQXR0cmlidXRlKCkpP3RoaXMucmVtb3ZlQXR0cmlidXRlKHQpOnRoaXN9LGEucHJvdG90eXBlLmluY3JlYXNlTmVzdGluZ0xldmVsPWZ1bmN0aW9uKCl7dmFyIHQsZSxuO3JldHVybih0PXRoaXMuZ2V0TGFzdE5lc3RhYmxlQXR0cmlidXRlKCkpPyhuPXRoaXMuYXR0cmlidXRlcy5sYXN0SW5kZXhPZih0KSxlPXIuYXBwbHkobnVsbCxbdGhpcy5hdHRyaWJ1dGVzLG4rMSwwXS5jb25jYXQodS5jYWxsKGQodCkpKSksdGhpcy5jb3B5V2l0aEF0dHJpYnV0ZXMoZSkpOnRoaXN9LGEucHJvdG90eXBlLmdldExpc3RJdGVtQXR0cmlidXRlcz1mdW5jdGlvbigpe3ZhciB0LGUsbixpLHI7Zm9yKGk9dGhpcy5hdHRyaWJ1dGVzLHI9W10sZT0wLG49aS5sZW5ndGg7bj5lO2UrKyl0PWlbZV0sbyh0KS5saXN0QXR0cmlidXRlJiZyLnB1c2godCk7cmV0dXJuIHJ9LGEucHJvdG90eXBlLmlzTGlzdEl0ZW09ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gbnVsbCE9KHQ9byh0aGlzLmdldExhc3RBdHRyaWJ1dGUoKSkpP3QubGlzdEF0dHJpYnV0ZTp2b2lkIDB9LGEucHJvdG90eXBlLmlzVGVybWluYWxCbG9jaz1mdW5jdGlvbigpe3ZhciB0O3JldHVybiBudWxsIT0odD1vKHRoaXMuZ2V0TGFzdEF0dHJpYnV0ZSgpKSk/dC50ZXJtaW5hbDp2b2lkIDB9LGEucHJvdG90eXBlLmJyZWFrc09uUmV0dXJuPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIG51bGwhPSh0PW8odGhpcy5nZXRMYXN0QXR0cmlidXRlKCkpKT90LmJyZWFrT25SZXR1cm46dm9pZCAwfSxhLnByb3RvdHlwZS5maW5kTGluZUJyZWFrSW5EaXJlY3Rpb25Gcm9tUG9zaXRpb249ZnVuY3Rpb24odCxlKXt2YXIgbixvO3JldHVybiBvPXRoaXMudG9TdHJpbmcoKSxuPWZ1bmN0aW9uKCl7c3dpdGNoKHQpe2Nhc2VcImZvcndhcmRcIjpyZXR1cm4gby5pbmRleE9mKFwiXFxuXCIsZSk7Y2FzZVwiYmFja3dhcmRcIjpyZXR1cm4gby5zbGljZSgwLGUpLmxhc3RJbmRleE9mKFwiXFxuXCIpfX0oKSwtMSE9PW4/bjp2b2lkIDB9LGEucHJvdG90eXBlLmNvbnRlbnRzRm9ySW5zcGVjdGlvbj1mdW5jdGlvbigpe3JldHVybnt0ZXh0OnRoaXMudGV4dC5pbnNwZWN0KCksYXR0cmlidXRlczp0aGlzLmF0dHJpYnV0ZXN9fSxhLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRleHQudG9TdHJpbmcoKX0sYS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJue3RleHQ6dGhpcy50ZXh0LGF0dHJpYnV0ZXM6dGhpcy5hdHRyaWJ1dGVzfX0sYS5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGV4dC5nZXRMZW5ndGgoKX0sYS5wcm90b3R5cGUuY2FuQmVDb25zb2xpZGF0ZWRXaXRoPWZ1bmN0aW9uKHQpe3JldHVybiF0aGlzLmhhc0F0dHJpYnV0ZXMoKSYmIXQuaGFzQXR0cmlidXRlcygpfSxhLnByb3RvdHlwZS5jb25zb2xpZGF0ZVdpdGg9ZnVuY3Rpb24odCl7dmFyIG4sbztyZXR1cm4gbj1lLlRleHQudGV4dEZvclN0cmluZ1dpdGhBdHRyaWJ1dGVzKFwiXFxuXCIpLG89dGhpcy5nZXRUZXh0V2l0aG91dEJsb2NrQnJlYWsoKS5hcHBlbmRUZXh0KG4pLHRoaXMuY29weVdpdGhUZXh0KG8uYXBwZW5kVGV4dCh0LnRleHQpKX0sYS5wcm90b3R5cGUuc3BsaXRBdE9mZnNldD1mdW5jdGlvbih0KXt2YXIgZSxuO3JldHVybiAwPT09dD8oZT1udWxsLG49dGhpcyk6dD09PXRoaXMuZ2V0TGVuZ3RoKCk/KGU9dGhpcyxuPW51bGwpOihlPXRoaXMuY29weVdpdGhUZXh0KHRoaXMudGV4dC5nZXRUZXh0QXRSYW5nZShbMCx0XSkpLG49dGhpcy5jb3B5V2l0aFRleHQodGhpcy50ZXh0LmdldFRleHRBdFJhbmdlKFt0LHRoaXMuZ2V0TGVuZ3RoKCldKSkpLFtlLG5dfSxhLnByb3RvdHlwZS5nZXRCbG9ja0JyZWFrUG9zaXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50ZXh0LmdldExlbmd0aCgpLTF9LGEucHJvdG90eXBlLmdldFRleHRXaXRob3V0QmxvY2tCcmVhaz1mdW5jdGlvbigpe3JldHVybiBtKHRoaXMudGV4dCk/dGhpcy50ZXh0LmdldFRleHRBdFJhbmdlKFswLHRoaXMuZ2V0QmxvY2tCcmVha1Bvc2l0aW9uKCldKTp0aGlzLnRleHQuY29weSgpfSxhLnByb3RvdHlwZS5jYW5CZUdyb3VwZWQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuYXR0cmlidXRlc1t0XX0sYS5wcm90b3R5cGUuY2FuQmVHcm91cGVkV2l0aD1mdW5jdGlvbih0LGUpe3ZhciBuLHIscyxhO3JldHVybiBzPXQuZ2V0QXR0cmlidXRlcygpLHI9c1tlXSxuPXRoaXMuYXR0cmlidXRlc1tlXSxuPT09ciYmIShvKG4pLmdyb3VwPT09ITEmJihhPXNbZSsxXSxjLmNhbGwoaSgpLGEpPDApKX0saD1mdW5jdGlvbih0KXtyZXR1cm4gdD12KHQpLHQ9bCh0KX0sdj1mdW5jdGlvbih0KXt2YXIgbixvLGkscixzLGE7cmV0dXJuIHI9ITEsYT10LmdldFBpZWNlcygpLG89Mjw9YS5sZW5ndGg/dS5jYWxsKGEsMCxuPWEubGVuZ3RoLTEpOihuPTAsW10pLGk9YVtuKytdLG51bGw9PWk/dDoobz1mdW5jdGlvbigpe3ZhciB0LGUsbjtmb3Iobj1bXSx0PTAsZT1vLmxlbmd0aDtlPnQ7dCsrKXM9b1t0XSxzLmlzQmxvY2tCcmVhaygpPyhyPSEwLG4ucHVzaCh5KHMpKSk6bi5wdXNoKHMpO3JldHVybiBufSgpLHI/bmV3IGUuVGV4dCh1LmNhbGwobykuY29uY2F0KFtpXSkpOnQpfSxwPWUuVGV4dC50ZXh0Rm9yU3RyaW5nV2l0aEF0dHJpYnV0ZXMoXCJcXG5cIix7YmxvY2tCcmVhazohMH0pLGw9ZnVuY3Rpb24odCl7cmV0dXJuIG0odCk/dDp0LmFwcGVuZFRleHQocCl9LG09ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4gbj10LmdldExlbmd0aCgpLDA9PT1uPyExOihlPXQuZ2V0VGV4dEF0UmFuZ2UoW24tMSxuXSksZS5pc0Jsb2NrQnJlYWsoKSl9LHk9ZnVuY3Rpb24odCl7cmV0dXJuIHQuY29weVdpdGhvdXRBdHRyaWJ1dGUoXCJibG9ja0JyZWFrXCIpfSxkPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBlPW8odCkubGlzdEF0dHJpYnV0ZSxudWxsIT1lP1tlLHRdOlt0XX0sZj1mdW5jdGlvbih0KXtyZXR1cm4gdC5zbGljZSgtMSlbMF19LGc9ZnVuY3Rpb24odCxlKXt2YXIgbjtyZXR1cm4gbj10Lmxhc3RJbmRleE9mKGUpLC0xPT09bj90OnIodCxuLDEpfSxhfShlLk9iamVjdCl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuLG8saSxyLHMsYSx1LGMsbD1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBvIGluIGUpaC5jYWxsKGUsbykmJih0W29dPWVbb10pO3JldHVybiBuLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbix0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxoPXt9Lmhhc093blByb3BlcnR5LHA9W10uc2xpY2UsZD1bXS5pbmRleE9mfHxmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxuPXRoaXMubGVuZ3RoO24+ZTtlKyspaWYoZSBpbiB0aGlzJiZ0aGlzW2VdPT09dClyZXR1cm4gZTtyZXR1cm4tMX07dD1lLmFycmF5c0FyZUVxdWFsLGE9ZS5ub3JtYWxpemVTcGFjZXMscj1lLm1ha2VFbGVtZW50LHU9ZS50YWdOYW1lLGk9ZS5nZXRCbG9ja1RhZ05hbWVzLGM9ZS53YWxrVHJlZSxvPWUuZmluZENsb3Nlc3RFbGVtZW50RnJvbU5vZGUsbj1lLmVsZW1lbnRDb250YWluc05vZGUscz1lLm5vZGVJc0F0dGFjaG1lbnRFbGVtZW50LGUuSFRNTFBhcnNlcj1mdW5jdGlvbihoKXtmdW5jdGlvbiBmKHQsZSl7dGhpcy5odG1sPXQsdGhpcy5yZWZlcmVuY2VFbGVtZW50PShudWxsIT1lP2U6e30pLnJlZmVyZW5jZUVsZW1lbnQsdGhpcy5ibG9ja3M9W10sdGhpcy5ibG9ja0VsZW1lbnRzPVtdLHRoaXMucHJvY2Vzc2VkRWxlbWVudHM9W119dmFyIGcsbSx5LHYsYixBLEMsdyx4LEUsUyxrLFIsTCxELE87cmV0dXJuIGwoZixoKSxnPVwic3R5bGUgaHJlZiBzcmMgd2lkdGggaGVpZ2h0IGNsYXNzXCIuc3BsaXQoXCIgXCIpLGYucGFyc2U9ZnVuY3Rpb24odCxlKXt2YXIgbjtyZXR1cm4gbj1uZXcgdGhpcyh0LGUpLG4ucGFyc2UoKSxufSxmLnByb3RvdHlwZS5nZXREb2N1bWVudD1mdW5jdGlvbigpe3JldHVybiBlLkRvY3VtZW50LmZyb21KU09OKHRoaXMuYmxvY2tzKX0sZi5wcm90b3R5cGUucGFyc2U9ZnVuY3Rpb24oKXt2YXIgdCxlO3RyeXtmb3IodGhpcy5jcmVhdGVIaWRkZW5Db250YWluZXIoKSx0PVIodGhpcy5odG1sKSx0aGlzLmNvbnRhaW5lckVsZW1lbnQuaW5uZXJIVE1MPXQsZT1jKHRoaXMuY29udGFpbmVyRWxlbWVudCx7dXNpbmdGaWx0ZXI6RX0pO2UubmV4dE5vZGUoKTspdGhpcy5wcm9jZXNzTm9kZShlLmN1cnJlbnROb2RlKTtyZXR1cm4gdGhpcy50cmFuc2xhdGVCbG9ja0VsZW1lbnRNYXJnaW5zVG9OZXdsaW5lcygpfWZpbmFsbHl7dGhpcy5yZW1vdmVIaWRkZW5Db250YWluZXIoKX19LGYucHJvdG90eXBlLmNyZWF0ZUhpZGRlbkNvbnRhaW5lcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlZmVyZW5jZUVsZW1lbnQ/KHRoaXMuY29udGFpbmVyRWxlbWVudD10aGlzLnJlZmVyZW5jZUVsZW1lbnQuY2xvbmVOb2RlKCExKSx0aGlzLmNvbnRhaW5lckVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiaWRcIiksdGhpcy5jb250YWluZXJFbGVtZW50LnNldEF0dHJpYnV0ZShcImRhdGEtdHJpeC1pbnRlcm5hbFwiLFwiXCIpLHRoaXMuY29udGFpbmVyRWxlbWVudC5zdHlsZS5kaXNwbGF5PVwibm9uZVwiLHRoaXMucmVmZXJlbmNlRWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLmNvbnRhaW5lckVsZW1lbnQsdGhpcy5yZWZlcmVuY2VFbGVtZW50Lm5leHRTaWJsaW5nKSk6KHRoaXMuY29udGFpbmVyRWxlbWVudD1yKHt0YWdOYW1lOlwiZGl2XCIsc3R5bGU6e2Rpc3BsYXk6XCJub25lXCJ9fSksZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmNvbnRhaW5lckVsZW1lbnQpKX0sZi5wcm90b3R5cGUucmVtb3ZlSGlkZGVuQ29udGFpbmVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udGFpbmVyRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuY29udGFpbmVyRWxlbWVudCl9LFI9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGkscixzLGEsdSxsLGgsZixtLHksdixBLEM7Zm9yKHQ9dC5yZXBsYWNlKC88XFwvaHRtbFtePl0qPlteXSokL2ksXCI8L2h0bWw+XCIpLG49ZG9jdW1lbnQuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KFwiXCIpLG4uZG9jdW1lbnRFbGVtZW50LmlubmVySFRNTD10LGU9bi5ib2R5LG89bi5oZWFkLHk9by5xdWVyeVNlbGVjdG9yQWxsKFwic3R5bGVcIiksaT0wLGE9eS5sZW5ndGg7YT5pO2krKylBPXlbaV0sZS5hcHBlbmRDaGlsZChBKTtmb3IobT1bXSxDPWMoZSk7Qy5uZXh0Tm9kZSgpOylzd2l0Y2goZj1DLmN1cnJlbnROb2RlLGYubm9kZVR5cGUpe2Nhc2UgTm9kZS5FTEVNRU5UX05PREU6aWYoYihmKSltLnB1c2goZik7ZWxzZSBmb3Iodj1wLmNhbGwoZi5hdHRyaWJ1dGVzKSxyPTAsdT12Lmxlbmd0aDt1PnI7cisrKWg9dltyXS5uYW1lLGQuY2FsbChnLGgpPj0wfHwwPT09aC5pbmRleE9mKFwiZGF0YS10cml4XCIpfHxmLnJlbW92ZUF0dHJpYnV0ZShoKTticmVhaztjYXNlIE5vZGUuQ09NTUVOVF9OT0RFOm0ucHVzaChmKX1mb3Iocz0wLGw9bS5sZW5ndGg7bD5zO3MrKylmPW1bc10sZi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGYpO3JldHVybiBlLmlubmVySFRNTH0sYj1mdW5jdGlvbih0KXtyZXR1cm4obnVsbCE9dD90Lm5vZGVUeXBlOnZvaWQgMCkhPT1Ob2RlLkVMRU1FTlRfTk9ERXx8cyh0KT92b2lkIDA6XCJzY3JpcHRcIj09PXUodCl8fFwiZmFsc2VcIj09PXQuZ2V0QXR0cmlidXRlKFwiZGF0YS10cml4LXNlcmlhbGl6ZVwiKX0sRT1mdW5jdGlvbih0KXtyZXR1cm5cInN0eWxlXCI9PT11KHQpP05vZGVGaWx0ZXIuRklMVEVSX1JFSkVDVDpOb2RlRmlsdGVyLkZJTFRFUl9BQ0NFUFR9LGYucHJvdG90eXBlLnByb2Nlc3NOb2RlPWZ1bmN0aW9uKHQpe3N3aXRjaCh0Lm5vZGVUeXBlKXtjYXNlIE5vZGUuVEVYVF9OT0RFOnJldHVybiB0aGlzLnByb2Nlc3NUZXh0Tm9kZSh0KTtjYXNlIE5vZGUuRUxFTUVOVF9OT0RFOnJldHVybiB0aGlzLmFwcGVuZEJsb2NrRm9yRWxlbWVudCh0KSx0aGlzLnByb2Nlc3NFbGVtZW50KHQpfX0sZi5wcm90b3R5cGUuYXBwZW5kQmxvY2tGb3JFbGVtZW50PWZ1bmN0aW9uKGUpe3ZhciBvLGkscixzO2lmKHI9dGhpcy5pc0Jsb2NrRWxlbWVudChlKSxpPW4odGhpcy5jdXJyZW50QmxvY2tFbGVtZW50LGUpLHImJiF0aGlzLmlzQmxvY2tFbGVtZW50KGUuZmlyc3RDaGlsZCkpe2lmKCEodGhpcy5pc0luc2lnbmlmaWNhbnRUZXh0Tm9kZShlLmZpcnN0Q2hpbGQpJiZ0aGlzLmlzQmxvY2tFbGVtZW50KGUuZmlyc3RFbGVtZW50Q2hpbGQpfHwobz10aGlzLmdldEJsb2NrQXR0cmlidXRlcyhlKSxpJiZ0KG8sdGhpcy5jdXJyZW50QmxvY2suYXR0cmlidXRlcykpKSlyZXR1cm4gdGhpcy5jdXJyZW50QmxvY2s9dGhpcy5hcHBlbmRCbG9ja0ZvckF0dHJpYnV0ZXNXaXRoRWxlbWVudChvLGUpLHRoaXMuY3VycmVudEJsb2NrRWxlbWVudD1lfWVsc2UgaWYodGhpcy5jdXJyZW50QmxvY2tFbGVtZW50JiYhaSYmIXIpcmV0dXJuKHM9dGhpcy5maW5kUGFyZW50QmxvY2tFbGVtZW50KGUpKT90aGlzLmFwcGVuZEJsb2NrRm9yRWxlbWVudChzKToodGhpcy5jdXJyZW50QmxvY2s9dGhpcy5hcHBlbmRFbXB0eUJsb2NrKCksdGhpcy5jdXJyZW50QmxvY2tFbGVtZW50PW51bGwpfSxmLnByb3RvdHlwZS5maW5kUGFyZW50QmxvY2tFbGVtZW50PWZ1bmN0aW9uKHQpe3ZhciBlO2ZvcihlPXQucGFyZW50RWxlbWVudDtlJiZlIT09dGhpcy5jb250YWluZXJFbGVtZW50Oyl7aWYodGhpcy5pc0Jsb2NrRWxlbWVudChlKSYmZC5jYWxsKHRoaXMuYmxvY2tFbGVtZW50cyxlKT49MClyZXR1cm4gZTtlPWUucGFyZW50RWxlbWVudH1yZXR1cm4gbnVsbH0sZi5wcm90b3R5cGUucHJvY2Vzc1RleHROb2RlPWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIHRoaXMuaXNJbnNpZ25pZmljYW50VGV4dE5vZGUodCk/dm9pZCAwOihuPXQuZGF0YSx2KHQucGFyZW50Tm9kZSl8fChuPUwobiksRChudWxsIT0oZT10LnByZXZpb3VzU2libGluZyk/ZS50ZXh0Q29udGVudDp2b2lkIDApJiYobj14KG4pKSksdGhpcy5hcHBlbmRTdHJpbmdXaXRoQXR0cmlidXRlcyhuLHRoaXMuZ2V0VGV4dEF0dHJpYnV0ZXModC5wYXJlbnROb2RlKSkpfSxmLnByb3RvdHlwZS5wcm9jZXNzRWxlbWVudD1mdW5jdGlvbih0KXt2YXIgZSxuLG8saSxyO2lmKHModCkpcmV0dXJuIGU9QSh0KSxPYmplY3Qua2V5cyhlKS5sZW5ndGgmJihpPXRoaXMuZ2V0VGV4dEF0dHJpYnV0ZXModCksdGhpcy5hcHBlbmRBdHRhY2htZW50V2l0aEF0dHJpYnV0ZXMoZSxpKSx0LmlubmVySFRNTD1cIlwiKSx0aGlzLnByb2Nlc3NlZEVsZW1lbnRzLnB1c2godCk7c3dpdGNoKHUodCkpe2Nhc2VcImJyXCI6cmV0dXJuIHRoaXMuaXNFeHRyYUJSKHQpfHx0aGlzLmlzQmxvY2tFbGVtZW50KHQubmV4dFNpYmxpbmcpfHx0aGlzLmFwcGVuZFN0cmluZ1dpdGhBdHRyaWJ1dGVzKFwiXFxuXCIsdGhpcy5nZXRUZXh0QXR0cmlidXRlcyh0KSksdGhpcy5wcm9jZXNzZWRFbGVtZW50cy5wdXNoKHQpO2Nhc2VcImltZ1wiOmU9e3VybDp0LmdldEF0dHJpYnV0ZShcInNyY1wiKSxjb250ZW50VHlwZTpcImltYWdlXCJ9LG89dyh0KTtmb3IobiBpbiBvKXI9b1tuXSxlW25dPXI7cmV0dXJuIHRoaXMuYXBwZW5kQXR0YWNobWVudFdpdGhBdHRyaWJ1dGVzKGUsdGhpcy5nZXRUZXh0QXR0cmlidXRlcyh0KSksdGhpcy5wcm9jZXNzZWRFbGVtZW50cy5wdXNoKHQpO2Nhc2VcInRyXCI6aWYodC5wYXJlbnROb2RlLmZpcnN0Q2hpbGQhPT10KXJldHVybiB0aGlzLmFwcGVuZFN0cmluZ1dpdGhBdHRyaWJ1dGVzKFwiXFxuXCIpO2JyZWFrO2Nhc2VcInRkXCI6aWYodC5wYXJlbnROb2RlLmZpcnN0Q2hpbGQhPT10KXJldHVybiB0aGlzLmFwcGVuZFN0cmluZ1dpdGhBdHRyaWJ1dGVzKFwiIHwgXCIpfX0sZi5wcm90b3R5cGUuYXBwZW5kQmxvY2tGb3JBdHRyaWJ1dGVzV2l0aEVsZW1lbnQ9ZnVuY3Rpb24odCxlKXt2YXIgbjtyZXR1cm4gdGhpcy5ibG9ja0VsZW1lbnRzLnB1c2goZSksbj1tKHQpLHRoaXMuYmxvY2tzLnB1c2gobiksbn0sZi5wcm90b3R5cGUuYXBwZW5kRW1wdHlCbG9jaz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFwcGVuZEJsb2NrRm9yQXR0cmlidXRlc1dpdGhFbGVtZW50KFtdLG51bGwpfSxmLnByb3RvdHlwZS5hcHBlbmRTdHJpbmdXaXRoQXR0cmlidXRlcz1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmFwcGVuZFBpZWNlKGsodCxlKSl9LGYucHJvdG90eXBlLmFwcGVuZEF0dGFjaG1lbnRXaXRoQXR0cmlidXRlcz1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmFwcGVuZFBpZWNlKFModCxlKSl9LGYucHJvdG90eXBlLmFwcGVuZFBpZWNlPWZ1bmN0aW9uKHQpe3JldHVybiAwPT09dGhpcy5ibG9ja3MubGVuZ3RoJiZ0aGlzLmFwcGVuZEVtcHR5QmxvY2soKSx0aGlzLmJsb2Nrc1t0aGlzLmJsb2Nrcy5sZW5ndGgtMV0udGV4dC5wdXNoKHQpfSxmLnByb3RvdHlwZS5hcHBlbmRTdHJpbmdUb1RleHRBdEluZGV4PWZ1bmN0aW9uKHQsZSl7dmFyIG4sbztyZXR1cm4gbz10aGlzLmJsb2Nrc1tlXS50ZXh0LG49b1tvLmxlbmd0aC0xXSxcInN0cmluZ1wiPT09KG51bGwhPW4/bi50eXBlOnZvaWQgMCk/bi5zdHJpbmcrPXQ6by5wdXNoKGsodCkpfSxmLnByb3RvdHlwZS5wcmVwZW5kU3RyaW5nVG9UZXh0QXRJbmRleD1mdW5jdGlvbih0LGUpe3ZhciBuLG87cmV0dXJuIG89dGhpcy5ibG9ja3NbZV0udGV4dCxuPW9bMF0sXCJzdHJpbmdcIj09PShudWxsIT1uP24udHlwZTp2b2lkIDApP24uc3RyaW5nPXQrbi5zdHJpbmc6by51bnNoaWZ0KGsodCkpfSxrPWZ1bmN0aW9uKHQsZSl7dmFyIG47cmV0dXJuIG51bGw9PWUmJihlPXt9KSxuPVwic3RyaW5nXCIsdD1hKHQpLHtzdHJpbmc6dCxhdHRyaWJ1dGVzOmUsdHlwZTpufX0sUz1mdW5jdGlvbih0LGUpe3ZhciBuO3JldHVybiBudWxsPT1lJiYoZT17fSksbj1cImF0dGFjaG1lbnRcIix7YXR0YWNobWVudDp0LGF0dHJpYnV0ZXM6ZSx0eXBlOm59fSxtPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBudWxsPT10JiYodD17fSksZT1bXSx7dGV4dDplLGF0dHJpYnV0ZXM6dH19LGYucHJvdG90eXBlLmdldFRleHRBdHRyaWJ1dGVzPWZ1bmN0aW9uKHQpe3ZhciBuLGkscixhLHUsYyxsLGgscCxkLGYsZyxtO3I9e30sZD1lLmNvbmZpZy50ZXh0QXR0cmlidXRlcztmb3IobiBpbiBkKWlmKHU9ZFtuXSx1LnRhZ05hbWUmJm8odCx7bWF0Y2hpbmdTZWxlY3Rvcjp1LnRhZ05hbWUsdW50aWxOb2RlOnRoaXMuY29udGFpbmVyRWxlbWVudH0pKXJbbl09ITA7ZWxzZSBpZih1LnBhcnNlciYmKG09dS5wYXJzZXIodCkpKXtmb3IoaT0hMSxmPXRoaXMuZmluZEJsb2NrRWxlbWVudEFuY2VzdG9ycyh0KSxjPTAscD1mLmxlbmd0aDtwPmM7YysrKWlmKGE9ZltjXSx1LnBhcnNlcihhKT09PW0pe2k9ITA7YnJlYWt9aXx8KHJbbl09bSl9aWYocyh0KSYmKGw9dC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXRyaXgtYXR0cmlidXRlc1wiKSkpe2c9SlNPTi5wYXJzZShsKTtmb3IoaCBpbiBnKW09Z1toXSxyW2hdPW19cmV0dXJuIHJ9LGYucHJvdG90eXBlLmdldEJsb2NrQXR0cmlidXRlcz1mdW5jdGlvbih0KXt2YXIgbixvLGkscjtmb3Iobz1bXTt0JiZ0IT09dGhpcy5jb250YWluZXJFbGVtZW50Oyl7cj1lLmNvbmZpZy5ibG9ja0F0dHJpYnV0ZXM7Zm9yKG4gaW4gcilpPXJbbl0saS5wYXJzZSE9PSExJiZ1KHQpPT09aS50YWdOYW1lJiYoKFwiZnVuY3Rpb25cIj09dHlwZW9mIGkudGVzdD9pLnRlc3QodCk6dm9pZCAwKXx8IWkudGVzdCkmJihvLnB1c2gobiksaS5saXN0QXR0cmlidXRlJiZvLnB1c2goaS5saXN0QXR0cmlidXRlKSk7dD10LnBhcmVudE5vZGV9cmV0dXJuIG8ucmV2ZXJzZSgpfSxmLnByb3RvdHlwZS5maW5kQmxvY2tFbGVtZW50QW5jZXN0b3JzPWZ1bmN0aW9uKHQpe3ZhciBlLG47Zm9yKGU9W107dCYmdCE9PXRoaXMuY29udGFpbmVyRWxlbWVudDspbj11KHQpLGQuY2FsbChpKCksbik+PTAmJmUucHVzaCh0KSx0PXQucGFyZW50Tm9kZTtyZXR1cm4gZX0sQT1mdW5jdGlvbih0KXtyZXR1cm4gSlNPTi5wYXJzZSh0LmdldEF0dHJpYnV0ZShcImRhdGEtdHJpeC1hdHRhY2htZW50XCIpKX0sdz1mdW5jdGlvbih0KXt2YXIgZSxuLG87cmV0dXJuIG89dC5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKSxuPXQuZ2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIpLGU9e30sbyYmKGUud2lkdGg9cGFyc2VJbnQobywxMCkpLG4mJihlLmhlaWdodD1wYXJzZUludChuLDEwKSksZX0sZi5wcm90b3R5cGUuaXNCbG9ja0VsZW1lbnQ9ZnVuY3Rpb24odCl7dmFyIGU7aWYoKG51bGwhPXQ/dC5ub2RlVHlwZTp2b2lkIDApPT09Tm9kZS5FTEVNRU5UX05PREUmJiFvKHQse21hdGNoaW5nU2VsZWN0b3I6XCJ0ZFwiLHVudGlsTm9kZTp0aGlzLmNvbnRhaW5lckVsZW1lbnR9KSlyZXR1cm4gZT11KHQpLGQuY2FsbChpKCksZSk+PTB8fFwiYmxvY2tcIj09PXdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHQpLmRpc3BsYXl9LGYucHJvdG90eXBlLmlzSW5zaWduaWZpY2FudFRleHROb2RlPWZ1bmN0aW9uKHQpe3JldHVybihudWxsIT10P3Qubm9kZVR5cGU6dm9pZCAwKT09PU5vZGUuVEVYVF9OT0RFJiZPKHQuZGF0YSkmJiF2KHQucGFyZW50Tm9kZSk/IXQucHJldmlvdXNTaWJsaW5nfHx0aGlzLmlzQmxvY2tFbGVtZW50KHQucHJldmlvdXNTaWJsaW5nKXx8IXQubmV4dFNpYmxpbmd8fHRoaXMuaXNCbG9ja0VsZW1lbnQodC5uZXh0U2libGluZyk6dm9pZCAwfSxmLnByb3RvdHlwZS5pc0V4dHJhQlI9ZnVuY3Rpb24odCl7cmV0dXJuXCJiclwiPT09dSh0KSYmdGhpcy5pc0Jsb2NrRWxlbWVudCh0LnBhcmVudE5vZGUpJiZ0LnBhcmVudE5vZGUubGFzdENoaWxkPT09dH0sdj1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gZT13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KS53aGl0ZVNwYWNlLFwicHJlXCI9PT1lfHxcInByZS13cmFwXCI9PT1lfHxcInByZS1saW5lXCI9PT1lfSxmLnByb3RvdHlwZS50cmFuc2xhdGVCbG9ja0VsZW1lbnRNYXJnaW5zVG9OZXdsaW5lcz1mdW5jdGlvbigpe3ZhciB0LGUsbixvLGkscixzLGE7Zm9yKGU9dGhpcy5nZXRNYXJnaW5PZkRlZmF1bHRCbG9ja0VsZW1lbnQoKSxzPXRoaXMuYmxvY2tzLGE9W10sbz1uPTAsaT1zLmxlbmd0aDtpPm47bz0rK24pdD1zW29dLChyPXRoaXMuZ2V0TWFyZ2luT2ZCbG9ja0VsZW1lbnRBdEluZGV4KG8pKSYmKHIudG9wPjIqZS50b3AmJnRoaXMucHJlcGVuZFN0cmluZ1RvVGV4dEF0SW5kZXgoXCJcXG5cIixvKSxhLnB1c2goci5ib3R0b20+MiplLmJvdHRvbT90aGlzLmFwcGVuZFN0cmluZ1RvVGV4dEF0SW5kZXgoXCJcXG5cIixvKTp2b2lkIDApKTtyZXR1cm4gYX0sZi5wcm90b3R5cGUuZ2V0TWFyZ2luT2ZCbG9ja0VsZW1lbnRBdEluZGV4PWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIShlPXRoaXMuYmxvY2tFbGVtZW50c1t0XSl8fChuPXUoZSksZC5jYWxsKGkoKSxuKT49MHx8ZC5jYWxsKHRoaXMucHJvY2Vzc2VkRWxlbWVudHMsZSk+PTApP3ZvaWQgMDpDKGUpfSxmLnByb3RvdHlwZS5nZXRNYXJnaW5PZkRlZmF1bHRCbG9ja0VsZW1lbnQ9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdD1yKGUuY29uZmlnLmJsb2NrQXR0cmlidXRlc1tcImRlZmF1bHRcIl0udGFnTmFtZSksdGhpcy5jb250YWluZXJFbGVtZW50LmFwcGVuZENoaWxkKHQpLEModCl9LEM9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIGU9d2luZG93LmdldENvbXB1dGVkU3R5bGUodCksXCJibG9ja1wiPT09ZS5kaXNwbGF5P3t0b3A6cGFyc2VJbnQoZS5tYXJnaW5Ub3ApLGJvdHRvbTpwYXJzZUludChlLm1hcmdpbkJvdHRvbSl9OnZvaWQgMH0seT1SZWdFeHAoXCJbXlxcXFxTXCIrZS5OT05fQlJFQUtJTkdfU1BBQ0UrXCJdXCIpLEw9ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZShSZWdFeHAoXCJcIit5LnNvdXJjZSxcImdcIiksXCIgXCIpLnJlcGxhY2UoL1xcIHsyLH0vZyxcIiBcIil9LHg9ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZShSZWdFeHAoXCJeXCIreS5zb3VyY2UrXCIrXCIpLFwiXCIpfSxPPWZ1bmN0aW9uKHQpe3JldHVybiBSZWdFeHAoXCJeXCIreS5zb3VyY2UrXCIqJFwiKS50ZXN0KHQpfSxEPWZ1bmN0aW9uKHQpe3JldHVybi9cXHMkLy50ZXN0KHQpfSxmfShlLkJhc2ljT2JqZWN0KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0LG4sbyxpLHI9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBuKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgbyBpbiBlKXMuY2FsbChlLG8pJiYodFtvXT1lW29dKTtyZXR1cm4gbi5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG4sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0scz17fS5oYXNPd25Qcm9wZXJ0eSxhPVtdLnNsaWNlLHU9W10uaW5kZXhPZnx8ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsbj10aGlzLmxlbmd0aDtuPmU7ZSsrKWlmKGUgaW4gdGhpcyYmdGhpc1tlXT09PXQpcmV0dXJuIGU7cmV0dXJuLTF9O3Q9ZS5hcnJheXNBcmVFcXVhbCxvPWUubm9ybWFsaXplUmFuZ2UsaT1lLnJhbmdlSXNDb2xsYXBzZWQsbj1lLmdldEJsb2NrQ29uZmlnLGUuRG9jdW1lbnQ9ZnVuY3Rpb24ocyl7ZnVuY3Rpb24gYyh0KXtudWxsPT10JiYodD1bXSksYy5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcyxhcmd1bWVudHMpLDA9PT10Lmxlbmd0aCYmKHQ9W25ldyBlLkJsb2NrXSksdGhpcy5ibG9ja0xpc3Q9ZS5TcGxpdHRhYmxlTGlzdC5ib3godCl9dmFyIGw7cmV0dXJuIHIoYyxzKSxjLmZyb21KU09OPWZ1bmN0aW9uKHQpe3ZhciBuLG87cmV0dXJuIG89ZnVuY3Rpb24oKXt2YXIgbyxpLHI7Zm9yKHI9W10sbz0wLGk9dC5sZW5ndGg7aT5vO28rKyluPXRbb10sci5wdXNoKGUuQmxvY2suZnJvbUpTT04obikpO3JldHVybiByfSgpLG5ldyB0aGlzKG8pfSxjLmZyb21IVE1MPWZ1bmN0aW9uKHQsbil7cmV0dXJuIGUuSFRNTFBhcnNlci5wYXJzZSh0LG4pLmdldERvY3VtZW50KCl9LGMuZnJvbVN0cmluZz1mdW5jdGlvbih0LG4pe3ZhciBvO3JldHVybiBvPWUuVGV4dC50ZXh0Rm9yU3RyaW5nV2l0aEF0dHJpYnV0ZXModCxuKSxuZXcgdGhpcyhbbmV3IGUuQmxvY2sobyldKX0sYy5wcm90b3R5cGUuaXNFbXB0eT1mdW5jdGlvbigpe3ZhciB0O3JldHVybiAxPT09dGhpcy5ibG9ja0xpc3QubGVuZ3RoJiYodD10aGlzLmdldEJsb2NrQXRJbmRleCgwKSx0LmlzRW1wdHkoKSYmIXQuaGFzQXR0cmlidXRlcygpKX0sYy5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gbnVsbD09dCYmKHQ9e30pLGU9dC5jb25zb2xpZGF0ZUJsb2Nrcz90aGlzLmJsb2NrTGlzdC5jb25zb2xpZGF0ZSgpLnRvQXJyYXkoKTp0aGlzLmJsb2NrTGlzdC50b0FycmF5KCksbmV3IHRoaXMuY29uc3RydWN0b3IoZSl9LGMucHJvdG90eXBlLmNvcHlVc2luZ09iamVjdHNGcm9tRG9jdW1lbnQ9ZnVuY3Rpb24odCl7dmFyIG47cmV0dXJuIG49bmV3IGUuT2JqZWN0TWFwKHQuZ2V0T2JqZWN0cygpKSx0aGlzLmNvcHlVc2luZ09iamVjdE1hcChuKX0sYy5wcm90b3R5cGUuY29weVVzaW5nT2JqZWN0TWFwPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbztyZXR1cm4gbj1mdW5jdGlvbigpe3ZhciBuLGkscixzO2ZvcihyPXRoaXMuZ2V0QmxvY2tzKCkscz1bXSxuPTAsaT1yLmxlbmd0aDtpPm47bisrKWU9cltuXSxzLnB1c2goKG89dC5maW5kKGUpKT9vOmUuY29weVVzaW5nT2JqZWN0TWFwKHQpKTtyZXR1cm4gc30uY2FsbCh0aGlzKSxuZXcgdGhpcy5jb25zdHJ1Y3RvcihuKX0sYy5wcm90b3R5cGUuY29weVdpdGhCYXNlQmxvY2tBdHRyaWJ1dGVzPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbztyZXR1cm4gbnVsbD09dCYmKHQ9W10pLG89ZnVuY3Rpb24oKXt2YXIgbyxpLHIscztmb3Iocj10aGlzLmdldEJsb2NrcygpLHM9W10sbz0wLGk9ci5sZW5ndGg7aT5vO28rKyluPXJbb10sZT10LmNvbmNhdChuLmdldEF0dHJpYnV0ZXMoKSkscy5wdXNoKG4uY29weVdpdGhBdHRyaWJ1dGVzKGUpKTtyZXR1cm4gc30uY2FsbCh0aGlzKSxuZXcgdGhpcy5jb25zdHJ1Y3RvcihvKX0sYy5wcm90b3R5cGUucmVwbGFjZUJsb2NrPWZ1bmN0aW9uKHQsZSl7dmFyIG47cmV0dXJuIG49dGhpcy5ibG9ja0xpc3QuaW5kZXhPZih0KSwtMT09PW4/dGhpczpuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLmJsb2NrTGlzdC5yZXBsYWNlT2JqZWN0QXRJbmRleChlLG4pKX0sYy5wcm90b3R5cGUuaW5zZXJ0RG9jdW1lbnRBdFJhbmdlPWZ1bmN0aW9uKHQsZSl7dmFyIG4scixzLGEsdSxjLGw7cmV0dXJuIHI9dC5ibG9ja0xpc3QsdT0oZT1vKGUpKVswXSxjPXRoaXMubG9jYXRpb25Gcm9tUG9zaXRpb24odSkscz1jLmluZGV4LGE9Yy5vZmZzZXQsbD10aGlzLG49dGhpcy5nZXRCbG9ja0F0UG9zaXRpb24odSksaShlKSYmbi5pc0VtcHR5KCkmJiFuLmhhc0F0dHJpYnV0ZXMoKT9sPW5ldyB0aGlzLmNvbnN0cnVjdG9yKGwuYmxvY2tMaXN0LnJlbW92ZU9iamVjdEF0SW5kZXgocykpOm4uZ2V0QmxvY2tCcmVha1Bvc2l0aW9uKCk9PT1hJiZ1KyssbD1sLnJlbW92ZVRleHRBdFJhbmdlKGUpLG5ldyB0aGlzLmNvbnN0cnVjdG9yKGwuYmxvY2tMaXN0Lmluc2VydFNwbGl0dGFibGVMaXN0QXRQb3NpdGlvbihyLHUpKX0sYy5wcm90b3R5cGUubWVyZ2VEb2N1bWVudEF0UmFuZ2U9ZnVuY3Rpb24oZSxuKXt2YXIgaSxyLHMsYSx1LGMsbCxoLHAsZCxmLGc7cmV0dXJuIGY9KG49byhuKSlbMF0sZD10aGlzLmxvY2F0aW9uRnJvbVBvc2l0aW9uKGYpLHI9dGhpcy5nZXRCbG9ja0F0SW5kZXgoZC5pbmRleCkuZ2V0QXR0cmlidXRlcygpLGk9ZS5nZXRCYXNlQmxvY2tBdHRyaWJ1dGVzKCksZz1yLnNsaWNlKC1pLmxlbmd0aCksdChpLGcpPyhsPXIuc2xpY2UoMCwtaS5sZW5ndGgpLGM9ZS5jb3B5V2l0aEJhc2VCbG9ja0F0dHJpYnV0ZXMobCkpOmM9ZS5jb3B5KHtjb25zb2xpZGF0ZUJsb2NrczohMH0pLmNvcHlXaXRoQmFzZUJsb2NrQXR0cmlidXRlcyhyKSxzPWMuZ2V0QmxvY2tDb3VudCgpLGE9Yy5nZXRCbG9ja0F0SW5kZXgoMCksdChyLGEuZ2V0QXR0cmlidXRlcygpKT8odT1hLmdldFRleHRXaXRob3V0QmxvY2tCcmVhaygpLHA9dGhpcy5pbnNlcnRUZXh0QXRSYW5nZSh1LG4pLHM+MSYmKGM9bmV3IHRoaXMuY29uc3RydWN0b3IoYy5nZXRCbG9ja3MoKS5zbGljZSgxKSksaD1mK3UuZ2V0TGVuZ3RoKCkscD1wLmluc2VydERvY3VtZW50QXRSYW5nZShjLGgpKSk6cD10aGlzLmluc2VydERvY3VtZW50QXRSYW5nZShjLG4pLHB9LGMucHJvdG90eXBlLmluc2VydFRleHRBdFJhbmdlPWZ1bmN0aW9uKHQsZSl7dmFyIG4saSxyLHMsYTtyZXR1cm4gYT0oZT1vKGUpKVswXSxzPXRoaXMubG9jYXRpb25Gcm9tUG9zaXRpb24oYSksaT1zLmluZGV4LHI9cy5vZmZzZXQsbj10aGlzLnJlbW92ZVRleHRBdFJhbmdlKGUpLG5ldyB0aGlzLmNvbnN0cnVjdG9yKG4uYmxvY2tMaXN0LmVkaXRPYmplY3RBdEluZGV4KGksZnVuY3Rpb24oZSl7cmV0dXJuIGUuY29weVdpdGhUZXh0KGUudGV4dC5pbnNlcnRUZXh0QXRQb3NpdGlvbih0LHIpKX0pKX0sYy5wcm90b3R5cGUucmVtb3ZlVGV4dEF0UmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGUsbixyLHMsYSx1LGMsbCxoLHAsZCxmLGcsbSx5LHYsYixBLEMsdyx4O3JldHVybiBwPXQ9byh0KSxsPXBbMF0sQT1wWzFdLGkodCk/dGhpczooZD10aGlzLmxvY2F0aW9uUmFuZ2VGcm9tUmFuZ2UodCksdT1kWzBdLHY9ZFsxXSxhPXUuaW5kZXgsYz11Lm9mZnNldCxzPXRoaXMuZ2V0QmxvY2tBdEluZGV4KGEpLHk9di5pbmRleCxiPXYub2Zmc2V0LG09dGhpcy5nZXRCbG9ja0F0SW5kZXgoeSksZj1BLWw9PT0xJiZzLmdldEJsb2NrQnJlYWtQb3NpdGlvbigpPT09YyYmbS5nZXRCbG9ja0JyZWFrUG9zaXRpb24oKSE9PWImJlwiXFxuXCI9PT1tLnRleHQuZ2V0U3RyaW5nQXRQb3NpdGlvbihiKSxmP3I9dGhpcy5ibG9ja0xpc3QuZWRpdE9iamVjdEF0SW5kZXgoeSxmdW5jdGlvbih0KXtyZXR1cm4gdC5jb3B5V2l0aFRleHQodC50ZXh0LnJlbW92ZVRleHRBdFJhbmdlKFtiLGIrMV0pKVxufSk6KGg9cy50ZXh0LmdldFRleHRBdFJhbmdlKFswLGNdKSxDPW0udGV4dC5nZXRUZXh0QXRSYW5nZShbYixtLmdldExlbmd0aCgpXSksdz1oLmFwcGVuZFRleHQoQyksZz1hIT09eSYmMD09PWMseD1nJiZzLmdldEF0dHJpYnV0ZUxldmVsKCk+PW0uZ2V0QXR0cmlidXRlTGV2ZWwoKSxuPXg/bS5jb3B5V2l0aFRleHQodyk6cy5jb3B5V2l0aFRleHQodyksZT15KzEtYSxyPXRoaXMuYmxvY2tMaXN0LnNwbGljZShhLGUsbikpLG5ldyB0aGlzLmNvbnN0cnVjdG9yKHIpKX0sYy5wcm90b3R5cGUubW92ZVRleHRGcm9tUmFuZ2VUb1Bvc2l0aW9uPWZ1bmN0aW9uKHQsZSl7dmFyIG4saSxyLHMsdSxjLGwsaCxwLGQ7aWYoYz10PW8odCkscD1jWzBdLHI9Y1sxXSxlPj1wJiZyPj1lKXJldHVybiB0aGlzO2lmKGk9dGhpcy5nZXREb2N1bWVudEF0UmFuZ2UodCksaD10aGlzLnJlbW92ZVRleHRBdFJhbmdlKHQpLHU9ZT5wLHUmJihlLT1pLmdldExlbmd0aCgpKSwhaC5maXJzdEJsb2NrSW5SYW5nZUlzRW50aXJlbHlTZWxlY3RlZCh0KSl7aWYobD1pLmdldEJsb2NrcygpLHM9bFswXSxuPTI8PWwubGVuZ3RoP2EuY2FsbChsLDEpOltdLDA9PT1uLmxlbmd0aD8oZD1zLmdldFRleHRXaXRob3V0QmxvY2tCcmVhaygpLHUmJihlKz0xKSk6ZD1zLnRleHQsaD1oLmluc2VydFRleHRBdFJhbmdlKGQsZSksMD09PW4ubGVuZ3RoKXJldHVybiBoO2k9bmV3IHRoaXMuY29uc3RydWN0b3IobiksZSs9ZC5nZXRMZW5ndGgoKX1yZXR1cm4gaC5pbnNlcnREb2N1bWVudEF0UmFuZ2UoaSxlKX0sYy5wcm90b3R5cGUuYWRkQXR0cmlidXRlQXRSYW5nZT1mdW5jdGlvbih0LGUsbyl7dmFyIGk7cmV0dXJuIGk9dGhpcy5ibG9ja0xpc3QsdGhpcy5lYWNoQmxvY2tBdFJhbmdlKG8sZnVuY3Rpb24obyxyLHMpe3JldHVybiBpPWkuZWRpdE9iamVjdEF0SW5kZXgocyxmdW5jdGlvbigpe3JldHVybiBuKHQpP28uYWRkQXR0cmlidXRlKHQsZSk6clswXT09PXJbMV0/bzpvLmNvcHlXaXRoVGV4dChvLnRleHQuYWRkQXR0cmlidXRlQXRSYW5nZSh0LGUscikpfSl9KSxuZXcgdGhpcy5jb25zdHJ1Y3RvcihpKX0sYy5wcm90b3R5cGUuYWRkQXR0cmlidXRlPWZ1bmN0aW9uKHQsZSl7dmFyIG47cmV0dXJuIG49dGhpcy5ibG9ja0xpc3QsdGhpcy5lYWNoQmxvY2soZnVuY3Rpb24obyxpKXtyZXR1cm4gbj1uLmVkaXRPYmplY3RBdEluZGV4KGksZnVuY3Rpb24oKXtyZXR1cm4gby5hZGRBdHRyaWJ1dGUodCxlKX0pfSksbmV3IHRoaXMuY29uc3RydWN0b3Iobil9LGMucHJvdG90eXBlLnJlbW92ZUF0dHJpYnV0ZUF0UmFuZ2U9ZnVuY3Rpb24odCxlKXt2YXIgbztyZXR1cm4gbz10aGlzLmJsb2NrTGlzdCx0aGlzLmVhY2hCbG9ja0F0UmFuZ2UoZSxmdW5jdGlvbihlLGkscil7cmV0dXJuIG4odCk/bz1vLmVkaXRPYmplY3RBdEluZGV4KHIsZnVuY3Rpb24oKXtyZXR1cm4gZS5yZW1vdmVBdHRyaWJ1dGUodCl9KTppWzBdIT09aVsxXT9vPW8uZWRpdE9iamVjdEF0SW5kZXgocixmdW5jdGlvbigpe3JldHVybiBlLmNvcHlXaXRoVGV4dChlLnRleHQucmVtb3ZlQXR0cmlidXRlQXRSYW5nZSh0LGkpKX0pOnZvaWQgMH0pLG5ldyB0aGlzLmNvbnN0cnVjdG9yKG8pfSxjLnByb3RvdHlwZS51cGRhdGVBdHRyaWJ1dGVzRm9yQXR0YWNobWVudD1mdW5jdGlvbih0LGUpe3ZhciBuLG8saSxyO3JldHVybiBpPShvPXRoaXMuZ2V0UmFuZ2VPZkF0dGFjaG1lbnQoZSkpWzBdLG49dGhpcy5sb2NhdGlvbkZyb21Qb3NpdGlvbihpKS5pbmRleCxyPXRoaXMuZ2V0VGV4dEF0SW5kZXgobiksbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5ibG9ja0xpc3QuZWRpdE9iamVjdEF0SW5kZXgobixmdW5jdGlvbihuKXtyZXR1cm4gbi5jb3B5V2l0aFRleHQoci51cGRhdGVBdHRyaWJ1dGVzRm9yQXR0YWNobWVudCh0LGUpKX0pKX0sYy5wcm90b3R5cGUucmVtb3ZlQXR0cmlidXRlRm9yQXR0YWNobWVudD1mdW5jdGlvbih0LGUpe3ZhciBuO3JldHVybiBuPXRoaXMuZ2V0UmFuZ2VPZkF0dGFjaG1lbnQoZSksdGhpcy5yZW1vdmVBdHRyaWJ1dGVBdFJhbmdlKHQsbil9LGMucHJvdG90eXBlLmluc2VydEJsb2NrQnJlYWtBdFJhbmdlPWZ1bmN0aW9uKHQpe3ZhciBuLGkscixzO3JldHVybiBzPSh0PW8odCkpWzBdLHI9dGhpcy5sb2NhdGlvbkZyb21Qb3NpdGlvbihzKS5vZmZzZXQsaT10aGlzLnJlbW92ZVRleHRBdFJhbmdlKHQpLDA9PT1yJiYobj1bbmV3IGUuQmxvY2tdKSxuZXcgdGhpcy5jb25zdHJ1Y3RvcihpLmJsb2NrTGlzdC5pbnNlcnRTcGxpdHRhYmxlTGlzdEF0UG9zaXRpb24obmV3IGUuU3BsaXR0YWJsZUxpc3QobikscykpfSxjLnByb3RvdHlwZS5hcHBseUJsb2NrQXR0cmlidXRlQXRSYW5nZT1mdW5jdGlvbih0LGUsbyl7dmFyIGkscixzLGE7cmV0dXJuIHM9dGhpcy5leHBhbmRSYW5nZVRvTGluZUJyZWFrc0FuZFNwbGl0QmxvY2tzKG8pLHI9cy5kb2N1bWVudCxvPXMucmFuZ2UsaT1uKHQpLGkubGlzdEF0dHJpYnV0ZT8ocj1yLnJlbW92ZUxhc3RMaXN0QXR0cmlidXRlQXRSYW5nZShvLHtleGNlcHRBdHRyaWJ1dGVOYW1lOnR9KSxhPXIuY29udmVydExpbmVCcmVha3NUb0Jsb2NrQnJlYWtzSW5SYW5nZShvKSxyPWEuZG9jdW1lbnQsbz1hLnJhbmdlKTpyPWkudGVybWluYWw/ci5yZW1vdmVMYXN0VGVybWluYWxBdHRyaWJ1dGVBdFJhbmdlKG8pOnIuY29uc29saWRhdGVCbG9ja3NBdFJhbmdlKG8pLHIuYWRkQXR0cmlidXRlQXRSYW5nZSh0LGUsbyl9LGMucHJvdG90eXBlLnJlbW92ZUxhc3RMaXN0QXR0cmlidXRlQXRSYW5nZT1mdW5jdGlvbih0LGUpe3ZhciBvO3JldHVybiBudWxsPT1lJiYoZT17fSksbz10aGlzLmJsb2NrTGlzdCx0aGlzLmVhY2hCbG9ja0F0UmFuZ2UodCxmdW5jdGlvbih0LGkscil7dmFyIHM7aWYoKHM9dC5nZXRMYXN0QXR0cmlidXRlKCkpJiZuKHMpLmxpc3RBdHRyaWJ1dGUmJnMhPT1lLmV4Y2VwdEF0dHJpYnV0ZU5hbWUpcmV0dXJuIG89by5lZGl0T2JqZWN0QXRJbmRleChyLGZ1bmN0aW9uKCl7cmV0dXJuIHQucmVtb3ZlQXR0cmlidXRlKHMpfSl9KSxuZXcgdGhpcy5jb25zdHJ1Y3RvcihvKX0sYy5wcm90b3R5cGUucmVtb3ZlTGFzdFRlcm1pbmFsQXR0cmlidXRlQXRSYW5nZT1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gZT10aGlzLmJsb2NrTGlzdCx0aGlzLmVhY2hCbG9ja0F0UmFuZ2UodCxmdW5jdGlvbih0LG8saSl7dmFyIHI7aWYoKHI9dC5nZXRMYXN0QXR0cmlidXRlKCkpJiZuKHIpLnRlcm1pbmFsKXJldHVybiBlPWUuZWRpdE9iamVjdEF0SW5kZXgoaSxmdW5jdGlvbigpe3JldHVybiB0LnJlbW92ZUF0dHJpYnV0ZShyKX0pfSksbmV3IHRoaXMuY29uc3RydWN0b3IoZSl9LGMucHJvdG90eXBlLmZpcnN0QmxvY2tJblJhbmdlSXNFbnRpcmVseVNlbGVjdGVkPWZ1bmN0aW9uKHQpe3ZhciBlLG4saSxyLHMsYTtyZXR1cm4gcj10PW8odCksYT1yWzBdLGU9clsxXSxuPXRoaXMubG9jYXRpb25Gcm9tUG9zaXRpb24oYSkscz10aGlzLmxvY2F0aW9uRnJvbVBvc2l0aW9uKGUpLDA9PT1uLm9mZnNldCYmbi5pbmRleDxzLmluZGV4PyEwOm4uaW5kZXg9PT1zLmluZGV4PyhpPXRoaXMuZ2V0QmxvY2tBdEluZGV4KG4uaW5kZXgpLmdldExlbmd0aCgpLDA9PT1uLm9mZnNldCYmcy5vZmZzZXQ9PT1pKTohMX0sYy5wcm90b3R5cGUuZXhwYW5kUmFuZ2VUb0xpbmVCcmVha3NBbmRTcGxpdEJsb2Nrcz1mdW5jdGlvbih0KXt2YXIgZSxuLGkscixzLGEsdSxjLGw7cmV0dXJuIGE9dD1vKHQpLGw9YVswXSxyPWFbMV0sYz10aGlzLmxvY2F0aW9uRnJvbVBvc2l0aW9uKGwpLGk9dGhpcy5sb2NhdGlvbkZyb21Qb3NpdGlvbihyKSxlPXRoaXMsdT1lLmdldEJsb2NrQXRJbmRleChjLmluZGV4KSxudWxsIT0oYy5vZmZzZXQ9dS5maW5kTGluZUJyZWFrSW5EaXJlY3Rpb25Gcm9tUG9zaXRpb24oXCJiYWNrd2FyZFwiLGMub2Zmc2V0KSkmJihzPWUucG9zaXRpb25Gcm9tTG9jYXRpb24oYyksZT1lLmluc2VydEJsb2NrQnJlYWtBdFJhbmdlKFtzLHMrMV0pLGkuaW5kZXgrPTEsaS5vZmZzZXQtPWUuZ2V0QmxvY2tBdEluZGV4KGMuaW5kZXgpLmdldExlbmd0aCgpLGMuaW5kZXgrPTEpLGMub2Zmc2V0PTAsMD09PWkub2Zmc2V0JiZpLmluZGV4PmMuaW5kZXg/KGkuaW5kZXgtPTEsaS5vZmZzZXQ9ZS5nZXRCbG9ja0F0SW5kZXgoaS5pbmRleCkuZ2V0QmxvY2tCcmVha1Bvc2l0aW9uKCkpOihuPWUuZ2V0QmxvY2tBdEluZGV4KGkuaW5kZXgpLFwiXFxuXCI9PT1uLnRleHQuZ2V0U3RyaW5nQXRSYW5nZShbaS5vZmZzZXQtMSxpLm9mZnNldF0pP2kub2Zmc2V0LT0xOmkub2Zmc2V0PW4uZmluZExpbmVCcmVha0luRGlyZWN0aW9uRnJvbVBvc2l0aW9uKFwiZm9yd2FyZFwiLGkub2Zmc2V0KSxpLm9mZnNldCE9PW4uZ2V0QmxvY2tCcmVha1Bvc2l0aW9uKCkmJihzPWUucG9zaXRpb25Gcm9tTG9jYXRpb24oaSksZT1lLmluc2VydEJsb2NrQnJlYWtBdFJhbmdlKFtzLHMrMV0pKSksbD1lLnBvc2l0aW9uRnJvbUxvY2F0aW9uKGMpLHI9ZS5wb3NpdGlvbkZyb21Mb2NhdGlvbihpKSx0PW8oW2wscl0pLHtkb2N1bWVudDplLHJhbmdlOnR9fSxjLnByb3RvdHlwZS5jb252ZXJ0TGluZUJyZWFrc1RvQmxvY2tCcmVha3NJblJhbmdlPWZ1bmN0aW9uKHQpe3ZhciBlLG4saTtyZXR1cm4gbj0odD1vKHQpKVswXSxpPXRoaXMuZ2V0U3RyaW5nQXRSYW5nZSh0KS5zbGljZSgwLC0xKSxlPXRoaXMsaS5yZXBsYWNlKC8uKj9cXG4vZyxmdW5jdGlvbih0KXtyZXR1cm4gbis9dC5sZW5ndGgsZT1lLmluc2VydEJsb2NrQnJlYWtBdFJhbmdlKFtuLTEsbl0pfSkse2RvY3VtZW50OmUscmFuZ2U6dH19LGMucHJvdG90eXBlLmNvbnNvbGlkYXRlQmxvY2tzQXRSYW5nZT1mdW5jdGlvbih0KXt2YXIgZSxuLGkscixzO3JldHVybiBpPXQ9byh0KSxzPWlbMF0sbj1pWzFdLHI9dGhpcy5sb2NhdGlvbkZyb21Qb3NpdGlvbihzKS5pbmRleCxlPXRoaXMubG9jYXRpb25Gcm9tUG9zaXRpb24obikuaW5kZXgsbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5ibG9ja0xpc3QuY29uc29saWRhdGVGcm9tSW5kZXhUb0luZGV4KHIsZSkpfSxjLnByb3RvdHlwZS5nZXREb2N1bWVudEF0UmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIHQ9byh0KSxlPXRoaXMuYmxvY2tMaXN0LmdldFNwbGl0dGFibGVMaXN0SW5SYW5nZSh0KS50b0FycmF5KCksbmV3IHRoaXMuY29uc3RydWN0b3IoZSl9LGMucHJvdG90eXBlLmdldFN0cmluZ0F0UmFuZ2U9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ2V0RG9jdW1lbnRBdFJhbmdlKHQpLnRvU3RyaW5nKCl9LGMucHJvdG90eXBlLmdldEJsb2NrQXRJbmRleD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5ibG9ja0xpc3QuZ2V0T2JqZWN0QXRJbmRleCh0KX0sYy5wcm90b3R5cGUuZ2V0QmxvY2tBdFBvc2l0aW9uPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBlPXRoaXMubG9jYXRpb25Gcm9tUG9zaXRpb24odCkuaW5kZXgsdGhpcy5nZXRCbG9ja0F0SW5kZXgoZSl9LGMucHJvdG90eXBlLmdldFRleHRBdEluZGV4PWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBudWxsIT0oZT10aGlzLmdldEJsb2NrQXRJbmRleCh0KSk/ZS50ZXh0OnZvaWQgMH0sYy5wcm90b3R5cGUuZ2V0VGV4dEF0UG9zaXRpb249ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIGU9dGhpcy5sb2NhdGlvbkZyb21Qb3NpdGlvbih0KS5pbmRleCx0aGlzLmdldFRleHRBdEluZGV4KGUpfSxjLnByb3RvdHlwZS5nZXRQaWVjZUF0UG9zaXRpb249ZnVuY3Rpb24odCl7dmFyIGUsbixvO3JldHVybiBvPXRoaXMubG9jYXRpb25Gcm9tUG9zaXRpb24odCksZT1vLmluZGV4LG49by5vZmZzZXQsdGhpcy5nZXRUZXh0QXRJbmRleChlKS5nZXRQaWVjZUF0UG9zaXRpb24obil9LGMucHJvdG90eXBlLmdldENoYXJhY3RlckF0UG9zaXRpb249ZnVuY3Rpb24odCl7dmFyIGUsbixvO3JldHVybiBvPXRoaXMubG9jYXRpb25Gcm9tUG9zaXRpb24odCksZT1vLmluZGV4LG49by5vZmZzZXQsdGhpcy5nZXRUZXh0QXRJbmRleChlKS5nZXRTdHJpbmdBdFJhbmdlKFtuLG4rMV0pfSxjLnByb3RvdHlwZS5nZXRMZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ibG9ja0xpc3QuZ2V0RW5kUG9zaXRpb24oKX0sYy5wcm90b3R5cGUuZ2V0QmxvY2tzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmxvY2tMaXN0LnRvQXJyYXkoKX0sYy5wcm90b3R5cGUuZ2V0QmxvY2tDb3VudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJsb2NrTGlzdC5sZW5ndGh9LGMucHJvdG90eXBlLmdldEVkaXRDb3VudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkaXRDb3VudH0sYy5wcm90b3R5cGUuZWFjaEJsb2NrPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmJsb2NrTGlzdC5lYWNoT2JqZWN0KHQpfSxjLnByb3RvdHlwZS5lYWNoQmxvY2tBdFJhbmdlPWZ1bmN0aW9uKHQsZSl7dmFyIG4saSxyLHMsYSx1LGMsbCxoLHAsZCxmO2lmKHU9dD1vKHQpLGQ9dVswXSxyPXVbMV0scD10aGlzLmxvY2F0aW9uRnJvbVBvc2l0aW9uKGQpLGk9dGhpcy5sb2NhdGlvbkZyb21Qb3NpdGlvbihyKSxwLmluZGV4PT09aS5pbmRleClyZXR1cm4gbj10aGlzLmdldEJsb2NrQXRJbmRleChwLmluZGV4KSxmPVtwLm9mZnNldCxpLm9mZnNldF0sZShuLGYscC5pbmRleCk7Zm9yKGg9W10sYT1zPWM9cC5pbmRleCxsPWkuaW5kZXg7bD49Yz9sPj1zOnM+PWw7YT1sPj1jPysrczotLXMpKG49dGhpcy5nZXRCbG9ja0F0SW5kZXgoYSkpPyhmPWZ1bmN0aW9uKCl7c3dpdGNoKGEpe2Nhc2UgcC5pbmRleDpyZXR1cm5bcC5vZmZzZXQsbi50ZXh0LmdldExlbmd0aCgpXTtjYXNlIGkuaW5kZXg6cmV0dXJuWzAsaS5vZmZzZXRdO2RlZmF1bHQ6cmV0dXJuWzAsbi50ZXh0LmdldExlbmd0aCgpXX19KCksaC5wdXNoKGUobixmLGEpKSk6aC5wdXNoKHZvaWQgMCk7cmV0dXJuIGh9LGMucHJvdG90eXBlLmdldENvbW1vbkF0dHJpYnV0ZXNBdFJhbmdlPWZ1bmN0aW9uKHQpe3ZhciBuLHIscztyZXR1cm4gcj0odD1vKHQpKVswXSxpKHQpP3RoaXMuZ2V0Q29tbW9uQXR0cmlidXRlc0F0UG9zaXRpb24ocik6KHM9W10sbj1bXSx0aGlzLmVhY2hCbG9ja0F0UmFuZ2UodCxmdW5jdGlvbih0LGUpe3JldHVybiBlWzBdIT09ZVsxXT8ocy5wdXNoKHQudGV4dC5nZXRDb21tb25BdHRyaWJ1dGVzQXRSYW5nZShlKSksbi5wdXNoKGwodCkpKTp2b2lkIDB9KSxlLkhhc2guZnJvbUNvbW1vbkF0dHJpYnV0ZXNPZk9iamVjdHMocykubWVyZ2UoZS5IYXNoLmZyb21Db21tb25BdHRyaWJ1dGVzT2ZPYmplY3RzKG4pKS50b09iamVjdCgpKX0sYy5wcm90b3R5cGUuZ2V0Q29tbW9uQXR0cmlidXRlc0F0UG9zaXRpb249ZnVuY3Rpb24odCl7dmFyIG4sbyxpLHIscyxhLGMsaCxwLGQ7aWYocD10aGlzLmxvY2F0aW9uRnJvbVBvc2l0aW9uKHQpLHM9cC5pbmRleCxoPXAub2Zmc2V0LGk9dGhpcy5nZXRCbG9ja0F0SW5kZXgocyksIWkpcmV0dXJue307cj1sKGkpLG49aS50ZXh0LmdldEF0dHJpYnV0ZXNBdFBvc2l0aW9uKGgpLG89aS50ZXh0LmdldEF0dHJpYnV0ZXNBdFBvc2l0aW9uKGgtMSksYT1mdW5jdGlvbigpe3ZhciB0LG47dD1lLmNvbmZpZy50ZXh0QXR0cmlidXRlcyxuPVtdO2ZvcihjIGluIHQpZD10W2NdLGQuaW5oZXJpdGFibGUmJm4ucHVzaChjKTtyZXR1cm4gbn0oKTtmb3IoYyBpbiBvKWQ9b1tjXSwoZD09PW5bY118fHUuY2FsbChhLGMpPj0wKSYmKHJbY109ZCk7cmV0dXJuIHJ9LGMucHJvdG90eXBlLmdldFJhbmdlT2ZDb21tb25BdHRyaWJ1dGVBdFBvc2l0aW9uPWZ1bmN0aW9uKHQsZSl7dmFyIG4saSxyLHMsYSx1LGMsbCxoO3JldHVybiBhPXRoaXMubG9jYXRpb25Gcm9tUG9zaXRpb24oZSkscj1hLmluZGV4LHM9YS5vZmZzZXQsaD10aGlzLmdldFRleHRBdEluZGV4KHIpLHU9aC5nZXRFeHBhbmRlZFJhbmdlRm9yQXR0cmlidXRlQXRPZmZzZXQodCxzKSxsPXVbMF0saT11WzFdLGM9dGhpcy5wb3NpdGlvbkZyb21Mb2NhdGlvbih7aW5kZXg6cixvZmZzZXQ6bH0pLG49dGhpcy5wb3NpdGlvbkZyb21Mb2NhdGlvbih7aW5kZXg6cixvZmZzZXQ6aX0pLG8oW2Msbl0pfSxjLnByb3RvdHlwZS5nZXRCYXNlQmxvY2tBdHRyaWJ1dGVzPWZ1bmN0aW9uKCl7dmFyIHQsZSxuLG8saSxyLHM7Zm9yKHQ9dGhpcy5nZXRCbG9ja0F0SW5kZXgoMCkuZ2V0QXR0cmlidXRlcygpLG49bz0xLHM9dGhpcy5nZXRCbG9ja0NvdW50KCk7cz49MT9zPm86bz5zO249cz49MT8rK286LS1vKWU9dGhpcy5nZXRCbG9ja0F0SW5kZXgobikuZ2V0QXR0cmlidXRlcygpLHI9TWF0aC5taW4odC5sZW5ndGgsZS5sZW5ndGgpLHQ9ZnVuY3Rpb24oKXt2YXIgbixvLHM7Zm9yKHM9W10saT1uPTAsbz1yOyhvPj0wP28+bjpuPm8pJiZlW2ldPT09dFtpXTtpPW8+PTA/KytuOi0tbilzLnB1c2goZVtpXSk7cmV0dXJuIHN9KCk7cmV0dXJuIHR9LGw9ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4gbj17fSwoZT10LmdldExhc3RBdHRyaWJ1dGUoKSkmJihuW2VdPSEwKSxufSxjLnByb3RvdHlwZS5nZXRBdHRhY2htZW50QnlJZD1mdW5jdGlvbih0KXt2YXIgZSxuLG8saTtmb3IoaT10aGlzLmdldEF0dGFjaG1lbnRzKCksbj0wLG89aS5sZW5ndGg7bz5uO24rKylpZihlPWlbbl0sZS5pZD09PXQpcmV0dXJuIGV9LGMucHJvdG90eXBlLmdldEF0dGFjaG1lbnRQaWVjZXM9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdD1bXSx0aGlzLmJsb2NrTGlzdC5lYWNoT2JqZWN0KGZ1bmN0aW9uKGUpe3ZhciBuO3JldHVybiBuPWUudGV4dCx0PXQuY29uY2F0KG4uZ2V0QXR0YWNobWVudFBpZWNlcygpKX0pLHR9LGMucHJvdG90eXBlLmdldEF0dGFjaG1lbnRzPWZ1bmN0aW9uKCl7dmFyIHQsZSxuLG8saTtmb3Iobz10aGlzLmdldEF0dGFjaG1lbnRQaWVjZXMoKSxpPVtdLHQ9MCxlPW8ubGVuZ3RoO2U+dDt0Kyspbj1vW3RdLGkucHVzaChuLmF0dGFjaG1lbnQpO3JldHVybiBpfSxjLnByb3RvdHlwZS5nZXRSYW5nZU9mQXR0YWNobWVudD1mdW5jdGlvbih0KXt2YXIgZSxuLGkscixzLGEsdTtmb3Iocj0wLHM9dGhpcy5ibG9ja0xpc3QudG9BcnJheSgpLG49ZT0wLGk9cy5sZW5ndGg7aT5lO249KytlKXtpZihhPXNbbl0udGV4dCx1PWEuZ2V0UmFuZ2VPZkF0dGFjaG1lbnQodCkpcmV0dXJuIG8oW3IrdVswXSxyK3VbMV1dKTtyKz1hLmdldExlbmd0aCgpfX0sYy5wcm90b3R5cGUuZ2V0TG9jYXRpb25SYW5nZU9mQXR0YWNobWVudD1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gZT10aGlzLmdldFJhbmdlT2ZBdHRhY2htZW50KHQpLHRoaXMubG9jYXRpb25SYW5nZUZyb21SYW5nZShlKX0sYy5wcm90b3R5cGUuZ2V0QXR0YWNobWVudFBpZWNlRm9yQXR0YWNobWVudD1mdW5jdGlvbih0KXt2YXIgZSxuLG8saTtmb3IoaT10aGlzLmdldEF0dGFjaG1lbnRQaWVjZXMoKSxlPTAsbj1pLmxlbmd0aDtuPmU7ZSsrKWlmKG89aVtlXSxvLmF0dGFjaG1lbnQ9PT10KXJldHVybiBvfSxjLnByb3RvdHlwZS5sb2NhdGlvbkZyb21Qb3NpdGlvbj1mdW5jdGlvbih0KXt2YXIgZSxuO3JldHVybiBuPXRoaXMuYmxvY2tMaXN0LmZpbmRJbmRleEFuZE9mZnNldEF0UG9zaXRpb24oTWF0aC5tYXgoMCx0KSksbnVsbCE9bi5pbmRleD9uOihlPXRoaXMuZ2V0QmxvY2tzKCkse2luZGV4OmUubGVuZ3RoLTEsb2Zmc2V0OmVbZS5sZW5ndGgtMV0uZ2V0TGVuZ3RoKCl9KX0sYy5wcm90b3R5cGUucG9zaXRpb25Gcm9tTG9jYXRpb249ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuYmxvY2tMaXN0LmZpbmRQb3NpdGlvbkF0SW5kZXhBbmRPZmZzZXQodC5pbmRleCx0Lm9mZnNldCl9LGMucHJvdG90eXBlLmxvY2F0aW9uUmFuZ2VGcm9tUG9zaXRpb249ZnVuY3Rpb24odCl7cmV0dXJuIG8odGhpcy5sb2NhdGlvbkZyb21Qb3NpdGlvbih0KSl9LGMucHJvdG90eXBlLmxvY2F0aW9uUmFuZ2VGcm9tUmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGUsbixpLHI7aWYodD1vKHQpKXJldHVybiByPXRbMF0sbj10WzFdLGk9dGhpcy5sb2NhdGlvbkZyb21Qb3NpdGlvbihyKSxlPXRoaXMubG9jYXRpb25Gcm9tUG9zaXRpb24obiksbyhbaSxlXSl9LGMucHJvdG90eXBlLnJhbmdlRnJvbUxvY2F0aW9uUmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4gdD1vKHQpLGU9dGhpcy5wb3NpdGlvbkZyb21Mb2NhdGlvbih0WzBdKSxpKHQpfHwobj10aGlzLnBvc2l0aW9uRnJvbUxvY2F0aW9uKHRbMV0pKSxvKFtlLG5dKX0sYy5wcm90b3R5cGUuaXNFcXVhbFRvPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmJsb2NrTGlzdC5pc0VxdWFsVG8obnVsbCE9dD90LmJsb2NrTGlzdDp2b2lkIDApfSxjLnByb3RvdHlwZS5nZXRUZXh0cz1mdW5jdGlvbigpe3ZhciB0LGUsbixvLGk7Zm9yKG89dGhpcy5nZXRCbG9ja3MoKSxpPVtdLGU9MCxuPW8ubGVuZ3RoO24+ZTtlKyspdD1vW2VdLGkucHVzaCh0LnRleHQpO3JldHVybiBpfSxjLnByb3RvdHlwZS5nZXRQaWVjZXM9ZnVuY3Rpb24oKXt2YXIgdCxlLG4sbyxpO2ZvcihuPVtdLG89dGhpcy5nZXRUZXh0cygpLHQ9MCxlPW8ubGVuZ3RoO2U+dDt0KyspaT1vW3RdLG4ucHVzaC5hcHBseShuLGkuZ2V0UGllY2VzKCkpO3JldHVybiBufSxjLnByb3RvdHlwZS5nZXRPYmplY3RzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0QmxvY2tzKCkuY29uY2F0KHRoaXMuZ2V0VGV4dHMoKSkuY29uY2F0KHRoaXMuZ2V0UGllY2VzKCkpfSxjLnByb3RvdHlwZS50b1NlcmlhbGl6YWJsZURvY3VtZW50PWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHQ9W10sdGhpcy5ibG9ja0xpc3QuZWFjaE9iamVjdChmdW5jdGlvbihlKXtyZXR1cm4gdC5wdXNoKGUuY29weVdpdGhUZXh0KGUudGV4dC50b1NlcmlhbGl6YWJsZVRleHQoKSkpfSksbmV3IHRoaXMuY29uc3RydWN0b3IodCl9LGMucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmxvY2tMaXN0LnRvU3RyaW5nKCl9LGMucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJsb2NrTGlzdC50b0pTT04oKX0sYy5wcm90b3R5cGUudG9Db25zb2xlPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIEpTT04uc3RyaW5naWZ5KGZ1bmN0aW9uKCl7dmFyIGUsbixvLGk7Zm9yKG89dGhpcy5ibG9ja0xpc3QudG9BcnJheSgpLGk9W10sZT0wLG49by5sZW5ndGg7bj5lO2UrKyl0PW9bZV0saS5wdXNoKEpTT04ucGFyc2UodC50ZXh0LnRvQ29uc29sZSgpKSk7cmV0dXJuIGl9LmNhbGwodGhpcykpfSxjfShlLk9iamVjdCl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXtlLkxpbmVCcmVha0luc2VydGlvbj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dmFyIGU7dGhpcy5jb21wb3NpdGlvbj10LHRoaXMuZG9jdW1lbnQ9dGhpcy5jb21wb3NpdGlvbi5kb2N1bWVudCxlPXRoaXMuY29tcG9zaXRpb24uZ2V0U2VsZWN0ZWRSYW5nZSgpLHRoaXMuc3RhcnRQb3NpdGlvbj1lWzBdLHRoaXMuZW5kUG9zaXRpb249ZVsxXSx0aGlzLnN0YXJ0TG9jYXRpb249dGhpcy5kb2N1bWVudC5sb2NhdGlvbkZyb21Qb3NpdGlvbih0aGlzLnN0YXJ0UG9zaXRpb24pLHRoaXMuZW5kTG9jYXRpb249dGhpcy5kb2N1bWVudC5sb2NhdGlvbkZyb21Qb3NpdGlvbih0aGlzLmVuZFBvc2l0aW9uKSx0aGlzLmJsb2NrPXRoaXMuZG9jdW1lbnQuZ2V0QmxvY2tBdEluZGV4KHRoaXMuZW5kTG9jYXRpb24uaW5kZXgpLHRoaXMuYnJlYWtzT25SZXR1cm49dGhpcy5ibG9jay5icmVha3NPblJldHVybigpLHRoaXMucHJldmlvdXNDaGFyYWN0ZXI9dGhpcy5ibG9jay50ZXh0LmdldFN0cmluZ0F0UG9zaXRpb24odGhpcy5lbmRMb2NhdGlvbi5vZmZzZXQtMSksdGhpcy5uZXh0Q2hhcmFjdGVyPXRoaXMuYmxvY2sudGV4dC5nZXRTdHJpbmdBdFBvc2l0aW9uKHRoaXMuZW5kTG9jYXRpb24ub2Zmc2V0KX1yZXR1cm4gdC5wcm90b3R5cGUuc2hvdWxkSW5zZXJ0QmxvY2tCcmVhaz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJsb2NrLmhhc0F0dHJpYnV0ZXMoKSYmdGhpcy5ibG9jay5pc0xpc3RJdGVtKCkmJiF0aGlzLmJsb2NrLmlzRW1wdHkoKT8wIT09dGhpcy5zdGFydExvY2F0aW9uLm9mZnNldDp0aGlzLmJyZWFrc09uUmV0dXJuJiZcIlxcblwiIT09dGhpcy5uZXh0Q2hhcmFjdGVyfSx0LnByb3RvdHlwZS5zaG91bGRCcmVha0Zvcm1hdHRlZEJsb2NrPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmxvY2suaGFzQXR0cmlidXRlcygpJiYhdGhpcy5ibG9jay5pc0xpc3RJdGVtKCkmJih0aGlzLmJyZWFrc09uUmV0dXJuJiZcIlxcblwiPT09dGhpcy5uZXh0Q2hhcmFjdGVyfHxcIlxcblwiPT09dGhpcy5wcmV2aW91c0NoYXJhY3Rlcil9LHQucHJvdG90eXBlLnNob3VsZERlY3JlYXNlTGlzdExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmxvY2suaGFzQXR0cmlidXRlcygpJiZ0aGlzLmJsb2NrLmlzTGlzdEl0ZW0oKSYmdGhpcy5ibG9jay5pc0VtcHR5KCl9LHQucHJvdG90eXBlLnNob3VsZFByZXBlbmRMaXN0SXRlbT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJsb2NrLmlzTGlzdEl0ZW0oKSYmMD09PXRoaXMuc3RhcnRMb2NhdGlvbi5vZmZzZXQmJiF0aGlzLmJsb2NrLmlzRW1wdHkoKX0sdC5wcm90b3R5cGUuc2hvdWxkUmVtb3ZlTGFzdEJsb2NrQXR0cmlidXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYmxvY2suaGFzQXR0cmlidXRlcygpJiYhdGhpcy5ibG9jay5pc0xpc3RJdGVtKCkmJnRoaXMuYmxvY2suaXNFbXB0eSgpfSx0fSgpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQsbixvLGkscixzLGEsdSxjLGwsaD1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBvIGluIGUpcC5jYWxsKGUsbykmJih0W29dPWVbb10pO3JldHVybiBuLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbix0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxwPXt9Lmhhc093blByb3BlcnR5O3M9ZS5ub3JtYWxpemVSYW5nZSxjPWUucmFuZ2VzQXJlRXF1YWwsdT1lLnJhbmdlSXNDb2xsYXBzZWQsYT1lLm9iamVjdHNBcmVFcXVhbCx0PWUuYXJyYXlTdGFydHNXaXRoLGw9ZS5zdW1tYXJpemVBcnJheUNoYW5nZSxvPWUuZ2V0QWxsQXR0cmlidXRlTmFtZXMsaT1lLmdldEJsb2NrQ29uZmlnLHI9ZS5nZXRUZXh0Q29uZmlnLG49ZS5leHRlbmQsZS5Db21wb3NpdGlvbj1mdW5jdGlvbihwKXtmdW5jdGlvbiBkKCl7dGhpcy5kb2N1bWVudD1uZXcgZS5Eb2N1bWVudCx0aGlzLmF0dGFjaG1lbnRzPVtdLHRoaXMuY3VycmVudEF0dHJpYnV0ZXM9e30sdGhpcy5yZXZpc2lvbj0wfXZhciBmO3JldHVybiBoKGQscCksZC5wcm90b3R5cGUuc2V0RG9jdW1lbnQ9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIHQuaXNFcXVhbFRvKHRoaXMuZG9jdW1lbnQpP3ZvaWQgMDoodGhpcy5kb2N1bWVudD10LHRoaXMucmVmcmVzaEF0dGFjaG1lbnRzKCksdGhpcy5yZXZpc2lvbisrLG51bGwhPShlPXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBlLmNvbXBvc2l0aW9uRGlkQ2hhbmdlRG9jdW1lbnQ/ZS5jb21wb3NpdGlvbkRpZENoYW5nZURvY3VtZW50KHQpOnZvaWQgMCl9LGQucHJvdG90eXBlLmdldFNuYXBzaG90PWZ1bmN0aW9uKCl7cmV0dXJue2RvY3VtZW50OnRoaXMuZG9jdW1lbnQsc2VsZWN0ZWRSYW5nZTp0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKX19LGQucHJvdG90eXBlLmxvYWRTbmFwc2hvdD1mdW5jdGlvbih0KXt2YXIgbixvLGkscjtyZXR1cm4gbj10LmRvY3VtZW50LHI9dC5zZWxlY3RlZFJhbmdlLG51bGwhPShvPXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBvLmNvbXBvc2l0aW9uV2lsbExvYWRTbmFwc2hvdCYmby5jb21wb3NpdGlvbldpbGxMb2FkU25hcHNob3QoKSx0aGlzLnNldERvY3VtZW50KG51bGwhPW4/bjpuZXcgZS5Eb2N1bWVudCksdGhpcy5zZXRTZWxlY3Rpb24obnVsbCE9cj9yOlswLDBdKSxudWxsIT0oaT10aGlzLmRlbGVnYXRlKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgaS5jb21wb3NpdGlvbkRpZExvYWRTbmFwc2hvdD9pLmNvbXBvc2l0aW9uRGlkTG9hZFNuYXBzaG90KCk6dm9pZCAwfSxkLnByb3RvdHlwZS5pbnNlcnRUZXh0PWZ1bmN0aW9uKHQsZSl7dmFyIG4sbyxpLHI7cmV0dXJuIHI9KG51bGwhPWU/ZTp7dXBkYXRlUG9zaXRpb246ITB9KS51cGRhdGVQb3NpdGlvbixvPXRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpLHRoaXMuc2V0RG9jdW1lbnQodGhpcy5kb2N1bWVudC5pbnNlcnRUZXh0QXRSYW5nZSh0LG8pKSxpPW9bMF0sbj1pK3QuZ2V0TGVuZ3RoKCksciYmdGhpcy5zZXRTZWxlY3Rpb24obiksdGhpcy5ub3RpZnlEZWxlZ2F0ZU9mSW5zZXJ0aW9uQXRSYW5nZShbaSxuXSl9LGQucHJvdG90eXBlLmluc2VydEJsb2NrPWZ1bmN0aW9uKHQpe3ZhciBuO3JldHVybiBudWxsPT10JiYodD1uZXcgZS5CbG9jayksbj1uZXcgZS5Eb2N1bWVudChbdF0pLHRoaXMuaW5zZXJ0RG9jdW1lbnQobil9LGQucHJvdG90eXBlLmluc2VydERvY3VtZW50PWZ1bmN0aW9uKHQpe3ZhciBuLG8saTtyZXR1cm4gbnVsbD09dCYmKHQ9bmV3IGUuRG9jdW1lbnQpLG89dGhpcy5nZXRTZWxlY3RlZFJhbmdlKCksdGhpcy5zZXREb2N1bWVudCh0aGlzLmRvY3VtZW50Lmluc2VydERvY3VtZW50QXRSYW5nZSh0LG8pKSxpPW9bMF0sbj1pK3QuZ2V0TGVuZ3RoKCksdGhpcy5zZXRTZWxlY3Rpb24obiksdGhpcy5ub3RpZnlEZWxlZ2F0ZU9mSW5zZXJ0aW9uQXRSYW5nZShbaSxuXSl9LGQucHJvdG90eXBlLmluc2VydFN0cmluZz1mdW5jdGlvbih0LG4pe3ZhciBvLGk7cmV0dXJuIG89dGhpcy5nZXRDdXJyZW50VGV4dEF0dHJpYnV0ZXMoKSxpPWUuVGV4dC50ZXh0Rm9yU3RyaW5nV2l0aEF0dHJpYnV0ZXModCxvKSx0aGlzLmluc2VydFRleHQoaSxuKX0sZC5wcm90b3R5cGUuaW5zZXJ0QmxvY2tCcmVhaz1mdW5jdGlvbigpe3ZhciB0LGUsbjtyZXR1cm4gZT10aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSx0aGlzLnNldERvY3VtZW50KHRoaXMuZG9jdW1lbnQuaW5zZXJ0QmxvY2tCcmVha0F0UmFuZ2UoZSkpLG49ZVswXSx0PW4rMSx0aGlzLnNldFNlbGVjdGlvbih0KSx0aGlzLm5vdGlmeURlbGVnYXRlT2ZJbnNlcnRpb25BdFJhbmdlKFtuLHRdKX0sZC5wcm90b3R5cGUuaW5zZXJ0TGluZUJyZWFrPWZ1bmN0aW9uKCl7dmFyIHQsbjtyZXR1cm4gbj1uZXcgZS5MaW5lQnJlYWtJbnNlcnRpb24odGhpcyksbi5zaG91bGREZWNyZWFzZUxpc3RMZXZlbCgpPyh0aGlzLmRlY3JlYXNlTGlzdExldmVsKCksdGhpcy5zZXRTZWxlY3Rpb24obi5zdGFydFBvc2l0aW9uKSk6bi5zaG91bGRQcmVwZW5kTGlzdEl0ZW0oKT8odD1uZXcgZS5Eb2N1bWVudChbbi5ibG9jay5jb3B5V2l0aG91dFRleHQoKV0pLHRoaXMuaW5zZXJ0RG9jdW1lbnQodCkpOm4uc2hvdWxkSW5zZXJ0QmxvY2tCcmVhaygpP3RoaXMuaW5zZXJ0QmxvY2tCcmVhaygpOm4uc2hvdWxkUmVtb3ZlTGFzdEJsb2NrQXR0cmlidXRlKCk/dGhpcy5yZW1vdmVMYXN0QmxvY2tBdHRyaWJ1dGUoKTpuLnNob3VsZEJyZWFrRm9ybWF0dGVkQmxvY2soKT90aGlzLmJyZWFrRm9ybWF0dGVkQmxvY2sobik6dGhpcy5pbnNlcnRTdHJpbmcoXCJcXG5cIil9LGQucHJvdG90eXBlLmluc2VydEhUTUw9ZnVuY3Rpb24odCl7dmFyIG4sbyxpLHIscztyZXR1cm4gcz10aGlzLmdldFBvc2l0aW9uKCkscj10aGlzLmRvY3VtZW50LmdldExlbmd0aCgpLG49ZS5Eb2N1bWVudC5mcm9tSFRNTCh0KSx0aGlzLnNldERvY3VtZW50KHRoaXMuZG9jdW1lbnQubWVyZ2VEb2N1bWVudEF0UmFuZ2Uobix0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSkpLG89dGhpcy5kb2N1bWVudC5nZXRMZW5ndGgoKSxpPXMrKG8tciksdGhpcy5zZXRTZWxlY3Rpb24oaSksdGhpcy5ub3RpZnlEZWxlZ2F0ZU9mSW5zZXJ0aW9uQXRSYW5nZShbaSxpXSl9LGQucHJvdG90eXBlLnJlcGxhY2VIVE1MPWZ1bmN0aW9uKHQpe3ZhciBuLG8saTtyZXR1cm4gbj1lLkRvY3VtZW50LmZyb21IVE1MKHQpLmNvcHlVc2luZ09iamVjdHNGcm9tRG9jdW1lbnQodGhpcy5kb2N1bWVudCksbz10aGlzLmdldExvY2F0aW9uUmFuZ2Uoe3N0cmljdDohMX0pLGk9dGhpcy5kb2N1bWVudC5yYW5nZUZyb21Mb2NhdGlvblJhbmdlKG8pLHRoaXMuc2V0RG9jdW1lbnQobiksdGhpcy5zZXRTZWxlY3Rpb24oaSl9LGQucHJvdG90eXBlLmluc2VydEZpbGU9ZnVuY3Rpb24odCl7dmFyIG4sbztyZXR1cm4obnVsbCE9KG89dGhpcy5kZWxlZ2F0ZSk/by5jb21wb3NpdGlvblNob3VsZEFjY2VwdEZpbGUodCk6dm9pZCAwKT8obj1lLkF0dGFjaG1lbnQuYXR0YWNobWVudEZvckZpbGUodCksdGhpcy5pbnNlcnRBdHRhY2htZW50KG4pKTp2b2lkIDB9LGQucHJvdG90eXBlLmluc2VydEZpbGVzPWZ1bmN0aW9uKHQpe3ZhciBuLG8saSxyLHMsYSx1O2Zvcih1PW5ldyBlLlRleHQscj0wLHM9dC5sZW5ndGg7cz5yO3IrKylpPXRbcl0sKG51bGwhPShhPXRoaXMuZGVsZWdhdGUpP2EuY29tcG9zaXRpb25TaG91bGRBY2NlcHRGaWxlKGkpOnZvaWQgMCkmJihuPWUuQXR0YWNobWVudC5hdHRhY2htZW50Rm9yRmlsZShpKSxvPWUuVGV4dC50ZXh0Rm9yQXR0YWNobWVudFdpdGhBdHRyaWJ1dGVzKG4sdGhpcy5jdXJyZW50QXR0cmlidXRlcyksdT11LmFwcGVuZFRleHQobykpO3JldHVybiB0aGlzLmluc2VydFRleHQodSl9LGQucHJvdG90eXBlLmluc2VydEF0dGFjaG1lbnQ9ZnVuY3Rpb24odCl7dmFyIG47cmV0dXJuIG49ZS5UZXh0LnRleHRGb3JBdHRhY2htZW50V2l0aEF0dHJpYnV0ZXModCx0aGlzLmN1cnJlbnRBdHRyaWJ1dGVzKSx0aGlzLmluc2VydFRleHQobil9LGQucHJvdG90eXBlLmRlbGV0ZUluRGlyZWN0aW9uPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbyxpLHIscyxhO3JldHVybiBpPXRoaXMuZ2V0TG9jYXRpb25SYW5nZSgpLHI9dGhpcy5nZXRTZWxlY3RlZFJhbmdlKCkscz11KHIpLHM/bz1cImJhY2t3YXJkXCI9PT10JiYwPT09aVswXS5vZmZzZXQ6YT1pWzBdLmluZGV4IT09aVsxXS5pbmRleCxvJiZ0aGlzLmNhbkRlY3JlYXNlQmxvY2tBdHRyaWJ1dGVMZXZlbCgpJiYobj10aGlzLmdldEJsb2NrKCksbi5pc0xpc3RJdGVtKCk/dGhpcy5kZWNyZWFzZUxpc3RMZXZlbCgpOnRoaXMuZGVjcmVhc2VCbG9ja0F0dHJpYnV0ZUxldmVsKCksdGhpcy5zZXRTZWxlY3Rpb24oclswXSksbi5pc0VtcHR5KCkpPyExOihzJiYocj10aGlzLmdldEV4cGFuZGVkUmFuZ2VJbkRpcmVjdGlvbih0KSxcImJhY2t3YXJkXCI9PT10JiYoZT10aGlzLmdldEF0dGFjaG1lbnRBdFJhbmdlKHIpKSksZT8odGhpcy5lZGl0QXR0YWNobWVudChlKSwhMSk6KHRoaXMuc2V0RG9jdW1lbnQodGhpcy5kb2N1bWVudC5yZW1vdmVUZXh0QXRSYW5nZShyKSksdGhpcy5zZXRTZWxlY3Rpb24oclswXSksb3x8YT8hMTp2b2lkIDApKX0sZC5wcm90b3R5cGUubW92ZVRleHRGcm9tUmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIGU9dGhpcy5nZXRTZWxlY3RlZFJhbmdlKClbMF0sdGhpcy5zZXREb2N1bWVudCh0aGlzLmRvY3VtZW50Lm1vdmVUZXh0RnJvbVJhbmdlVG9Qb3NpdGlvbih0LGUpKSx0aGlzLnNldFNlbGVjdGlvbihlKX0sZC5wcm90b3R5cGUucmVtb3ZlQXR0YWNobWVudD1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4oZT10aGlzLmRvY3VtZW50LmdldFJhbmdlT2ZBdHRhY2htZW50KHQpKT8odGhpcy5zdG9wRWRpdGluZ0F0dGFjaG1lbnQoKSx0aGlzLnNldERvY3VtZW50KHRoaXMuZG9jdW1lbnQucmVtb3ZlVGV4dEF0UmFuZ2UoZSkpLHRoaXMuc2V0U2VsZWN0aW9uKGVbMF0pKTp2b2lkIDB9LGQucHJvdG90eXBlLnJlbW92ZUxhc3RCbG9ja0F0dHJpYnV0ZT1mdW5jdGlvbigpe3ZhciB0LGUsbixvO3JldHVybiBuPXRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpLG89blswXSxlPW5bMV0sdD10aGlzLmRvY3VtZW50LmdldEJsb2NrQXRQb3NpdGlvbihlKSx0aGlzLnJlbW92ZUN1cnJlbnRBdHRyaWJ1dGUodC5nZXRMYXN0QXR0cmlidXRlKCkpLHRoaXMuc2V0U2VsZWN0aW9uKG8pfSxmPVwiIFwiLGQucHJvdG90eXBlLmluc2VydFBsYWNlaG9sZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGxhY2Vob2xkZXJQb3NpdGlvbj10aGlzLmdldFBvc2l0aW9uKCksdGhpcy5pbnNlcnRTdHJpbmcoZil9LGQucHJvdG90eXBlLnNlbGVjdFBsYWNlaG9sZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPXRoaXMucGxhY2Vob2xkZXJQb3NpdGlvbj8odGhpcy5zZXRTZWxlY3RlZFJhbmdlKFt0aGlzLnBsYWNlaG9sZGVyUG9zaXRpb24sdGhpcy5wbGFjZWhvbGRlclBvc2l0aW9uK2YubGVuZ3RoXSksdGhpcy5nZXRTZWxlY3RlZFJhbmdlKCkpOnZvaWQgMH0sZC5wcm90b3R5cGUuZm9yZ2V0UGxhY2Vob2xkZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wbGFjZWhvbGRlclBvc2l0aW9uPW51bGx9LGQucHJvdG90eXBlLmhhc0N1cnJlbnRBdHRyaWJ1dGU9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIGU9dGhpcy5jdXJyZW50QXR0cmlidXRlc1t0XSxudWxsIT1lJiZlIT09ITF9LGQucHJvdG90eXBlLnRvZ2dsZUN1cnJlbnRBdHRyaWJ1dGU9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuKGU9IXRoaXMuY3VycmVudEF0dHJpYnV0ZXNbdF0pP3RoaXMuc2V0Q3VycmVudEF0dHJpYnV0ZSh0LGUpOnRoaXMucmVtb3ZlQ3VycmVudEF0dHJpYnV0ZSh0KX0sZC5wcm90b3R5cGUuY2FuU2V0Q3VycmVudEF0dHJpYnV0ZT1mdW5jdGlvbih0KXtyZXR1cm4gaSh0KT90aGlzLmNhblNldEN1cnJlbnRCbG9ja0F0dHJpYnV0ZSh0KTp0aGlzLmNhblNldEN1cnJlbnRUZXh0QXR0cmlidXRlKHQpfSxkLnByb3RvdHlwZS5jYW5TZXRDdXJyZW50VGV4dEF0dHJpYnV0ZT1mdW5jdGlvbih0KXtzd2l0Y2godCl7Y2FzZVwiaHJlZlwiOnJldHVybiF0aGlzLnNlbGVjdGlvbkNvbnRhaW5zQXR0YWNobWVudFdpdGhBdHRyaWJ1dGUodCk7ZGVmYXVsdDpyZXR1cm4hMH19LGQucHJvdG90eXBlLmNhblNldEN1cnJlbnRCbG9ja0F0dHJpYnV0ZT1mdW5jdGlvbigpe3ZhciB0O2lmKHQ9dGhpcy5nZXRCbG9jaygpKXJldHVybiF0LmlzVGVybWluYWxCbG9jaygpfSxkLnByb3RvdHlwZS5zZXRDdXJyZW50QXR0cmlidXRlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGkodCk/dGhpcy5zZXRCbG9ja0F0dHJpYnV0ZSh0LGUpOih0aGlzLnNldFRleHRBdHRyaWJ1dGUodCxlKSx0aGlzLmN1cnJlbnRBdHRyaWJ1dGVzW3RdPWUsdGhpcy5ub3RpZnlEZWxlZ2F0ZU9mQ3VycmVudEF0dHJpYnV0ZXNDaGFuZ2UoKSl9LGQucHJvdG90eXBlLnNldFRleHRBdHRyaWJ1dGU9ZnVuY3Rpb24odCxuKXt2YXIgbyxpLHIscztpZihpPXRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpKXJldHVybiByPWlbMF0sbz1pWzFdLHIhPT1vP3RoaXMuc2V0RG9jdW1lbnQodGhpcy5kb2N1bWVudC5hZGRBdHRyaWJ1dGVBdFJhbmdlKHQsbixpKSk6XCJocmVmXCI9PT10PyhzPWUuVGV4dC50ZXh0Rm9yU3RyaW5nV2l0aEF0dHJpYnV0ZXMobix7aHJlZjpufSksdGhpcy5pbnNlcnRUZXh0KHMpKTp2b2lkIDB9LGQucHJvdG90eXBlLnNldEJsb2NrQXR0cmlidXRlPWZ1bmN0aW9uKHQsZSl7dmFyIG4sbztpZihvPXRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpKXJldHVybiB0aGlzLmNhblNldEN1cnJlbnRBdHRyaWJ1dGUodCk/KG49dGhpcy5nZXRCbG9jaygpLHRoaXMuc2V0RG9jdW1lbnQodGhpcy5kb2N1bWVudC5hcHBseUJsb2NrQXR0cmlidXRlQXRSYW5nZSh0LGUsbykpLHRoaXMuc2V0U2VsZWN0aW9uKG8pKTp2b2lkIDB9LGQucHJvdG90eXBlLnJlbW92ZUN1cnJlbnRBdHRyaWJ1dGU9ZnVuY3Rpb24odCl7cmV0dXJuIGkodCk/KHRoaXMucmVtb3ZlQmxvY2tBdHRyaWJ1dGUodCksdGhpcy51cGRhdGVDdXJyZW50QXR0cmlidXRlcygpKToodGhpcy5yZW1vdmVUZXh0QXR0cmlidXRlKHQpLGRlbGV0ZSB0aGlzLmN1cnJlbnRBdHRyaWJ1dGVzW3RdLHRoaXMubm90aWZ5RGVsZWdhdGVPZkN1cnJlbnRBdHRyaWJ1dGVzQ2hhbmdlKCkpfSxkLnByb3RvdHlwZS5yZW1vdmVUZXh0QXR0cmlidXRlPWZ1bmN0aW9uKHQpe3ZhciBlO2lmKGU9dGhpcy5nZXRTZWxlY3RlZFJhbmdlKCkpcmV0dXJuIHRoaXMuc2V0RG9jdW1lbnQodGhpcy5kb2N1bWVudC5yZW1vdmVBdHRyaWJ1dGVBdFJhbmdlKHQsZSkpfSxkLnByb3RvdHlwZS5yZW1vdmVCbG9ja0F0dHJpYnV0ZT1mdW5jdGlvbih0KXt2YXIgZTtpZihlPXRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpKXJldHVybiB0aGlzLnNldERvY3VtZW50KHRoaXMuZG9jdW1lbnQucmVtb3ZlQXR0cmlidXRlQXRSYW5nZSh0LGUpKX0sZC5wcm90b3R5cGUuY2FuRGVjcmVhc2VOZXN0aW5nTGV2ZWw9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4obnVsbCE9KHQ9dGhpcy5nZXRCbG9jaygpKT90LmdldE5lc3RpbmdMZXZlbCgpOnZvaWQgMCk+MH0sZC5wcm90b3R5cGUuY2FuSW5jcmVhc2VOZXN0aW5nTGV2ZWw9ZnVuY3Rpb24oKXt2YXIgZSxuLG87aWYoZT10aGlzLmdldEJsb2NrKCkpcmV0dXJuKG51bGwhPShvPWkoZS5nZXRMYXN0TmVzdGFibGVBdHRyaWJ1dGUoKSkpP28ubGlzdEF0dHJpYnV0ZTowKT8obj10aGlzLmdldFByZXZpb3VzQmxvY2soKSk/dChuLmdldExpc3RJdGVtQXR0cmlidXRlcygpLGUuZ2V0TGlzdEl0ZW1BdHRyaWJ1dGVzKCkpOnZvaWQgMDplLmdldE5lc3RpbmdMZXZlbCgpPjB9LGQucHJvdG90eXBlLmRlY3JlYXNlTmVzdGluZ0xldmVsPWZ1bmN0aW9uKCl7dmFyIHQ7aWYodD10aGlzLmdldEJsb2NrKCkpcmV0dXJuIHRoaXMuc2V0RG9jdW1lbnQodGhpcy5kb2N1bWVudC5yZXBsYWNlQmxvY2sodCx0LmRlY3JlYXNlTmVzdGluZ0xldmVsKCkpKX0sZC5wcm90b3R5cGUuaW5jcmVhc2VOZXN0aW5nTGV2ZWw9ZnVuY3Rpb24oKXt2YXIgdDtpZih0PXRoaXMuZ2V0QmxvY2soKSlyZXR1cm4gdGhpcy5zZXREb2N1bWVudCh0aGlzLmRvY3VtZW50LnJlcGxhY2VCbG9jayh0LHQuaW5jcmVhc2VOZXN0aW5nTGV2ZWwoKSkpfSxkLnByb3RvdHlwZS5jYW5EZWNyZWFzZUJsb2NrQXR0cmlidXRlTGV2ZWw9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4obnVsbCE9KHQ9dGhpcy5nZXRCbG9jaygpKT90LmdldEF0dHJpYnV0ZUxldmVsKCk6dm9pZCAwKT4wfSxkLnByb3RvdHlwZS5kZWNyZWFzZUJsb2NrQXR0cmlidXRlTGV2ZWw9ZnVuY3Rpb24oKXt2YXIgdCxlO3JldHVybih0PW51bGwhPShlPXRoaXMuZ2V0QmxvY2soKSk/ZS5nZXRMYXN0QXR0cmlidXRlKCk6dm9pZCAwKT90aGlzLnJlbW92ZUN1cnJlbnRBdHRyaWJ1dGUodCk6dm9pZCAwfSxkLnByb3RvdHlwZS5kZWNyZWFzZUxpc3RMZXZlbD1mdW5jdGlvbigpe3ZhciB0LGUsbixvLGkscjtmb3Iocj10aGlzLmdldFNlbGVjdGVkUmFuZ2UoKVswXSxpPXRoaXMuZG9jdW1lbnQubG9jYXRpb25Gcm9tUG9zaXRpb24ocikuaW5kZXgsbj1pLHQ9dGhpcy5nZXRCbG9jaygpLmdldEF0dHJpYnV0ZUxldmVsKCk7KGU9dGhpcy5kb2N1bWVudC5nZXRCbG9ja0F0SW5kZXgobisxKSkmJmUuaXNMaXN0SXRlbSgpJiZlLmdldEF0dHJpYnV0ZUxldmVsKCk+dDspbisrO3JldHVybiByPXRoaXMuZG9jdW1lbnQucG9zaXRpb25Gcm9tTG9jYXRpb24oe2luZGV4Omksb2Zmc2V0OjB9KSxvPXRoaXMuZG9jdW1lbnQucG9zaXRpb25Gcm9tTG9jYXRpb24oe2luZGV4Om4sb2Zmc2V0OjB9KSx0aGlzLnNldERvY3VtZW50KHRoaXMuZG9jdW1lbnQucmVtb3ZlTGFzdExpc3RBdHRyaWJ1dGVBdFJhbmdlKFtyLG9dKSl9LGQucHJvdG90eXBlLnVwZGF0ZUN1cnJlbnRBdHRyaWJ1dGVzPWZ1bmN0aW9uKCl7dmFyIHQsZSxuLGkscixzO2lmKHM9dGhpcy5nZXRTZWxlY3RlZFJhbmdlKHtpZ25vcmVMb2NrOiEwfSkpe2ZvcihlPXRoaXMuZG9jdW1lbnQuZ2V0Q29tbW9uQXR0cmlidXRlc0F0UmFuZ2Uocykscj1vKCksbj0wLGk9ci5sZW5ndGg7aT5uO24rKyl0PXJbbl0sZVt0XXx8dGhpcy5jYW5TZXRDdXJyZW50QXR0cmlidXRlKHQpfHwoZVt0XT0hMSk7aWYoIWEoZSx0aGlzLmN1cnJlbnRBdHRyaWJ1dGVzKSlyZXR1cm4gdGhpcy5jdXJyZW50QXR0cmlidXRlcz1lLHRoaXMubm90aWZ5RGVsZWdhdGVPZkN1cnJlbnRBdHRyaWJ1dGVzQ2hhbmdlKCl9fSxkLnByb3RvdHlwZS5nZXRDdXJyZW50QXR0cmlidXRlcz1mdW5jdGlvbigpe3JldHVybiBuLmNhbGwoe30sdGhpcy5jdXJyZW50QXR0cmlidXRlcyl9LGQucHJvdG90eXBlLmdldEN1cnJlbnRUZXh0QXR0cmlidXRlcz1mdW5jdGlvbigpe3ZhciB0LGUsbixvO3Q9e30sbj10aGlzLmN1cnJlbnRBdHRyaWJ1dGVzO2ZvcihlIGluIG4pbz1uW2VdLHIoZSkmJih0W2VdPW8pO3JldHVybiB0fSxkLnByb3RvdHlwZS5mcmVlemVTZWxlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXRDdXJyZW50QXR0cmlidXRlKFwiZnJvemVuXCIsITApfSxkLnByb3RvdHlwZS50aGF3U2VsZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVtb3ZlQ3VycmVudEF0dHJpYnV0ZShcImZyb3plblwiKX0sZC5wcm90b3R5cGUuaGFzRnJvemVuU2VsZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzQ3VycmVudEF0dHJpYnV0ZShcImZyb3plblwiKX0sZC5wcm94eU1ldGhvZChcImdldFNlbGVjdGlvbk1hbmFnZXIoKS5nZXRQb2ludFJhbmdlXCIpLGQucHJveHlNZXRob2QoXCJnZXRTZWxlY3Rpb25NYW5hZ2VyKCkuc2V0TG9jYXRpb25SYW5nZUZyb21Qb2ludFJhbmdlXCIpLGQucHJveHlNZXRob2QoXCJnZXRTZWxlY3Rpb25NYW5hZ2VyKCkubG9jYXRpb25Jc0N1cnNvclRhcmdldFwiKSxkLnByb3h5TWV0aG9kKFwiZ2V0U2VsZWN0aW9uTWFuYWdlcigpLnNlbGVjdGlvbklzRXhwYW5kZWRcIiksZC5wcm94eU1ldGhvZChcImRlbGVnYXRlPy5nZXRTZWxlY3Rpb25NYW5hZ2VyXCIpLGQucHJvdG90eXBlLnNldFNlbGVjdGlvbj1mdW5jdGlvbih0KXt2YXIgZSxuO3JldHVybiBlPXRoaXMuZG9jdW1lbnQubG9jYXRpb25SYW5nZUZyb21SYW5nZSh0KSxudWxsIT0obj10aGlzLmRlbGVnYXRlKT9uLmNvbXBvc2l0aW9uRGlkUmVxdWVzdENoYW5naW5nU2VsZWN0aW9uVG9Mb2NhdGlvblJhbmdlKGUpOnZvaWQgMH0sZC5wcm90b3R5cGUuZ2V0U2VsZWN0ZWRSYW5nZT1mdW5jdGlvbigpe3ZhciB0O3JldHVybih0PXRoaXMuZ2V0TG9jYXRpb25SYW5nZSgpKT90aGlzLmRvY3VtZW50LnJhbmdlRnJvbUxvY2F0aW9uUmFuZ2UodCk6dm9pZCAwfSxkLnByb3RvdHlwZS5zZXRTZWxlY3RlZFJhbmdlPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBlPXRoaXMuZG9jdW1lbnQubG9jYXRpb25SYW5nZUZyb21SYW5nZSh0KSx0aGlzLmdldFNlbGVjdGlvbk1hbmFnZXIoKS5zZXRMb2NhdGlvblJhbmdlKGUpfSxkLnByb3RvdHlwZS5nZXRQb3NpdGlvbj1mdW5jdGlvbigpe3ZhciB0O3JldHVybih0PXRoaXMuZ2V0TG9jYXRpb25SYW5nZSgpKT90aGlzLmRvY3VtZW50LnBvc2l0aW9uRnJvbUxvY2F0aW9uKHRbMF0pOnZvaWQgMH0sZC5wcm90b3R5cGUuZ2V0TG9jYXRpb25SYW5nZT1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gbnVsbCE9KGU9dGhpcy5nZXRTZWxlY3Rpb25NYW5hZ2VyKCkuZ2V0TG9jYXRpb25SYW5nZSh0KSk/ZTpzKHtpbmRleDowLG9mZnNldDowfSl9LGQucHJvdG90eXBlLmdldEV4cGFuZGVkUmFuZ2VJbkRpcmVjdGlvbj1mdW5jdGlvbih0KXt2YXIgZSxuLG87cmV0dXJuIG49dGhpcy5nZXRTZWxlY3RlZFJhbmdlKCksbz1uWzBdLGU9blsxXSxcImJhY2t3YXJkXCI9PT10P289dGhpcy50cmFuc2xhdGVVVEYxNlBvc2l0aW9uRnJvbU9mZnNldChvLC0xKTplPXRoaXMudHJhbnNsYXRlVVRGMTZQb3NpdGlvbkZyb21PZmZzZXQoZSwxKSxzKFtvLGVdKX0sZC5wcm90b3R5cGUubW92ZUN1cnNvckluRGlyZWN0aW9uPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbyxpO3JldHVybiB0aGlzLmVkaXRpbmdBdHRhY2htZW50P289dGhpcy5kb2N1bWVudC5nZXRSYW5nZU9mQXR0YWNobWVudCh0aGlzLmVkaXRpbmdBdHRhY2htZW50KTooaT10aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSxvPXRoaXMuZ2V0RXhwYW5kZWRSYW5nZUluRGlyZWN0aW9uKHQpLG49IWMoaSxvKSksdGhpcy5zZXRTZWxlY3RlZFJhbmdlKFwiYmFja3dhcmRcIj09PXQ/b1swXTpvWzFdKSxuJiYoZT10aGlzLmdldEF0dGFjaG1lbnRBdFJhbmdlKG8pKT90aGlzLmVkaXRBdHRhY2htZW50KGUpOnZvaWQgMH0sZC5wcm90b3R5cGUuZXhwYW5kU2VsZWN0aW9uSW5EaXJlY3Rpb249ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIGU9dGhpcy5nZXRFeHBhbmRlZFJhbmdlSW5EaXJlY3Rpb24odCksdGhpcy5zZXRTZWxlY3RlZFJhbmdlKGUpfSxkLnByb3RvdHlwZS5leHBhbmRTZWxlY3Rpb25Gb3JFZGl0aW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzQ3VycmVudEF0dHJpYnV0ZShcImhyZWZcIik/dGhpcy5leHBhbmRTZWxlY3Rpb25Bcm91bmRDb21tb25BdHRyaWJ1dGUoXCJocmVmXCIpOnZvaWQgMH0sZC5wcm90b3R5cGUuZXhwYW5kU2VsZWN0aW9uQXJvdW5kQ29tbW9uQXR0cmlidXRlPWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIGU9dGhpcy5nZXRQb3NpdGlvbigpLG49dGhpcy5kb2N1bWVudC5nZXRSYW5nZU9mQ29tbW9uQXR0cmlidXRlQXRQb3NpdGlvbih0LGUpLHRoaXMuc2V0U2VsZWN0ZWRSYW5nZShuKX0sZC5wcm90b3R5cGUuc2VsZWN0aW9uQ29udGFpbnNBdHRhY2htZW50V2l0aEF0dHJpYnV0ZT1mdW5jdGlvbih0KXt2YXIgZSxuLG8saSxyO2lmKHI9dGhpcy5nZXRTZWxlY3RlZFJhbmdlKCkpe2ZvcihpPXRoaXMuZG9jdW1lbnQuZ2V0RG9jdW1lbnRBdFJhbmdlKHIpLmdldEF0dGFjaG1lbnRzKCksbj0wLG89aS5sZW5ndGg7bz5uO24rKylpZihlPWlbbl0sZS5oYXNBdHRyaWJ1dGUodCkpcmV0dXJuITA7cmV0dXJuITF9fSxkLnByb3RvdHlwZS5zZWxlY3Rpb25Jc0luQ3Vyc29yVGFyZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdGluZ0F0dGFjaG1lbnR8fHRoaXMucG9zaXRpb25Jc0N1cnNvclRhcmdldCh0aGlzLmdldFBvc2l0aW9uKCkpfSxkLnByb3RvdHlwZS5wb3NpdGlvbklzQ3Vyc29yVGFyZ2V0PWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybihlPXRoaXMuZG9jdW1lbnQubG9jYXRpb25Gcm9tUG9zaXRpb24odCkpP3RoaXMubG9jYXRpb25Jc0N1cnNvclRhcmdldChlKTp2b2lkIDB9LGQucHJvdG90eXBlLnBvc2l0aW9uSXNCbG9ja0JyZWFrPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBudWxsIT0oZT10aGlzLmRvY3VtZW50LmdldFBpZWNlQXRQb3NpdGlvbih0KSk/ZS5pc0Jsb2NrQnJlYWsoKTp2b2lkIDB9LGQucHJvdG90eXBlLmdldFNlbGVjdGVkRG9jdW1lbnQ9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4odD10aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSk/dGhpcy5kb2N1bWVudC5nZXREb2N1bWVudEF0UmFuZ2UodCk6dm9pZCAwfSxkLnByb3RvdHlwZS5nZXRBdHRhY2htZW50cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmF0dGFjaG1lbnRzLnNsaWNlKDApfSxkLnByb3RvdHlwZS5yZWZyZXNoQXR0YWNobWVudHM9ZnVuY3Rpb24oKXt2YXIgdCxlLG4sbyxpLHIscyxhLHUsYyxoLHA7Zm9yKG49dGhpcy5kb2N1bWVudC5nZXRBdHRhY2htZW50cygpLGE9bCh0aGlzLmF0dGFjaG1lbnRzLG4pLHQ9YS5hZGRlZCxoPWEucmVtb3ZlZCx0aGlzLmF0dGFjaG1lbnRzPW4sbz0wLHI9aC5sZW5ndGg7cj5vO28rKyllPWhbb10sZS5kZWxlZ2F0ZT1udWxsLG51bGwhPSh1PXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB1LmNvbXBvc2l0aW9uRGlkUmVtb3ZlQXR0YWNobWVudCYmdS5jb21wb3NpdGlvbkRpZFJlbW92ZUF0dGFjaG1lbnQoZSk7Zm9yKHA9W10saT0wLHM9dC5sZW5ndGg7cz5pO2krKyllPXRbaV0sZS5kZWxlZ2F0ZT10aGlzLHAucHVzaChudWxsIT0oYz10aGlzLmRlbGVnYXRlKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYy5jb21wb3NpdGlvbkRpZEFkZEF0dGFjaG1lbnQ/Yy5jb21wb3NpdGlvbkRpZEFkZEF0dGFjaG1lbnQoZSk6dm9pZCAwKTtyZXR1cm4gcH0sZC5wcm90b3R5cGUuYXR0YWNobWVudERpZENoYW5nZUF0dHJpYnV0ZXM9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIHRoaXMucmV2aXNpb24rKyxudWxsIT0oZT10aGlzLmRlbGVnYXRlKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgZS5jb21wb3NpdGlvbkRpZEVkaXRBdHRhY2htZW50P2UuY29tcG9zaXRpb25EaWRFZGl0QXR0YWNobWVudCh0KTp2b2lkIDB9LGQucHJvdG90eXBlLmF0dGFjaG1lbnREaWRDaGFuZ2VQcmV2aWV3VVJMPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiB0aGlzLnJldmlzaW9uKyssbnVsbCE9KGU9dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGUuY29tcG9zaXRpb25EaWRDaGFuZ2VBdHRhY2htZW50UHJldmlld1VSTD9lLmNvbXBvc2l0aW9uRGlkQ2hhbmdlQXR0YWNobWVudFByZXZpZXdVUkwodCk6dm9pZCAwfSxkLnByb3RvdHlwZS5lZGl0QXR0YWNobWVudD1mdW5jdGlvbih0KXt2YXIgZTtpZih0IT09dGhpcy5lZGl0aW5nQXR0YWNobWVudClyZXR1cm4gdGhpcy5zdG9wRWRpdGluZ0F0dGFjaG1lbnQoKSx0aGlzLmVkaXRpbmdBdHRhY2htZW50PXQsbnVsbCE9KGU9dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGUuY29tcG9zaXRpb25EaWRTdGFydEVkaXRpbmdBdHRhY2htZW50P2UuY29tcG9zaXRpb25EaWRTdGFydEVkaXRpbmdBdHRhY2htZW50KHRoaXMuZWRpdGluZ0F0dGFjaG1lbnQpOnZvaWQgMH0sZC5wcm90b3R5cGUuc3RvcEVkaXRpbmdBdHRhY2htZW50PWZ1bmN0aW9uKCl7dmFyIHQ7aWYodGhpcy5lZGl0aW5nQXR0YWNobWVudClyZXR1cm4gbnVsbCE9KHQ9dGhpcy5kZWxlZ2F0ZSkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQuY29tcG9zaXRpb25EaWRTdG9wRWRpdGluZ0F0dGFjaG1lbnQmJnQuY29tcG9zaXRpb25EaWRTdG9wRWRpdGluZ0F0dGFjaG1lbnQodGhpcy5lZGl0aW5nQXR0YWNobWVudCksdGhpcy5lZGl0aW5nQXR0YWNobWVudD1udWxsfSxkLnByb3RvdHlwZS5jYW5FZGl0QXR0YWNobWVudENhcHRpb249ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gbnVsbCE9KHQ9dGhpcy5lZGl0aW5nQXR0YWNobWVudCk/dC5pc1ByZXZpZXdhYmxlKCk6dm9pZCAwfSxkLnByb3RvdHlwZS51cGRhdGVBdHRyaWJ1dGVzRm9yQXR0YWNobWVudD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnNldERvY3VtZW50KHRoaXMuZG9jdW1lbnQudXBkYXRlQXR0cmlidXRlc0ZvckF0dGFjaG1lbnQodCxlKSl9LGQucHJvdG90eXBlLnJlbW92ZUF0dHJpYnV0ZUZvckF0dGFjaG1lbnQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5zZXREb2N1bWVudCh0aGlzLmRvY3VtZW50LnJlbW92ZUF0dHJpYnV0ZUZvckF0dGFjaG1lbnQodCxlKSl9LGQucHJvdG90eXBlLmJyZWFrRm9ybWF0dGVkQmxvY2s9ZnVuY3Rpb24odCl7dmFyIG4sbyxpLHIscztyZXR1cm4gbz10LmRvY3VtZW50LG49dC5ibG9jayxyPXQuc3RhcnRQb3NpdGlvbixzPVtyLTEscl0sbi5nZXRCbG9ja0JyZWFrUG9zaXRpb24oKT09PXQuc3RhcnRMb2NhdGlvbi5vZmZzZXQ/KG4uYnJlYWtzT25SZXR1cm4oKSYmXCJcXG5cIj09PXQubmV4dENoYXJhY3Rlcj9yKz0xOm89by5yZW1vdmVUZXh0QXRSYW5nZShzKSxzPVtyLHJdKTpcIlxcblwiPT09dC5uZXh0Q2hhcmFjdGVyP1wiXFxuXCI9PT10LnByZXZpb3VzQ2hhcmFjdGVyP3M9W3ItMSxyKzFdOihzPVtyLHIrMV0scis9MSk6dC5zdGFydExvY2F0aW9uLm9mZnNldC0xIT09MCYmKHIrPTEpLGk9bmV3IGUuRG9jdW1lbnQoW24ucmVtb3ZlTGFzdEF0dHJpYnV0ZSgpLmNvcHlXaXRob3V0VGV4dCgpXSksdGhpcy5zZXREb2N1bWVudChvLmluc2VydERvY3VtZW50QXRSYW5nZShpLHMpKSx0aGlzLnNldFNlbGVjdGlvbihyKX0sZC5wcm90b3R5cGUuZ2V0UHJldmlvdXNCbG9jaz1mdW5jdGlvbigpe3ZhciB0LGU7cmV0dXJuKGU9dGhpcy5nZXRMb2NhdGlvblJhbmdlKCkpJiYodD1lWzBdLmluZGV4LHQ+MCk/dGhpcy5kb2N1bWVudC5nZXRCbG9ja0F0SW5kZXgodC0xKTp2b2lkIDB9LGQucHJvdG90eXBlLmdldEJsb2NrPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuKHQ9dGhpcy5nZXRMb2NhdGlvblJhbmdlKCkpP3RoaXMuZG9jdW1lbnQuZ2V0QmxvY2tBdEluZGV4KHRbMF0uaW5kZXgpOnZvaWQgMH0sZC5wcm90b3R5cGUuZ2V0QXR0YWNobWVudEF0UmFuZ2U9ZnVuY3Rpb24odCl7dmFyIG47cmV0dXJuIG49dGhpcy5kb2N1bWVudC5nZXREb2N1bWVudEF0UmFuZ2UodCksbi50b1N0cmluZygpPT09ZS5PQkpFQ1RfUkVQTEFDRU1FTlRfQ0hBUkFDVEVSK1wiXFxuXCI/bi5nZXRBdHRhY2htZW50cygpWzBdOnZvaWQgMH0sZC5wcm90b3R5cGUubm90aWZ5RGVsZWdhdGVPZkN1cnJlbnRBdHRyaWJ1dGVzQ2hhbmdlPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIG51bGwhPSh0PXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0LmNvbXBvc2l0aW9uRGlkQ2hhbmdlQ3VycmVudEF0dHJpYnV0ZXM/dC5jb21wb3NpdGlvbkRpZENoYW5nZUN1cnJlbnRBdHRyaWJ1dGVzKHRoaXMuY3VycmVudEF0dHJpYnV0ZXMpOnZvaWQgMH0sZC5wcm90b3R5cGUubm90aWZ5RGVsZWdhdGVPZkluc2VydGlvbkF0UmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIG51bGwhPShlPXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBlLmNvbXBvc2l0aW9uRGlkUGVyZm9ybUluc2VydGlvbkF0UmFuZ2U/ZS5jb21wb3NpdGlvbkRpZFBlcmZvcm1JbnNlcnRpb25BdFJhbmdlKHQpOnZvaWQgMH0sZC5wcm90b3R5cGUudHJhbnNsYXRlVVRGMTZQb3NpdGlvbkZyb21PZmZzZXQ9ZnVuY3Rpb24odCxlKXt2YXIgbixvO3JldHVybiBvPXRoaXMuZG9jdW1lbnQudG9VVEYxNlN0cmluZygpLG49by5vZmZzZXRGcm9tVUNTMk9mZnNldCh0KSxvLm9mZnNldFRvVUNTMk9mZnNldChuK2UpfSxkfShlLkJhc2ljT2JqZWN0KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbygpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIGkgaW4gZSluLmNhbGwoZSxpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIG8ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBvLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LG49e30uaGFzT3duUHJvcGVydHk7ZS5VbmRvTWFuYWdlcj1mdW5jdGlvbihlKXtmdW5jdGlvbiBuKHQpe3RoaXMuY29tcG9zaXRpb249dCx0aGlzLnVuZG9FbnRyaWVzPVtdLHRoaXMucmVkb0VudHJpZXM9W119dmFyIG87cmV0dXJuIHQobixlKSxuLnByb3RvdHlwZS5yZWNvcmRVbmRvRW50cnk9ZnVuY3Rpb24odCxlKXt2YXIgbixpLHIscyxhO3JldHVybiBzPW51bGwhPWU/ZTp7fSxpPXMuY29udGV4dCxuPXMuY29uc29saWRhdGFibGUscj10aGlzLnVuZG9FbnRyaWVzLnNsaWNlKC0xKVswXSxuJiZvKHIsdCxpKT92b2lkIDA6KGE9dGhpcy5jcmVhdGVFbnRyeSh7ZGVzY3JpcHRpb246dCxjb250ZXh0Oml9KSx0aGlzLnVuZG9FbnRyaWVzLnB1c2goYSksdGhpcy5yZWRvRW50cmllcz1bXSl9LG4ucHJvdG90eXBlLnVuZG89ZnVuY3Rpb24oKXt2YXIgdCxlO3JldHVybihlPXRoaXMudW5kb0VudHJpZXMucG9wKCkpPyh0PXRoaXMuY3JlYXRlRW50cnkoZSksdGhpcy5yZWRvRW50cmllcy5wdXNoKHQpLHRoaXMuY29tcG9zaXRpb24ubG9hZFNuYXBzaG90KGUuc25hcHNob3QpKTp2b2lkIDB9LG4ucHJvdG90eXBlLnJlZG89ZnVuY3Rpb24oKXt2YXIgdCxlO3JldHVybih0PXRoaXMucmVkb0VudHJpZXMucG9wKCkpPyhlPXRoaXMuY3JlYXRlRW50cnkodCksdGhpcy51bmRvRW50cmllcy5wdXNoKGUpLHRoaXMuY29tcG9zaXRpb24ubG9hZFNuYXBzaG90KHQuc25hcHNob3QpKTp2b2lkIDB9LG4ucHJvdG90eXBlLmNhblVuZG89ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51bmRvRW50cmllcy5sZW5ndGg+MH0sbi5wcm90b3R5cGUuY2FuUmVkbz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlZG9FbnRyaWVzLmxlbmd0aD4wfSxuLnByb3RvdHlwZS5jcmVhdGVFbnRyeT1mdW5jdGlvbih0KXt2YXIgZSxuLG87cmV0dXJuIG89bnVsbCE9dD90Ont9LG49by5kZXNjcmlwdGlvbixlPW8uY29udGV4dCx7ZGVzY3JpcHRpb246bnVsbCE9bj9uLnRvU3RyaW5nKCk6dm9pZCAwLGNvbnRleHQ6SlNPTi5zdHJpbmdpZnkoZSksc25hcHNob3Q6dGhpcy5jb21wb3NpdGlvbi5nZXRTbmFwc2hvdCgpfX0sbz1mdW5jdGlvbih0LGUsbil7cmV0dXJuKG51bGwhPXQ/dC5kZXNjcmlwdGlvbjp2b2lkIDApPT09KG51bGwhPWU/ZS50b1N0cmluZygpOnZvaWQgMCkmJihudWxsIT10P3QuY29udGV4dDp2b2lkIDApPT09SlNPTi5zdHJpbmdpZnkobil9LG59KGUuQmFzaWNPYmplY3QpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7ZS5FZGl0b3I9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsbixvKXt0aGlzLmNvbXBvc2l0aW9uPXQsdGhpcy5zZWxlY3Rpb25NYW5hZ2VyPW4sdGhpcy5lbGVtZW50PW8sdGhpcy51bmRvTWFuYWdlcj1uZXcgZS5VbmRvTWFuYWdlcih0aGlzLmNvbXBvc2l0aW9uKX1yZXR1cm4gdC5wcm90b3R5cGUubG9hZERvY3VtZW50PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmxvYWRTbmFwc2hvdCh7ZG9jdW1lbnQ6dCxzZWxlY3RlZFJhbmdlOlswLDBdfSl9LHQucHJvdG90eXBlLmxvYWRIVE1MPWZ1bmN0aW9uKHQpe3JldHVybiBudWxsPT10JiYodD1cIlwiKSx0aGlzLmxvYWREb2N1bWVudChlLkRvY3VtZW50LmZyb21IVE1MKHQse3JlZmVyZW5jZUVsZW1lbnQ6dGhpcy5lbGVtZW50fSkpfSx0LnByb3RvdHlwZS5sb2FkSlNPTj1mdW5jdGlvbih0KXt2YXIgbixvO3JldHVybiBuPXQuZG9jdW1lbnQsbz10LnNlbGVjdGVkUmFuZ2Usbj1lLkRvY3VtZW50LmZyb21KU09OKG4pLHRoaXMubG9hZFNuYXBzaG90KHtkb2N1bWVudDpuLHNlbGVjdGVkUmFuZ2U6b30pfSx0LnByb3RvdHlwZS5sb2FkU25hcHNob3Q9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudW5kb01hbmFnZXI9bmV3IGUuVW5kb01hbmFnZXIodGhpcy5jb21wb3NpdGlvbiksdGhpcy5jb21wb3NpdGlvbi5sb2FkU25hcHNob3QodCl9LHQucHJvdG90eXBlLmdldERvY3VtZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb24uZG9jdW1lbnR9LHQucHJvdG90eXBlLmdldFNlbGVjdGVkRG9jdW1lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb21wb3NpdGlvbi5nZXRTZWxlY3RlZERvY3VtZW50KCl9LHQucHJvdG90eXBlLmdldFNuYXBzaG90PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb24uZ2V0U25hcHNob3QoKX0sdC5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U25hcHNob3QoKX0sdC5wcm90b3R5cGUuZGVsZXRlSW5EaXJlY3Rpb249ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb24uZGVsZXRlSW5EaXJlY3Rpb24odCl9LHQucHJvdG90eXBlLmluc2VydEF0dGFjaG1lbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb24uaW5zZXJ0QXR0YWNobWVudCh0KX0sdC5wcm90b3R5cGUuaW5zZXJ0RG9jdW1lbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb24uaW5zZXJ0RG9jdW1lbnQodCl9LHQucHJvdG90eXBlLmluc2VydEZpbGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb24uaW5zZXJ0RmlsZSh0KX0sdC5wcm90b3R5cGUuaW5zZXJ0SFRNTD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb21wb3NpdGlvbi5pbnNlcnRIVE1MKHQpfSx0LnByb3RvdHlwZS5pbnNlcnRTdHJpbmc9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb24uaW5zZXJ0U3RyaW5nKHQpfSx0LnByb3RvdHlwZS5pbnNlcnRUZXh0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbXBvc2l0aW9uLmluc2VydFRleHQodCl9LHQucHJvdG90eXBlLmluc2VydExpbmVCcmVhaz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbXBvc2l0aW9uLmluc2VydExpbmVCcmVhaygpfSx0LnByb3RvdHlwZS5nZXRTZWxlY3RlZFJhbmdlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb24uZ2V0U2VsZWN0ZWRSYW5nZSgpfSx0LnByb3RvdHlwZS5nZXRQb3NpdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbXBvc2l0aW9uLmdldFBvc2l0aW9uKCl9LHQucHJvdG90eXBlLmdldENsaWVudFJlY3RBdFBvc2l0aW9uPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiBlPXRoaXMuZ2V0RG9jdW1lbnQoKS5sb2NhdGlvblJhbmdlRnJvbVJhbmdlKFt0LHQrMV0pLHRoaXMuc2VsZWN0aW9uTWFuYWdlci5nZXRDbGllbnRSZWN0QXRMb2NhdGlvblJhbmdlKGUpfSx0LnByb3RvdHlwZS5leHBhbmRTZWxlY3Rpb25JbkRpcmVjdGlvbj1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb21wb3NpdGlvbi5leHBhbmRTZWxlY3Rpb25JbkRpcmVjdGlvbih0KX0sdC5wcm90b3R5cGUubW92ZUN1cnNvckluRGlyZWN0aW9uPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbXBvc2l0aW9uLm1vdmVDdXJzb3JJbkRpcmVjdGlvbih0KX0sdC5wcm90b3R5cGUuc2V0U2VsZWN0ZWRSYW5nZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb21wb3NpdGlvbi5zZXRTZWxlY3RlZFJhbmdlKHQpfSx0LnByb3RvdHlwZS5hY3RpdmF0ZUF0dHJpYnV0ZT1mdW5jdGlvbih0LGUpe3JldHVybiBudWxsPT1lJiYoZT0hMCksdGhpcy5jb21wb3NpdGlvbi5zZXRDdXJyZW50QXR0cmlidXRlKHQsZSl9LHQucHJvdG90eXBlLmF0dHJpYnV0ZUlzQWN0aXZlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbXBvc2l0aW9uLmhhc0N1cnJlbnRBdHRyaWJ1dGUodCl9LHQucHJvdG90eXBlLmNhbkFjdGl2YXRlQXR0cmlidXRlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbXBvc2l0aW9uLmNhblNldEN1cnJlbnRBdHRyaWJ1dGUodCl9LHQucHJvdG90eXBlLmRlYWN0aXZhdGVBdHRyaWJ1dGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb24ucmVtb3ZlQ3VycmVudEF0dHJpYnV0ZSh0KX0sdC5wcm90b3R5cGUuY2FuRGVjcmVhc2VOZXN0aW5nTGV2ZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb21wb3NpdGlvbi5jYW5EZWNyZWFzZU5lc3RpbmdMZXZlbCgpfSx0LnByb3RvdHlwZS5jYW5JbmNyZWFzZU5lc3RpbmdMZXZlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbXBvc2l0aW9uLmNhbkluY3JlYXNlTmVzdGluZ0xldmVsKClcbn0sdC5wcm90b3R5cGUuZGVjcmVhc2VOZXN0aW5nTGV2ZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jYW5EZWNyZWFzZU5lc3RpbmdMZXZlbCgpP3RoaXMuY29tcG9zaXRpb24uZGVjcmVhc2VOZXN0aW5nTGV2ZWwoKTp2b2lkIDB9LHQucHJvdG90eXBlLmluY3JlYXNlTmVzdGluZ0xldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FuSW5jcmVhc2VOZXN0aW5nTGV2ZWwoKT90aGlzLmNvbXBvc2l0aW9uLmluY3JlYXNlTmVzdGluZ0xldmVsKCk6dm9pZCAwfSx0LnByb3RvdHlwZS5jYW5EZWNyZWFzZUluZGVudGF0aW9uTGV2ZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jYW5EZWNyZWFzZU5lc3RpbmdMZXZlbCgpfSx0LnByb3RvdHlwZS5jYW5JbmNyZWFzZUluZGVudGF0aW9uTGV2ZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jYW5JbmNyZWFzZU5lc3RpbmdMZXZlbCgpfSx0LnByb3RvdHlwZS5kZWNyZWFzZUluZGVudGF0aW9uTGV2ZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kZWNyZWFzZU5lc3RpbmdMZXZlbCgpfSx0LnByb3RvdHlwZS5pbmNyZWFzZUluZGVudGF0aW9uTGV2ZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbmNyZWFzZU5lc3RpbmdMZXZlbCgpfSx0LnByb3RvdHlwZS5jYW5SZWRvPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudW5kb01hbmFnZXIuY2FuUmVkbygpfSx0LnByb3RvdHlwZS5jYW5VbmRvPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudW5kb01hbmFnZXIuY2FuVW5kbygpfSx0LnByb3RvdHlwZS5yZWNvcmRVbmRvRW50cnk9ZnVuY3Rpb24odCxlKXt2YXIgbixvLGk7cmV0dXJuIGk9bnVsbCE9ZT9lOnt9LG89aS5jb250ZXh0LG49aS5jb25zb2xpZGF0YWJsZSx0aGlzLnVuZG9NYW5hZ2VyLnJlY29yZFVuZG9FbnRyeSh0LHtjb250ZXh0Om8sY29uc29saWRhdGFibGU6bn0pfSx0LnByb3RvdHlwZS5yZWRvPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FuUmVkbygpP3RoaXMudW5kb01hbmFnZXIucmVkbygpOnZvaWQgMH0sdC5wcm90b3R5cGUudW5kbz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNhblVuZG8oKT90aGlzLnVuZG9NYW5hZ2VyLnVuZG8oKTp2b2lkIDB9LHR9KCl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdD1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG8oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBpIGluIGUpbi5jYWxsKGUsaSkmJih0W2ldPWVbaV0pO3JldHVybiBvLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbyx0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxuPXt9Lmhhc093blByb3BlcnR5O2UuTWFuYWdlZEF0dGFjaG1lbnQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gbih0LGUpe3ZhciBuO3RoaXMuYXR0YWNobWVudE1hbmFnZXI9dCx0aGlzLmF0dGFjaG1lbnQ9ZSxuPXRoaXMuYXR0YWNobWVudCx0aGlzLmlkPW4uaWQsdGhpcy5maWxlPW4uZmlsZX1yZXR1cm4gdChuLGUpLG4ucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmF0dGFjaG1lbnRNYW5hZ2VyLnJlcXVlc3RSZW1vdmFsT2ZBdHRhY2htZW50KHRoaXMuYXR0YWNobWVudCl9LG4ucHJveHlNZXRob2QoXCJhdHRhY2htZW50LmdldEF0dHJpYnV0ZVwiKSxuLnByb3h5TWV0aG9kKFwiYXR0YWNobWVudC5oYXNBdHRyaWJ1dGVcIiksbi5wcm94eU1ldGhvZChcImF0dGFjaG1lbnQuc2V0QXR0cmlidXRlXCIpLG4ucHJveHlNZXRob2QoXCJhdHRhY2htZW50LmdldEF0dHJpYnV0ZXNcIiksbi5wcm94eU1ldGhvZChcImF0dGFjaG1lbnQuc2V0QXR0cmlidXRlc1wiKSxuLnByb3h5TWV0aG9kKFwiYXR0YWNobWVudC5pc1BlbmRpbmdcIiksbi5wcm94eU1ldGhvZChcImF0dGFjaG1lbnQuaXNQcmV2aWV3YWJsZVwiKSxuLnByb3h5TWV0aG9kKFwiYXR0YWNobWVudC5nZXRVUkxcIiksbi5wcm94eU1ldGhvZChcImF0dGFjaG1lbnQuZ2V0SHJlZlwiKSxuLnByb3h5TWV0aG9kKFwiYXR0YWNobWVudC5nZXRGaWxlbmFtZVwiKSxuLnByb3h5TWV0aG9kKFwiYXR0YWNobWVudC5nZXRGaWxlc2l6ZVwiKSxuLnByb3h5TWV0aG9kKFwiYXR0YWNobWVudC5nZXRGb3JtYXR0ZWRGaWxlc2l6ZVwiKSxuLnByb3h5TWV0aG9kKFwiYXR0YWNobWVudC5nZXRFeHRlbnNpb25cIiksbi5wcm94eU1ldGhvZChcImF0dGFjaG1lbnQuZ2V0Q29udGVudFR5cGVcIiksbi5wcm94eU1ldGhvZChcImF0dGFjaG1lbnQuZ2V0RmlsZVwiKSxuLnByb3h5TWV0aG9kKFwiYXR0YWNobWVudC5zZXRGaWxlXCIpLG4ucHJveHlNZXRob2QoXCJhdHRhY2htZW50LnJlbGVhc2VGaWxlXCIpLG4ucHJveHlNZXRob2QoXCJhdHRhY2htZW50LmdldFVwbG9hZFByb2dyZXNzXCIpLG4ucHJveHlNZXRob2QoXCJhdHRhY2htZW50LnNldFVwbG9hZFByb2dyZXNzXCIpLG59KGUuQmFzaWNPYmplY3QpfS5jYWxsKHRoaXMpLGZ1bmN0aW9uKCl7dmFyIHQ9ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBvKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWZvcih2YXIgaSBpbiBlKW4uY2FsbChlLGkpJiYodFtpXT1lW2ldKTtyZXR1cm4gby5wcm90b3R5cGU9ZS5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IG8sdC5fX3N1cGVyX189ZS5wcm90b3R5cGUsdH0sbj17fS5oYXNPd25Qcm9wZXJ0eTtlLkF0dGFjaG1lbnRNYW5hZ2VyPWZ1bmN0aW9uKG4pe2Z1bmN0aW9uIG8odCl7dmFyIGUsbixvO2ZvcihudWxsPT10JiYodD1bXSksdGhpcy5tYW5hZ2VkQXR0YWNobWVudHM9e30sbj0wLG89dC5sZW5ndGg7bz5uO24rKyllPXRbbl0sdGhpcy5tYW5hZ2VBdHRhY2htZW50KGUpfXJldHVybiB0KG8sbiksby5wcm90b3R5cGUuZ2V0QXR0YWNobWVudHM9ZnVuY3Rpb24oKXt2YXIgdCxlLG4sbztuPXRoaXMubWFuYWdlZEF0dGFjaG1lbnRzLG89W107Zm9yKGUgaW4gbil0PW5bZV0sby5wdXNoKHQpO3JldHVybiBvfSxvLnByb3RvdHlwZS5tYW5hZ2VBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3ZhciBuLG87cmV0dXJuIG51bGwhPShuPXRoaXMubWFuYWdlZEF0dGFjaG1lbnRzKVtvPXQuaWRdP25bb106bltvXT1uZXcgZS5NYW5hZ2VkQXR0YWNobWVudCh0aGlzLHQpfSxvLnByb3RvdHlwZS5hdHRhY2htZW50SXNNYW5hZ2VkPWZ1bmN0aW9uKHQpe3JldHVybiB0LmlkIGluIHRoaXMubWFuYWdlZEF0dGFjaG1lbnRzfSxvLnByb3RvdHlwZS5yZXF1ZXN0UmVtb3ZhbE9mQXR0YWNobWVudD1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gdGhpcy5hdHRhY2htZW50SXNNYW5hZ2VkKHQpJiZudWxsIT0oZT10aGlzLmRlbGVnYXRlKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgZS5hdHRhY2htZW50TWFuYWdlckRpZFJlcXVlc3RSZW1vdmFsT2ZBdHRhY2htZW50P2UuYXR0YWNobWVudE1hbmFnZXJEaWRSZXF1ZXN0UmVtb3ZhbE9mQXR0YWNobWVudCh0KTp2b2lkIDB9LG8ucHJvdG90eXBlLnVubWFuYWdlQXR0YWNobWVudD1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gZT10aGlzLm1hbmFnZWRBdHRhY2htZW50c1t0LmlkXSxkZWxldGUgdGhpcy5tYW5hZ2VkQXR0YWNobWVudHNbdC5pZF0sZX0sb30oZS5CYXNpY09iamVjdCl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuLG8saSxyLHMsYSx1LGMsbCxoO3Q9ZS5lbGVtZW50Q29udGFpbnNOb2RlLG49ZS5maW5kQ2hpbGRJbmRleE9mTm9kZSxyPWUubm9kZUlzQmxvY2tTdGFydCxzPWUubm9kZUlzQmxvY2tTdGFydENvbW1lbnQsaT1lLm5vZGVJc0Jsb2NrQ29udGFpbmVyLGE9ZS5ub2RlSXNDdXJzb3JUYXJnZXQsdT1lLm5vZGVJc0VtcHR5VGV4dE5vZGUsYz1lLm5vZGVJc1RleHROb2RlLG89ZS5ub2RlSXNBdHRhY2htZW50RWxlbWVudCxsPWUudGFnTmFtZSxoPWUud2Fsa1RyZWUsZS5Mb2NhdGlvbk1hcHBlcj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7dGhpcy5lbGVtZW50PXR9dmFyIHAsZCxmLGc7cmV0dXJuIGUucHJvdG90eXBlLmZpbmRMb2NhdGlvbkZyb21Db250YWluZXJBbmRPZmZzZXQ9ZnVuY3Rpb24oZSxvLGkpe3ZhciBzLHUsbCxwLGcsbSx5O2ZvcihtPShudWxsIT1pP2k6e3N0cmljdDohMH0pLnN0cmljdCx1PTAsbD0hMSxwPXtpbmRleDowLG9mZnNldDowfSwocz10aGlzLmZpbmRBdHRhY2htZW50RWxlbWVudFBhcmVudEZvck5vZGUoZSkpJiYoZT1zLnBhcmVudE5vZGUsbz1uKHMpKSx5PWgodGhpcy5lbGVtZW50LHt1c2luZ0ZpbHRlcjpmfSk7eS5uZXh0Tm9kZSgpOyl7aWYoZz15LmN1cnJlbnROb2RlLGc9PT1lJiZjKGUpKXthKGcpfHwocC5vZmZzZXQrPW8pO2JyZWFrfWlmKGcucGFyZW50Tm9kZT09PWUpe2lmKHUrKz09PW8pYnJlYWt9ZWxzZSBpZighdChlLGcpJiZ1PjApYnJlYWs7cihnLHtzdHJpY3Q6bX0pPyhsJiZwLmluZGV4KysscC5vZmZzZXQ9MCxsPSEwKTpwLm9mZnNldCs9ZChnKX1yZXR1cm4gcH0sZS5wcm90b3R5cGUuZmluZENvbnRhaW5lckFuZE9mZnNldEZyb21Mb2NhdGlvbj1mdW5jdGlvbih0KXt2YXIgZSxvLHMsYSx1LGw7aWYoMD09PXQuaW5kZXgmJjA9PT10Lm9mZnNldCl7Zm9yKGU9dGhpcy5lbGVtZW50LGE9MDtlLmZpcnN0Q2hpbGQ7KWlmKGU9ZS5maXJzdENoaWxkLGkoZSkpe2E9MTticmVha31yZXR1cm5bZSxhXX1pZih1PXRoaXMuZmluZE5vZGVBbmRPZmZzZXRGcm9tTG9jYXRpb24odCksbz11WzBdLHM9dVsxXSxvKXtpZihjKG8pKWU9byxsPW8udGV4dENvbnRlbnQsYT10Lm9mZnNldC1zO2Vsc2V7aWYoZT1vLnBhcmVudE5vZGUsIXIoby5wcmV2aW91c1NpYmxpbmcpJiYhaShlKSlmb3IoO289PT1lLmxhc3RDaGlsZCYmKG89ZSxlPWUucGFyZW50Tm9kZSwhaShlKSk7KTthPW4obyksMCE9PXQub2Zmc2V0JiZhKyt9cmV0dXJuW2UsYV19fSxlLnByb3RvdHlwZS5maW5kTm9kZUFuZE9mZnNldEZyb21Mb2NhdGlvbj1mdW5jdGlvbih0KXt2YXIgZSxuLG8saSxyLHMsdSxsO2Zvcih1PTAsbD10aGlzLmdldFNpZ25pZmljYW50Tm9kZXNGb3JJbmRleCh0LmluZGV4KSxuPTAsbz1sLmxlbmd0aDtvPm47bisrKXtpZihlPWxbbl0saT1kKGUpLHQub2Zmc2V0PD11K2kpaWYoYyhlKSl7aWYocj1lLHM9dSx0Lm9mZnNldD09PXMmJmEocikpYnJlYWt9ZWxzZSByfHwocj1lLHM9dSk7aWYodSs9aSx1PnQub2Zmc2V0KWJyZWFrfXJldHVybltyLHNdfSxlLnByb3RvdHlwZS5maW5kQXR0YWNobWVudEVsZW1lbnRQYXJlbnRGb3JOb2RlPWZ1bmN0aW9uKHQpe2Zvcig7dCYmdCE9PXRoaXMuZWxlbWVudDspe2lmKG8odCkpcmV0dXJuIHQ7dD10LnBhcmVudE5vZGV9fSxlLnByb3RvdHlwZS5nZXRTaWduaWZpY2FudE5vZGVzRm9ySW5kZXg9ZnVuY3Rpb24odCl7dmFyIGUsbixvLGkscjtmb3Iobz1bXSxyPWgodGhpcy5lbGVtZW50LHt1c2luZ0ZpbHRlcjpwfSksaT0hMTtyLm5leHROb2RlKCk7KWlmKG49ci5jdXJyZW50Tm9kZSxzKG4pKXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgZSYmbnVsbCE9PWU/ZSsrOmU9MCxlPT09dClpPSEwO2Vsc2UgaWYoaSlicmVha31lbHNlIGkmJm8ucHVzaChuKTtyZXR1cm4gb30sZD1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gdC5ub2RlVHlwZT09PU5vZGUuVEVYVF9OT0RFP2EodCk/MDooZT10LnRleHRDb250ZW50LGUubGVuZ3RoKTpcImJyXCI9PT1sKHQpfHxvKHQpPzE6MH0scD1mdW5jdGlvbih0KXtyZXR1cm4gZyh0KT09PU5vZGVGaWx0ZXIuRklMVEVSX0FDQ0VQVD9mKHQpOk5vZGVGaWx0ZXIuRklMVEVSX1JFSkVDVH0sZz1mdW5jdGlvbih0KXtyZXR1cm4gdSh0KT9Ob2RlRmlsdGVyLkZJTFRFUl9SRUpFQ1Q6Tm9kZUZpbHRlci5GSUxURVJfQUNDRVBUfSxmPWZ1bmN0aW9uKHQpe3JldHVybiBvKHQucGFyZW50Tm9kZSk/Tm9kZUZpbHRlci5GSUxURVJfUkVKRUNUOk5vZGVGaWx0ZXIuRklMVEVSX0FDQ0VQVH0sZX0oKX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0LG4sbz1bXS5zbGljZTt0PWUuZ2V0RE9NUmFuZ2Usbj1lLnNldERPTVJhbmdlLGUuUG9pbnRNYXBwZXI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBlLnByb3RvdHlwZS5jcmVhdGVET01SYW5nZUZyb21Qb2ludD1mdW5jdGlvbihlKXt2YXIgbyxpLHIscyxhLHUsYyxsO2lmKGM9ZS54LGw9ZS55LGRvY3VtZW50LmNhcmV0UG9zaXRpb25Gcm9tUG9pbnQpcmV0dXJuIGE9ZG9jdW1lbnQuY2FyZXRQb3NpdGlvbkZyb21Qb2ludChjLGwpLHI9YS5vZmZzZXROb2RlLGk9YS5vZmZzZXQsbz1kb2N1bWVudC5jcmVhdGVSYW5nZSgpLG8uc2V0U3RhcnQocixpKSxvO2lmKGRvY3VtZW50LmNhcmV0UmFuZ2VGcm9tUG9pbnQpcmV0dXJuIGRvY3VtZW50LmNhcmV0UmFuZ2VGcm9tUG9pbnQoYyxsKTtpZihkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSl7cz10KCk7dHJ5e3U9ZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKSx1Lm1vdmVUb1BvaW50KGMsbCksdS5zZWxlY3QoKX1jYXRjaChoKXt9cmV0dXJuIG89dCgpLG4ocyksb319LGUucHJvdG90eXBlLmdldENsaWVudFJlY3RzRm9yRE9NUmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGUsbixpO3JldHVybiBuPW8uY2FsbCh0LmdldENsaWVudFJlY3RzKCkpLGk9blswXSxlPW5bbi5sZW5ndGgtMV0sW2ksZV19LGV9KCl9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuYXBwbHkoZSxhcmd1bWVudHMpfX0sbz1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPXR9Zm9yKHZhciBvIGluIGUpaS5jYWxsKGUsbykmJih0W29dPWVbb10pO3JldHVybiBuLnByb3RvdHlwZT1lLnByb3RvdHlwZSx0LnByb3RvdHlwZT1uZXcgbix0Ll9fc3VwZXJfXz1lLnByb3RvdHlwZSx0fSxpPXt9Lmhhc093blByb3BlcnR5LHI9W10uaW5kZXhPZnx8ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsbj10aGlzLmxlbmd0aDtuPmU7ZSsrKWlmKGUgaW4gdGhpcyYmdGhpc1tlXT09PXQpcmV0dXJuIGU7cmV0dXJuLTF9O3Q9ZS5nZXRET01SYW5nZSxlLlNlbGVjdGlvbkNoYW5nZU9ic2VydmVyPWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIGkoKXt0aGlzLnJ1bj1uKHRoaXMucnVuLHRoaXMpLHRoaXMudXBkYXRlPW4odGhpcy51cGRhdGUsdGhpcyksdGhpcy5zZWxlY3Rpb25NYW5hZ2Vycz1bXX12YXIgcztyZXR1cm4gbyhpLGUpLGkucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnRlZD92b2lkIDA6KHRoaXMuc3RhcnRlZD0hMCxcIm9uc2VsZWN0aW9uY2hhbmdlXCJpbiBkb2N1bWVudD9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwic2VsZWN0aW9uY2hhbmdlXCIsdGhpcy51cGRhdGUsITApOnRoaXMucnVuKCkpfSxpLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnRlZD8odGhpcy5zdGFydGVkPSExLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzZWxlY3Rpb25jaGFuZ2VcIix0aGlzLnVwZGF0ZSwhMCkpOnZvaWQgMH0saS5wcm90b3R5cGUucmVnaXN0ZXJTZWxlY3Rpb25NYW5hZ2VyPWZ1bmN0aW9uKHQpe3JldHVybiByLmNhbGwodGhpcy5zZWxlY3Rpb25NYW5hZ2Vycyx0KTwwPyh0aGlzLnNlbGVjdGlvbk1hbmFnZXJzLnB1c2godCksdGhpcy5zdGFydCgpKTp2b2lkIDB9LGkucHJvdG90eXBlLnVucmVnaXN0ZXJTZWxlY3Rpb25NYW5hZ2VyPWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiB0aGlzLnNlbGVjdGlvbk1hbmFnZXJzPWZ1bmN0aW9uKCl7dmFyIG4sbyxpLHI7Zm9yKGk9dGhpcy5zZWxlY3Rpb25NYW5hZ2VycyxyPVtdLG49MCxvPWkubGVuZ3RoO28+bjtuKyspZT1pW25dLGUhPT10JiZyLnB1c2goZSk7cmV0dXJuIHJ9LmNhbGwodGhpcyksMD09PXRoaXMuc2VsZWN0aW9uTWFuYWdlcnMubGVuZ3RoP3RoaXMuc3RvcCgpOnZvaWQgMH0saS5wcm90b3R5cGUubm90aWZ5U2VsZWN0aW9uTWFuYWdlcnNPZlNlbGVjdGlvbkNoYW5nZT1mdW5jdGlvbigpe3ZhciB0LGUsbixvLGk7Zm9yKG49dGhpcy5zZWxlY3Rpb25NYW5hZ2VycyxvPVtdLHQ9MCxlPW4ubGVuZ3RoO2U+dDt0KyspaT1uW3RdLG8ucHVzaChpLnNlbGVjdGlvbkRpZENoYW5nZSgpKTtyZXR1cm4gb30saS5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKCl7dmFyIGU7cmV0dXJuIGU9dCgpLHMoZSx0aGlzLmRvbVJhbmdlKT92b2lkIDA6KHRoaXMuZG9tUmFuZ2U9ZSx0aGlzLm5vdGlmeVNlbGVjdGlvbk1hbmFnZXJzT2ZTZWxlY3Rpb25DaGFuZ2UoKSl9LGkucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tUmFuZ2U9bnVsbCx0aGlzLnVwZGF0ZSgpfSxpLnByb3RvdHlwZS5ydW49ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGFydGVkPyh0aGlzLnVwZGF0ZSgpLHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnJ1bikpOnZvaWQgMH0scz1mdW5jdGlvbih0LGUpe3JldHVybihudWxsIT10P3Quc3RhcnRDb250YWluZXI6dm9pZCAwKT09PShudWxsIT1lP2Uuc3RhcnRDb250YWluZXI6dm9pZCAwKSYmKG51bGwhPXQ/dC5zdGFydE9mZnNldDp2b2lkIDApPT09KG51bGwhPWU/ZS5zdGFydE9mZnNldDp2b2lkIDApJiYobnVsbCE9dD90LmVuZENvbnRhaW5lcjp2b2lkIDApPT09KG51bGwhPWU/ZS5lbmRDb250YWluZXI6dm9pZCAwKSYmKG51bGwhPXQ/dC5lbmRPZmZzZXQ6dm9pZCAwKT09PShudWxsIT1lP2UuZW5kT2Zmc2V0OnZvaWQgMCl9LGl9KGUuQmFzaWNPYmplY3QpLG51bGw9PWUuc2VsZWN0aW9uQ2hhbmdlT2JzZXJ2ZXImJihlLnNlbGVjdGlvbkNoYW5nZU9ic2VydmVyPW5ldyBlLlNlbGVjdGlvbkNoYW5nZU9ic2VydmVyKX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0LG4sbyxpLHIscyxhLHUsYyxsLGg9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdC5hcHBseShlLGFyZ3VtZW50cyl9fSxwPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIG8gaW4gZSlkLmNhbGwoZSxvKSYmKHRbb109ZVtvXSk7cmV0dXJuIG4ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBuLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LGQ9e30uaGFzT3duUHJvcGVydHk7bz1lLmdldERPTVNlbGVjdGlvbixuPWUuZ2V0RE9NUmFuZ2UsbD1lLnNldERPTVJhbmdlLHQ9ZS5lbGVtZW50Q29udGFpbnNOb2RlLHM9ZS5ub2RlSXNDdXJzb3JUYXJnZXQscj1lLmlubmVyRWxlbWVudElzQWN0aXZlLGk9ZS5oYW5kbGVFdmVudCxhPWUubm9ybWFsaXplUmFuZ2UsdT1lLnJhbmdlSXNDb2xsYXBzZWQsYz1lLnJhbmdlc0FyZUVxdWFsLGUuU2VsZWN0aW9uTWFuYWdlcj1mdW5jdGlvbihkKXtmdW5jdGlvbiBmKHQpe3RoaXMuZWxlbWVudD10LHRoaXMuc2VsZWN0aW9uRGlkQ2hhbmdlPWgodGhpcy5zZWxlY3Rpb25EaWRDaGFuZ2UsdGhpcyksdGhpcy5kaWRNb3VzZURvd249aCh0aGlzLmRpZE1vdXNlRG93bix0aGlzKSx0aGlzLmxvY2F0aW9uTWFwcGVyPW5ldyBlLkxvY2F0aW9uTWFwcGVyKHRoaXMuZWxlbWVudCksdGhpcy5wb2ludE1hcHBlcj1uZXcgZS5Qb2ludE1hcHBlcix0aGlzLmxvY2tDb3VudD0wLGkoXCJtb3VzZWRvd25cIix7b25FbGVtZW50OnRoaXMuZWxlbWVudCx3aXRoQ2FsbGJhY2s6dGhpcy5kaWRNb3VzZURvd259KX1yZXR1cm4gcChmLGQpLGYucHJvdG90eXBlLmdldExvY2F0aW9uUmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGUsbztyZXR1cm4gbnVsbD09dCYmKHQ9e30pLGU9dC5zdHJpY3Q9PT0hMT90aGlzLmNyZWF0ZUxvY2F0aW9uUmFuZ2VGcm9tRE9NUmFuZ2UobigpLHtzdHJpY3Q6ITF9KTp0Lmlnbm9yZUxvY2s/dGhpcy5jdXJyZW50TG9jYXRpb25SYW5nZTpudWxsIT0obz10aGlzLmxvY2tlZExvY2F0aW9uUmFuZ2UpP286dGhpcy5jdXJyZW50TG9jYXRpb25SYW5nZX0sZi5wcm90b3R5cGUuc2V0TG9jYXRpb25SYW5nZT1mdW5jdGlvbih0KXt2YXIgZTtpZighdGhpcy5sb2NrZWRMb2NhdGlvblJhbmdlKXJldHVybiB0PWEodCksKGU9dGhpcy5jcmVhdGVET01SYW5nZUZyb21Mb2NhdGlvblJhbmdlKHQpKT8obChlKSx0aGlzLnVwZGF0ZUN1cnJlbnRMb2NhdGlvblJhbmdlKHQpKTp2b2lkIDB9LGYucHJvdG90eXBlLnNldExvY2F0aW9uUmFuZ2VGcm9tUG9pbnRSYW5nZT1mdW5jdGlvbih0KXt2YXIgZSxuO3JldHVybiB0PWEodCksbj10aGlzLmdldExvY2F0aW9uQXRQb2ludCh0WzBdKSxlPXRoaXMuZ2V0TG9jYXRpb25BdFBvaW50KHRbMV0pLHRoaXMuc2V0TG9jYXRpb25SYW5nZShbbixlXSl9LGYucHJvdG90eXBlLmdldENsaWVudFJlY3RBdExvY2F0aW9uUmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuKGU9dGhpcy5jcmVhdGVET01SYW5nZUZyb21Mb2NhdGlvblJhbmdlKHQpKT90aGlzLmdldENsaWVudFJlY3RzRm9yRE9NUmFuZ2UoZSlbMV06dm9pZCAwfSxmLnByb3RvdHlwZS5sb2NhdGlvbklzQ3Vyc29yVGFyZ2V0PWZ1bmN0aW9uKHQpe3ZhciBlLG4sbztyZXR1cm4gbz10aGlzLmZpbmROb2RlQW5kT2Zmc2V0RnJvbUxvY2F0aW9uKHQpLGU9b1swXSxuPW9bMV0scyhlKX0sZi5wcm90b3R5cGUubG9jaz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5sb2NrQ291bnQrKz8odGhpcy51cGRhdGVDdXJyZW50TG9jYXRpb25SYW5nZSgpLHRoaXMubG9ja2VkTG9jYXRpb25SYW5nZT10aGlzLmdldExvY2F0aW9uUmFuZ2UoKSk6dm9pZCAwfSxmLnByb3RvdHlwZS51bmxvY2s9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gMD09PS0tdGhpcy5sb2NrQ291bnQmJih0PXRoaXMubG9ja2VkTG9jYXRpb25SYW5nZSx0aGlzLmxvY2tlZExvY2F0aW9uUmFuZ2U9bnVsbCxudWxsIT10KT90aGlzLnNldExvY2F0aW9uUmFuZ2UodCk6dm9pZCAwfSxmLnByb3RvdHlwZS5jbGVhclNlbGVjdGlvbj1mdW5jdGlvbigpe3ZhciB0O3JldHVybiBudWxsIT0odD1vKCkpP3QucmVtb3ZlQWxsUmFuZ2VzKCk6dm9pZCAwfSxmLnByb3RvdHlwZS5zZWxlY3Rpb25Jc0NvbGxhcHNlZD1mdW5jdGlvbigpe3ZhciB0O3JldHVybihudWxsIT0odD1uKCkpP3QuY29sbGFwc2VkOnZvaWQgMCk9PT0hMH0sZi5wcm90b3R5cGUuc2VsZWN0aW9uSXNFeHBhbmRlZD1mdW5jdGlvbigpe3JldHVybiF0aGlzLnNlbGVjdGlvbklzQ29sbGFwc2VkKCl9LGYucHJveHlNZXRob2QoXCJsb2NhdGlvbk1hcHBlci5maW5kTG9jYXRpb25Gcm9tQ29udGFpbmVyQW5kT2Zmc2V0XCIpLGYucHJveHlNZXRob2QoXCJsb2NhdGlvbk1hcHBlci5maW5kQ29udGFpbmVyQW5kT2Zmc2V0RnJvbUxvY2F0aW9uXCIpLGYucHJveHlNZXRob2QoXCJsb2NhdGlvbk1hcHBlci5maW5kTm9kZUFuZE9mZnNldEZyb21Mb2NhdGlvblwiKSxmLnByb3h5TWV0aG9kKFwicG9pbnRNYXBwZXIuY3JlYXRlRE9NUmFuZ2VGcm9tUG9pbnRcIiksZi5wcm94eU1ldGhvZChcInBvaW50TWFwcGVyLmdldENsaWVudFJlY3RzRm9yRE9NUmFuZ2VcIiksZi5wcm90b3R5cGUuZGlkTW91c2VEb3duPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGF1c2VUZW1wb3JhcmlseSgpfSxmLnByb3RvdHlwZS5wYXVzZVRlbXBvcmFyaWx5PWZ1bmN0aW9uKCl7dmFyIGUsbixvLHI7cmV0dXJuIHRoaXMucGF1c2VkPSEwLG49ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIG4saSxzO2ZvcihlLnBhdXNlZD0hMSxjbGVhclRpbWVvdXQociksaT0wLHM9by5sZW5ndGg7cz5pO2krKyluPW9baV0sbi5kZXN0cm95KCk7cmV0dXJuIHQoZG9jdW1lbnQsZS5lbGVtZW50KT9lLnNlbGVjdGlvbkRpZENoYW5nZSgpOnZvaWQgMH19KHRoaXMpLHI9c2V0VGltZW91dChuLDIwMCksbz1mdW5jdGlvbigpe3ZhciB0LG8scixzO2ZvcihyPVtcIm1vdXNlbW92ZVwiLFwia2V5ZG93blwiXSxzPVtdLHQ9MCxvPXIubGVuZ3RoO28+dDt0KyspZT1yW3RdLHMucHVzaChpKGUse29uRWxlbWVudDpkb2N1bWVudCx3aXRoQ2FsbGJhY2s6bn0pKTtyZXR1cm4gc30oKX0sZi5wcm90b3R5cGUuc2VsZWN0aW9uRGlkQ2hhbmdlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGF1c2VkfHxyKHRoaXMuZWxlbWVudCk/dm9pZCAwOnRoaXMudXBkYXRlQ3VycmVudExvY2F0aW9uUmFuZ2UoKX0sZi5wcm90b3R5cGUudXBkYXRlQ3VycmVudExvY2F0aW9uUmFuZ2U9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuKG51bGwhPXQ/dDp0PXRoaXMuY3JlYXRlTG9jYXRpb25SYW5nZUZyb21ET01SYW5nZShuKCkpKSYmIWModCx0aGlzLmN1cnJlbnRMb2NhdGlvblJhbmdlKT8odGhpcy5jdXJyZW50TG9jYXRpb25SYW5nZT10LG51bGwhPShlPXRoaXMuZGVsZWdhdGUpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBlLmxvY2F0aW9uUmFuZ2VEaWRDaGFuZ2U/ZS5sb2NhdGlvblJhbmdlRGlkQ2hhbmdlKHRoaXMuY3VycmVudExvY2F0aW9uUmFuZ2Uuc2xpY2UoMCkpOnZvaWQgMCk6dm9pZCAwfSxmLnByb3RvdHlwZS5jcmVhdGVET01SYW5nZUZyb21Mb2NhdGlvblJhbmdlPWZ1bmN0aW9uKHQpe3ZhciBlLG4sbyxpO3JldHVybiBvPXRoaXMuZmluZENvbnRhaW5lckFuZE9mZnNldEZyb21Mb2NhdGlvbih0WzBdKSxuPXUodCk/bzpudWxsIT0oaT10aGlzLmZpbmRDb250YWluZXJBbmRPZmZzZXRGcm9tTG9jYXRpb24odFsxXSkpP2k6byxudWxsIT1vJiZudWxsIT1uPyhlPWRvY3VtZW50LmNyZWF0ZVJhbmdlKCksZS5zZXRTdGFydC5hcHBseShlLG8pLGUuc2V0RW5kLmFwcGx5KGUsbiksZSk6dm9pZCAwfSxmLnByb3RvdHlwZS5jcmVhdGVMb2NhdGlvblJhbmdlRnJvbURPTVJhbmdlPWZ1bmN0aW9uKHQsZSl7dmFyIG4sbztpZihudWxsIT10JiZ0aGlzLmRvbVJhbmdlV2l0aGluRWxlbWVudCh0KSYmKG89dGhpcy5maW5kTG9jYXRpb25Gcm9tQ29udGFpbmVyQW5kT2Zmc2V0KHQuc3RhcnRDb250YWluZXIsdC5zdGFydE9mZnNldCxlKSkpcmV0dXJuIHQuY29sbGFwc2VkfHwobj10aGlzLmZpbmRMb2NhdGlvbkZyb21Db250YWluZXJBbmRPZmZzZXQodC5lbmRDb250YWluZXIsdC5lbmRPZmZzZXQsZSkpLGEoW28sbl0pfSxmLnByb3RvdHlwZS5nZXRMb2NhdGlvbkF0UG9pbnQ9ZnVuY3Rpb24odCl7dmFyIGUsbjtyZXR1cm4oZT10aGlzLmNyZWF0ZURPTVJhbmdlRnJvbVBvaW50KHQpKSYmbnVsbCE9KG49dGhpcy5jcmVhdGVMb2NhdGlvblJhbmdlRnJvbURPTVJhbmdlKGUpKT9uWzBdOnZvaWQgMH0sZi5wcm90b3R5cGUuZG9tUmFuZ2VXaXRoaW5FbGVtZW50PWZ1bmN0aW9uKGUpe3JldHVybiBlLmNvbGxhcHNlZD90KHRoaXMuZWxlbWVudCxlLnN0YXJ0Q29udGFpbmVyKTp0KHRoaXMuZWxlbWVudCxlLnN0YXJ0Q29udGFpbmVyKSYmdCh0aGlzLmVsZW1lbnQsZS5lbmRDb250YWluZXIpfSxmfShlLkJhc2ljT2JqZWN0KX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe3ZhciB0LG4sbyxpPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9dH1mb3IodmFyIG8gaW4gZSlyLmNhbGwoZSxvKSYmKHRbb109ZVtvXSk7cmV0dXJuIG4ucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBuLHQuX19zdXBlcl9fPWUucHJvdG90eXBlLHR9LHI9e30uaGFzT3duUHJvcGVydHkscz1bXS5zbGljZTtuPWUucmFuZ2VJc0NvbGxhcHNlZCxvPWUucmFuZ2VzQXJlRXF1YWwsdD1lLm9iamVjdHNBcmVFcXVhbCxlLkVkaXRvckNvbnRyb2xsZXI9ZnVuY3Rpb24ocil7ZnVuY3Rpb24gYSh0KXt2YXIgbixvO3RoaXMuZWRpdG9yRWxlbWVudD10LmVkaXRvckVsZW1lbnQsbj10LmRvY3VtZW50LG89dC5odG1sLHRoaXMuc2VsZWN0aW9uTWFuYWdlcj1uZXcgZS5TZWxlY3Rpb25NYW5hZ2VyKHRoaXMuZWRpdG9yRWxlbWVudCksdGhpcy5zZWxlY3Rpb25NYW5hZ2VyLmRlbGVnYXRlPXRoaXMsdGhpcy5jb21wb3NpdGlvbj1uZXcgZS5Db21wb3NpdGlvbix0aGlzLmNvbXBvc2l0aW9uLmRlbGVnYXRlPXRoaXMsdGhpcy5hdHRhY2htZW50TWFuYWdlcj1uZXcgZS5BdHRhY2htZW50TWFuYWdlcih0aGlzLmNvbXBvc2l0aW9uLmdldEF0dGFjaG1lbnRzKCkpLHRoaXMuYXR0YWNobWVudE1hbmFnZXIuZGVsZWdhdGU9dGhpcyx0aGlzLmlucHV0Q29udHJvbGxlcj1uZXcgZS5JbnB1dENvbnRyb2xsZXIodGhpcy5lZGl0b3JFbGVtZW50KSx0aGlzLmlucHV0Q29udHJvbGxlci5kZWxlZ2F0ZT10aGlzLHRoaXMuaW5wdXRDb250cm9sbGVyLnJlc3BvbmRlcj10aGlzLmNvbXBvc2l0aW9uLHRoaXMuY29tcG9zaXRpb25Db250cm9sbGVyPW5ldyBlLkNvbXBvc2l0aW9uQ29udHJvbGxlcih0aGlzLmVkaXRvckVsZW1lbnQsdGhpcy5jb21wb3NpdGlvbiksdGhpcy5jb21wb3NpdGlvbkNvbnRyb2xsZXIuZGVsZWdhdGU9dGhpcyx0aGlzLnRvb2xiYXJDb250cm9sbGVyPW5ldyBlLlRvb2xiYXJDb250cm9sbGVyKHRoaXMuZWRpdG9yRWxlbWVudC50b29sYmFyRWxlbWVudCksdGhpcy50b29sYmFyQ29udHJvbGxlci5kZWxlZ2F0ZT10aGlzLHRoaXMuZWRpdG9yPW5ldyBlLkVkaXRvcih0aGlzLmNvbXBvc2l0aW9uLHRoaXMuc2VsZWN0aW9uTWFuYWdlcix0aGlzLmVkaXRvckVsZW1lbnQpLG51bGwhPW4/dGhpcy5lZGl0b3IubG9hZERvY3VtZW50KG4pOnRoaXMuZWRpdG9yLmxvYWRIVE1MKG8pfXJldHVybiBpKGEsciksYS5wcm90b3R5cGUucmVnaXN0ZXJTZWxlY3Rpb25NYW5hZ2VyPWZ1bmN0aW9uKCl7cmV0dXJuIGUuc2VsZWN0aW9uQ2hhbmdlT2JzZXJ2ZXIucmVnaXN0ZXJTZWxlY3Rpb25NYW5hZ2VyKHRoaXMuc2VsZWN0aW9uTWFuYWdlcil9LGEucHJvdG90eXBlLnVucmVnaXN0ZXJTZWxlY3Rpb25NYW5hZ2VyPWZ1bmN0aW9uKCl7cmV0dXJuIGUuc2VsZWN0aW9uQ2hhbmdlT2JzZXJ2ZXIudW5yZWdpc3RlclNlbGVjdGlvbk1hbmFnZXIodGhpcy5zZWxlY3Rpb25NYW5hZ2VyKX0sYS5wcm90b3R5cGUuY29tcG9zaXRpb25EaWRDaGFuZ2VEb2N1bWVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkaXRvckVsZW1lbnQubm90aWZ5KFwiZG9jdW1lbnQtY2hhbmdlXCIpLHRoaXMuaGFuZGxpbmdJbnB1dD92b2lkIDA6dGhpcy5yZW5kZXIoKX0sYS5wcm90b3R5cGUuY29tcG9zaXRpb25EaWRDaGFuZ2VDdXJyZW50QXR0cmlidXRlcz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jdXJyZW50QXR0cmlidXRlcz10LHRoaXMudG9vbGJhckNvbnRyb2xsZXIudXBkYXRlQXR0cmlidXRlcyh0aGlzLmN1cnJlbnRBdHRyaWJ1dGVzKSx0aGlzLnVwZGF0ZUN1cnJlbnRBY3Rpb25zKCksdGhpcy5lZGl0b3JFbGVtZW50Lm5vdGlmeShcImF0dHJpYnV0ZXMtY2hhbmdlXCIse2F0dHJpYnV0ZXM6dGhpcy5jdXJyZW50QXR0cmlidXRlc30pfSxhLnByb3RvdHlwZS5jb21wb3NpdGlvbkRpZFBlcmZvcm1JbnNlcnRpb25BdFJhbmdlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnBhc3Rpbmc/dGhpcy5wYXN0ZWRSYW5nZT10OnZvaWQgMH0sYS5wcm90b3R5cGUuY29tcG9zaXRpb25TaG91bGRBY2NlcHRGaWxlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmVkaXRvckVsZW1lbnQubm90aWZ5KFwiZmlsZS1hY2NlcHRcIix7ZmlsZTp0fSl9LGEucHJvdG90eXBlLmNvbXBvc2l0aW9uRGlkQWRkQXR0YWNobWVudD1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gZT10aGlzLmF0dGFjaG1lbnRNYW5hZ2VyLm1hbmFnZUF0dGFjaG1lbnQodCksdGhpcy5lZGl0b3JFbGVtZW50Lm5vdGlmeShcImF0dGFjaG1lbnQtYWRkXCIse2F0dGFjaG1lbnQ6ZX0pfSxhLnByb3RvdHlwZS5jb21wb3NpdGlvbkRpZEVkaXRBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiB0aGlzLmNvbXBvc2l0aW9uQ29udHJvbGxlci5yZXJlbmRlclZpZXdGb3JPYmplY3QodCksZT10aGlzLmF0dGFjaG1lbnRNYW5hZ2VyLm1hbmFnZUF0dGFjaG1lbnQodCksdGhpcy5lZGl0b3JFbGVtZW50Lm5vdGlmeShcImF0dGFjaG1lbnQtZWRpdFwiLHthdHRhY2htZW50OmV9KSx0aGlzLmVkaXRvckVsZW1lbnQubm90aWZ5KFwiY2hhbmdlXCIpfSxhLnByb3RvdHlwZS5jb21wb3NpdGlvbkRpZENoYW5nZUF0dGFjaG1lbnRQcmV2aWV3VVJMPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbXBvc2l0aW9uQ29udHJvbGxlci5pbnZhbGlkYXRlVmlld0Zvck9iamVjdCh0KSx0aGlzLmVkaXRvckVsZW1lbnQubm90aWZ5KFwiY2hhbmdlXCIpfSxhLnByb3RvdHlwZS5jb21wb3NpdGlvbkRpZFJlbW92ZUF0dGFjaG1lbnQ9ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIGU9dGhpcy5hdHRhY2htZW50TWFuYWdlci51bm1hbmFnZUF0dGFjaG1lbnQodCksdGhpcy5lZGl0b3JFbGVtZW50Lm5vdGlmeShcImF0dGFjaG1lbnQtcmVtb3ZlXCIse2F0dGFjaG1lbnQ6ZX0pfSxhLnByb3RvdHlwZS5jb21wb3NpdGlvbkRpZFN0YXJ0RWRpdGluZ0F0dGFjaG1lbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuYXR0YWNobWVudExvY2F0aW9uUmFuZ2U9dGhpcy5jb21wb3NpdGlvbi5kb2N1bWVudC5nZXRMb2NhdGlvblJhbmdlT2ZBdHRhY2htZW50KHQpLHRoaXMuY29tcG9zaXRpb25Db250cm9sbGVyLmluc3RhbGxBdHRhY2htZW50RWRpdG9yRm9yQXR0YWNobWVudCh0KSx0aGlzLnNlbGVjdGlvbk1hbmFnZXIuc2V0TG9jYXRpb25SYW5nZSh0aGlzLmF0dGFjaG1lbnRMb2NhdGlvblJhbmdlKX0sYS5wcm90b3R5cGUuY29tcG9zaXRpb25EaWRTdG9wRWRpdGluZ0F0dGFjaG1lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb21wb3NpdGlvbkNvbnRyb2xsZXIudW5pbnN0YWxsQXR0YWNobWVudEVkaXRvcigpLHRoaXMuYXR0YWNobWVudExvY2F0aW9uUmFuZ2U9bnVsbH0sYS5wcm90b3R5cGUuY29tcG9zaXRpb25EaWRSZXF1ZXN0Q2hhbmdpbmdTZWxlY3Rpb25Ub0xvY2F0aW9uUmFuZ2U9ZnVuY3Rpb24odCl7cmV0dXJuIXRoaXMubG9hZGluZ1NuYXBzaG90fHx0aGlzLmlzRm9jdXNlZCgpPyh0aGlzLnJlcXVlc3RlZExvY2F0aW9uUmFuZ2U9dCx0aGlzLmNvbXBvc2l0aW9uUmV2aXNpb25XaGVuTG9jYXRpb25SYW5nZVJlcXVlc3RlZD10aGlzLmNvbXBvc2l0aW9uLnJldmlzaW9uLHRoaXMuaGFuZGxpbmdJbnB1dD92b2lkIDA6dGhpcy5yZW5kZXIoKSk6dm9pZCAwfSxhLnByb3RvdHlwZS5jb21wb3NpdGlvbldpbGxMb2FkU25hcHNob3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb2FkaW5nU25hcHNob3Q9ITB9LGEucHJvdG90eXBlLmNvbXBvc2l0aW9uRGlkTG9hZFNuYXBzaG90PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb25Db250cm9sbGVyLnJlZnJlc2hWaWV3Q2FjaGUoKSx0aGlzLnJlbmRlcigpLHRoaXMubG9hZGluZ1NuYXBzaG90PSExfSxhLnByb3RvdHlwZS5nZXRTZWxlY3Rpb25NYW5hZ2VyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0aW9uTWFuYWdlcn0sYS5wcm94eU1ldGhvZChcImdldFNlbGVjdGlvbk1hbmFnZXIoKS5zZXRMb2NhdGlvblJhbmdlXCIpLGEucHJveHlNZXRob2QoXCJnZXRTZWxlY3Rpb25NYW5hZ2VyKCkuZ2V0TG9jYXRpb25SYW5nZVwiKSxhLnByb3RvdHlwZS5hdHRhY2htZW50TWFuYWdlckRpZFJlcXVlc3RSZW1vdmFsT2ZBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnJlbW92ZUF0dGFjaG1lbnQodCl9LGEucHJvdG90eXBlLmNvbXBvc2l0aW9uQ29udHJvbGxlcldpbGxTeW5jRG9jdW1lbnRWaWV3PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5wdXRDb250cm9sbGVyLmVkaXRvcldpbGxTeW5jRG9jdW1lbnRWaWV3KCksdGhpcy5zZWxlY3Rpb25NYW5hZ2VyLmxvY2soKSx0aGlzLnNlbGVjdGlvbk1hbmFnZXIuY2xlYXJTZWxlY3Rpb24oKX0sYS5wcm90b3R5cGUuY29tcG9zaXRpb25Db250cm9sbGVyRGlkU3luY0RvY3VtZW50Vmlldz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlucHV0Q29udHJvbGxlci5lZGl0b3JEaWRTeW5jRG9jdW1lbnRWaWV3KCksdGhpcy5zZWxlY3Rpb25NYW5hZ2VyLnVubG9jaygpLHRoaXMudXBkYXRlQ3VycmVudEFjdGlvbnMoKSx0aGlzLmVkaXRvckVsZW1lbnQubm90aWZ5KFwic3luY1wiKX0sYS5wcm90b3R5cGUuY29tcG9zaXRpb25Db250cm9sbGVyRGlkUmVuZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPXRoaXMucmVxdWVzdGVkTG9jYXRpb25SYW5nZSYmKHRoaXMuY29tcG9zaXRpb25SZXZpc2lvbldoZW5Mb2NhdGlvblJhbmdlUmVxdWVzdGVkPT09dGhpcy5jb21wb3NpdGlvbi5yZXZpc2lvbiYmdGhpcy5zZWxlY3Rpb25NYW5hZ2VyLnNldExvY2F0aW9uUmFuZ2UodGhpcy5yZXF1ZXN0ZWRMb2NhdGlvblJhbmdlKSx0aGlzLnJlcXVlc3RlZExvY2F0aW9uUmFuZ2U9bnVsbCx0aGlzLmNvbXBvc2l0aW9uUmV2aXNpb25XaGVuTG9jYXRpb25SYW5nZVJlcXVlc3RlZD1udWxsKSx0aGlzLnJlbmRlcmVkQ29tcG9zaXRpb25SZXZpc2lvbiE9PXRoaXMuY29tcG9zaXRpb24ucmV2aXNpb24mJih0aGlzLmNvbXBvc2l0aW9uLnVwZGF0ZUN1cnJlbnRBdHRyaWJ1dGVzKCksdGhpcy5lZGl0b3JFbGVtZW50Lm5vdGlmeShcInJlbmRlclwiKSksdGhpcy5yZW5kZXJlZENvbXBvc2l0aW9uUmV2aXNpb249dGhpcy5jb21wb3NpdGlvbi5yZXZpc2lvbn0sYS5wcm90b3R5cGUuY29tcG9zaXRpb25Db250cm9sbGVyRGlkRm9jdXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b29sYmFyQ29udHJvbGxlci5oaWRlRGlhbG9nKCksdGhpcy5lZGl0b3JFbGVtZW50Lm5vdGlmeShcImZvY3VzXCIpfSxhLnByb3RvdHlwZS5jb21wb3NpdGlvbkNvbnRyb2xsZXJEaWRCbHVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdG9yRWxlbWVudC5ub3RpZnkoXCJibHVyXCIpfSxhLnByb3RvdHlwZS5jb21wb3NpdGlvbkNvbnRyb2xsZXJEaWRTZWxlY3RBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbXBvc2l0aW9uLmVkaXRBdHRhY2htZW50KHQpfSxhLnByb3RvdHlwZS5jb21wb3NpdGlvbkNvbnRyb2xsZXJEaWRSZXF1ZXN0RGVzZWxlY3RpbmdBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIGU9bnVsbCE9KG49dGhpcy5hdHRhY2htZW50TG9jYXRpb25SYW5nZSk/bjp0aGlzLmNvbXBvc2l0aW9uLmRvY3VtZW50LmdldExvY2F0aW9uUmFuZ2VPZkF0dGFjaG1lbnQodCksdGhpcy5zZWxlY3Rpb25NYW5hZ2VyLnNldExvY2F0aW9uUmFuZ2UoZVsxXSl9LGEucHJvdG90eXBlLmNvbXBvc2l0aW9uQ29udHJvbGxlcldpbGxVcGRhdGVBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmVkaXRvci5yZWNvcmRVbmRvRW50cnkoXCJFZGl0IEF0dGFjaG1lbnRcIix7Y29udGV4dDp0LmlkLGNvbnNvbGlkYXRhYmxlOiEwfSl9LGEucHJvdG90eXBlLmNvbXBvc2l0aW9uQ29udHJvbGxlckRpZFJlcXVlc3RSZW1vdmFsT2ZBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnJlbW92ZUF0dGFjaG1lbnQodCl9LGEucHJvdG90eXBlLmlucHV0Q29udHJvbGxlcldpbGxIYW5kbGVJbnB1dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhhbmRsaW5nSW5wdXQ9ITAsdGhpcy5yZXF1ZXN0ZWRSZW5kZXI9ITF9LGEucHJvdG90eXBlLmlucHV0Q29udHJvbGxlckRpZFJlcXVlc3RSZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXF1ZXN0ZWRSZW5kZXI9ITB9LGEucHJvdG90eXBlLmlucHV0Q29udHJvbGxlckRpZEhhbmRsZUlucHV0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFuZGxpbmdJbnB1dD0hMSx0aGlzLnJlcXVlc3RlZFJlbmRlcj8odGhpcy5yZXF1ZXN0ZWRSZW5kZXI9ITEsdGhpcy5yZW5kZXIoKSk6dm9pZCAwfSxhLnByb3RvdHlwZS5pbnB1dENvbnRyb2xsZXJEaWRBbGxvd1VuaGFuZGxlZElucHV0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdG9yRWxlbWVudC5ub3RpZnkoXCJjaGFuZ2VcIil9LGEucHJvdG90eXBlLmlucHV0Q29udHJvbGxlckRpZFJlcXVlc3RSZXBhcnNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwYXJzZSgpfSxhLnByb3RvdHlwZS5pbnB1dENvbnRyb2xsZXJXaWxsUGVyZm9ybVR5cGluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlY29yZFR5cGluZ1VuZG9FbnRyeSgpfSxhLnByb3RvdHlwZS5pbnB1dENvbnRyb2xsZXJXaWxsQ3V0VGV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkaXRvci5yZWNvcmRVbmRvRW50cnkoXCJDdXRcIil9LGEucHJvdG90eXBlLmlucHV0Q29udHJvbGxlcldpbGxQYXN0ZVRleHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGl0b3IucmVjb3JkVW5kb0VudHJ5KFwiUGFzdGVcIiksdGhpcy5wYXN0aW5nPSEwfSxhLnByb3RvdHlwZS5pbnB1dENvbnRyb2xsZXJEaWRQYXN0ZT1mdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gZT10aGlzLnBhc3RlZFJhbmdlLHRoaXMucGFzdGVkUmFuZ2U9bnVsbCx0aGlzLnBhc3Rpbmc9bnVsbCx0aGlzLmVkaXRvckVsZW1lbnQubm90aWZ5KFwicGFzdGVcIix7cGFzdGVEYXRhOnQscmFuZ2U6ZX0pfSxhLnByb3RvdHlwZS5pbnB1dENvbnRyb2xsZXJXaWxsTW92ZVRleHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGl0b3IucmVjb3JkVW5kb0VudHJ5KFwiTW92ZVwiKX0sYS5wcm90b3R5cGUuaW5wdXRDb250cm9sbGVyV2lsbEF0dGFjaEZpbGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdG9yLnJlY29yZFVuZG9FbnRyeShcIkRyb3AgRmlsZXNcIil9LGEucHJvdG90eXBlLmlucHV0Q29udHJvbGxlckRpZFJlY2VpdmVLZXlib2FyZENvbW1hbmQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudG9vbGJhckNvbnRyb2xsZXIuYXBwbHlLZXlib2FyZENvbW1hbmQodCl9LGEucHJvdG90eXBlLmlucHV0Q29udHJvbGxlckRpZFN0YXJ0RHJhZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxvY2F0aW9uUmFuZ2VCZWZvcmVEcmFnPXRoaXMuc2VsZWN0aW9uTWFuYWdlci5nZXRMb2NhdGlvblJhbmdlKCl9LGEucHJvdG90eXBlLmlucHV0Q29udHJvbGxlckRpZFJlY2VpdmVEcmFnT3ZlclBvaW50PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNlbGVjdGlvbk1hbmFnZXIuc2V0TG9jYXRpb25SYW5nZUZyb21Qb2ludFJhbmdlKHQpfSxhLnByb3RvdHlwZS5pbnB1dENvbnRyb2xsZXJEaWRDYW5jZWxEcmFnPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0aW9uTWFuYWdlci5zZXRMb2NhdGlvblJhbmdlKHRoaXMubG9jYXRpb25SYW5nZUJlZm9yZURyYWcpLHRoaXMubG9jYXRpb25SYW5nZUJlZm9yZURyYWc9bnVsbH0sYS5wcm90b3R5cGUubG9jYXRpb25SYW5nZURpZENoYW5nZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb21wb3NpdGlvbi51cGRhdGVDdXJyZW50QXR0cmlidXRlcygpLHRoaXMudXBkYXRlQ3VycmVudEFjdGlvbnMoKSx0aGlzLmF0dGFjaG1lbnRMb2NhdGlvblJhbmdlJiYhbyh0aGlzLmF0dGFjaG1lbnRMb2NhdGlvblJhbmdlLHQpJiZ0aGlzLmNvbXBvc2l0aW9uLnN0b3BFZGl0aW5nQXR0YWNobWVudCgpLHRoaXMuZWRpdG9yRWxlbWVudC5ub3RpZnkoXCJzZWxlY3Rpb24tY2hhbmdlXCIpfSxhLnByb3RvdHlwZS50b29sYmFyRGlkQ2xpY2tCdXR0b249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRMb2NhdGlvblJhbmdlKCk/dm9pZCAwOnRoaXMuc2V0TG9jYXRpb25SYW5nZSh7aW5kZXg6MCxvZmZzZXQ6MH0pfSxhLnByb3RvdHlwZS50b29sYmFyRGlkSW52b2tlQWN0aW9uPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmludm9rZUFjdGlvbih0KX0sYS5wcm90b3R5cGUudG9vbGJhckRpZFRvZ2dsZUF0dHJpYnV0ZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5yZWNvcmRGb3JtYXR0aW5nVW5kb0VudHJ5KCksdGhpcy5jb21wb3NpdGlvbi50b2dnbGVDdXJyZW50QXR0cmlidXRlKHQpLHRoaXMucmVuZGVyKCksdGhpcy5zZWxlY3Rpb25Gcm96ZW4/dm9pZCAwOnRoaXMuZWRpdG9yRWxlbWVudC5mb2N1cygpfSxhLnByb3RvdHlwZS50b29sYmFyRGlkVXBkYXRlQXR0cmlidXRlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMucmVjb3JkRm9ybWF0dGluZ1VuZG9FbnRyeSgpLHRoaXMuY29tcG9zaXRpb24uc2V0Q3VycmVudEF0dHJpYnV0ZSh0LGUpLHRoaXMucmVuZGVyKCksdGhpcy5zZWxlY3Rpb25Gcm96ZW4/dm9pZCAwOnRoaXMuZWRpdG9yRWxlbWVudC5mb2N1cygpfSxhLnByb3RvdHlwZS50b29sYmFyRGlkUmVtb3ZlQXR0cmlidXRlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnJlY29yZEZvcm1hdHRpbmdVbmRvRW50cnkoKSx0aGlzLmNvbXBvc2l0aW9uLnJlbW92ZUN1cnJlbnRBdHRyaWJ1dGUodCksdGhpcy5yZW5kZXIoKSx0aGlzLnNlbGVjdGlvbkZyb3plbj92b2lkIDA6dGhpcy5lZGl0b3JFbGVtZW50LmZvY3VzKCl9LGEucHJvdG90eXBlLnRvb2xiYXJXaWxsU2hvd0RpYWxvZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbXBvc2l0aW9uLmV4cGFuZFNlbGVjdGlvbkZvckVkaXRpbmcoKSx0aGlzLmZyZWV6ZVNlbGVjdGlvbigpfSxhLnByb3RvdHlwZS50b29sYmFyRGlkU2hvd0RpYWxvZz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5lZGl0b3JFbGVtZW50Lm5vdGlmeShcInRvb2xiYXItZGlhbG9nLXNob3dcIix7ZGlhbG9nTmFtZTp0fSl9LGEucHJvdG90eXBlLnRvb2xiYXJEaWRIaWRlRGlhbG9nPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRoYXdTZWxlY3Rpb24oKSx0aGlzLmVkaXRvckVsZW1lbnQuZm9jdXMoKSx0aGlzLmVkaXRvckVsZW1lbnQubm90aWZ5KFwidG9vbGJhci1kaWFsb2ctaGlkZVwiLHtkaWFsb2dOYW1lOnR9KX0sYS5wcm90b3R5cGUuZnJlZXplU2VsZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0aW9uRnJvemVuP3ZvaWQgMDoodGhpcy5zZWxlY3Rpb25NYW5hZ2VyLmxvY2soKSx0aGlzLmNvbXBvc2l0aW9uLmZyZWV6ZVNlbGVjdGlvbigpLHRoaXMuc2VsZWN0aW9uRnJvemVuPSEwLHRoaXMucmVuZGVyKCkpfSxhLnByb3RvdHlwZS50aGF3U2VsZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0aW9uRnJvemVuPyh0aGlzLmNvbXBvc2l0aW9uLnRoYXdTZWxlY3Rpb24oKSx0aGlzLnNlbGVjdGlvbk1hbmFnZXIudW5sb2NrKCksdGhpcy5zZWxlY3Rpb25Gcm96ZW49ITEsdGhpcy5yZW5kZXIoKSk6dm9pZCAwfSxhLnByb3RvdHlwZS5hY3Rpb25zPXt1bmRvOnt0ZXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdG9yLmNhblVuZG8oKX0scGVyZm9ybTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVkaXRvci51bmRvKCl9fSxyZWRvOnt0ZXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdG9yLmNhblJlZG8oKX0scGVyZm9ybTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVkaXRvci5yZWRvKCl9fSxsaW5rOnt0ZXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdG9yLmNhbkFjdGl2YXRlQXR0cmlidXRlKFwiaHJlZlwiKX19LGluY3JlYXNlTmVzdGluZ0xldmVsOnt0ZXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdG9yLmNhbkluY3JlYXNlTmVzdGluZ0xldmVsKCl9LHBlcmZvcm06ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGl0b3IuaW5jcmVhc2VOZXN0aW5nTGV2ZWwoKSYmdGhpcy5yZW5kZXIoKX19LGRlY3JlYXNlTmVzdGluZ0xldmVsOnt0ZXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdG9yLmNhbkRlY3JlYXNlTmVzdGluZ0xldmVsKCl9LHBlcmZvcm06ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGl0b3IuZGVjcmVhc2VOZXN0aW5nTGV2ZWwoKSYmdGhpcy5yZW5kZXIoKX19LGluY3JlYXNlQmxvY2tMZXZlbDp7dGVzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVkaXRvci5jYW5JbmNyZWFzZU5lc3RpbmdMZXZlbCgpfSxwZXJmb3JtOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRpdG9yLmluY3JlYXNlTmVzdGluZ0xldmVsKCkmJnRoaXMucmVuZGVyKCl9fSxkZWNyZWFzZUJsb2NrTGV2ZWw6e3Rlc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGl0b3IuY2FuRGVjcmVhc2VOZXN0aW5nTGV2ZWwoKX0scGVyZm9ybTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVkaXRvci5kZWNyZWFzZU5lc3RpbmdMZXZlbCgpJiZ0aGlzLnJlbmRlcigpfX19LGEucHJvdG90eXBlLmNhbkludm9rZUFjdGlvbj1mdW5jdGlvbih0KXt2YXIgZSxuO3JldHVybiB0aGlzLmFjdGlvbklzRXh0ZXJuYWwodCk/ITA6ISEobnVsbCE9KGU9dGhpcy5hY3Rpb25zW3RdKSYmbnVsbCE9KG49ZS50ZXN0KT9uLmNhbGwodGhpcyk6dm9pZCAwKX0sYS5wcm90b3R5cGUuaW52b2tlQWN0aW9uPWZ1bmN0aW9uKHQpe3ZhciBlLG47cmV0dXJuIHRoaXMuYWN0aW9uSXNFeHRlcm5hbCh0KT90aGlzLmVkaXRvckVsZW1lbnQubm90aWZ5KFwiYWN0aW9uLWludm9rZVwiLHthY3Rpb25OYW1lOnR9KTpudWxsIT0oZT10aGlzLmFjdGlvbnNbdF0pJiZudWxsIT0obj1lLnBlcmZvcm0pP24uY2FsbCh0aGlzKTp2b2lkIDB9LGEucHJvdG90eXBlLmFjdGlvbklzRXh0ZXJuYWw9ZnVuY3Rpb24odCl7cmV0dXJuL154LS4vLnRlc3QodCl9LGEucHJvdG90eXBlLmdldEN1cnJlbnRBY3Rpb25zPWZ1bmN0aW9uKCl7dmFyIHQsZTtlPXt9O2Zvcih0IGluIHRoaXMuYWN0aW9ucyllW3RdPXRoaXMuY2FuSW52b2tlQWN0aW9uKHQpO3JldHVybiBlfSxhLnByb3RvdHlwZS51cGRhdGVDdXJyZW50QWN0aW9ucz1mdW5jdGlvbigpe3ZhciBlO3JldHVybiBlPXRoaXMuZ2V0Q3VycmVudEFjdGlvbnMoKSx0KGUsdGhpcy5jdXJyZW50QWN0aW9ucyk/dm9pZCAwOih0aGlzLmN1cnJlbnRBY3Rpb25zPWUsdGhpcy50b29sYmFyQ29udHJvbGxlci51cGRhdGVBY3Rpb25zKHRoaXMuY3VycmVudEFjdGlvbnMpLHRoaXMuZWRpdG9yRWxlbWVudC5ub3RpZnkoXCJhY3Rpb25zLWNoYW5nZVwiLHthY3Rpb25zOnRoaXMuY3VycmVudEFjdGlvbnN9KSl9LGEucHJvdG90eXBlLnJlcGFyc2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb21wb3NpdGlvbi5yZXBsYWNlSFRNTCh0aGlzLmVkaXRvckVsZW1lbnQuaW5uZXJIVE1MKX0sYS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tcG9zaXRpb25Db250cm9sbGVyLnJlbmRlcigpfSxhLnByb3RvdHlwZS5yZW1vdmVBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmVkaXRvci5yZWNvcmRVbmRvRW50cnkoXCJEZWxldGUgQXR0YWNobWVudFwiKSx0aGlzLmNvbXBvc2l0aW9uLnJlbW92ZUF0dGFjaG1lbnQodCksdGhpcy5yZW5kZXIoKX0sYS5wcm90b3R5cGUucmVjb3JkRm9ybWF0dGluZ1VuZG9FbnRyeT1mdW5jdGlvbigpe3ZhciB0O3JldHVybiB0PXRoaXMuc2VsZWN0aW9uTWFuYWdlci5nZXRMb2NhdGlvblJhbmdlKCksbih0KT92b2lkIDA6dGhpcy5lZGl0b3IucmVjb3JkVW5kb0VudHJ5KFwiRm9ybWF0dGluZ1wiLHtjb250ZXh0OnRoaXMuZ2V0VW5kb0NvbnRleHQoKSxjb25zb2xpZGF0YWJsZTohMH0pfSxhLnByb3RvdHlwZS5yZWNvcmRUeXBpbmdVbmRvRW50cnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGl0b3IucmVjb3JkVW5kb0VudHJ5KFwiVHlwaW5nXCIse2NvbnRleHQ6dGhpcy5nZXRVbmRvQ29udGV4dCh0aGlzLmN1cnJlbnRBdHRyaWJ1dGVzKSxjb25zb2xpZGF0YWJsZTohMH0pfSxhLnByb3RvdHlwZS5nZXRVbmRvQ29udGV4dD1mdW5jdGlvbigpe3ZhciB0O3JldHVybiB0PTE8PWFyZ3VtZW50cy5sZW5ndGg/cy5jYWxsKGFyZ3VtZW50cywwKTpbXSxbdGhpcy5nZXRMb2NhdGlvbkNvbnRleHQoKSx0aGlzLmdldFRpbWVDb250ZXh0KCldLmNvbmNhdChzLmNhbGwodCkpfSxhLnByb3RvdHlwZS5nZXRMb2NhdGlvbkNvbnRleHQ9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdD10aGlzLnNlbGVjdGlvbk1hbmFnZXIuZ2V0TG9jYXRpb25SYW5nZSgpLG4odCk/dFswXS5pbmRleDp0fSxhLnByb3RvdHlwZS5nZXRUaW1lQ29udGV4dD1mdW5jdGlvbigpe3JldHVybiBlLmNvbmZpZy51bmRvSW50ZXJ2YWw+MD9NYXRoLmZsb29yKChuZXcgRGF0ZSkuZ2V0VGltZSgpL2UuY29uZmlnLnVuZG9JbnRlcnZhbCk6MH0sYS5wcm90b3R5cGUuaXNGb2N1c2VkPWZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHRoaXMuZWRpdG9yRWxlbWVudD09PShudWxsIT0odD10aGlzLmVkaXRvckVsZW1lbnQub3duZXJEb2N1bWVudCk/dC5hY3RpdmVFbGVtZW50OnZvaWQgMCl9LGF9KGUuQ29udHJvbGxlcil9LmNhbGwodGhpcyksZnVuY3Rpb24oKXt2YXIgdCxuLG8saSxyLHM7aT1lLm1ha2VFbGVtZW50LHI9ZS5zZWxlY3Rpb25FbGVtZW50cyxzPWUudHJpZ2dlckV2ZW50LG49ZS5oYW5kbGVFdmVudCxvPWUuaGFuZGxlRXZlbnRPbmNlLHQ9ZS5BdHRhY2htZW50Vmlldy5hdHRhY2htZW50U2VsZWN0b3IsZS5yZWdpc3RlckVsZW1lbnQoXCJ0cml4LWVkaXRvclwiLGZ1bmN0aW9uKCl7dmFyIGEsdSxjLGwsaCxwO3JldHVybiBsPTAsYT1mdW5jdGlvbih0KXtyZXR1cm4hZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIjpmb2N1c1wiKSYmdC5oYXNBdHRyaWJ1dGUoXCJhdXRvZm9jdXNcIikmJmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJbYXV0b2ZvY3VzXVwiKT09PXQ/dC5mb2N1cygpOnZvaWQgMH0saD1mdW5jdGlvbih0KXtyZXR1cm4gdC5oYXNBdHRyaWJ1dGUoXCJjb250ZW50ZWRpdGFibGVcIik/dm9pZCAwOih0LnNldEF0dHJpYnV0ZShcImNvbnRlbnRlZGl0YWJsZVwiLFwiXCIpLG8oXCJmb2N1c1wiLHtvbkVsZW1lbnQ6dCx3aXRoQ2FsbGJhY2s6ZnVuY3Rpb24oKXtyZXR1cm4gdSh0KX19KSl9LHU9ZnVuY3Rpb24odCl7cmV0dXJuIGModCkscCh0KX0sYz1mdW5jdGlvbih0KXtyZXR1cm4oXCJmdW5jdGlvblwiPT10eXBlb2YgZG9jdW1lbnQucXVlcnlDb21tYW5kU3VwcG9ydGVkP2RvY3VtZW50LnF1ZXJ5Q29tbWFuZFN1cHBvcnRlZChcImVuYWJsZU9iamVjdFJlc2l6aW5nXCIpOnZvaWQgMCk/KGRvY3VtZW50LmV4ZWNDb21tYW5kKFwiZW5hYmxlT2JqZWN0UmVzaXppbmdcIiwhMSwhMSksbihcIm1zY29udHJvbHNlbGVjdFwiLHtvbkVsZW1lbnQ6dCxwcmV2ZW50RGVmYXVsdDohMH0pKTp2b2lkIDB9LHA9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4oXCJmdW5jdGlvblwiPT10eXBlb2YgZG9jdW1lbnQucXVlcnlDb21tYW5kU3VwcG9ydGVkP2RvY3VtZW50LnF1ZXJ5Q29tbWFuZFN1cHBvcnRlZChcIkRlZmF1bHRQYXJhZ3JhcGhTZXBhcmF0b3JcIik6dm9pZCAwKSYmKHQ9ZS5jb25maWcuYmxvY2tBdHRyaWJ1dGVzW1wiZGVmYXVsdFwiXS50YWdOYW1lLFwiZGl2XCI9PT10fHxcInBcIj09PXQpP2RvY3VtZW50LmV4ZWNDb21tYW5kKFwiRGVmYXVsdFBhcmFncmFwaFNlcGFyYXRvclwiLCExLHQpOnZvaWQgMH0se2RlZmF1bHRDU1M6XCIldDplbXB0eTpub3QoOmZvY3VzKTo6YmVmb3JlIHtcXG4gIGNvbnRlbnQ6IGF0dHIocGxhY2Vob2xkZXIpO1xcbiAgY29sb3I6IGdyYXl0ZXh0O1xcbn1cXG5cXG4ldCBhW2NvbnRlbnRlZGl0YWJsZT1mYWxzZV0ge1xcbiAgY3Vyc29yOiB0ZXh0O1xcbn1cXG5cXG4ldCBpbWcge1xcbiAgbWF4LXdpZHRoOiAxMDAlO1xcbiAgaGVpZ2h0OiBhdXRvO1xcbn1cXG5cXG4ldCBcIit0K1wiIGZpZ2NhcHRpb24gdGV4dGFyZWEge1xcbiAgcmVzaXplOiBub25lO1xcbn1cXG5cXG4ldCBcIit0K1wiIGZpZ2NhcHRpb24gdGV4dGFyZWEudHJpeC1hdXRvcmVzaXplLWNsb25lIHtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIGxlZnQ6IC05OTk5cHg7XFxuICBtYXgtaGVpZ2h0OiAwcHg7XFxufVxcblxcbiV0IFwiK3QrJ1tkYXRhLXRyaXgtbXV0YWJsZV0gZmlnY2FwdGlvbjplbXB0eTo6YmVmb3JlIHtcXG4gIGNvbnRlbnQ6IFwiJytlLmNvbmZpZy5sYW5nLmNhcHRpb25Qcm9tcHQrJ1wiO1xcbiAgY29sb3I6IGdyYXl0ZXh0O1xcbn1cXG5cXG4ldCAnK3Iuc2VsZWN0b3IrXCIgeyBcIityLmNzc1RleHQrXCIgfVwiLHRyaXhJZDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzQXR0cmlidXRlKFwidHJpeC1pZFwiKT90aGlzLmdldEF0dHJpYnV0ZShcInRyaXgtaWRcIik6KHRoaXMuc2V0QXR0cmlidXRlKFwidHJpeC1pZFwiLCsrbCksdGhpcy50cml4SWQpfX0sdG9vbGJhckVsZW1lbnQ6e2dldDpmdW5jdGlvbigpe3ZhciB0LGUsbjtyZXR1cm4gdGhpcy5oYXNBdHRyaWJ1dGUoXCJ0b29sYmFyXCIpP251bGwhPShlPXRoaXMub3duZXJEb2N1bWVudCk/ZS5nZXRFbGVtZW50QnlJZCh0aGlzLmdldEF0dHJpYnV0ZShcInRvb2xiYXJcIikpOnZvaWQgMDp0aGlzLnBhcmVudEVsZW1lbnQ/KG49XCJ0cml4LXRvb2xiYXItXCIrdGhpcy50cml4SWQsdGhpcy5zZXRBdHRyaWJ1dGUoXCJ0b29sYmFyXCIsbiksdD1pKFwidHJpeC10b29sYmFyXCIse2lkOm59KSx0aGlzLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHQsdGhpcyksdCk6dm9pZCAwfX0saW5wdXRFbGVtZW50OntnZXQ6ZnVuY3Rpb24oKXt2YXIgdCxlLG47cmV0dXJuIHRoaXMuaGFzQXR0cmlidXRlKFwiaW5wdXRcIik/bnVsbCE9KG49dGhpcy5vd25lckRvY3VtZW50KT9uLmdldEVsZW1lbnRCeUlkKHRoaXMuZ2V0QXR0cmlidXRlKFwiaW5wdXRcIikpOnZvaWQgMDp0aGlzLnBhcmVudEVsZW1lbnQ/KGU9XCJ0cml4LWlucHV0LVwiK3RoaXMudHJpeElkLHRoaXMuc2V0QXR0cmlidXRlKFwiaW5wdXRcIixlKSx0PWkoXCJpbnB1dFwiLHt0eXBlOlwiaGlkZGVuXCIsaWQ6ZX0pLHRoaXMucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUodCx0aGlzLm5leHRFbGVtZW50U2libGluZyksdCk6dm9pZCAwfX0sZWRpdG9yOntnZXQ6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gbnVsbCE9KHQ9dGhpcy5lZGl0b3JDb250cm9sbGVyKT90LmVkaXRvcjp2b2lkIDB9fSxuYW1lOntnZXQ6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gbnVsbCE9KHQ9dGhpcy5pbnB1dEVsZW1lbnQpP3QubmFtZTp2b2lkIDB9fSx2YWx1ZTp7Z2V0OmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIG51bGwhPSh0PXRoaXMuaW5wdXRFbGVtZW50KT90LnZhbHVlOnZvaWQgMH0sc2V0OmZ1bmN0aW9uKHQpe3ZhciBlO3JldHVybiB0aGlzLmRlZmF1bHRWYWx1ZT10LG51bGwhPShlPXRoaXMuZWRpdG9yKT9lLmxvYWRIVE1MKHRoaXMuZGVmYXVsdFZhbHVlKTp2b2lkIDB9fSxub3RpZnk6ZnVuY3Rpb24odCxuKXt2YXIgbztzd2l0Y2godCl7Y2FzZVwiZG9jdW1lbnQtY2hhbmdlXCI6dGhpcy5kb2N1bWVudENoYW5nZWRTaW5jZUxhc3RSZW5kZXI9ITA7YnJlYWs7Y2FzZVwicmVuZGVyXCI6dGhpcy5kb2N1bWVudENoYW5nZWRTaW5jZUxhc3RSZW5kZXImJih0aGlzLmRvY3VtZW50Q2hhbmdlZFNpbmNlTGFzdFJlbmRlcj0hMSx0aGlzLm5vdGlmeShcImNoYW5nZVwiKSk7YnJlYWs7Y2FzZVwiY2hhbmdlXCI6Y2FzZVwiYXR0YWNobWVudC1hZGRcIjpjYXNlXCJhdHRhY2htZW50LWVkaXRcIjpjYXNlXCJhdHRhY2htZW50LXJlbW92ZVwiOm51bGwhPShvPXRoaXMuaW5wdXRFbGVtZW50KSYmKG8udmFsdWU9ZS5zZXJpYWxpemVUb0NvbnRlbnRUeXBlKHRoaXMsXCJ0ZXh0L2h0bWxcIikpfXJldHVybiB0aGlzLmVkaXRvckNvbnRyb2xsZXI/cyhcInRyaXgtXCIrdCx7b25FbGVtZW50OnRoaXMsYXR0cmlidXRlczpufSk6dm9pZCAwfSxjcmVhdGVkQ2FsbGJhY2s6ZnVuY3Rpb24oKXtyZXR1cm4gaCh0aGlzKX0sYXR0YWNoZWRDYWxsYmFjazpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc0F0dHJpYnV0ZShcImRhdGEtdHJpeC1pbnRlcm5hbFwiKT92b2lkIDA6KG51bGw9PXRoaXMuZWRpdG9yQ29udHJvbGxlciYmKHRoaXMuZWRpdG9yQ29udHJvbGxlcj1uZXcgZS5FZGl0b3JDb250cm9sbGVyKHtlZGl0b3JFbGVtZW50OnRoaXMsaHRtbDp0aGlzLmRlZmF1bHRWYWx1ZT10aGlzLnZhbHVlfSkpLHRoaXMuZWRpdG9yQ29udHJvbGxlci5yZWdpc3RlclNlbGVjdGlvbk1hbmFnZXIoKSx0aGlzLnJlZ2lzdGVyUmVzZXRMaXN0ZW5lcigpLGEodGhpcykscmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiB0Lm5vdGlmeShcImluaXRpYWxpemVcIil9fSh0aGlzKSkpfSxkZXRhY2hlZENhbGxiYWNrOmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIG51bGwhPSh0PXRoaXMuZWRpdG9yQ29udHJvbGxlcikmJnQudW5yZWdpc3RlclNlbGVjdGlvbk1hbmFnZXIoKSx0aGlzLnVucmVnaXN0ZXJSZXNldExpc3RlbmVyKCl9LHJlZ2lzdGVyUmVzZXRMaXN0ZW5lcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlc2V0TGlzdGVuZXI9dGhpcy5yZXNldEJ1YmJsZWQuYmluZCh0aGlzKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsdGhpcy5yZXNldExpc3RlbmVyLCExKX0sdW5yZWdpc3RlclJlc2V0TGlzdGVuZXI6ZnVuY3Rpb24oKXtyZXR1cm4gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXNldFwiLHRoaXMucmVzZXRMaXN0ZW5lciwhMSl9LHJlc2V0QnViYmxlZDpmdW5jdGlvbih0KXt2YXIgZTtyZXR1cm4gdC50YXJnZXQhPT0obnVsbCE9KGU9dGhpcy5pbnB1dEVsZW1lbnQpP2UuZm9ybTp2b2lkIDApfHx0LmRlZmF1bHRQcmV2ZW50ZWQ/dm9pZCAwOnRoaXMucmVzZXQoKX0scmVzZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52YWx1ZT10aGlzLmRlZmF1bHRWYWx1ZX19fSgpKX0uY2FsbCh0aGlzKSxmdW5jdGlvbigpe30uY2FsbCh0aGlzKX0pLmNhbGwodGhpcyksXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQmJmRlZmluZShlKX0uY2FsbCh0aGlzKTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/trix/dist/trix.js\n");

/***/ }),

/***/ "./node_modules/webpack/buildin/amd-options.js":
/*!****************************************!*\
  !*** (webpack)/buildin/amd-options.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("/* WEBPACK VAR INJECTION */(function(__webpack_amd_options__) {/* globals __webpack_amd_options__ */\r\nmodule.exports = __webpack_amd_options__;\r\n\n/* WEBPACK VAR INJECTION */}.call(this, {}))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvd2VicGFjay9idWlsZGluL2FtZC1vcHRpb25zLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL2FtZC1vcHRpb25zLmpzPzAwODYiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFscyBfX3dlYnBhY2tfYW1kX29wdGlvbnNfXyAqL1xyXG5tb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19hbWRfb3B0aW9uc19fO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7O0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack/buildin/amd-options.js\n");

/***/ })

}]);